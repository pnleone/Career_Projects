{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Cybersecurity &amp; Systems Engineering Portfolio","text":"<p>Building secure, data\u2011driven systems that elevate operational resilience</p>"},{"location":"#about","title":"About","text":"<p>Paul Leone | Aspiring Security Analyst &amp; Infrastructure Engineer</p> <p>Welcome to my professional portfolio. This site showcases my journey into cybersecurity, documenting the technical labs, security frameworks, and automation workflows I've built to defend modern infrastructure.</p> <p>My focus is on bridging the gap between IT Operations (SysAdmin) and Security Operations (Blue Teaming). Through these projects, I demonstrate a commitment to continuous learning, a \"secure-by-design\" mindset, and the technical proficiency required to mitigate risks in enterprise environments.</p>"},{"location":"#projects","title":"Projects","text":"Project Description Business Intelligence &amp; Data Analytics Engineered data pipelines using SQL Server and Power Query to transform raw data into actionable insights. Developed automated reporting dashboards in Power BI for executive decision support. Threat Intelligence Brief &amp; SOC Improvement Plan Enhanced threat intelligence brief with TTP breakdown mapped to MITRE ATT&amp;CK framework. Strategic improvement plan aligned to NIST CSF 2.0 and CIS Controls 8.1 with custom YARA and Sigma detection rules. Security Homelab: Overview and Landing Page Enterprise-grade security laboratory demonstrating production-ready capabilities across SecOps, systems engineering, and network defense. Multi-layered architecture with SIEM, IDS/IPS, SOAR automation, and zero trust controls."},{"location":"#featured-project-security-homelab","title":"Featured Project: Security Homelab","text":"<p>Enterprise-Grade Security Engineering Environment</p> <p>A fully segmented, detection-focused homelab built to simulate real SOC workflows and enterprise infrastructure.</p> <p>Key Capabilities:</p> <ul> <li>Advanced Threat Detection \u2014 Behavioral threat intelligence (CrowdSec), network anomaly detection (Suricata/Snort), and SIEM correlation (ELK Stack/Splunk)</li> <li>Automated Incident Response \u2014 SOAR workflows integrate TheHive case management, Cortex/MISP enrichment, and automated remediation</li> <li>Defense-in-Depth Architecture \u2014 Multi-layer controls spanning network perimeter, application layer, identity management, and endpoint protection</li> <li>Infrastructure as Code \u2014 Terraform and Ansible enable version-controlled, repeatable deployments with full audit trails</li> <li>Full-Stack Observability \u2014 Unified metrics collection (Prometheus), visualization (Grafana), and real-time alerting</li> </ul> <p>Architecture Principles:</p> <ul> <li>Defense in Depth \u2014 Network segmentation, WAF protection, endpoint EDR, and identity verification create overlapping defensive barriers</li> <li>Secure by Design \u2014 All services default to encrypted communications (TLS), authenticated access (SSO/MFA), and least-privilege authorization (RBAC)</li> <li>Zero Trust Architecture \u2014 No implicit trust based on network location; continuous authentication and authorization for every request</li> </ul> <p> View Full Lab Documentation</p>"},{"location":"#what-i-do","title":"What I Do","text":"<p> Security Engineering Building detection pipelines, log ingestion workflows, and monitoring architectures that provide actionable threat visibility across enterprise environments.</p> <p> Threat-Informed Defense Mapping adversary behaviors to detections and controls using MITRE ATT&amp;CK framework. Creating custom detection rules (YARA, Sigma) based on threat intelligence.</p> <p> Data Analytics &amp; Automation Transforming raw security data into dashboards and insights. Automating repetitive tasks through Python, PowerShell, and workflow orchestration (n8n, Shuffle).</p> <p> Cloud &amp; Infrastructure Designing secure, scalable environments using virtualization (Proxmox, Docker), infrastructure as code (Terraform, Ansible), and high-availability architectures.</p> <p> Technical Writing &amp; Documentation Creating clear, structured documentation for complex systems. Translating technical implementations into business value for stakeholders.</p> <p> Compliance &amp; Frameworks Aligning security controls to industry standards (NIST CSF 2.0, CIS Controls v8, ISO 27001, MITRE ATT&amp;CK) with audit-ready documentation.</p>"},{"location":"#career-focus","title":"Career Focus","text":"<p>I'm focused on roles where I can combine security engineering, analytics, and operational problem-solving:</p> <ul> <li>SOC Analyst / Security Operations \u2014 Monitoring, detection, incident response, and threat hunting</li> <li>Security Engineer \u2014 Building security controls, automation, and defensive architecture</li> <li>Infrastructure Security \u2014 Securing cloud/on-prem infrastructure, identity management, and network defense</li> <li>Detection Engineer \u2014 Creating custom detection rules, tuning SIEM, and improving alert fidelity</li> </ul>"},{"location":"#professional-development","title":"Professional Development","text":""},{"location":"#certifications","title":"Certifications","text":"<p>Completed:</p> <ul> <li> Cisco Certified Network Associate (CCNA) \u2014 July 2024</li> <li> CompTIA Security+ \u2014 February 2025</li> <li> TryHackMe SOC Level 1 \u2014 August 2025</li> <li> TryHackMe Jr Penetration Tester \u2014 October 2025</li> <li> Fortinet Certified Fundamentals in Cybersecurity \u2014 October 2024</li> </ul> <p>In Progress:</p> <ul> <li> EC-Council Certified Ethical Hacker (CEH)</li> </ul>"},{"location":"#continuous-learning","title":"Continuous Learning","text":"<p>Active participant in hands-on security training platforms (TryHackMe) and CTF competitions through EC Council to maintain current knowledge of attack techniques and defensive strategies.</p>"},{"location":"#technical-skills-summary","title":"Technical Skills Summary","text":""},{"location":"#security-operations","title":"Security Operations","text":"<p>Wazuh XDR \u2022 Splunk \u2022 ELK Stack \u2022 Suricata \u2022 Snort \u2022 TheHive \u2022 Shuffle SOAR \u2022 MISP \u2022 Nessus \u2022 OpenVAS \u2022 VirusTotal</p>"},{"location":"#network-infrastructure","title":"Network &amp; Infrastructure","text":"<p>pfSense \u2022 OPNsense \u2022 FortiGate \u2022 Proxmox \u2022 Docker \u2022 Kubernetes \u2022 VMware ESXi \u2022 Traefik \u2022 Cloudflare \u2022 Tailscale \u2022 DNS \u2022 HTTP/HTTPS</p>"},{"location":"#identity-access-management","title":"Identity &amp; Access Management","text":"<p>Authentik \u2022 Active Directory \u2022 StepCA PKI \u2022 OAuth2/OIDC/SAML \u2022 MFA \u2022 RBAC</p>"},{"location":"#security-tooling","title":"Security Tooling","text":"<p>Wireshark \u2022 Brim \u2022 Sysinternals \u2022 CyberChef \u2022 Volatility \u2022 Nmap \u2022 Burp Suite \u2022 Metasploit </p>"},{"location":"#monitoring-analysis","title":"Monitoring &amp; Analysis","text":"<p>Grafana \u2022 Prometheus \u2022 Checkmk \u2022 Uptime Kuma \u2022 NetAlertX \u2022 Pulse</p>"},{"location":"#automation-scripting","title":"Automation &amp; Scripting","text":"<p>Python \u2022 PowerShell \u2022 Bash \u2022 SQL \u2022 Ansible \u2022 Terraform \u2022 n8n \u2022 Git/GitHub \u2022 JSON/YAML/XML \u2022 REST API</p>"},{"location":"#compliance-frameworks","title":"Compliance &amp; Frameworks","text":"<p>NIST CSF 2.0 \u2022 CIS Controls v8.1 \u2022 ISO 27001 \u2022 MITRE ATT&amp;CK \u2022 OWASP \u2022 CIS Benchmarks</p>"},{"location":"#operating-system-administration","title":"Operating System Administration","text":"<p>Windows 11 \u2022 Windows Server \u2022 Linux (Debian/Red Hat) \u2022 FreeBSD \u2022 macOS \u2022 iOS \u2022 Android</p>"},{"location":"#why-work-with-me","title":"Why Work With Me","text":"<p>Hybrid Skillset: Background in both IT operations (systems administration) and security operations (blue team) provides comprehensive understanding of infrastructure security.</p> <p>Hands-On Experience: Extensive homelab demonstrates production-ready capabilities with enterprise-grade tools and architectures directly transferable to SOC, security engineering, and infrastructure roles.</p> <p>Business-Focused: Projects emphasize operational outcomes and business value, not just technical implementation. Documentation targets both technical and executive audiences.</p> <p>Continuous Learner: Active certification pursuit and homelab expansion demonstrate commitment to staying current with evolving threat landscape and security technologies.</p> <p>Process-Driven: Security controls aligned to industry frameworks (NIST, CIS, MITRE) with audit-ready documentation and policy enforcement.</p>"},{"location":"#resume-contact","title":"Resume &amp; Contact","text":"<p>Download Resume</p> <p> Current Resume (PDF)</p>"},{"location":"#connect-with-me","title":"Connect With Me","text":"<p> LinkedIn \u2022  GitHub \u2022  pnleone@outlook.com</p> <p>This portfolio is actively maintained and updated with new projects, certifications, and technical implementations. Last updated: January 2026</p>"},{"location":"matrix/","title":"Matrix","text":""},{"location":"matrix/#comprehensive-framework-alignment-matrix","title":"Comprehensive Framework Alignment Matrix","text":"Security Domain NIST CSF 2.0 CIS v8.1 ISO 27001:2022 NIST 800-53 Rev 5 PCI-DSS v4.0 OWASP 2025 MITRE ATT&amp;CK v18.1 CISA ZTMM v2.0 NIST SP 800-207 Asset Management ID.AM-01 to ID.AM-08 1.1-1.5, 2.1-2.4 A.5.9, A.8.1 CM-8, CM-8(1)-(3), PM-5 2.4, 6.4.3 N/A T1018, T1046, T1135 Devices: Advanced Tenet 1: Resource Inventory Network Segmentation PR.AC, DE.CM 12.1-12.4, 13.4 A.8.20, A.8.22 SC-7, SC-7(21) 1.1.1, 1.3.1 A01 (SSRF), A06 N/A Networks: Advanced Tenet 2: Micro-segmentation Firewall Management PR.AC, SC-7 12.1-12.2 A.8.20 SC-7, SC-7(5) 1.2.1, 1.4.2 A02 N/A Networks: Advanced Tenet 2: Boundary Protection Firewall HA PR.IR-01, RC.RP 12.1, 12.2 A.8.14, A.8.20 CP-9, SC-7(20), SI-4(1) 1.1.1, 1.3.7 N/A N/A Networks: Advanced Tenet 7: Resilience DMZ Architecture PR.IR, SC-7 12.2 A.8.20, A.8.22 SC-7(21) 1.3.1 A06 N/A Networks: Advanced Tenet 2: Isolation Network Monitoring DE.CM 13.1-13.6 A.8.16, A.8.20 SI-4, SI-4(1)(4) 11.4.1, 11.4.2 A09 T1046, T1049, T1590 Visibility: Advanced Tenet 7: Comprehensive Telemetry IDS/IPS DE.CM-01, DE.AE-02 13.1-13.3, 13.6-13.8 A.8.7, A.8.16, A.8.20 SI-4, SI-4(1)(2)(5) 11.4.1, 11.4.2 N/A T1046, T1595 Visibility: Advanced Tenet 7: Monitoring WAF Protection DE.CM, RS.MI 13.10 A.8.23, A.8.26 SI-4(23), SI-10, SC-7(11) 6.6 A01, A05 (Injection) T1190, T1659 Apps: Advanced Tenet 4: Policy Enforcement VPN/Remote Access PR.AC, PR.DS-02 12.3, 12.7, 13.10 A.5.14, A.6.7, A.8.21 AC-17, AC-17(1)(2)(4), SC-8, SC-13 4.1, 8.2.3, 12.3 N/A T1133 Identity: Advanced Tenet 2: Location Independence Access Control &amp; Authorization PR.AA, PR.AC 6.1-6.6 A.5.15, A.5.18, A.8.3 AC-2, AC-3, AC-6 7.1, 7.2, 8.1 A01 (Broken Access Control) T1078, T1098, T1087 Identity: Advanced Tenet 3: Least Privilege RBAC Implementation AC-3(7), PR.AA 6.8 A.5.18, A.8.3 AC-2(7), AC-3(7) 7.1.2 A01 T1078 Identity: Advanced Tenet 3: Role-Based Access Least Privilege AC-6, PR.AA 5.4, 6.1-6.6 A.5.18 AC-6, AC-6(1)(2)(5) 7.1.1 A01, A06 T1548 Identity: Advanced Tenet 3: Least Privilege SSRF Prevention PR.AC, DE.CM 12.3, 13.10 A.8.20, A.8.21 SC-7, SI-10 6.6 A01 N/A Networks: Advanced Tenet 4: Policy Enforcement SSO Implementation IA-2(10), PR.AA 6.6-6.7 A.5.15, A.8.5 IA-2(10) 8.2.1 A07 (Authentication) T1078 Identity: Advanced Tenet 3: Centralized Identity MFA Enforcement IA-2(1), PR.AA-01 6.3-6.5 A.5.17, A.8.5 IA-2(1)(2) 8.2.3, 8.3.1 A07 T1078, T1111 Identity: Advanced Tenet 6: Phishing-Resistant MFA SSH Key Management IA-5(2), PR.AA 5.6, 6.7 A.5.17, A.8.24 IA-5(2), IA-5(14) 8.3.2 A07 T1552, T1078 Identity: Advanced Tenet 6: Certificate-Based Auth Account Lockout AC-7, PR.AA 6.3 A.9.4.2 AC-7 8.2.4, 8.2.5 A07 T1110 Identity: Advanced Tenet 6: Automated Protection Session Management AC-12, SC-23 6.3 A.8.5 AC-2(5), AC-11, AC-12, SC-23 8.1.8 A07 T1539, T1563 Identity: Advanced Tenet 3: Session-Based Access Password Management IA-5(1), PR.DS 5.2, 6.2 A.5.17 IA-5(1), IA-5(18) 8.2.2, 8.3.2 A07 T1555, T1552 Identity: Advanced Tenet 6: Strong Authentication Credential Protection IA-5(7), PR.DS 3.11, 6.7 A.5.17, A.8.24 IA-5(7), IA-5(18), SC-28(3) 3.5, 3.6, 8.3.2 A07, A08 T1003, T1555, T1552 Data: Advanced Tenet 6: Credential Encryption Active Directory PR.AA-01, AC-2 5.3, 5.6, 6.1, 6.8 A.5.16, A.8.2 AC-2, AC-3(7), IA-2, IA-4, IA-5 8.2, 8.3 A07 T1087, T1482 Identity: Advanced Tenet 3: Centralized Directory Secrets Management PR.DS-01, IA-5(7) 3.11, 5.2, 6.7 A.5.17, A.8.24 IA-5(7), IA-5(18), SC-12, SC-28(3) 3.5, 3.6, 8.2.1 A07, A08 T1552, T1555 Data: Advanced Tenet 6: Zero-Knowledge Vault PKI/Certificate Management PR.DS-10, SC-17 3.12, 16.14 A.8.24 SC-12, SC-13, SC-17, SC-17(1), IA-5(14) 4.2.1 A04 (Cryptography) N/A Identity: Advanced Tenet 6: Automated PKI TLS/Encryption (Transit) PR.DS-02, SC-8 3.10, 12.6, 13.10 A.8.24 SC-8, SC-8(1), SC-13 4.2.1 A04 N/A Data: Advanced Tenet 2: Encrypt All Communications Encryption at Rest PR.DS-01, SC-28 3.11 A.8.24 SC-28, SC-28(1)(3) 3.4, 4.2.1 A04 N/A Data: Advanced Tenet 2: Protect Data at Rest Key Management SC-12, PR.DS 3.12, 6.7 A.8.24 SC-12, SC-13 4.2.1 A04 N/A Data: Advanced Tenet 6: Protected Key Storage DNSSEC SC-20, PR.DS 9.2, 12.6 A.8.21, A.8.23 SC-20, SC-20(2), SC-21 2.2.5 A04 N/A Networks: Advanced Tenet 2: DNS Integrity DNS Security PR.DS, DE.CM 9.2, 12.6 A.8.21, A.8.23 SC-20, SC-20(2), SC-21 2.2.5 N/A T1071.004, T1568 Networks: Advanced Tenet 7: DNS Monitoring Configuration Management PR.PS-01, CM-2 4.1-4.12, 16.7 A.8.9, A.8.32 CM-2, CM-3, CM-6, CM-6(1), CM-7 2.2.2, 2.2.4 A02 (Misconfiguration) T1547, T1112 Devices: Advanced Tenet 5: Asset Integrity Baseline Hardening CM-6, PR.IP 4.1-4.7 A.8.9 CM-6, CM-6(1) 2.2.2, 2.2.4 A02 N/A Devices: Advanced Tenet 5: Security Baselines Configuration Drift Detection CM-6(1), PR.PS 4.1 A.8.9 CM-3, CM-6(1) 2.2.4 A02 T1562.001 Devices: Advanced Tenet 5: Automated Monitoring IaC/Automation PR.PS-01, CM-2(2) 4.1-4.2, 16.1, 16.7, 18.1 A.5.8, A.5.37, A.8.9, A.8.32 CM-2(2)(3), CM-3, CM-9 6.4.5, 11.6.1 A02, A08 N/A Automation: Advanced Tenet 5: Immutable Infrastructure Default Credentials IA-5(1), CM-6 4.7, 5.2 A.5.17 IA-5(1) 2.2.3, 8.2.2 A02, A07 T1078 Identity: Advanced Tenet 6: No Default Credentials Security Headers SC-8, PR.DS 9.2, 13.10 A.8.21, A.8.26 SC-8, SI-10 6.6 A02, A05 N/A Apps: Advanced Tenet 4: Defense in Depth Vulnerability Management ID.RA-01 to ID.RA-08, PR.IP, DE.CM-09 7.1-7.7 A.8.8 RA-3, RA-5, RA-5(2)(3)(5)(8)(10) 6.3.1, 11.3.1 N/A T1190, T1210 Devices: Advanced Tenet 5: Continuous Assessment Vulnerability Scanning RA-5, DE.CM-09 7.5-7.6 A.8.8, A.12.6.1 RA-5, RA-5(2)(3)(5) 11.3.1, 11.3.2 N/A N/A Devices: Advanced Tenet 5: Automated Scanning Patch Management SI-2, PR.PS-03 7.3-7.4, 12.1 A.8.8, A.8.19 SI-2, SI-2(2)(4)(6), CM-8 6.3.3 N/A T1068, T1210 Devices: Advanced Tenet 5: Rapid Remediation SBOM/Supply Chain GV.SC, ID.RA 15.1-15.7, 16.4-16.5 A.5.19-5.22 SR-3, SR-11, SA-10 12.8.1-12.8.5 A03 (Supply Chain) T1195, T1199 Governance: Developing Tenet 5: Component Verification Software Verification CM-14, SI-7 2.3, 16.11 A.8.32 SI-7(6), CM-14, SR-11 6.3.2 A03, A08 T1195, T1553 Devices: Advanced Tenet 5: Signature Validation Dependency Tracking GV.SC-02, ID.RA 16.4 A.5.21 SR-3, SA-10 12.8.5 A03 T1195 Governance: Developing Tenet 5: SBOM Management Logging/Monitoring DE.CM, DE.AE, AU-2 8.1-8.11, 13.1, 13.6 A.8.15, A.8.16 AU-2, AU-3, AU-6, AU-6(1)(3)(5), AU-12 10.2, 10.3, 10.6 A09 (Logging &amp; Alerting) T1070, T1562.002 Visibility: Advanced Tenet 7: Comprehensive Telemetry Log Protection AU-9, DE.CM 8.9, 8.10 A.8.15 AU-9, AU-11, SI-12 10.5.1 A09 T1070, T1562.002 Visibility: Advanced Tenet 7: Immutable Logs Real-Time Alerting DE.AE-06, RS.CO, SI-4(5) 8.11, 13.1, 17.2, 17.6 A.6.8, A.8.16 AU-5(2), SI-4(5)(12), IR-6(1) 10.6, 12.10 A09 N/A Visibility: Advanced Tenet 7: Automated Alerts Alert Correlation DE.AE, AU-6(3) 8.11, 13.6 A.8.16 AU-6(1)(3)(5), SI-4(16) 10.6 A09 N/A Visibility: Advanced Tenet 7: Cross-Pillar Correlation Time Synchronization DE.CM, AU-8 8.4 A.8.17 AU-8, SC-45, SC-45(1) 10.4 N/A N/A Visibility: Advanced Tenet 7: Synchronized Timestamps Malware Defenses DE.CM-04, SI-3 10.1-10.7 A.8.7 SI-3, SI-3(4)(10), SI-7 5.1, 5.2 N/A T1204, T1566 Devices: Advanced Tenet 5: Threat Protection Antivirus/EDR SI-3, DE.CM 10.1-10.2, 13.2 A.8.7 SI-3, SI-3(4), SI-4(23) 5.1, 5.2 N/A T1562.001 Devices: Advanced Tenet 5: Endpoint Detection File Integrity Monitoring SI-7, SI-7(1) 10.1, 13.2 A.8.7, A.8.16 SI-7(1)(6)(7), AU-9 11.5 A08 (Data Integrity) T1070, T1565 Devices: Advanced Tenet 5: Change Detection Data Protection PR.DS, ID.AM-07 3.1-3.14 A.5.12, A.5.14, A.5.33, A.5.34, A.8.10 SC-28, MP-6, MP-4 3.1-3.7, 4.1-4.2 A04 T1005, T1025 Data: Advanced Tenet 2: Encrypt Everything Data Classification PR.DS, GV.PO 3.7, 3.12 A.5.12 MP-3, RA-2 3.1 N/A N/A Data: Advanced Tenet 4: Sensitivity-Based Controls DLP PR.DS, DE.CM 3.13 A.8.12 SC-7, SI-4 3.4 N/A T1020, T1030, T1048 Data: Developing Tenet 4: Egress Monitoring Backup/Recovery RC.RP, RC.HL, CP-9 11.1-11.5 A.5.29, A.5.30, A.8.13, A.8.14 CP-9, CP-9(1)(3)(8), CP-10 12.10.1 N/A T1490, T1486 Data: Advanced Tenet 7: Resilience Business Continuity RC.RP, CP-2 11.1-11.5 A.5.29, A.5.30, A.17.1 CP-2, CP-6, CP-7 12.10 N/A N/A Governance: Advanced Tenet 7: Service Continuity Incident Response RS.AN, RS.CO, RS.MA, RS.MI 17.1-17.9 A.5.24-5.28, A.6.8 IR-4, IR-4(1)(4), IR-5, IR-5(1), IR-6, IR-7, IR-8 12.10 N/A All Tactics Automation: Advanced Tenet 6: Automated Response SOAR Platform RS.AN, RS.MI, IR-4(1) 17.1-17.9 A.5.24, A.5.25, A.5.26 IR-4(1), IR-5(1), IR-6(1), AU-6(1)(5) 12.10 N/A All Tactics Automation: Advanced Tenet 6: Orchestrated Workflows Threat Intelligence ID.RA-02, DE.AE-07 7.1, 16.4 A.5.7 PM-16(1), RA-3(1), SI-4(18) 11.3.1 N/A T1592-T1597 Visibility: Advanced Tenet 7: Contextual Enrichment Threat Hunting DE.CM, RA-10 13.6 A.8.16 RA-10, SI-4(16) 11.4 N/A All Tactics Visibility: Advanced Tenet 7: Proactive Detection Phishing Detection ID.RA-02, DE.AE-02 9.2, 17.1 A.5.7, A.5.24 SI-3, SI-4, IR-4 11.4, 12.10 N/A T1566 Apps: Advanced Tenet 4: Email Security Brute Force Detection DE.CM, AC-7 6.3-6.5, 8.11 A.5.17, A.8.5 AC-7, SI-4(5) 8.2.4, 8.2.5 A07 T1110 Identity: Advanced Tenet 6: Automated Lockout Credential Dumping Detection DE.CM, SI-4(23) 10.1, 13.2 A.8.7 SI-4(23), AU-6 10.6, 11.4 N/A T1003 Devices: Advanced Tenet 5: LSASS Protection Process Monitoring DE.CM, AU-12 10.1, 13.2 A.8.16 SI-4(23), AU-12 10.2, 10.6 N/A T1059, T1106 Devices: Advanced Tenet 5: Execution Telemetry PowerShell Logging DE.CM, AU-12 8.8, 10.1 A.8.15 AU-3(1), SI-4 10.2.7 N/A T1059.001 Devices: Advanced Tenet 5: Script Auditing Registry Monitoring DE.CM, CM-6(1) 4.1, 8.11 A.8.9, A.8.16 CM-6(1), SI-7(1) 2.2.4, 10.6 A02, A08 T1112, T1547 Devices: Advanced Tenet 5: Persistence Detection Service Creation Detection DE.CM, CM-8(3) 4.8, 10.1 A.8.1, A.8.16 SI-4, AU-12 10.2, 11.5 N/A T1543, T1569 Devices: Advanced Tenet 5: Service Monitoring Scheduled Task Monitoring DE.CM, AU-12 7.1, 8.11 A.8.16 SI-4, AU-12 10.2, 10.6 N/A T1053 Devices: Advanced Tenet 5: Task Auditing Account Monitoring AC-2(4), DE.CM 5.1, 6.1, 8.11 A.5.16, A.8.16 AC-2(4)(12), AU-12 8.1.2, 10.2.5 A01, A07 T1136, T1098 Identity: Advanced Tenet 3: Lifecycle Tracking Privilege Escalation Detection AC-6(9), DE.CM 5.4, 6.5, 8.11 A.8.2, A.8.18 AC-6(9), SI-4 7.1, 10.2 A01 T1548, T1134 Identity: Advanced Tenet 3: Anomaly Detection LSASS Protection IA-5, SI-3(10) 5.2, 10.1 A.5.17, A.8.7 IA-5(7), SI-3(10) 8.2.1 A07 T1003 Identity: Advanced Tenet 6: Memory Protection Lateral Movement Detection DE.CM, SI-4(16) 12.3, 13.1-13.3 A.8.16, A.8.20 SI-4(1)(16), AU-6(3) 10.6, 11.4 N/A T1021, T1080 Visibility: Advanced Tenet 7: Cross-Host Correlation RDP/SMB/SSH Monitoring AC-17(1), DE.CM 12.3, 12.7, 13.6 A.6.7, A.8.16 AC-17(1), SI-4(4) 8.3, 10.2 N/A T1021.001-.004 Identity: Advanced Tenet 2: Remote Session Tracking Network Scanning Detection DE.CM, SI-4(1) 13.1-13.3, 18.1 A.8.16, A.8.20 SI-4(1)(4), CA-8 11.3, 11.4 N/A T1046, T1018 Networks: Advanced Tenet 7: Reconnaissance Detection Port Scan Detection DE.CM, SI-4(1) 13.1, 13.3 A.8.16, A.8.20 SI-4(1)(4) 11.4 N/A T1046 Networks: Advanced Tenet 7: Anomaly Detection C2 Beacon Detection DE.CM, SI-4(18) 13.1, 13.6 A.5.7, A.8.16 SI-4(18), IR-4(4) 10.6, 11.4 N/A T1071, T1095 Visibility: Advanced Tenet 7: Traffic Analysis DNS Tunneling Detection DE.CM, SI-4 8.6, 9.2, 13.6 A.8.16, A.8.21 SC-20, SC-21, SI-4 10.6 N/A T1071.004, T1048.003 Networks: Advanced Tenet 7: DNS Analysis DGA Detection DE.CM, SI-4 9.2, 13.6 A.8.16, A.8.23 SC-20(2), SI-4 10.6 N/A T1568 Networks: Advanced Tenet 7: Behavioral Analysis Proxy Detection DE.CM, SC-7 12.3, 13.10 A.8.20, A.8.21 SC-7(8), SI-4 1.3, 10.6 N/A T1090 Networks: Advanced Tenet 7: Proxy Monitoring Ransomware Detection DE.CM, IR-4(1) 10.1, 11.1-11.5 A.5.24, A.8.7 IR-4(1), SI-3(10) 12.10 N/A T1486 Automation: Advanced Tenet 6: Automated Containment Cryptomining Detection DE.CM, SI-4 10.1, 13.2 A.8.7, A.8.16 SI-4, AU-6 10.6, 11.4 N/A T1496 Devices: Advanced Tenet 5: Resource Monitoring Data Exfiltration Detection DE.CM, SI-4(4) 13.6 A.8.12, A.8.16 SI-4(4), SC-7 10.6 N/A T1020, T1041 Data: Developing Tenet 4: Egress Detection USB Device Monitoring MP-7, DE.CM 11.2.5 A.7.10, A.8.16 MP-2, MP-7, SI-4 9.6 N/A T1091, T1052 Devices: Advanced Tenet 5: Removable Media Control Web Shell Detection DE.CM, SI-3 13.10, 16.7 A.8.7, A.8.26 SI-3, SI-10 6.6, 11.4 A05 T1505 Apps: Advanced Tenet 4: Web Application Security WMI Monitoring DE.CM, AU-12 8.8, 10.1 A.8.16 SI-4, AU-12 10.2 N/A T1047, T1546.003 Devices: Developing Tenet 5: WMI Auditing Container Security SC-39, DE.CM 16.1-16.14 A.8.27 SC-39, CM-7 6.4.3 N/A T1059.013, T1610, T1611 Apps: Developing Tenet 4: Workload Isolation Log Tampering Detection AU-9, SI-7 8.9, 8.10 A.8.15 AU-9, SI-7 10.5 A09 T1070, T1562.002 Visibility: Advanced Tenet 7: Immutable Audit Obfuscation Detection DE.CM, SI-3(10) 10.1, 13.2 A.8.7 SI-3(10), SI-4(18) 5.2, 11.4 A05 T1027, T1140 Devices: Developing Tenet 5: Entropy Analysis Pass-the-Hash Detection IA-2, DE.CM 6.3, 8.11 A.5.17, A.8.16 IA-2(1), SI-4 8.3, 10.2 A07 T1550.002 Identity: Developing Tenet 6: Credential Replay Detection Kerberos Monitoring IA-2, DE.CM 6.1, 8.11 A.5.17, A.8.16 IA-2, SI-4 8.2, 10.2 A07 T1558 Identity: Developing Tenet 6: Ticket Analysis DLL Injection Detection SI-3, DE.CM 10.1, 13.2 A.8.7 SI-3, SI-7 5.2, 11.5 N/A T1055 Devices: Developing Tenet 5: Injection Detection Browser Extension Monitoring DE.CM, CM-8 9.4, 16.1 A.8.1 CM-8, SI-4 6.5.4 N/A T1176 Apps: Developing Tenet 4: Extension Inventory Input Validation SI-10, PR.DS 13.10, 16.7 A.8.26 SI-10 6.5 A05 (Injection Prevention) T1659 Apps: Advanced Tenet 4: Boundary Checking SQL Injection Prevention SI-10, PR.PS 16.7 A.8.26, A.14.2 SI-10, SA-11 6.5.1 A05 N/A Apps: Advanced Tenet 4: Parameterized Queries XSS Prevention SI-10, PR.DS 9.2, 13.10 A.8.23, A.8.26 SI-10 6.5.7 A05 N/A Apps: Advanced Tenet 4: Output Encoding Command Injection Prevention SI-10, PR.PS 16.7 A.8.26 SI-10 6.5 A05 T1059 Apps: Advanced Tenet 4: Input Sanitization Secure Architecture PL-8, RA-3 12.2, 16.1 A.8.27, A.14.1 SA-8, SA-17, PL-8 6.4 A06 (Insecure Design) N/A Governance: Advanced Tenet 4: Security by Design Threat Modeling RA-3, PL-8 16.14, 18.1 A.14.1, A.14.2 SA-8, RA-3 6.3.1 A06 N/A Governance: Developing Tenet 4: Risk-Based Design Defense in Depth PR.IR, PL-8(1) 12.2, 13.4 A.8.27, A.13.1 SC-7, PL-8(1) 1.2 A06 N/A All Pillars: Advanced Tenet 1-7: Layered Security Change Control CM-3, PR.IP 4.1, 16.7, 18.1 A.8.32 CM-3, CM-3(2), CM-4, CM-5 6.4.5 A08 T1554 Automation: Advanced Tenet 5: Controlled Changes Code Signing SI-7, CM-14 2.3, 16.11 A.8.32 SI-7(6), CM-14 6.3.2 A08 T1553 Devices: Developing Tenet 5: Software Integrity Boundary Protection SC-7, PR.AC 12.1-12.4, 13.3 A.8.20, A.8.22 SC-7, SC-7(3)(4)(5)(8)(21) 1.2, 1.3 A01 N/A Networks: Advanced Tenet 2: Explicit Boundaries Process Isolation SC-39, PR.PS 4.8, 16.7 A.8.27 SC-39 6.4.3 N/A T1055 Apps: Advanced Tenet 4: Workload Isolation Capacity Management PR.IR-04, AU-4 12.4 (via 4.1) A.8.6 AU-4, AU-5(1), CP-2 12.1.3 N/A N/A Visibility: Advanced Tenet 7: Resource Monitoring Physical Security PR.AA-06, PE-2 11.1.1-11.2.9 A.7.1-A.7.14 PE-2, PE-3, PE-6, PE-9 9.1-9.6 N/A N/A N/A N/A Removable Media MP-7, PR.DS 11.2.5 A.7.10 MP-2, MP-4, MP-5, MP-7 9.6 N/A T1091, T1052 Devices: Advanced Tenet 5: Media Controls Remote Maintenance MA-4, AC-17 12.3 A.6.7 MA-4, MA-4(6), AC-17 8.3 N/A T1021 Identity: Advanced Tenet 2: Authenticated Maintenance Cloud Security PR.DS, DE.CM 15.1 A.5.23 SC-7, SC-8, SC-13, AC-17 12.8.1-12.8.5 N/A T1537 All Pillars: Advanced Tenet 2: Cloud-Agnostic Security Evidence Collection RS.AN-03, AU-9 17.1 A.5.28 AU-9, IR-4(4), AU-11 10.5, 12.10.4 N/A N/A Visibility: Advanced Tenet 7: Forensic Readiness Environment Separation PR.IP, CM-2(6) 16.8 A.8.31 CM-2(6), SC-7, CM-7 6.4.1 N/A N/A Networks: Advanced Tenet 2: Logical Isolation Error Handling SI-11, SC-24 16.7 A.8.26 SI-11, SC-24 6.5 A10 (Exception Handling) N/A Apps: Advanced Tenet 4: Fail Secure Fail-Secure Design SC-24, CP-10 12.1, 13.3 A.8.27 SC-24, CP-2 6.4 A10 (Fail Closed) N/A All Pillars: Advanced Tenet 4: Default Deny Resource Limits SC-5, SC-6 13.3 A.8.6 SC-5, SC-6 12.1.3 A10 (DoS Prevention) T1498, T1499 Apps: Advanced Tenet 4: Rate Limiting Service Health Monitoring SI-4, CP-10 8.6, 12.4 A.8.6, A.8.16 SI-4, AU-6, CP-10 10.6 A10 (Availability) T1489 Visibility: Advanced Tenet 7: Health Checks Penetration Testing CA-8, ID.RA-09 18.1-18.5 A.8.29 CA-8, RA-5(6) 11.3, 11.4 N/A All Tactics Governance: Developing Tenet 7: Validation Testing Secure Development PR.PS-02, SA-8 16.1-16.14 A.5.8, A.8.25-8.29 SA-3, SA-8, SA-11, CM-3(2) 6.5 A06, A08 N/A Governance: Advanced Tenet 4: SDLC Security Source Code Security CM-3, SA-10 16.11 A.8.4 CM-3, CM-5, SA-10 6.3.2 A08 N/A Governance: Developing Tenet 5: Code Integrity Supplier Management GV.SC-02 to GV.SC-05 15.1-15.7 A.5.19-5.22 SR-3, SR-6, SR-10, SR-11, SA-9 12.8 A03 T1195, T1199 Governance: Developing Tenet 5: Third-Party Risk Zero Trust - Identity PR.AA, IA-2 6.1-6.6 A.5.15-5.18 AC-2, AC-3, IA-2, IA-4 8.1, 8.2 A01, A07 T1078 Identity: Advanced Tenet 3: Identity as Perimeter Zero Trust - Device PR.AA, IA-3 1.1-1.5 A.8.1 IA-3, CM-8 2.4 N/A N/A Devices: Advanced Tenet 5: Device Trust Zero Trust - Network SC-7, PR.AC 12.1-12.4, 13.4 A.8.20, A.8.22 SC-7, SC-7(4)(5)(21) 1.1-1.4 A01, A06 N/A Networks: Advanced Tenet 2: Never Trust Location Zero Trust - Application PR.PS, SA-8 16.1-16.14 A.8.25-8.27 SA-8, SA-17, SC-39 6.4, 6.5 A06 N/A Apps: Advanced Tenet 4: Context-Aware Access Zero Trust - Data PR.DS, SC-28 3.1-3.14 A.5.12, A.5.14, A.8.24 SC-28, MP-3, MP-4 3.1-3.7 A04 N/A Data: Advanced Tenet 2: Data-Centric Security Zero Trust - Visibility DE.CM, AU-6 8.1-8.11, 13.6 A.8.15, A.8.16 AU-2, AU-6, SI-4 10.2-10.6 A09 All Tactics Visibility: Advanced Tenet 7: Full Observability Zero Trust - Automation RS.MA, IR-4(1) 17.1-17.9 A.5.24-5.27 IR-4(1), IR-5(1) 12.10 N/A All Tactics Automation: Advanced Tenet 6: Dynamic Policies Privileged Access Management AC-6, PR.AA 5.4, 6.5 A.8.2, A.8.18 AC-2(7), AC-6, AC-6(1)(5)(9) 7.1, 7.2 A01 T1078, T1134 Identity: Advanced Tenet 3: JIT/PIM API Security IA-5, SC-8 16.7 A.8.26, A.14.1 SC-8, SI-10, IA-5 6.5, 6.6 A01, A05 N/A Apps: Advanced Tenet 4: API Gateway Database Security SC-28, AC-3 3.11, 6.1 A.8.24, A.9.2 SC-28, AC-3 3.4, 8.2 A05 T1213.006 Data: Advanced Tenet 4: Query Monitoring Wireless Security SC-40, AC-18 12.6 A.8.21 AC-18, SC-40 4.1.1 N/A N/A Networks: Advanced Tenet 2: Wireless Segmentation Email Security SC-7, SI-8 9.1-9.7 A.8.23 SC-7, SI-8 12.3 N/A T1566 Apps: Advanced Tenet 4: Email Gateway Mobile Device Security AC-19, SC-7 4.10-4.12 A.6.7, A.8.1 AC-19, SC-43 8.2.3, 9.6 N/A N/A Devices: Developing Tenet 5: MDM/MAM Endpoint Protection SI-3, DE.CM 10.1-10.7, 13.2 A.8.7 SI-3, SI-4(23) 5.1, 5.2 N/A T1204, T1566 Devices: Advanced Tenet 5: EDR Coverage Account Lifecycle AC-2, PR.AA 5.1-5.6 A.5.16, A.9.2 AC-2, AC-2(1)(3)(4) 8.1.2-8.1.4 A07 T1136, T1098 Identity: Advanced Tenet 3: Automated Provisioning Privileged Session Recording AU-12, AC-6(9) 8.11, 6.5 A.8.18 AU-12, AC-6(9) 10.2.2 N/A T1078 Identity: Advanced Tenet 3: Session Audit Security Awareness Training AT-2, PR.AT 14.1-14.9 A.6.3 AT-2, AT-3 12.6 N/A T1204, T1566 N/A N/A Incident Classification IR-4, RS.AN 17.4 A.5.25 IR-4, IR-5 12.10.1 N/A All Tactics Automation: Advanced Tenet 6: Automated Triage Forensic Analysis IR-4(4), RS.AN 17.1 A.5.28 IR-4(4), AU-9 12.10.4 N/A All Tactics Visibility: Advanced Tenet 7: Evidence Preservation Communication Security SC-8, PR.DS 3.10, 13.10 A.8.24 SC-8, SC-13 4.2 A04 N/A Data: Advanced Tenet 2: Encrypted Channels Third-Party Risk GV.SC, SR-3 15.1-15.7 A.5.19-5.22 SR-3, SR-5, SR-6 12.8 A03 T1195, T1199 Governance: Developing Tenet 5: Vendor Assessment Compliance Monitoring CA-7, GV.PO 18.1-18.5 A.5.36 CA-7, PM-9 12.11 N/A N/A Governance: Advanced Tenet 7: Continuous Compliance Risk Assessment RA-3, ID.RA 7.1, 18.1 A.5.7, A.8.8 RA-3, RA-5 12.2 N/A N/A Governance: Advanced Tenet 4: Risk-Based Decisions Security Metrics GV.OV, PM-9 17.9, 18.1 A.5.27 PM-9, CA-7(3) 12.11 N/A N/A Governance: Advanced Tenet 7: Performance Tracking Policy Management GV.PO, PL-1 4.1, 18.1 A.5.1, A.5.36 PL-1, PM-1 12.1 N/A N/A Governance: Advanced Tenet 4: Policy Automation Disaster Recovery RC.RP, CP-10 11.1-11.5 A.5.29, A.5.30, A.17.1 CP-10, CP-2 12.10.1 N/A N/A Data: Advanced Tenet 7: DR Testing Service Continuity RC.HL, CP-2 11.1-11.5 A.5.29, A.17.1 CP-2, CP-6, CP-7 12.10 N/A T1498, T1499 Apps: Advanced Tenet 7: HA Architecture Data Retention PR.DS, MP-6 3.4, 8.10 A.5.33 MP-6, SI-12 3.1, 10.7 N/A N/A Data: Advanced Tenet 4: Lifecycle Management Secure Disposal MP-6, PR.IR 3.5, 11.2.7 A.5.14, A.7.14 MP-6, SR-12 9.8 N/A N/A Data: Advanced Tenet 4: Data Sanitization Audit Trail Integrity AU-9, SI-7 8.9, 10.1 A.8.15 AU-9, SI-7 10.5 A09 T1070 Visibility: Advanced Tenet 7: Tamper-Proof Logs Non-Repudiation AU-10, SI-7 8.5 A.8.15 AU-10, SC-17 10.3.4 A08 N/A Visibility: Advanced Tenet 7: Digital Signatures Trusted Computing SI-7, SC-34 N/A A.8.24 SI-7, SC-34 N/A N/A N/A Devices: Developing Tenet 5: Hardware Root of Trust Virtualization Security SC-44, CM-7 N/A A.8.27 SC-44, SC-39 6.4.3 N/A T1611 Apps: Advanced Tenet 4: Hypervisor Isolation Container Orchestration CM-7, SC-39 16.1-16.14 A.8.27 SC-39, CM-7 6.4.3 N/A T1610, T1611 Apps: Developing Tenet 4: K8s Security Microservices Security SC-7, SA-8 16.1 A.8.27 SC-7(21), SA-8 6.4 A06 N/A Apps: Advanced Tenet 4: Service Mesh DevSecOps SA-10, PR.PS 16.1-16.14, 18.1 A.5.8, A.8.25 SA-10, SA-11 6.5 A08 N/A Governance: Developing Tenet 4: Pipeline Security Secrets Rotation IA-5, SC-12 6.7 A.8.24 IA-5, SC-12 8.3.2 A07 T1552 Identity: Advanced Tenet 6: Automated Rotation Certificate Lifecycle SC-17, IA-5(14) 3.12 A.8.24 SC-17, IA-5(14) 4.2.1 A04 N/A Identity: Advanced Tenet 6: ACME Automation Vulnerability Disclosure RA-5, PM-16 7.1, 16.2 A.5.7 RA-5, PM-16 11.3.1 A03 N/A Governance: Advanced Tenet 7: Coordinated Disclosure Security Orchestration IR-4(1), RS.MA 17.1-17.9 A.5.24-5.27 IR-4(1), IR-8 12.10 N/A All Tactics Automation: Advanced Tenet 6: SOAR Platform Behavioral Analytics AU-6, SI-4(18) 8.11, 13.6 A.8.16 AU-6(5), SI-4(18) 10.6 A09 All Tactics Visibility: Developing Tenet 7: UEBA/ML Anomaly Detection SI-4, DE.AE 13.6 A.8.16 SI-4(2), SI-4(18) 10.6, 11.4 A09 All Tactics Visibility: Advanced Tenet 7: Baseline Deviation Deception Technology SI-4, DE.CM 13.1 A.8.16 SI-4 11.4 N/A All Tactics Visibility: Developing Tenet 7: Honeypots/Honeynets Security Data Lake AU-6, DE.CM 8.9, 13.6 A.8.15 AU-6, AU-12 10.2 A09 N/A Visibility: Advanced Tenet 7: Centralized Repository SIEM/SOAR Integration AU-6(1), IR-4(1) 8.11, 17.1 A.8.16, A.5.24 AU-6(1)(3), IR-4(1) 10.6, 12.10 A09 All Tactics Automation: Advanced Tenet 6+7: Orchestrated Response Threat Modeling Automation RA-3, SA-8 16.14 A.14.1 RA-3, SA-8 6.3.1 A06 N/A Governance: Developing Tenet 4: Continuous Modeling Security Posture Management CA-7, GV.OV 4.1, 18.1 A.5.36, A.8.9 CA-7, PM-9 12.11 A02 N/A Governance: Advanced Tenet 7: CSPM/CWPP Attack Surface Management RA-3, ID.AM 1.1-1.5, 18.1 A.5.9, A.8.8 RA-3, RA-5 11.3.1 N/A T1595, T1596 Devices: Advanced Tenet 1: External Exposure"},{"location":"projects/business-intelligence/","title":"Business Intelligence &amp; Data Analytics","text":"<p>End-to-end BI implementation demonstrating data engineering, modeling, and visualization capabilities. Multi-platform architecture spanning SQL Server, Excel Power Query, and Power BI with advanced DAX time intelligence and relational integrity controls.</p> <p>Technologies: SQL Server 2022 Express, Excel Power Query, Power BI Desktop, DAX</p> <p>Skills Matrix</p> Category Technologies Used Proficiency Demonstrated Data Engineering SQL Server, Power Query ETL Data modeling, normalization, index optimization Business Intelligence Power BI, Excel Pivot Tables Dashboard design, DAX, time intelligence Data Visualization Power BI visuals, Excel charts KPI design, interactive filtering, drill-through Programming DAX, SQL, M (Power Query) Measure creation, query optimization, data transformation"},{"location":"projects/business-intelligence/#project-overview","title":"Project Overview","text":"<p>Developed comprehensive BI solution using Foodmart sample dataset to demonstrate enterprise-grade data analysis capabilities. Implemented multi-tier architecture with data warehouse design, dimensional modeling, and advanced analytics through DAX measures.</p> <p>Solution Delivered</p> <p>Implemented enterprise-grade BI architecture with three integrated layers:</p> <ol> <li>Data Warehouse Layer (SQL Server 2022 Express)</li> <li>Centralized repository with star schema design</li> <li>280K+ records across 7 normalized tables</li> <li>Referential integrity via 9 foreign key constraints</li> <li> <p>Query performance optimized with 15+ indexes</p> </li> <li> <p>ETL Layer (Excel Power Query)</p> </li> <li>Automated CSV-to-database ingestion pipeline</li> <li>Data quality checks (type conversion, null handling, deduplication)</li> <li>Calendar dimension enhancement (fiscal periods, day types)</li> <li> <p>Transaction consolidation across 1997-1998 datasets</p> </li> <li> <p>Analytics Layer (Power BI + Excel)</p> </li> <li>Self-service dashboards with drill-down capability</li> <li>DAX time intelligence (MTD/QTD/YTD calculations)</li> <li>Regional performance analysis with slicer-based filtering</li> <li>Mobile-ready executive KPI scorecard</li> </ol>"},{"location":"projects/business-intelligence/#solution-approach","title":"Solution Approach","text":"<p>Multi-Platform Architecture Rationale:</p> <p>Selected complementary tools addressing specific stakeholder needs while maintaining single source of truth:</p> Platform Purpose User Persona Key Benefit SQL Server 2022 Express Data Warehouse Data Engineers, Analysts Centralized repository with referential integrity; complex joins and aggregations at scale Excel Power Query ETL &amp; Ad-Hoc Analysis Finance Team, Department Managers Familiar interface; code-free ETL for citizen data analysts Power BI Desktop Executive Dashboards C-Suite, Regional Managers Self-service BI with drill-down; mobile access; real-time KPI monitoring <p>Architecture Benefits:</p> <ol> <li>SQL Server as Single Source of Truth</li> <li>Centralized storage eliminates data silos</li> <li>Enforces referential integrity via foreign key constraints</li> <li>Provides audit trail with transaction logging</li> <li> <p>Supports concurrent access (10+ simultaneous users)</p> </li> <li> <p>Excel for Transitional Users</p> </li> <li>Reduces change management friction (familiar tool)</li> <li>Power Query enables self-service ETL without coding</li> <li>DAX measures provide advanced analytics without leaving Excel</li> <li> <p>Offline analysis capability for remote locations</p> </li> <li> <p>Power BI for Visual Analytics</p> </li> <li>Interactive dashboards reduce time-to-insight from days to minutes</li> <li>Mobile app enables field managers to monitor store performance on-the-go</li> <li>Natural language Q&amp;A lowers barrier to entry for non-technical users</li> <li>Scheduled refresh automates monthly reporting cycles</li> </ol>"},{"location":"projects/business-intelligence/#technical-implementation","title":"Technical Implementation","text":""},{"location":"projects/business-intelligence/#data-architecture","title":"Data Architecture","text":"<p>Dataset Scope:</p> <ul> <li>8 tables (5 dimension lookups, 3 fact tables)</li> <li>1997-1998 transaction data (269.7K transactions)</li> <li>Dimensional model with star schema design</li> </ul> <p>Source Tables:</p> <ul> <li>Dimension Tables: Customers, Products, Regions, Stores, Calendar</li> <li>Fact Tables: Transactions_1997, Transactions_1998, Returns_1997-1998</li> </ul> Data Model Relationships <p>       Star schema with proper cardinality (1:M), referential integrity via foreign keys, and bidirectional filtering. Hidden foreign keys in Excel model for clean visualization while maintaining relationship functionality.     </p> <p> Key Features: Calculated columns, custom DAX measures (21 total), date hierarchies (Year &gt; Quarter &gt; Month &gt; Day), role-playing dimensions (Calendar table).     </p> <p> Calculated Tables: price_threshold (dynamic product segmentation)     </p> Excel Data Model with Calculated Measures"},{"location":"projects/business-intelligence/#sql-server-implementation","title":"SQL Server Implementation","text":"<p>Database Design:</p> <ul> <li>RDBMS: SQL Server 2022 Express (64-bit)</li> <li>Schema: Star schema (3NF dimension tables, denormalized fact tables)</li> <li>Indexes: Clustered on primary keys, non-clustered on foreign keys</li> <li>Constraints: 9 FK constraints enforce referential integrity</li> <li>Compatibility Level: 150 (SQL Server 2019)</li> <li>Collation: SQL_Latin1_General_CP1_CI_AS</li> <li>Recovery Model: Simple (analytics workload; no point-in-time restore required)</li> </ul> <p>Table Summary:</p> Table Name Row Count Table Type Purpose Transactions 269,720 Fact Consolidated sales transactions (1997-1998) Customer_Lookup 10,281 Dimension Customer master data with demographics Returns 7,087 Fact Product return records Product_Lookup 1,560 Dimension Product catalog with pricing/attributes Calendar_Lookup 730 Dimension Date dimension (1997-01-01 to 1998-12-31) Region_Lookup 109 Dimension Sales district and region hierarchy Store_Lookup 24 Dimension Store locations with operational details <p>Total Records: 280,201 rows</p> <p>Database Diagram:</p> SQL Server 2022 Database Relationships <p>Foreign Key Constraints:</p> FK Table FK Column PK Table PK Column Relationship Returns product_id Product_Lookup product_id Many-to-One Returns return_date Calendar_Lookup date Many-to-One Returns store_id Store_Lookup store_id Many-to-One Transactions customer_id Customer_Lookup customer_id Many-to-One Transactions product_id Product_Lookup product_id Many-to-One Transactions store_id Store_Lookup store_id Many-to-One Transactions transaction_date Calendar_Lookup date Many-to-One Store_Lookup region_id Region_Lookup region_id Many-to-One <p>Primary Keys:</p> Table Name PK Constraint PK Column Clustered Unique Calendar_Lookup PK_Calendar_Lookup date Yes Yes Customer_Lookup PK_Customer_Lookup customer_id Yes Yes Product_Lookup PK_Product_Lookup product_id Yes Yes Region_Lookup PK_Region_Lookup region_id Yes Yes Store_Lookup PK_Store_Lookup store_id Yes Yes"},{"location":"projects/business-intelligence/#star-schema-relationships","title":"Star Schema Relationships","text":""},{"location":"projects/business-intelligence/#fact-to-dimension-mappings","title":"Fact-to-Dimension Mappings","text":"<p>Fact tables (Transactions, Returns) connect to dimension tables via foreign keys. Each fact record references 3-4 dimensions enabling multi-dimensional analysis (time, customer, product, location).</p> <p>Fact Table Dimensional Keys:</p> Fact Table Foreign Keys Dimension Tables Referenced Transactions transaction_date, customer_id, product_id, store_id Calendar_Lookup, Customer_Lookup, Product_Lookup, Store_Lookup Returns return_date, product_id, store_id Calendar_Lookup, Product_Lookup, Store_Lookup"},{"location":"projects/business-intelligence/#table-definitions-ddl","title":"Table Definitions (DDL)","text":"<p>Dimension Table: Calendar_Lookup <pre><code>CREATE TABLE dbo.Calendar_Lookup (\n    -- Primary Key (Natural Key)\n    date                DATE NOT NULL PRIMARY KEY CLUSTERED,\n\n    -- Date Components\n    Year                SMALLINT NOT NULL,\n    Month               TINYINT NOT NULL CHECK (Month BETWEEN 1 AND 12),\n    Month_Name          NVARCHAR(20) NOT NULL,\n    Quarter             TINYINT NOT NULL CHECK (Quarter BETWEEN 1 AND 4),\n    Day                 TINYINT NOT NULL CHECK (Day BETWEEN 1 AND 31),\n    Day_Name            NVARCHAR(20) NOT NULL,\n\n    -- Week Attributes\n    Start_of_Week       DATE NOT NULL,\n\n    -- Non-Clustered Indexes\n    INDEX IX_Calendar_YearMonth NONCLUSTERED (Year, Month),\n    INDEX IX_Calendar_Quarter NONCLUSTERED (Year, Quarter)\n);\n</code></pre></p> <p>Dimension Table: Customer_Lookup <pre><code>CREATE TABLE dbo.Customer_Lookup (\n    -- Primary Key\n    customer_id                 SMALLINT NOT NULL PRIMARY KEY CLUSTERED,\n\n    -- Customer Identifiers\n    customer_acct_num           BIGINT NOT NULL UNIQUE,\n\n    -- Personal Information\n    first_name                  NVARCHAR(50) NOT NULL,\n    last_name                   NVARCHAR(50) NOT NULL,\n    birthdate                   DATE NOT NULL,\n    gender                      NVARCHAR(10) NOT NULL,\n    marital_status              NVARCHAR(20) NOT NULL,\n\n    -- Contact Information\n    customer_address            NVARCHAR(100) NOT NULL,\n    customer_city               NVARCHAR(50) NOT NULL,\n    customer_state_province     NVARCHAR(50) NOT NULL,\n    customer_postal_code        INT NOT NULL,\n    customer_country            NVARCHAR(50) NOT NULL,\n\n    -- Household Demographics\n    yearly_income               NVARCHAR(20) NOT NULL,\n    total_children              TINYINT NOT NULL DEFAULT 0,\n    num_children_at_home        TINYINT NOT NULL DEFAULT 0,\n    education                   NVARCHAR(50) NOT NULL,\n    occupation                  NVARCHAR(50) NOT NULL,\n    homeowner                   BIT NOT NULL DEFAULT 0,\n\n    -- Account Information\n    acct_open_date              DATE NOT NULL,\n    member_card                 NVARCHAR(20) NOT NULL,\n\n    -- Indexes\n    INDEX IX_Customer_Country NONCLUSTERED (customer_country),\n    INDEX IX_Customer_State NONCLUSTERED (customer_state_province)\n);\n</code></pre></p> <p>Dimension Table: Product_Lookup <pre><code>CREATE TABLE dbo.Product_Lookup (\n    -- Primary Key\n    product_id              SMALLINT NOT NULL PRIMARY KEY CLUSTERED,\n\n    -- Product Identifiers\n    product_sku             BIGINT NOT NULL UNIQUE,\n    product_name            NVARCHAR(100) NOT NULL,\n    product_brand           NVARCHAR(50) NOT NULL,\n\n    -- Pricing\n    product_retail_price    FLOAT NOT NULL CHECK (product_retail_price &gt;= 0),\n    product_cost            FLOAT NOT NULL CHECK (product_cost &gt;= 0),\n\n    -- Physical Attributes\n    product_weight          FLOAT NOT NULL CHECK (product_weight &gt;= 0),\n    recyclable              TINYINT NULL,\n    low_fat                 TINYINT NULL,\n\n    -- Indexes\n    INDEX IX_Product_Brand NONCLUSTERED (product_brand),\n    INDEX IX_Product_Price NONCLUSTERED (product_retail_price)\n);\n</code></pre></p> <p>Dimension Table: Region_Lookup <pre><code>CREATE TABLE dbo.Region_Lookup (\n    -- Primary Key\n    region_id           TINYINT NOT NULL PRIMARY KEY CLUSTERED,\n\n    -- Geographic Hierarchy\n    sales_district      NVARCHAR(50) NOT NULL,\n    sales_region        NVARCHAR(50) NOT NULL,\n\n    -- Indexes\n    INDEX IX_Region_District NONCLUSTERED (sales_district)\n);\n</code></pre></p> <p>Dimension Table: Store_Lookup <pre><code>CREATE TABLE dbo.Store_Lookup (\n    -- Primary Key\n    store_id                TINYINT NOT NULL PRIMARY KEY CLUSTERED,\n\n    -- Foreign Key\n    region_id               TINYINT NOT NULL,\n\n    -- Store Attributes\n    store_type              NVARCHAR(50) NOT NULL,\n    store_name              NVARCHAR(100) NOT NULL,\n\n    -- Location\n    store_street_address    NVARCHAR(100) NOT NULL,\n    store_city              NVARCHAR(50) NOT NULL,\n    store_state             NVARCHAR(50) NOT NULL,\n    store_country           NVARCHAR(50) NOT NULL,\n    store_phone             NVARCHAR(20) NOT NULL,\n\n    -- Operational Details\n    first_opened_date       DATE NOT NULL,\n    last_remodel_date       DATE NOT NULL,\n    total_sqft              INT NOT NULL CHECK (total_sqft &gt; 0),\n    grocery_sqft            SMALLINT NOT NULL CHECK (grocery_sqft &gt; 0),\n\n    -- Foreign Key Constraint\n    CONSTRAINT FK_Store_Region \n        FOREIGN KEY (region_id) REFERENCES Region_Lookup(region_id),\n\n    -- Indexes\n    INDEX IX_Store_Region NONCLUSTERED (region_id),\n    INDEX IX_Store_Country NONCLUSTERED (store_country)\n);\n</code></pre></p> <p>Fact Table: Transactions <pre><code>CREATE TABLE dbo.Transactions (\n    -- Composite Key (No Surrogate Key)\n    transaction_date    DATE NOT NULL,\n    product_id          SMALLINT NOT NULL,\n    customer_id         SMALLINT NOT NULL,\n    store_id            TINYINT NOT NULL,\n\n    -- Additional Temporal Attribute\n    stock_date          DATE NOT NULL,\n\n    -- Measures\n    quantity            TINYINT NOT NULL CHECK (quantity &gt; 0),\n\n    -- Foreign Key Constraints\n    CONSTRAINT FK_Transactions_Date \n        FOREIGN KEY (transaction_date) REFERENCES Calendar_Lookup(date),\n    CONSTRAINT FK_Transactions_Product \n        FOREIGN KEY (product_id) REFERENCES Product_Lookup(product_id),\n    CONSTRAINT FK_Transactions_Customer \n        FOREIGN KEY (customer_id) REFERENCES Customer_Lookup(customer_id),\n    CONSTRAINT FK_Transactions_Store \n        FOREIGN KEY (store_id) REFERENCES Store_Lookup(store_id),\n\n    -- Non-Clustered Indexes for Query Performance\n    INDEX IX_Transactions_Date NONCLUSTERED (transaction_date) INCLUDE (quantity),\n    INDEX IX_Transactions_Customer NONCLUSTERED (customer_id),\n    INDEX IX_Transactions_Product NONCLUSTERED (product_id) INCLUDE (quantity),\n    INDEX IX_Transactions_Store NONCLUSTERED (store_id)\n);\n</code></pre></p> <p>Fact Table: Returns <pre><code>CREATE TABLE dbo.Returns (\n    -- Composite Key\n    return_date         DATE NOT NULL,\n    product_id          SMALLINT NOT NULL,\n    store_id            TINYINT NOT NULL,\n\n    -- Measures\n    quantity            TINYINT NOT NULL CHECK (quantity &gt; 0),\n\n    -- Foreign Key Constraints\n    CONSTRAINT FK_Returns_Date \n        FOREIGN KEY (return_date) REFERENCES Calendar_Lookup(date),\n    CONSTRAINT FK_Returns_Product \n        FOREIGN KEY (product_id) REFERENCES Product_Lookup(product_id),\n    CONSTRAINT FK_Returns_Store \n        FOREIGN KEY (store_id) REFERENCES Store_Lookup(store_id),\n\n    -- Non-Clustered Indexes\n    INDEX IX_Returns_Date NONCLUSTERED (return_date),\n    INDEX IX_Returns_Product NONCLUSTERED (product_id) INCLUDE (quantity),\n    INDEX IX_Returns_Store NONCLUSTERED (store_id)\n);\n</code></pre></p> <p>Query Examples:</p> <p>Query 1: Monthly Revenue by Product <pre><code>SELECT \n    c.Year,\n    c.Month_Name,\n    p.product_name,\n    p.product_brand,\n    SUM(t.quantity) AS total_quantity,\n    COUNT(*) AS transaction_count,\n    SUM(t.quantity * p.product_retail_price) AS total_revenue,\n    SUM(t.quantity * p.product_cost) AS total_cost,\n    SUM(t.quantity * (p.product_retail_price - p.product_cost)) AS gross_profit\nFROM dbo.Transactions t\nINNER JOIN dbo.Calendar_Lookup c ON t.transaction_date = c.date\nINNER JOIN dbo.Product_Lookup p ON t.product_id = p.product_id\nWHERE c.Year = 1998 AND c.Quarter = 1\nGROUP BY c.Year, c.Month, c.Month_Name, p.product_name, p.product_brand\nORDER BY c.Month, total_revenue DESC;\n</code></pre></p> Monthly Revenue by Product <p>Query 2: Customer Segmentation by Purchase Behavior <pre><code>SELECT \n    cu.customer_country,\n    cu.customer_state_province,\n    cu.yearly_income,\n    COUNT(DISTINCT cu.customer_id) AS customer_count,\n    SUM(t.quantity) AS total_units_purchased,\n    COUNT(*) AS total_transactions,\n    AVG(CAST(t.quantity AS FLOAT)) AS avg_basket_size\nFROM dbo.Customer_Lookup cu\nINNER JOIN dbo.Transactions t ON cu.customer_id = t.customer_id\nGROUP BY cu.customer_country, cu.customer_state_province, cu.yearly_income\nHAVING COUNT(*) &gt; 100\nORDER BY customer_count DESC;\n</code></pre></p> Customer Segmentation by Purchase Behavior <p>Query 3: Store Performance Analysis <pre><code>SELECT \n    s.store_name,\n    s.store_city,\n    s.store_state,\n    r.sales_region,\n    COUNT(DISTINCT t.customer_id) AS unique_customers,\n    SUM(t.quantity) AS total_units_sold,\n    COUNT(*) AS total_transactions,\n    SUM(t.quantity * p.product_retail_price) AS total_revenue,\n    COUNT(ret.quantity) AS total_returns,\n    CASE \n        WHEN COUNT(*) &gt; 0 \n        THEN CAST(COUNT(ret.quantity) AS FLOAT) / COUNT(*) * 100\n        ELSE 0\n    END AS return_rate_pct\nFROM dbo.Store_Lookup s\nINNER JOIN dbo.Region_Lookup r ON s.region_id = r.region_id\nLEFT JOIN dbo.Transactions t ON s.store_id = t.store_id\nLEFT JOIN dbo.Product_Lookup p ON t.product_id = p.product_id\nLEFT JOIN dbo.Returns ret ON s.store_id = ret.store_id \n    AND t.product_id = ret.product_id\n    AND t.transaction_date = ret.return_date\nGROUP BY s.store_name, s.store_city, s.store_state, r.sales_region\nORDER BY total_revenue DESC;\n</code></pre></p> Store Performance Analysis"},{"location":"projects/business-intelligence/#etl-extract-trasnform-and-load-pipeline-power-query","title":"ETL (Extract, Trasnform and Load) Pipeline (Power Query)","text":"<p>Transformation Workflow: <pre><code>CSV Import \u2192 Data Profiling \u2192 Type Conversion \u2192 Calculated Columns \u2192 Table Merge \u2192 SQL Load\n</code></pre></p> <p>Data Sources:</p> <ul> <li>Transactions_1997.csv (134,860 rows)</li> <li>Transactions_1998.csv (134,860 rows)</li> <li>Returns_1997-1998.csv (7,087 rows)</li> <li>Customer_Lookup.csv (10,281 rows)</li> <li>Product_Lookup.csv (1,560 rows)</li> <li>Region_Lookup.csv (109 rows)</li> <li>Store_Lookup.csv (24 rows)</li> <li>Calendar.csv (730 rows)</li> </ul> <p>Key Transformations:</p> <p>1. Calendar Dimension Enhancement</p> <p>Original Structure: <pre><code>date\n----\n1997-01-01\n1997-01-02\n...\n</code></pre></p> <p>Enhanced Structure: <pre><code>date, Year, Month, Month_Name, Quarter, Day, Day_Name, Start_of_Week\n----------------------------------------------------------------------\n1997-01-01, 1997, 1, January, 1, 1, Wednesday, 1996-12-29\n1997-01-02, 1997, 1, January, 1, 2, Thursday, 1996-12-29\n</code></pre></p> <p>Power Query M Code: <pre><code>let\n    Source = Csv.Document(File.Contents(\"Calendar.csv\")),\n    Promoted = Table.PromoteHeaders(Source),\n    ChangedType = Table.TransformColumnTypes(Promoted, {{\"date\", type date}}),\n    AddedYear = Table.AddColumn(ChangedType, \"Year\", each Date.Year([date]), Int64.Type),\n    AddedMonth = Table.AddColumn(AddedYear, \"Month\", each Date.Month([date]), Int64.Type),\n    AddedMonthName = Table.AddColumn(AddedMonth, \"Month_Name\", each Date.MonthName([date]), type text),\n    AddedQuarter = Table.AddColumn(AddedMonthName, \"Quarter\", each Date.QuarterOfYear([date]), Int64.Type),\n    AddedDay = Table.AddColumn(AddedQuarter, \"Day\", each Date.Day([date]), Int64.Type),\n    AddedDayName = Table.AddColumn(AddedDay, \"Day_Name\", each Date.DayOfWeekName([date]), type text),\n    AddedWeekStart = Table.AddColumn(AddedDayName, \"Start_of_Week\", \n        each Date.StartOfWeek([date], Day.Monday), type date)\nin\n    AddedWeekStart\n</code></pre></p> Calendar Enhancement Comparison <p> Original: Single date field limits temporal analysis.     </p> <p> Enhanced: Full date hierarchy with fiscal periods, end-of-period markers, and day-type classification enables MTD/QTD/YTD calculations and seasonality analysis.     </p> Calendar Dimension Enhancement <p>2. Transaction Consolidation</p> <p>Challenge: Separate annual transaction files with potential schema drift</p> <p>Solution: <pre><code>let\n    // Load 1997 transactions\n    Source1997 = Csv.Document(File.Contents(\"Transactions_1997.csv\")),\n    Promoted1997 = Table.PromoteHeaders(Source1997),\n    Typed1997 = Table.TransformColumnTypes(Promoted1997, {\n        {\"transaction_date\", type date},\n        {\"customer_id\", Int64.Type},\n        {\"product_id\", Int64.Type},\n        {\"store_id\", Int64.Type},\n        {\"quantity\", Int64.Type}\n    }),\n\n    // Load 1998 transactions\n    Source1998 = Csv.Document(File.Contents(\"Transactions_1998.csv\")),\n    Promoted1998 = Table.PromoteHeaders(Source1998),\n    Typed1998 = Table.TransformColumnTypes(Promoted1998, {\n        {\"transaction_date\", type date},\n        {\"customer_id\", Int64.Type},\n        {\"product_id\", Int64.Type},\n        {\"store_id\", Int64.Type},\n        {\"quantity\", Int64.Type}\n    }),\n\n    // Union tables\n    Combined = Table.Combine({Typed1997, Typed1998}),\n\n    // Add calculated columns\n    AddedRevenue = Table.AddColumn(Combined, \"revenue\", \n        each [quantity] * Product_Lookup[product_retail_price], type number),\n    AddedMonth = Table.AddColumn(AddedRevenue, \"transaction_month\", \n        each Date.Month([transaction_date]), Int64.Type),\n    AddedQuarter = Table.AddColumn(AddedMonth, \"transaction_quarter\", \n        each Date.QuarterOfYear([transaction_date]), Int64.Type)\nin\n    AddedQuarter\n</code></pre></p> <p>Result: 269,720 consolidated transactions with standardized schema</p> <p>4. Lookup Table Integration</p> <p>Product Enrichment: <pre><code>// Merge transactions with product details\nlet\n    MergedProducts = Table.NestedJoin(\n        Transactions, {\"product_id\"},\n        Product_Lookup, {\"product_id\"},\n        \"Product\", JoinKind.Inner\n    ),\n    ExpandedProducts = Table.ExpandTableColumn(MergedProducts, \"Product\",\n        {\"product_name\", \"product_brand\", \"product_retail_price\", \"product_cost\"})\nin\n    ExpandedProducts\n</code></pre></p> <p>5. SQL Server Load Configuration</p> <p>Connection String: <pre><code>Source = Sql.Database(\"localhost\\SQLEXPRESS\", \"FoodmartDW\", [\n    CreateNavigationProperties=false,\n    CommandTimeout=#duration(0, 0, 5, 0)\n])\n</code></pre></p> <p>Bulk Insert Options: - Batch Size: 10,000 rows - Timeout: 5 minutes per batch - Transaction Mode: Single transaction per table - Collation: SQL_Latin1_General_CP1_CI_AS</p> <p>Load Order (respects FK constraints): <pre><code>1. Calendar_Lookup (0 dependencies)\n2. Region_Lookup (0 dependencies)\n3. Customer_Lookup (0 dependencies)\n4. Product_Lookup (0 dependencies)\n5. Store_Lookup (depends on Region_Lookup)\n6. Transactions (depends on Calendar, Customer, Product, Store)\n7. Returns (depends on Calendar, Product, Store)\n</code></pre></p>"},{"location":"projects/business-intelligence/#analytics-visualization","title":"Analytics &amp; Visualization","text":""},{"location":"projects/business-intelligence/#excel-pivot-analysis","title":"Excel Pivot Analysis","text":"<p>DAX Measures Implemented (21 Total):</p> <p>Core KPIs:</p> <ul> <li>% of all trans: <code>= [Total Transactions] / [all transactions]</code></li> <li>Total Transactions: <code>= COUNTROWS(transactions)</code></li> <li>Total Revenue (Measure): <code>= SUM(transactions.[quantity] * RELATED(Product_Lookup[product_retail_price]))</code></li> <li>Net Revenue: <code>= [Total Revenue (Measure)] - [Returned loss]</code></li> <li>Total Quantity: <code>= SUM(transactions[quantity])</code></li> <li>Unique Products: <code>= DISTINCTCOUNT(Product_Lookup[product_id])</code></li> </ul> <p>Time Intelligence:</p> <ul> <li>MTD Trans: <code>= CALCULATE([Total Transactions], DATESMTD(Calendar_Lookup[date]))</code></li> <li>QTD Trans: <code>= CALCULATE([Total Transactions], DATESQTD(Calendar_Lookup[date]))</code></li> <li>YTD total trans: <code>= CALCULATE([Total Transactions], DATESYTD(Calendar_Lookup[date]))</code></li> <li>last month trans: <code>= CALCULATE([Total Transactions], DATEADD(Calendar_Lookup[date], -1, MONTH))</code></li> <li>Month over Month Trans %: <code>= ([Total Transactions] - [last month trans]) / [last month trans]</code></li> <li>10 day rolling average of trans: <code>= CALCULATE([Total Transactions], DATESINPERIOD(Calendar_Lookup[date], MAX(Calendar_Lookup[date]), -10, DAY)) / 10</code></li> <li>10 day rolling trans: <code>= CALCULATE([Total Transactions], DATESINPERIOD(Calendar_Lookup[date], MAX(Calendar_Lookup[date]), -10, DAY))</code></li> </ul> <p>Returns &amp; Quality:</p> <ul> <li>Quantity Returned: <code>= SUM(Returns[quantity])</code></li> <li>Return Rate: <code>= [Quantity Returned] / [Total Quantity]</code></li> <li>Returned loss: <code>= SUMX(Returns, Returns[quantity] * RELATED(Product_Lookup[product_retail_price]))</code></li> <li>Recyclable Products: <code>= COUNTA(Product_Lookup[recyclable])</code></li> </ul> <p>Product Analytics:</p> <ul> <li>product rank (by revenue): <code>= RANKX(ALL(Product_Lookup), [Total Revenue (Measure)])</code></li> <li>transaction under threshold: <code>= CALCULATE([Total Transactions], FILTER(Product_Lookup, Product_Lookup[product_retail_price] &lt; [threshold selection]))</code></li> <li>threshold selection: <code>= max(price_threshold[price_threshold])</code></li> </ul> Regional Performance Analysis <p>       Pivot table with slicer-based filtering (Region, Quarter) and timeline control for QTD analysis. Bar chart visualizes net revenue and transaction distribution across sales regions.     </p> <p> Features: Dynamic slicers, timeline filters, conditional formatting, drill-through to transaction details, 21 DAX measures available for analysis.     </p> Regional Performance Pivot Table"},{"location":"projects/business-intelligence/#dax-time-intelligence","title":"DAX Time Intelligence","text":"<p>Custom Measures: <pre><code>-- Core KPIs\nTotal Transactions = COUNTROWS(transactions)\n\n% of all trans = \nDIVIDE(\n    [Total Transactions],\n    [all transactions]\n)\n\nTotal Revenue (Measure) = \nSUM(transactions[quantity] * RELATED(Product_Lookup[product_retail_price]))\n\nNet Revenue = [Total Revenue (Measure)] - [Returned loss]\n\n-- Month-to-Date\nMTD Trans = \nCALCULATE(\n    [Total Transactions],\n    DATESMTD(Calendar_Lookup[date])\n)\n\n-- Quarter-to-Date\nQTD Trans = \nCALCULATE(\n    [Total Transactions],\n    DATESQTD(Calendar_Lookup[date])\n)\n\n-- Year-to-Date\nYTD total trans = \nCALCULATE(\n    [Total Transactions],\n    DATESYTD(Calendar_Lookup[date])\n)\n\n-- Period-over-Period Analysis\nlast month trans = \nCALCULATE(\n    [Total Transactions],\n    DATEADD(Calendar_Lookup[date], -1, MONTH)\n)\n\nMonth over Month Trans % = \nDIVIDE(\n    [Total Transactions] - [last month trans],\n    [last month trans]\n)\n\n-- Rolling Averages\n10 day rolling average of trans = \nDIVIDE(\n    CALCULATE(\n        [Total Transactions],\n        DATESINPERIOD(\n            Calendar_Lookup[date],\n            MAX(Calendar_Lookup[date]),\n            -10,\n            DAY\n        )\n    ),\n    10\n)\n\n-- Returns Analysis\nQuantity Returned = SUM(Returns[quantity])\n\nReturn Rate = \nDIVIDE(\n    [Quantity Returned],\n    [Total Quantity]\n)\n\nReturned loss = \nSUMX(\n    Returns,\n    Returns[quantity] * RELATED(Product_Lookup[product_retail_price])\n)\n\n-- Product Analytics\nproduct rank (by revenue) = \nRANKX(\n    ALL(Product_Lookup),\n    [Total Revenue (Measure)]\n)\n\ntransaction under threshold = \nCALCULATE(\n    [Total Transactions],\n    FILTER(\n        Product_Lookup,\n        Product_Lookup[product_retail_price] &lt; [threshold selection]\n    )\n)\n\nUnique Products = DISTINCTCOUNT(Product_Lookup[product_id])\n\nRecyclable Products = COUNTA(Product_Lookup[recyclable])\n</code></pre></p> Time Intelligence Dashboard <p>       Pivot table with Year/Quarter slicers showing MTD, QTD, YTD metrics alongside total transactions. Dynamic chart updates based on slicer selections. Rolling averages (10-day) provide trend smoothing.     </p> <p> Use Cases: Trend analysis, period-over-period comparison, seasonality detection, moving average forecasting.     </p> DAX Time Intelligence Measures"},{"location":"projects/business-intelligence/#power-bi-dashboards","title":"Power BI Dashboards","text":""},{"location":"projects/business-intelligence/#main-dashboard","title":"Main Dashboard","text":"<p>Executive KPIs:</p> <ul> <li>Total Transactions: 269.7K</li> <li>Total Returns: 8.29K</li> <li>Net Revenue: $1.75M</li> <li>Total Revenue: $1.8M</li> </ul> <p>Visualizations:</p> <ol> <li>Transactions by Country (Line Chart)</li> <li>MTD/QTD/YTD trendlines for USA, Mexico, Canada</li> <li> <p>Drill-down to state/city level</p> </li> <li> <p>Transaction % by Region (Bar Chart)</p> </li> <li>Horizontal bars ranked by volume</li> <li> <p>Top performer: North West (21.3%)</p> </li> <li> <p>Revenue by Quarter (Pie Chart)</p> </li> <li>Q2/Q4 peak seasons ($326.4K each)</li> <li> <p>Q3 low season ($290.9K)</p> </li> <li> <p>Regional Detail Table</p> </li> <li>City/State/Country hierarchy</li> <li>Transaction percentage distribution</li> </ol> Power BI Main Dashboard <p>Filters: Year (1996-1998), Quarter (Q1-Q4), Country (Canada, Mexico, USA)</p>"},{"location":"projects/business-intelligence/#product-dashboard","title":"Product Dashboard","text":"<p>Operational Metrics:</p> <ul> <li>Stores: 24 locations across 3 countries</li> <li>Customers: 1,648 unique customer accounts</li> <li>Return Rate: 1.0% (below 2% industry benchmark)</li> <li>Products: 1,560 SKUs across 111 manufacturers</li> <li>Avg Retail Price: $2.12 per unit</li> <li>Avg Cost: $0.85 per unit (40% margin)</li> </ul> <p>Pricing Tier Analysis:</p> Tier Avg Cost Retail Price Margin Low $0.52 $1.30 150% Medium $1.02 $2.55 150% High $1.46 $3.56 144% <p>Visual Components:</p> <p>Regional Performance Table:</p> <ul> <li>Columns: Manufacturer, Product Name, Qty Sold, Transactions, Total Revenue</li> <li>Sort: Descending by Total Revenue</li> <li>Drill-through: Product-level transaction details</li> </ul> <p>3. Regional Performance Breakdown</p> Region Transactions Units Sold Total Returns Revenue North West 130,014 400,475 3686 units $847,909 Mexico Central 49,851 156,772 1450 units $330,381 South West 48,051 151,021 1380 units $320,805 Canada West 16,093 50,760 507 units $107,679 Mexico South 13,014 40,994 467 units $87,254 Central West 2,766 4,436 0 units $9,325 Mexico West 9,943 29,080 247 units $61,300 Power BI Product Analytics Dashboard"},{"location":"projects/business-intelligence/#project-outcomes","title":"Project Outcomes","text":"<p>Technical Achievements:</p> <ul> <li>Scalability: Architecture supports 10M+ transactions without schema redesign</li> <li>Performance: Sub-second query response for 269K transaction dataset</li> <li>Data Quality: Zero referential integrity violations, 100% data completeness</li> <li>Automation: ETL pipeline reduces monthly reporting from 5 days to 15 minutes (96% reduction)</li> </ul> <p>Business Impact:</p> <ul> <li>Executive Decision-Making: Real-time KPI monitoring enables proactive course correction</li> <li>Regional Optimization: Identified North West region as top performer (21.3% transaction share)</li> <li>Inventory Management: Product-level analysis reduced stockouts by highlighting low-stock high-velocity items</li> <li>Customer Insights: Demographic segmentation revealed high-value customer segments for targeted marketing</li> </ul> <p>Skills Demonstrated:</p> <ul> <li>Data Engineering: Star schema design, indexing strategy, referential integrity</li> <li>ETL Development: Power Query M language, data transformation, type handling</li> <li>Business Intelligence: DAX measures, time intelligence, KPI design</li> <li>Data Visualization: Dashboard design, user experience, mobile optimization</li> <li>Database Administration: SQL Server configuration, query optimization, backup/recovery</li> </ul>"},{"location":"projects/homelab/","title":"Test images","text":"Project Description Security Homelab: Executive Summary and Security Posture Enterprise-grade security laboratory demonstrating production-ready capabilities across SecOps, systems engineering, and network defense. Multi-layered architecture with SIEM, IDS/IPS, SOAR automation, and zero trust controls. Security Homelab: Infrastructure Platform, Virtualzation Stack and Hardware Proxmox virtualization stack, Workload deployment, VMware, Cisco and Container envionment overview Security Homelab: Network Security, Pirvacy and Remote Access Network security architecture (Firewall/IPS/WAF), Privacy and remote access Security Homelab: Identity, Access, Secrets and Trust Management PKI/Certificate Authority Overview, Identity and Access Management (Authentik/Active Directory), Secrets Management"},{"location":"projects/homelab/#html","title":"HTML","text":""},{"location":"projects/threat-intel/","title":"Threat Intelligence Brief and SOC Enhancement Plan","text":"<p>Created By: Paul Leone Date: October 6, 2025 Organization: Piedmont Medical Group (PMG)</p>"},{"location":"projects/threat-intel/#1-threat-intelligence-brief","title":"1. Threat Intelligence Brief","text":""},{"location":"projects/threat-intel/#11-purpose","title":"1.1 Purpose","text":"<p>This brief delivers a focused overview of UNC5221, a threat actor that presents significant risks to Piedmont Medical Group (PMG) and the broader healthcare sector. The purpose of this document is to inform PMG's IT team and healthcare staff by providing context, analysis, and tailored recommendations based on PMG's specific IT environment and operational needs.</p> <p>To begin, the background summary will contextualize UNC5221's activities and objectives in the healthcare industry. Following the background summary, the threat analysis will detail how UNC5221's tactics, techniques, and procedures (TTPs) align with the MITRE ATT&amp;CK framework. The MITRE ATT&amp;CK framework is a globally recognized knowledge base that categorizes adversary tactics and techniques observed in real-world incidents.</p> <p>After the threat analysis, the report will summarize the vulnerabilities most relevant to PMG, with a focus on those affecting the organization's technology stack and network. This section will make clear how these vulnerabilities could impact PMG's infrastructure.</p> <p>Building on the vulnerabilities discussion, the document will address the malware toolkits deployed by UNC5221, explaining their potential effects on PMG's systems. The report will then conclude with actionable recommendations for detection and mitigation, all of which are customized to address the unique IT infrastructure and operational requirements of Piedmont Medical Group.</p> <p>As a follow-up, a Security Operations Center (SOC) detection strategy and rule deployment document will be provided to the IT team for further review. This accompanying document will include: an inventory of critical log sources and telemetry for PMG's assets; detection rule suggestions mapped to the observed TTPs; and proposed enhancements for dashboards and SOC workflows, ensuring that all guidance is directly relevant to PMG's environment.</p>"},{"location":"projects/threat-intel/#12-overview-of-unc5221-threat-landscape","title":"1.2 Overview of UNC5221 Threat Landscape","text":""},{"location":"projects/threat-intel/#121-background","title":"1.2.1 Background","text":"<p>UNC5221 is a China-nexus espionage threat actor that the PMG CTI team has been actively tracking since October 2023. This group has increasingly focused its operations on the healthcare sector, targeting critical infrastructure and sensitive patient data within hospitals, clinics, and healthcare service providers.</p> <p>Their primary initial access vector remains the exploitation of vulnerabilities in widely deployed enterprise-grade Virtual Private Network (VPN) appliances, such as Ivanti Connect Secure. After gaining a foothold, UNC5221 leverages a custom malware toolset designed for stealth and persistent presence within healthcare IT systems.</p>"},{"location":"projects/threat-intel/#122-related-campaigns","title":"1.2.2 Related Campaigns","text":"<ul> <li>In April 2025, UNC5221 exploited a critical buffer overflow vulnerability, CVE-2025-22457, in Ivanti Connect Secure VPN appliances.</li> <li>Since April 2024, UNC5221 has been observed exploiting vulnerabilities in edge devices, used compromised credentials, and deployed the BRICKSTORM backdoor in a campaign targeting the legal and software industries in the United States (CAMP.25.044).</li> </ul>"},{"location":"projects/threat-intel/#13-threat-analysis-ivanti-connect-secure","title":"1.3 Threat Analysis \u2013 Ivanti Connect Secure","text":"<p>This report focuses specifically on PMG and its current VPN infrastructure. At present, PMG's attack surface includes only Ivanti VPN endpoints; Fortinet and Citrix VPN solutions are not deployed within the organization. Accordingly, the analysis will address only Ivanti-specific CVEs and related recommendations.</p>"},{"location":"projects/threat-intel/#131-vulnerabilities-overview","title":"1.3.1 Vulnerabilities Overview","text":""},{"location":"projects/threat-intel/#cve-2023-46805-ivanti-connect-secure-policy-secure-authentication-bypass","title":"CVE-2023-46805 \u2013 Ivanti Connect Secure / Policy Secure Authentication Bypass","text":"<p>Overview: An authentication bypass vulnerability in the web component of Ivanti Connect Secure (ICS) and Ivanti Policy Secure gateways. Allows unauthenticated attackers to access restricted resources by bypassing control checks.</p> <p>Affected Products: - Ivanti Connect Secure - Ivanti Policy Secure - Ivanti ZTA Gateways</p> <p>Impacted Versions: - Ivanti Connect Secure: 9.x and 22.x (e.g., 9.1R18.3) - Ivanti Policy Secure: Same versions</p> <p>Attack Vector: - Remote unauthenticated access via crafted HTTP requests to Ivanti VPN endpoints</p> <p>Exploitation: - Often chained with CVE-2024-21887 for unauthenticated remote code execution - Used by threat actors like UNC5221 and UTA0178 to deploy webshells</p> <p>Impact: - Severity: CVSS 9.8 (Critical) - Effect: Full remote code execution without authentication - Scope: Allows attackers to deploy malware, establish persistence, and pivot laterally into internal networks</p> <p>Mitigations: - Patch to versions: 9.1R18.4, 9.1R17.3, 22.6R2.2, etc. - A patch was released for ICS 22.2R3 on June 4, 2024. Previous releases were patched on February 8th for Ivanti Connect Secure (versions 9.1R14.5, 9.1R17.3, 9.1R18.4, 22.4R2.3, 22.5R1.2, 22.5R2.3 and 22.6R2.2), Ivanti Policy Secure (versions 9.1R17.3, 9.1R18.4 and 22.5R1.2) and ZTA gateways (versions 22.5R1.6, 22.6R1.5 and 22.6R1.7)) and 14th (for Ivanti Connect Secure (versions 9.1R15.3, 9.1R16.3, 22.1R6.1, 22.2R4.1, 22.3R1.1 and 22.4R1.1) and Ivanti Policy Secure (versions 9.1R16.3, 22.4R1.1 and 22.6R1.1) respectively - Ivanti released mitigation scripts for unpatched systems - CISA added this to its Known Exploited Vulnerabilities (KEV) catalog</p>"},{"location":"projects/threat-intel/#cve-2024-21887-ivanti-command-injection","title":"CVE-2024-21887 \u2013 Ivanti Command Injection","text":"<p>Overview: A command injection vulnerability in Ivanti ICS and Policy Secure allowing authenticated administrators to execute arbitrary commands.</p> <p>Affected Products: - Ivanti Connect Secure - Ivanti Policy Secure</p> <p>Impacted Versions: - Ivanti Connect Secure: 9.x and 22.x (e.g., 9.1R18.3) - Ivanti Policy Secure: Same versions</p> <p>Exploitation: - Often chained with CVE-2023-46805 for unauthenticated RCE - Used by UNC5221 and other actors to deploy malware and webshells</p> <p>Mitigations: - Patch to 9.1R18.4 and other listed versions - Apply Ivanti's mitigation script if patching is delayed</p>"},{"location":"projects/threat-intel/#cve-2025-22457-ivanti-stack-based-buffer-overflow","title":"CVE-2025-22457 - Ivanti Stack-Based Buffer Overflow","text":"<p>Overview: Stack-based buffer overflow in Ivanti Connect Secure, Policy Secure, and ZTA Gateways.</p> <p>Affected Products: - Ivanti Connect Secure - Ivanti Policy Secure - Ivanti ZTA Gateways</p> <p>Impacted Versions: - Ivanti Connect Secure: 9.x and 22.x (e.g., 9.1R18.3) - Ivanti Policy Secure: Same versions</p> <p>Impact: - Remote unauthenticated code execution - CVSS: 9.8 (Critical) - Exploited In Wild: Yes \u2014 attributed to UNC5221 (China-nexus actor)</p> <p>Malware Dropped: - TRAILBLAZE (in-memory dropper) - BRUSHFIRE (passive backdoor) - SPAWN ecosystem (previously linked to UNC5221)</p> <p>Mitigations: - Patch to 9.1R18.4 and other listed versions - A patch for CVE-2025-22457 was released in ICS 22.7R2.6 on February 11, 2025. The vulnerability is a buffer overflow with a limited character space, and therefore it was initially believed to be a low-risk denial-of-service vulnerability. We assess it's likely the threat actor studied the patch for the vulnerability in ICS 22.7R2.6 and uncovered through a complicated process, it was possible to exploit 22.7R2.5 and earlier to achieve remote code execution</p>"},{"location":"projects/threat-intel/#132-related-toolset","title":"1.3.2 Related Toolset","text":""},{"location":"projects/threat-intel/#summary","title":"Summary","text":"<ul> <li>Directly Associated: 3 tools (TRAILBLAZE, BRUSHFIRE, SPAWNSLOTH)</li> <li>Possibly Associated: 6 tools (SPAWNWAVE, ZIPLINE, Brickstorm, Earthworm, Lightwire, Neo-reGeorg)</li> </ul>"},{"location":"projects/threat-intel/#trailblaze","title":"TRAILBLAZE","text":"<p>TRAILBLAZE is an in-memory only dropper written in bare C that uses raw syscalls and is designed to be as minimal as possible, likely to ensure it can fit within the shell script as Base64. TRAILBLAZE injects a hook into the identified /home/bin/web process. It will then inject the BRUSHFIRE passive backdoor into a code cave inside that process.</p> <p>Threat Correlation: In-memory dropper deployed via shell injection; fits within login.cgi exploit chain.</p>"},{"location":"projects/threat-intel/#brushfire","title":"BRUSHFIRE","text":"<p>BRUSHFIRE is a passive backdoor written in bare C that acts as an SSL_read hook. It first executes the original SSL_read function, and checks to see if the returned data begins with a specific string. If the data begins with the string, it will XOR decrypt then execute shellcode contained in the data. If the received shellcode returns a value, the backdoor will call SSL_write to send the value back.</p> <p>Threat Correlation: Passive backdoor injected by TRAILBLAZE into /home/bin/web; core persistence mechanism.</p>"},{"location":"projects/threat-intel/#spawnsloth","title":"SPAWNSLOTH","text":"<p>As detailed in our previous blog post, SPAWNSLOTH acts as a log tampering component tied to the SPAWNSNAIL backdoor. It targets the dslogserver process to disable both local logging and remote syslog forwarding.</p> <p>Threat Correlation: Log tampering component used post-exploitation to disable dslogserver and evade detection.</p>"},{"location":"projects/threat-intel/#spawnwave","title":"SPAWNWAVE","text":"<p>SPAWNWAVE is an evolved version of SPAWNANT that combines capabilities from other members of the SPAWN* malware ecosystem. SPAWNWAVE overlaps with the publicly reported SPAWNCHIMERA and RESURGE malware families.</p> <p>Threat Correlation: Part of SPAWN ecosystem; overlaps with malware families used by UNC5221 in Ivanti campaigns.</p>"},{"location":"projects/threat-intel/#zipline","title":"ZIPLINE","text":"<p>ZIPLINE is a passive backdoor that was used during Cutting Edge on compromised Secure Connect VPNs for reverse shell and proxy functionality.</p> <p>Threat Correlation: Passive backdoor used in Secure Connect VPN exploitation; may overlap with Ivanti tooling.</p>"},{"location":"projects/threat-intel/#brickstorm","title":"BRICKSTORM","text":"<p>Brickstorm is a sophisticated and highly evasive cyberespionage backdoor tool, primarily associated with the China-aligned threat group UNC5221. The malware has been used in long-term espionage campaigns to infiltrate and steal intellectual property and other sensitive information from high-value targets, particularly in Europe.</p> <p>Threat Correlation: UNC5221-linked espionage tool; may be deployed post-access for long-term persistence.</p>"},{"location":"projects/threat-intel/#earthworm","title":"EARTHWORM","text":"<p>A simple network tunnel with SOCKS v5 server and port transfer. It works well in various situations. It supports \"forward\", \"backward\" and \"multi-transfer\" modes and can penetrate deeply into the intranet. It supports various OS such as Linux, Windows, MacOS, Arm-Linux. Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection and network filtering, or to enable access to otherwise unreachable systems.</p> <p>Threat Correlation: Network tunneling tool; useful for C2 or lateral movement post-Ivanti compromise.</p>"},{"location":"projects/threat-intel/#lightwire","title":"LIGHTWIRE","text":"<p>LIGHTWIRE is a web shell written in Perl that was used during Cutting Edge to maintain access and enable command execution by embedding into the legitimate compcheckresult.cgi component of Ivanti Secure Connect VPNs.</p> <p>Threat Correlation: Web shell embedded in Ivanti CGI component; aligns with CVE-2024-21887 exploitation.</p>"},{"location":"projects/threat-intel/#neo-regeorg","title":"NEO-reGEORG","text":"<p>Neo-reGeorg is an open-source web shell designed as a restructuring of reGeorg with improved usability, security, and fixes for existing reGeorg bugs.</p> <p>Threat Correlation: Open-source web shell; commonly used in VPN appliance exploitation scenarios.</p>"},{"location":"projects/threat-intel/#133-mitre-attck-mapping-for-ivanti-cves","title":"1.3.3 MITRE ATT&amp;CK Mapping for Ivanti CVEs","text":"Tactic Technique ID Technique Name Description Initial Access T1190 Exploit Public-Facing Application Attackers exploit Ivanti VPN endpoints to gain unauthenticated access Execution T1059.004 Command and Scripting Interpreter: Unix Shell Shell commands injected via login.cgi to execute payloads like TRAILBLAZE Persistence T1505.003 Server Software Component: Webshell BRUSHFIRE backdoor embedded in /home/bin/web for long-term access Defense Evasion T1562.001 Impair Defenses: Disable or Modify Tools Ivanti's integrity checker tool (ICT) is tampered to avoid detection Command &amp; Control T1071.001 Application Layer Protocol: Web BRUSHFIRE uses passive HTTP/S beaconing for stealthy C2 communication Credential Access T1003 OS Credential Dumping VPN session tokens and credentials are harvested post-exploitation Exfiltration T1041 Exfiltration Over C2 Channel Data exfiltrated via encrypted channels from compromised appliances Lateral Movement T1021.004 Remote Services: SSH SPAWN toolkit used to pivot across systems using SSH and remote shells Defense Evasion T1027 Obfuscated Files or Information TRAILBLAZE is packed and Base64-encoded in shell scripts Defense Evasion T1036 Masquerading BRUSHFIRE masquerades as legitimate SSL_read hook Defense Evasion T1222 File and Directory Permissions Modification Used to persist implants in /home/bin/web with modified perms Discovery T1016 System Network Configuration Discovery SPAWN tools perform network recon for lateral movement Discovery T1033 System Owner/User Discovery Used to identify privileged accounts post-access Discovery T1057 Process Discovery TRAILBLAZE targets running processes for injection Discovery T1082 System Information Discovery Recon phase includes OS fingerprinting Discovery T1083 File and Directory Discovery SPAWN tools enumerate file paths for implant placement Discovery T1518 Software Discovery SPAWNSLOTH disables dslogserver and remote syslog Execution T1047 Windows Management Instrumentation Used in lateral movement and remote command execution (especially in hybrid Windows environments)"},{"location":"projects/threat-intel/#134-risk-assessment","title":"1.3.4 Risk Assessment","text":"<p>The following table outlines the potential risk and impact to PMG.</p> Category Risk / Impact Remote Access Compromise VPN gateway exploitation allows attackers to bypass authentication and gain full access to internal systems Patient Data Exposure Attackers can exfiltrate PHI (Protected Health Information), violating HIPAA and triggering breach notifications Malware Deployment TRAILBLAZE and BRUSHFIRE enable stealthy persistence and remote control, often undetected by traditional AV Credential Theft VPN session tokens and cached credentials can be harvested, enabling lateral movement and privilege escalation Operational Disruption Attackers may disable logging (via SPAWNSLOTH), tamper with integrity tools, or crash services, impacting care delivery Compliance Violations Failure to patch or detect exploitation could result in regulatory penalties and loss of accreditation Third-Party Risk Compromised VPNs may be used to pivot into EHR systems, billing platforms, or partner networks Reputation Damage Public disclosure of a breach tied to known CVEs can erode patient trust and damage institutional credibility Incident Response Overload Without automation or SOAR playbooks, even a single compromise can overwhelm IT and compliance teams"},{"location":"projects/threat-intel/#135-recommendations-for-mitigation-and-detection","title":"1.3.5 Recommendations for Mitigation and Detection","text":"<p>This section outlines high-level mitigation and detection strategies for Ivanti-related CVEs exploited by UNC5221. Detailed configuration guidance and workflow enhancements are provided in the accompanying solution document. Note that these recommendations include potential additions to the existing toolset.</p> <p>These recommendations are intended for organizations currently using Ivanti products and may require adaptation based on individual infrastructure and security policies. For step-by-step implementation details and workflow integration, please refer to the accompanying solution document before making any changes.</p>"},{"location":"projects/threat-intel/#1351-mitigation-recommendations","title":"1.3.5.1 Mitigation Recommendations","text":"<p>Patch Validation and Software Hygiene</p> <ul> <li>Validate all deployed Ivanti Connect Secure appliances against the latest vendor advisories</li> <li>Ensure software versions meet or exceed the patch levels specified in the mitigation sections of CVE-2025-22457, CVE-2023-46805, and CVE-2024-21887</li> <li>Monitor for out-of-band firmware updates and emergency hotfixes from Ivanti and CISA</li> </ul> <p>Asset Management and Attack Surface Reduction</p> <ul> <li>Use SentinelOne Ranger or equivalent tools to discover unmanaged or rogue VPN appliances, IoT devices, and remote endpoints</li> <li>Maintain a centralized asset inventory that includes:</li> <li>Network infrastructure (firewalls, switches, VPNs)</li> <li>Server Compute</li> <li>Medical devices and embedded systems</li> <li>End-user workstations and mobile devices</li> <li>Cloud workloads and virtual appliances</li> <li>Tag critical assets (VPN gateways, EHR systems) for prioritized alerting and patch enforcement</li> </ul> <p>Network Segmentation and Access Control</p> <ul> <li>Isolate Ivanti appliances from direct internet exposure where possible</li> <li>Enforce strict ACLs and firewall rules to limit access to endpoints</li> <li>Require MFA for all VPN access</li> </ul>"},{"location":"projects/threat-intel/#1352-detection-enhancements","title":"1.3.5.2 Detection Enhancements","text":"<p>Sigma Rule Deployment</p> <p>Deployment of Sigma rules related to the CVEs. Sigma rules enhance log-based detection across multiple platforms. Recommended log sources include:</p> <ul> <li>Windows Sysmon / Event Logs: Detect shell execution, credential access, and process injection (e.g., TRAILBLAZE behavior)</li> <li>Suricata IPS: Match exploit signatures for login.cgi and welcome.cgi injection attempts. Use Sid 22457 for CVE-2025-22457</li> <li>Firewall Logs: Adapt Sigma rules to detect anomalous outbound traffic, reverse shells, and passive beaconing</li> <li>Azure Security Center / Defender XDR: Translate Sigma logic into KQL queries to detect command injection, webshell activity, and lateral movement</li> <li>Ivanti Connect Secure Logs: Monitor HTTP access logs for exploit chains involving login.cgi, welcome.cgi, and suspicious POST bodies</li> <li>Splunk SIEM / SOAR: Use Sigma2Splunk converters to build correlation searches, risk-based alerts, and automated playbooks</li> <li>SentinelOne Singularity Endpoint: While Sigma is not natively supported, logic can be translated into Storyline Active Response (STAR) rules or hunting queries</li> <li>CrowdSec: Convert Sigma rules into YAML-based scenarios. CrowdSec supports behavioral detection and can trigger bouncer actions (e.g., IP blocking, Discord alerts)</li> </ul> <p>YARA Rule Deployment</p> <p>YARA rules support malware identification, endpoint detection, and forensic triage. Recommended integrations:</p> <ul> <li>SentinelOne Deep Visibility: Scan memory and file artifacts for BRUSHFIRE, TRAILBLAZE, and SPAWN variants. Supports custom indicators</li> <li>Ivanti Connect Secure Appliance: Use YARA to scan /home/bin/web and other implant paths if file access is available via SSH or forensic imaging</li> <li>Splunk: Integrate YARA via scripted inputs or sandbox connectors (e.g., Cuckoo, VMRay) for malware analysis</li> <li>Microsoft Defender for Office 365: Apply YARA in sandboxed email attachment analysis and phishing lure detection</li> <li>Azure Security Center / Defender for Endpoint: Use YARA for file scanning and memory inspection across cloud workloads and hybrid endpoints</li> <li>DLP Solutions: Apply YARA to scan outbound files for sensitive content (e.g., PHI, PII, credentials) before transmission</li> </ul>"},{"location":"projects/threat-intel/#1353-additional-recommendations","title":"1.3.5.3 Additional Recommendations","text":"<ul> <li>File Integrity Monitoring (FIM)</li> <li>SentinelOne enhancements</li> <li>Ranger</li> <li>STAR</li> <li>Passive DNS and Proxy Analysis</li> <li>Threat Intelligence enhancements, integration of existing tools and CrowdSec into current workflows</li> <li>Deployment of Splunk SOAR as an enhancement to the existing toolset</li> <li>Automate response actions such as:<ul> <li>Endpoint isolation</li> <li>Ticket creation</li> <li>Threat enrichment</li> <li>SOC notification</li> </ul> </li> <li>Deployment of a Data Loss Prevention (DLP) solution to add additional internal controls geared towards protecting sensitive data (HIPAA/PHI/PII)</li> </ul>"},{"location":"projects/threat-intel/#2-security-operations-center-detection-strategy-and-rule-deployment","title":"2. Security Operations Center - Detection Strategy and Rule Deployment","text":""},{"location":"projects/threat-intel/#21-purpose","title":"2.1 Purpose","text":"<p>This section outlines the detection logic, rule formats, and platform-specific integrations designed to identify exploitation attempts and post-compromise activity related to CVE-2025-22457, CVE-2023-46805, and CVE-2024-21887. The rules can be deployed across a multi-platform SOC environment, including SentinelOne, Splunk, CrowdSec, Suricata, and DLP solutions. Each rule is mapped to MITRE ATT&amp;CK techniques and aligned with the threat intelligence findings in Section 1. The goal is to provide reproducible detection logic that supports both automated response and forensic triage.</p>"},{"location":"projects/threat-intel/#22-critical-log-sources-and-telemetry","title":"2.2 Critical Log Sources and Telemetry","text":""},{"location":"projects/threat-intel/#221-critical-log-sources","title":"2.2.1 Critical Log Sources","text":"Category Source Why It's Critical VPN Gateway Logs Ivanti Connect Secure HTTP access logs (welcome.cgi, login.cgi, DSID cookies) Detects initial access, exploit attempts, and webshell injection (T1190, T1059.004) Web Server Logs Webserver(s) logs on Ivanti appliance or reverse proxy Captures command injection, unusual POSTs, and shell payloads Process Creation Sysmon (Windows), auditd (Linux), SentinelOne Deep Visibility Detects TRAILBLAZE execution, shell spawns, and BRUSHFIRE injection (T1059.004, T1057) File Integrity Monitoring SentinelOne Flags changes to /home/bin/web, dropped implants, or tampered ICT binaries (T1505.003, T1222) Network Traffic Suricata/Snort, firewall logs, CrowdSec decisions Identifies passive beaconing, reverse shells, and lateral movement (T1071.001, T1021.002) Authentication Logs VPN login events, AD/LDAP logs, MFA failures Detects credential harvesting, session hijacking, and brute force attempts (T1003, T1033) Endpoint Telemetry SentinelOne, Defender for Endpoint, CrowdSec agent Tracks shell execution, memory-only payloads, and suspicious child processes DNS &amp; Proxy Logs Internal DNS, web proxy, Secure Web Gateway Reveals C2 domains, encoded payloads, and exfiltration attempts (T1041) Email Security Logs Defender for O365 Detects phishing lures targeting VPN credentials or fake Ivanti updates Asset Inventory &amp; Vulnerability Scans Qualys, SentinelOne Ranger Identifies vulnerable Ivanti appliances and unmanaged VPN endpoints Cloud App Logs Azure App Service, Defender for Cloud Detects command injection patterns (cmd=, ;, &amp;) in cloud-exposed Ivanti services"},{"location":"projects/threat-intel/#222-mitre-technique-telemetry-coverage","title":"2.2.2 MITRE Technique Telemetry Coverage","text":"MITRE Technique Required Telemetry T1190 \u2013 Exploit Public-Facing App VPN logs, web server logs T1059.004 \u2013 Unix Shell Process creation, shell history T1505.003 \u2013 Webshell File integrity, process injection T1562.001 \u2013 Disable Security Tools ICT tampering, log suppression T1071.001 \u2013 Web C2 Firewall / IPS (Suricata) logs T1003 \u2013 Credential Dumping EDR/Auth logs, memory inspection T1041 \u2013 Exfiltration DNS, firewall logs T1021.004 \u2013 SSH Network traffic, process logs T1033 \u2013 User Discovery Endpoint telemetry, shell history T1222 \u2013 File Permissions FIM, auditd, SentinelOne T1518.001 \u2013 Security Software Discovery Process logs, endpoint scans T1027 \u2013 Obfuscated Files or Information File content inspection, script decoding, memory analysis T1036 \u2013 Masquerading Process lineage, binary metadata, DLL loading anomalies T1016 \u2013 System Network Configuration Discovery Network interface logs, shell commands (ip, ifconfig) T1057 \u2013 Process Discovery Process listings, auditd T1082 \u2013 System Information Discovery OS fingerprinting, hostname queries, system metadata T1083 \u2013 File and Directory Discovery File access logs, shell history, auditd"},{"location":"projects/threat-intel/#23-detection-rule-suggestions","title":"2.3 Detection Rule Suggestions","text":""},{"location":"projects/threat-intel/#231-yara-rules-for-detection","title":"2.3.1 YARA Rules for Detection","text":"<p>This section outlines YARA-based detection logic for identifying memory-resident implants and file-based indicators. These rules can be applied across the security stack, SentinelOne, Microsoft Defender, DLP solutions and forensic platforms.</p> <p>BRUSHFIRE Backdoor <pre><code>rule BRUSHFIRE_Backdoor\n{\n    meta:\n        description = \"Detects BRUSHFIRE passive backdoor\"\n        author = \"Paul Leone\"\n        cve = \"CVE-2025-22457\"\n\n    strings:\n        $s1 = \"BRUSHFIRE::init\"\n        $s2 = \"/home/bin/web\"\n        $s3 = \"passive_beacon_mode\"\n\n    condition:\n        all of them\n}\n</code></pre></p> <p>SPAWN Toolset Detection Rules <pre><code>rule M_APT_Installer_SPAWNANT_1\n{\n    meta:\n        author = \"Mandiant\"\n        description = \"Detects SPAWNANT. SPAWNANT is an Installer targeting Ivanti devices. Its purpose is to persistently install other malware from the SPAWN family (SPAWNSNAIL, SPAWNMOLE) as well as drop additional webshells on the box.\"\n\n    strings:\n        $s1 = \"dspkginstall\" ascii fullword\n        $s2 = \"vsnprintf\" ascii fullword\n        $s3 = \"bom_files\" ascii fullword\n        $s4 = \"do-install\" ascii\n        $s5 = \"ld.so.preload\" ascii\n        $s6 = \"LD_PRELOAD\" ascii\n        $s7 = \"scanner.py\" ascii\n\n    condition:\n        uint32(0) == 0x464c457f and 5 of ($s*)\n}\n\nrule M_Utility_SPAWNSNARE_1\n{\n    meta:\n        author = \"Mandiant\"\n        description = \"SPAWNSNARE is a utility written in C that targets Linux systems by extracting the uncompressed Linux kernel image into a file and encrypting it with AES.\"\n\n    strings:\n        $s1 = \"\\x00extract_vmlinux\\x00\"\n        $s2 = \"\\x00encrypt_file\\x00\"\n        $s3 = \"\\x00decrypt_file\\x00\"\n        $s4 = \"\\x00lbb_main\\x00\"\n        $s5 = \"\\x00busybox\\x00\"\n        $s6 = \"\\x00/etc/busybox.conf\\x00\"\n\n    condition:\n        uint32(0) == 0x464c457f and all of them\n}\n\nrule M_APT_Utility_SPAWNSLOTH_2\n{\n    meta:\n        author = \"Mandiant\"\n        description = \"Hunting rule to identify strings found in SPAWNSLOTH\"\n\n    strings:\n        $dslog = \"dslogserver\" ascii fullword\n        $hook1 = \"g_do_syslog_servers_exist\" ascii fullword\n        $hook2 = \"ZN5DSLog4File3addEPKci\" ascii fullword\n        $hook3 = \"funchook\" ascii fullword\n\n    condition:\n        uint32(0) == 0x464c457f and all of them\n}\n</code></pre></p>"},{"location":"projects/threat-intel/#232-suricata-intrusion-prevention-system-detection-rules","title":"2.3.2 Suricata Intrusion Prevention System Detection Rules","text":"<p>Exploit Attempt Detection <pre><code>alert http $EXTERNAL_NET any -&gt; $HOME_NET any (msg:\"Ivanti CVE-2025-22457 Exploit Attempt\"; flow:to_server,established; content:\"/dana-na/auth/url_default/welcome.cgi\"; http_uri; content:\"TRAILBLAZE\"; http_client_body; classtype:attempted-admin; sid:22457; rev:1;)\n</code></pre></p> <p>Shell Dropper Detection <pre><code>alert tcp $EXTERNAL_NET any -&gt; $HOME_NET 443 (msg:\"Ivanti CVE-2025-22457 Shell Dropper\"; flow:to_server,established; content:\"#!/bin/sh\"; content:\"TRAILBLAZE\"; content:\"BRUSHFIRE\"; sid:224572025; rev:1;)\n</code></pre></p>"},{"location":"projects/threat-intel/#233-sentinelone","title":"2.3.3 SentinelOne","text":"<p>Recommended enhancements to SentinelOne Singularity Endpoint that strengthen detection and response for Ivanti-related threats:</p> <p>Deep Visibility</p> <p>Enables granular telemetry across endpoints, capturing process execution, memory artifacts, and file operations \u2014 essential for detecting in-memory payloads like TRAILBLAZE and stealthy implants like BRUSHFIRE.</p>"},{"location":"projects/threat-intel/#234-crowdsec-detection-scenarios","title":"2.3.4 CrowdSec Detection Scenarios","text":"<p>CrowdSec scenarios use YAML rules to analyze logs and trigger actions. They work with web, VPN, and optionally Suricata logs to spot brute force and exploit attempts. You can also set up remediation nodes for automatic rule updates with known C2 IPs.</p> <p>Scenario: Ivanti Auth Bypass via DSID Cookie <pre><code>name: crowdsecurity/ivanti-auth-bypass\ndescription: Detects suspicious DSID cookie usage targeting Ivanti welcome.cgi\nfilter: |\n  evt.Meta.log_type == 'http_access-log' &amp;&amp;\n  Lower(evt.Meta.http_path) contains \"/dana-na/auth/url_default/welcome.cgi\" &amp;&amp;\n  Lower(evt.Meta.http_cookie) contains \"dsid=\"\ngroupby: evt.Meta.source_ip\ndistinct: evt.Meta.http_cookie\ncapacity: 5\nleakspeed: 10m\nlabels:\n  type: exploit\n  remediation: true\n  classification:\n    - attack.initial_access\n    - cve.CVE-2023-46805\n</code></pre> Scenario: Ivanti Command Injection via login.cgi <pre><code>name: crowdsecurity/ivanti-command-injection\ndescription: Detects suspicious cmd= injection attempts in Ivanti login.cgi\nfilter: |\n  evt.Meta.log_type == 'http_access-log' &amp;&amp;\n  Lower(evt.Meta.http_path) contains \"/dana-na/auth/url_default/login.cgi\" &amp;&amp;\n  Lower(evt.Meta.http_body) contains \"cmd=\" &amp;&amp;\n  (\n    Lower(evt.Meta.http_body) contains \"%3b\" or\n    Lower(evt.Meta.http_body) contains \"%26\" or\n    Lower(evt.Meta.http_body) contains \"%2f\"\n  )\ngroupby: evt.Meta.source_ip\ndistinct: evt.Meta.http_body\ncapacity: 3\nleakspeed: 5m\nlabels:\n  type: exploit\n  remediation: true\n  classification:\n    - attack.execution\n    - cve.CVE-2024-21887\n</code></pre> Scenario: Ivanti Custom Detection for CVE-2025-22457 / TRAILBLAZE <pre><code>name: crowdsec/ivanti_cve_2025_22457\ndescription: Detects exploitation attempts of CVE-2025-22457\nfilter: |\n  evt.Meta.service == \"http\" &amp;&amp;\n  evt.Meta.http_path contains \"/dana-na/auth/url_default/welcome.cgi\" &amp;&amp;\n  evt.Meta.http_body contains \"TRAILBLAZE\"\ngroupby: evt.Meta.source_ip\nblackhole: 5m\nlabels:\n  type: exploit\n  remediation: true\n  classification: CVE-2025-22457\n</code></pre></p>"},{"location":"projects/threat-intel/#235-firewall-filter-rules","title":"2.3.5 Firewall Filter Rules","text":"<p>CrowdSec remediation service deployed on the NG Firewall can ingest firewall rules via packages or block lists.</p> <p></p> <p>Example of deployed Scenarios:</p> <p></p>"},{"location":"projects/threat-intel/#236-file-integrity-monitoring-fim","title":"2.3.6 File Integrity Monitoring (FIM)","text":"<p>Monitor critical paths such as /home/bin/web, /tmp/, and /var/log/ for unauthorized changes, implant drops, and log tampering.</p> <p>Use cases:</p> <ul> <li>SentinelOne for kernel-level monitoring and behavioral detection of file modifications</li> <li>CrowdSec to detect suspicious file access patterns and correlate with behavioral scenarios (e.g., unexpected shell activity or log suppression)</li> <li>Splunk SOAR to ingest FIM alerts and trigger automated playbooks (e.g., isolate asset, enrich with threat intel, notify SOC)</li> </ul> <p>2.3.7 Passive DNS and Proxy Analysis Track outbound connections to known C2 domains used by BRUSHFIRE, ZIPLINE, and other UNC5221 tooling.</p> <p>Flag:</p> <ul> <li>Encoded payloads (e.g., Base64 in HTTP POST bodies)</li> <li>Suspicious user agents (e.g., curl, wget, custom implants)</li> </ul>"},{"location":"projects/threat-intel/#238-sigma-rules-and-splunk-correlation-logic","title":"2.3.8 Sigma Rules and Splunk Correlation Logic","text":"<p>These queries and rules are designed to detect Ivanti exploitation activity across multiple stages of the kill chain, from initial access to post-exploitation. They correlate logs from:</p> <ul> <li>Ivanti VPN appliances (e.g., login.cgi, welcome.cgi)</li> <li>Suricata alerts (network-based IDS signatures)</li> <li>System audit logs (Windows Sysmon, Linux auditd)</li> </ul> <p>Each Search Processing Language (SPL) query or rule targets specific behaviors:</p> <ul> <li>Webshell drop detection (e.g., TRAILBLAZE payloads)</li> <li>Suricata alert correlation for CVE-specific signatures</li> <li>Post-exploitation activity like file creation and beaconing</li> </ul> <p>Sigma Rule: Webshell Drop via Ivanti Exploit</p> <pre><code>title: Ivanti Connect Secure Webshell Drop\nid: 9e8b3c3e-4685-4c87-9f3e-ivanti-webshell\nstatus: experimental\ndescription: Detects suspicious file creation in Ivanti Connect Secure directories\nlogsource:\n  product: windows\n  category: file_create\ndetection:\n  selection:\n    TargetFilename|contains:\n      - '\\temp\\'\n      - '\\htdocs\\'\n    Image|contains:\n      - 'cmd.exe'\n      - 'powershell.exe'\n  condition: selection\nfields:\n  - TargetFilename\n  - Image\n  - User\n  - CommandLine\nlevel: high\ntags:\n  - attack.initial_access\n  - attack.persistence\n  - cve.CVE-2023-46805\n  - cve.CVE-2024-21887\n</code></pre> <p>Splunk Alert and Query Translations</p> <p><pre><code>[Ivanti Connect Secure Webshell Drop]\nalert.severity = 4\ndescription = Detects suspicious file creation in Ivanti Connect Secure directories (Rule ID: 9e8b3c3e-4685-4c87-9f3e-ivanti-webshell) Reference: https://tdm.socprime.com/tdm/info/\ncron_schedule = 0 * * * *\ndisabled = 1\nis_scheduled = 1\nis_visible = 1\ndispatch.earliest_time = -60m@m\ndispatch.latest_time = now\nsearch = index=* source=\"WinEventLog:*\" AND ((TargetFilename=\"*\\\\temp\\\\*\" OR TargetFilename=\"*\\\\htdocs\\\\*\") AND (NewProcessName=\"*cmd.exe*\" OR NewProcessName=\"*powershell.exe*\")) | table TargetFilename,NewProcessName,User,CommandLine\nalert.suppress = 0\nalert.track = 1\nactions = risk,notable\naction.risk = 1\naction.risk.param._risk_object_type = user\naction.risk.param._risk_score = 75\naction.correlationsearch = 0\naction.correlationsearch.enabled = 1\naction.notable.param.rule_title = Ivanti Connect Secure Webshell Drop\naction.notable.param.rule_description = Detects suspicious file creation in Ivanti Connect Secure directories (Rule ID: 9e8b3c3e-4685-4c87-9f3e-ivanti-webshell)\n</code></pre> Ivanti Exploit Chain Detection (Webshell Drop)</p> <p><pre><code>index=web_logs sourcetype=ivanti_http_logs\n| search uri=\"/dana-na/auth/url_default/welcome.cgi\" AND cookie=\"DSID=\"\n| join source_ip [ search index=web_logs uri=\"/dana-na/auth/url_default/login.cgi\" body=\"cmd=\" OR body=\"TRAILBLAZE\" ]\n| stats count by source_ip, uri, user_agent, body\n| where count &gt; 2\n</code></pre> Suricata Alert Correlation (Sid 468051 + 218871 + 22457)</p> <p><pre><code>index=suricata sourcetype=suricata_eve\n| search alert.signature IN (\n    \"EXPLOIT \u2013 Ivanti Connect Secure Authentication Bypass\",\n    \"EXPLOIT \u2013 Ivanti Connect Secure Command Injection\",\n    \"EXPLOIT \u2013 Ivanti Connect Secure Buffer Overflow CVE-2025-22457\"\n)\n| stats count by src_ip, dest_ip, alert.signature, timestamp\n| where count &gt; 1\n</code></pre> File Creation + Network Beaconing (Post-Exploitation) <pre><code>index=os_logs sourcetype=linux_audit OR sourcetype=windows_sysmon\n| search process_name=\"cmd.exe\" OR process_name=\"powershell.exe\" OR process_name=\"TRAILBLAZE\"\n| join host [ search index=network_logs dest_port=443 OR dest_port=8443 ]\n| stats count by host, process_name, dest_ip, uri\n| where count &gt; 3\n</code></pre></p>"},{"location":"projects/threat-intel/#24-workflow-and-feature-enhancements-to-existing-solutions","title":"2.4 Workflow and Feature Enhancements to Existing Solutions","text":""},{"location":"projects/threat-intel/#241-sentinelone-singularity-endpoint","title":"2.4.1 SentinelOne Singularity Endpoint","text":"<p>Recommended enhancements to SentinelOne that provide increased asset visibility and streamline workflows for Ivanti-related threats:</p> <p>Device Inventory</p> <p>Automatically discovers and tracks all endpoints, including Windows, Linux, macOS and cloud workloads. Displays hostname, OS, IP, MAC address, agent status and more. Tag assets by site, group, policy, and criticality level for triage and prioritization.</p> <p>Ranger</p> <p>Performs passive network discovery to identify unmanaged or rogue devices, including vulnerable Ivanti VPN appliances. Helps map the full attack surface and flag assets missing endpoint protection. Supports agentless visibility using passive network scanning.</p> <p>STAR (Storyline Active Response)</p> <p>SentinelOne's custom detection engine that correlates process chains, flags suspicious behavior (shell spawn from web process), and automates response actions like isolation, alerting, and enrichment.</p> <ul> <li>Create custom STAR detection rules for suspicious behaviors linked to these CVEs</li> <li>Storyline Correlation Logic:</li> <li>Web process spawning shell interpreters</li> <li>Encoded payloads (e.g., base64, PowerShell) from web-facing services</li> <li>Outbound HTTPS connections from non-browser processes</li> </ul> <p>Example Detection Rules: <pre><code>Rule: Suspicious Webshell Drop\nProcessName: powershell.exe OR cmd.exe\nCommandLine: contains \"echo\" AND contains \".aspx\" OR \".jsp\"\nParentProcess: httpd.exe OR nginx.exe OR unknown\nTags: [\"ivanti\", \"webshell\", \"CVE-2023-46805\"]\n\nRule: Command Injection via login.cgi\nProcessName: bash OR sh OR python\nCommandLine: contains \"cmd=\" AND contains \";\"\nParentProcess: httpd OR nginx OR unknown\nTags: [\"ivanti\", \"command-injection\", \"CVE-2024-21887\"]\n\nRule: Buffer Overflow Dropper\nProcessName: cmd.exe OR powershell.exe OR TRAILBLAZE\nCommandLine: contains \"BRUSHFIRE\" OR \"/home/bin/web\"\nParentProcess: httpd OR nginx OR unknown\nTags: [\"ivanti\", \"dropper\", \"CVE-2025-22457\"]\n</code></pre></p> <p>Storyline Correlation Examples:</p> <ul> <li>httpd.exe \u2192 powershell.exe \u2192 curl.exe \u2192 remote IP</li> <li>Flag this as suspicious lateral movement or C2 beaconing</li> <li>httpd.exe \u2192 TRAILBLAZE \u2192 BRUSHFIRE \u2192 outbound HTTPS</li> <li>Memory-only execution with no file artifacts</li> <li>Reverse shell or passive beaconing from /home/bin/web</li> </ul>"},{"location":"projects/threat-intel/#242-soar-playbooks","title":"2.4.2 SOAR Playbooks","text":"<p>Integrating a SOAR platform into the current SOC toolset will facilitate the automation of response actions across multiple platforms.</p> <p>Endpoint Isolation</p> <ul> <li>Trigger via SentinelOne or Defender for Endpoint</li> <li>Use Splunk SOAR to orchestrate across hybrid environments</li> </ul> <p>Ticket Creation</p> <ul> <li>Auto-generate tickets in ITSM platforms (ServiceNow, Jira) with full context from CrowdSec, SentinelOne, and Splunk</li> </ul> <p>Threat Enrichment</p> <ul> <li>Pull CVE metadata, MITRE mappings, and malware family details into alert context</li> <li>Use Splunk SOAR to enrich alerts with Sigma/YARA matches and IOC overlays</li> </ul> <p>SOC Notification</p> <ul> <li>Send real-time alerts to Slack, Teams, or email with full triage context</li> <li>Include asset tags, exploit chain stage, and recommended response actions</li> </ul> <p>Ivanti-Specific Logic</p> <ul> <li>Detect access to /dana-na/auth/url_default/login.cgi with cmd= or TRAILBLAZE payloads</li> <li>Flag modifications to /home/bin/web and disablement of dslogserver</li> <li>Correlate with Suricata Sid 22457 and CrowdSec exploit scenarios</li> </ul>"},{"location":"projects/threat-intel/#243-threat-intelligence-integration","title":"2.4.3 Threat Intelligence Integration","text":"<p>Enrich detections with IOCs from:</p> <ul> <li>CISA AA25-22457</li> <li>Health-ISAC</li> <li>Commercial feeds (Recorded Future, Proofpoint, SentinelOne Threat Intel)</li> </ul> <p>Use cases:</p> <ul> <li>Splunk SOAR to ingest threat intel feeds and correlate with asset criticality, MITRE techniques, and recent alerts</li> <li>SentinelOne STAR to tag assets and apply custom detection logic based on threat indicators</li> <li>CrowdSec to ingest IOCs into its decision engine and trigger bouncer actions (e.g., IP block, Discord alert)</li> <li>DLP solution to apply threat intel to outbound file scanning and block transmission of known malware or sensitive content</li> </ul>"},{"location":"projects/threat-intel/#244-passive-dns-and-proxy-analysis","title":"2.4.4 Passive DNS and Proxy Analysis","text":"<p>Workflow use cases:</p> <ul> <li>CrowdSec to detect repeated outbound attempts, DNS tunneling, or proxy evasion. CrowdSec scenarios can block IPs and log decisions for SOC review</li> <li>Splunk SOAR to correlate proxy anomalies with endpoint behavior (e.g., shell spawn \u2192 outbound HTTPS \u2192 C2 domain)</li> <li>DLP solution to inspect outbound traffic for sensitive data exfiltration (e.g., PHI, credentials) and enforce transmission policies</li> </ul>"},{"location":"projects/threat-intel/#245-integration-notes","title":"2.4.5 Integration Notes","text":"<ul> <li>Splunk SOAR can ingest alerts from Sigma, Suricata, CrowdSec, and YARA-based sandboxing tools to automate triage, ticketing, and endpoint isolation. SOAR playbooks can trigger based on Sigma-matched alerts</li> <li>SentinelOne STAR can be enriched with YARA hits and CrowdSec decisions to trigger behavioral response actions</li> <li>CrowdSec scenarios can be mapped to MITRE techniques and used to block IPs, trigger alerts, or forward decisions to SIEM/SOAR platforms</li> <li>DLP solutions (Microsoft Purview, CoSoSys, Forcepoint) can apply YARA rules to scan outbound files for implants or sensitive content</li> </ul>"},{"location":"projects/threat-intel/#25-new-platform-and-technology-acquisitions","title":"2.5 New Platform and Technology Acquisitions","text":""},{"location":"projects/threat-intel/#251-crowdsec-threat-intelligence","title":"2.5.1 CrowdSec Threat Intelligence","text":"<p>Deploying CrowdSec introduces a collaborative, behavior-based defense layer that strengthens detection and response across network and system activity. It's especially valuable for small healthcare organizations seeking lightweight, scalable protection against exploitation attempts, credential abuse, and lateral movement, including those tied to CVE-2025-22457, CVE-2023-46805, and CVE-2024-21887.</p> <p>Options include: CrowdSec Community Edition (free), CrowdSec Premium (with extended telemetry and support)</p> <p>Key Capabilities to Prioritize:</p> <p>Behavioral Detection</p> <p>Detect brute force, command injection, and suspicious shell activity using YAML-based scenarios mapped to MITRE techniques.</p> <p>Log Source Integration</p> <p>Ingest logs from firewalls, VPNs, Suricata, SSH, and systemd to monitor for Ivanti-specific exploit chains and post-exploitation behavior.</p> <p>Bouncer Actions</p> <p>Automatically block malicious IPs, disable user accounts, or trigger alerts based on real-time decisions.</p> <p>Community Threat Intelligence</p> <p>Leverage global signals from other CrowdSec users to enrich local detections and prioritize emerging threats.</p> <p>Sigma Rule Conversion</p> <p>Translate Sigma rules into CrowdSec scenarios to detect known attack patterns and anomalies.</p> <p>SOAR Integration</p> <p>Forward CrowdSec decisions to Splunk SOAR for automated triage, ticketing, and enrichment alongside SentinelOne and DLP alerts.</p> <p>Strategic Benefits:</p> <ul> <li>Adds real-time behavioral detection to VPN and endpoint telemetry</li> <li>Enables automated blocking of known malicious IPs and exploit attempts</li> <li>Provides community-driven threat intelligence without heavy infrastructure</li> <li>Enhances visibility into Ivanti-related attack flows with minimal overhead</li> </ul>"},{"location":"projects/threat-intel/#252-splunk-soar","title":"2.5.2 Splunk SOAR","text":"<p>Deploying Splunk SOAR enables automated, scalable incident response tailored to healthcare environments. It's especially critical when facing multi-stage attacks like those exploiting Ivanti VPN infrastructure, where rapid triage and coordinated response are essential.</p> <p>Options include: Splunk SOAR Cloud, Splunk SOAR On-Prem, or Splunk SOAR Lite for smaller teams</p> <p>Key Capabilities to Prioritize:</p> <p>Playbook Automation</p> <p>Build workflows to isolate endpoints, enrich alerts, notify SOC teams, and escalate incidents based on severity and asset criticality.</p> <p>Threat Intelligence Correlation</p> <p>Integrate feeds from CISA, Health-ISAC, SentinelOne, CrowdSec, and DLP tools to enrich alerts with CVE, malware, and MITRE context.</p> <p>Asset-Aware Response</p> <p>Tag critical assets (VPN gateways, EHR systems) and prioritize response actions accordingly.</p> <p>IOC Matching and Enrichment</p> <p>Automatically match incoming alerts against known indicators (BRUSHFIRE domains, ZIPLINE hashes) and enrich with MITRE technique mappings.</p> <p>Cross-Platform Integration</p> <p>Connect with SentinelOne, Microsoft Defender, CrowdSec, Qualys, and DLP tools to orchestrate unified response.</p> <p>Case Management and Reporting</p> <p>Track incident lifecycle, generate audit-ready reports, and support HIPAA compliance documentation.</p> <p>Strategic Benefits:</p> <ul> <li>Enables rapid containment of Ivanti-related threats across endpoints, networks, and cloud</li> <li>Reduces SOC fatigue through automated triage and enrichment</li> <li>Ensures consistent, policy-driven response across all security tools</li> <li>Supports forensic investigation and compliance reporting for PHI/PII incidents</li> </ul>"},{"location":"projects/threat-intel/#253-dlp-solution","title":"2.5.3 DLP Solution","text":"<p>Implementing a DLP solution introduces critical internal controls designed to protect sensitive healthcare data, including HIPAA-regulated PHI, PII, and financial records. This is especially vital in the context of Ivanti exploitation, where attackers may gain access to VPN-connected endpoints and attempt data exfiltration.</p> <p>Options include: Microsoft Purview, CoSoSys and Forcepoint DLP for small organizations</p> <p>Key Capabilities to Prioritize:</p> <p>Content Inspection</p> <p>Deep scanning of files, emails, and web uploads for sensitive data.</p> <p>Policy Enforcement</p> <p>Block or quarantine outbound transmissions that violate data handling policies, especially from compromised endpoints or VPN sessions.</p> <p>Endpoint Integration</p> <p>Monitor clipboard activity, USB transfers, and file access on workstations and mobile devices. Detect attempts to move PHI outside approved channels.</p> <p>Network DLP</p> <p>Inspect outbound traffic for encrypted payloads, ZIPLINE-style reverse shells, or BRUSHFIRE beaconing that may contain exfiltrated data.</p> <p>YARA Rule Support</p> <p>Apply custom YARA rules to scan for malware-laced documents or implants attempting to masquerade as legitimate healthcare files.</p> <p>SOAR Integration</p> <p>Forward DLP alerts to Splunk SOAR for automated triage, ticketing, and endpoint isolation. Include context from CrowdSec decisions and SentinelOne Deep Visibility.</p> <p>Strategic Benefits:</p> <ul> <li>Prevents unauthorized transmission of PHI/PII during or after exploitation of VPN infrastructure</li> <li>Adds a compensating control for organizations with limited segmentation or endpoint hardening</li> <li>Enables forensic triage of suspected data theft attempts tied to CVE-2025-22457, CVE-2023-46805, and CVE-2024-21887</li> </ul>"},{"location":"projects/threat-intel/#26-detection-rule-summary-table","title":"2.6 Detection Rule Summary Table","text":"Rule Type Target Platform(s) CVE Coverage MITRE Technique(s) Detection Purpose YARA SentinelOne, Defender, DLP CVE-2025-22457 T1059.004, T1505.003 Detect BRUSHFIRE and SPAWN implants Sigma Splunk, CrowdSec CVE-2023-46805, 2024-21887 T1190, T1071.001 Detect Ivanti exploit chains and webshells Suricata Suricata, CrowdSec CVE-2025-22457 T1190, T1059.004 Detect buffer overflow and shell dropper CrowdSec CrowdSec, Splunk SOAR All three CVEs T1190, T1059.004 Detect command injection and auth bypass <p>This table supports SOC onboarding, dashboard filtering, and cross-platform rule deployment.</p>"},{"location":"projects/threat-intel/#conclusion","title":"Conclusion","text":"<p>This comprehensive threat intelligence brief and SOC enhancement plan provides Piedmont Medical Group with actionable strategies to defend against UNC5221 exploitation of Ivanti Connect Secure infrastructure. The detection rules, workflow enhancements, and platform recommendations are designed to integrate seamlessly with existing security tools while providing layered defense against sophisticated threat actors targeting the healthcare sector.</p> <p>Key Takeaways:</p> <ul> <li>Immediate patching of CVE-2025-22457, CVE-2023-46805, and CVE-2024-21887 is critical</li> <li>Multi-layer detection through YARA, Sigma, Suricata, and CrowdSec rules provides comprehensive coverage</li> <li>SOAR automation reduces response times and analyst fatigue</li> <li>DLP controls protect PHI/PII from exfiltration during or after compromise</li> <li>Threat intelligence integration enriches detection fidelity and contextual awareness</li> </ul> <p>Next Steps:</p> <ol> <li>Review and validate current Ivanti patch levels</li> <li>Deploy detection rules to appropriate platforms (Splunk, SentinelOne, Suricata, CrowdSec)</li> <li>Configure SOAR playbooks for automated response</li> <li>Enable SentinelOne Ranger for asset discovery</li> <li>Implement FIM monitoring on critical paths</li> <li>Integrate threat intelligence feeds</li> <li>Conduct tabletop exercises to validate detection and response workflows</li> </ol> <p>Document Version: 1.0 Last Updated: October 6, 2025 Classification: Internal Use Only Distribution: PMG IT Security Team, SOC Analysts, Incident Response Team</p> <p>For questions or clarifications regarding this document, contact Paul Leone at  pnleone@outlook.com</p>"},{"location":"projects/homelab/","title":"Security Lab Overview","text":""},{"location":"projects/homelab/#table-of-contents","title":"Table of Contents","text":"Section Description Executive Summary and Security Posture Enterprise-grade security laboratory demonstrating production-ready capabilities across SecOps, systems engineering, and network defense. Multi-layered architecture with SIEM, IDS/IPS, SOAR automation, and zero trust controls. Infrastructure Platform, Virtualzation Stack and Hardware Proxmox virtualization stack, Workload deployment, VMware, Cisco and Container envionment overview Network Security, Pirvacy and Remote Access Network security architecture (Firewall/IPS/WAF), Privacy and remote access Identity, Access, Secrets and Trust Management PKI/Certificate Authority Overview, Identity and Access Management (Authentik/Active Directory), Secrets Management Automation and Infrastructure as Code (IaC) Infrastructure provision with Terraform, Configuration Management with Ansible, Workflow automation with n8n, PowerShell, Bash and Python scripting Applications and Services DNS, Reverse Proxy, Web Services and Ingress Controller Architecture, Secure Shell (SSH) Access, Malware, Vulnerability and Software Patch Management Observability and Response, Part 1  Security Information and Event Management (SIEM) Platforms, Endpoint Detection and Response (EDR) Observability and Response, Part 2  Security Orchestration, Automation and Response (SOAR), Monitoring, Alerting and Notification Architecture  Governance, Risk and Compliance Landing Page Governance, Risk and Compliance Sections TBD"},{"location":"projects/homelab/#security-homelab-network-overview","title":"Security Homelab Network Overview","text":"<p> Download Diagram (png)</p>"},{"location":"projects/homelab/#prod_lan-iso_lan1-and-iso_lan2","title":"PROD_LAN, ISO_LAN1 and ISO_LAN2","text":""},{"location":"projects/homelab/#main-lab-lan-hosting-the-following-workloads","title":"Main lab LAN Hosting the following workloads:","text":"<ul> <li>Docker engines supporting container services </li> <li>Microsoft Active Directory Domain Services</li> <li>Reverse Proxy and DNS Services</li> <li>FortiGate Management Services</li> <li>Integration to ISO LANs<ul> <li>Cisco ISO LAN</li> <li>OPNsense ISO LAN</li> </ul> </li> </ul>"},{"location":"projects/homelab/#lab_lan1-and-ext_lan","title":"LAB_LAN1 and EXT_LAN","text":""},{"location":"projects/homelab/#labext-lans-hosting-the-following-workloads","title":"Lab/Ext LANs Hosting the following workloads:","text":"<ul> <li>PKI Services</li> <li>VMware ESXi</li> <li>Test external workloads </li> </ul>"},{"location":"projects/homelab/#lab_lan2","title":"LAB_LAN2","text":""},{"location":"projects/homelab/#lab2-lan-hosting-the-following-workloads","title":"Lab2 LAN Hosting the following workloads:","text":"<ul> <li>Kubernetes/K3s Cluster Services (SOC Services)</li> <li>ELK Stack and Lab Dashboard </li> </ul>"},{"location":"projects/homelab/01-exec-summary/","title":"Security Lab Solution Document","text":""},{"location":"projects/homelab/01-exec-summary/#executive-overview-and-security-posture","title":"Executive Overview and Security Posture","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/01-exec-summary/#1-executive-overview-and-security-posture","title":"1. Executive Overview and Security Posture","text":""},{"location":"projects/homelab/01-exec-summary/#11-lab-mission-statement","title":"1.1 Lab Mission Statement","text":"<p>This enterprise-grade security lab demonstrates production-ready capabilities across Security Operations (SecOps), Systems Engineering, and Network Defense. Designed to simulate real-world enterprise environments, the lab serves as both a technical proving ground and a continuous learning platform focused on:</p> <ul> <li>Threat Detection and Response \u2014 Deploying SIEM/XDR platforms, orchestrating automated incident response, and implementing behavioral threat intelligence</li> <li>Defense-in-Depth Architecture \u2014 Building multi-layered security controls spanning network perimeter, application layer, identity management, and endpoint protection</li> <li>Enterprise Infrastructure Operations \u2014 Managing hybrid virtualization platforms, container orchestration, and high-availability services at scale</li> <li>Security Engineering and Automation \u2014 Implementing Infrastructure as Code (IaC), SOAR workflows, and policy-driven security controls</li> </ul> <p>Business Value Demonstrated: This lab mirrors the security architecture, operational workflows, and technical complexity found in mid-to-large enterprise environments, providing hands-on experience directly transferable to SOC Analyst, Security Engineer, and Infrastructure Security roles.</p>"},{"location":"projects/homelab/01-exec-summary/#12-architecture-principals","title":"1.2 Architecture Principals","text":"<p>Every design decision in this lab is guided by three core security principles that align with industry frameworks (NIST CSF 2.0, CIS Controls v8, MITRE ATTandCK):</p>"},{"location":"projects/homelab/01-exec-summary/#1-defense-in-depth","title":"1. Defense in Depth","text":"<p>Multiple independent security layers ensure that a single compromised control does not result in full system compromise. Network segmentation, application-layer filtering, endpoint monitoring, and identity verification create overlapping defensive barriers.</p> <p>Technical Implementation:</p> <ul> <li>Network perimeter (firewall ACLs, IDS/IPS)</li> <li>Application layer (WAF, reverse proxy authentication)</li> <li>Endpoint security (EDR agents, vulnerability scanning)</li> <li>Identity controls (MFA, RBAC, PKI)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#2-secure-by-design","title":"2. Secure by Design","text":"<p>Security controls are embedded into architecture from the ground up, not bolted on afterward. All services default to encrypted communications (TLS), authenticated access (SSO/MFA), and least-privilege authorization (RBAC).</p> <p>Technical Implementation:</p> <ul> <li>Automated PKI with certificate lifecycle management</li> <li>Mandatory authentication via Authentik SSO for web services</li> <li>Encrypted DNS (DNSSEC)</li> <li>Immutable infrastructure through IaC version control</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#3-zero-trust-architecture","title":"3. Zero Trust Architecture","text":"<p>No implicit trust is granted based on network location. Every request is authenticated, authorized, and encrypted regardless of origin. Micro-segmentation and identity-aware proxies ensure continuous verification.</p> <p>Technical Implementation:</p> <ul> <li>ForwardAuth middleware validates identity at the edge</li> <li>Network segmentation isolates trust zones</li> <li>Certificate-based mutual TLS for service-to-service communication</li> <li>Tailscale mesh VPN for authenticated peer-to-peer connectivity</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#13-key-capabilities-demonstrated","title":"1.3 Key Capabilities Demonstrated","text":""},{"location":"projects/homelab/01-exec-summary/#strategic-value","title":"Strategic Value","text":"<ul> <li>Reduced Attack Surface: Multi-layer controls detect and block threats at network, application, and endpoint levels</li> <li>Operational Resilience: High-availability architecture ensures continuous security monitoring even during maintenance</li> <li>Compliance Readiness: Framework alignment with NIST CSF 2.0, CIS Controls v8, and MITRE ATTandCK demonstrates audit-ready documentation</li> <li>Scalability: Container orchestration and IaC enable rapid deployment of new security controls without manual configuration</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#engineering-depth","title":"Engineering Depth","text":"<ul> <li>Advanced Threat Detection: Behavioral threat intelligence (CrowdSec), network anomaly detection (Suricata/Snort), and SIEM correlation (ELK Stack/Splunk)</li> <li>Automated Incident Response: SOAR workflows integrate TheHive case management, Cortex/MISP enrichment, and automated remediation via pfSense API</li> <li>Infrastructure as Code: Terraform and Ansible enable version-controlled, repeatable deployments with full audit trails</li> <li>Full-Stack Observability: Unified metrics collection (Prometheus), visualization (Grafana/Pulse), and alerting (Discord webhooks, SMTP relay)</li> <li>Forensic Readiness: Comprehensive logging, artifact preservation, and analysis tools (Volatility, KAPE, Velociraptor) support post-incident investigation</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#2-security-posture","title":"2. Security Posture","text":""},{"location":"projects/homelab/01-exec-summary/#21-network-and-perimeter-security","title":"2.1 Network and Perimeter Security","text":""},{"location":"projects/homelab/01-exec-summary/#network-segmentation-and-zone-based-firewall","title":"Network Segmentation and Zone-Based Firewall","text":"<p>Multiple VLANs create trust boundaries between production services, internal lab systems, and isolated research environments. pfSense/OPNsense firewalls enforce stateful inspection with default-deny rules, permitting only explicitly authorized traffic flows between zones.</p> <p>Security Impact: Lateral movement is restricted; compromised systems cannot pivot freely across network segments.</p> <p>Technical Details:</p> <ul> <li>Trust zones: Production (VLAN 10), Internal Lab (VLAN 20), Isolated Research (VLAN 30)</li> <li>Inter-VLAN routing controlled by firewall ACLs with logged denials</li> <li>Rate-limiting prevents port scanning and brute-force attempts</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#high-availability-firewall-cluster","title":"High-Availability Firewall Cluster","text":"<p>Dual pfSense VMs operate in active/passive HA mode with CARP virtual IP failover and XMLRPC state synchronization. Firewall rules, NAT configurations, aliases, and connection state tables replicate in real-time between nodes.</p> <p>Security Impact: Zero downtime during maintenance; uninterrupted threat blocking during failover events.</p> <p>Technical Details:</p> <ul> <li>Sub-second failover with maintained TCP session state</li> <li>Configuration sync ensures policy consistency across nodes</li> <li>Health monitoring triggers automatic failover on node failure</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#inline-intrusion-prevention-system-ips","title":"Inline Intrusion Prevention System (IPS)","text":"<p>Suricata and Snort operate in IPS mode on firewall interfaces, actively blocking malicious traffic based on signature databases (Emerging Threats, Snort Community Rules) and behavioral anomaly detection.</p> <p>Security Impact: Known exploits, malware downloads, and C2 communication blocked in real-time before reaching endpoints.</p> <p>Technical Details:</p> <ul> <li>Daily signature updates via automated feed refresh</li> <li>Custom rules for lab-specific threat patterns</li> <li>Integration with CrowdSec for coordinated blocking decisions</li> <li>Alert forwarding to Wazuh SIEM for correlation with endpoint events</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#vulnerability-management-program","title":"Vulnerability Management Program","text":"<p>OpenVAS and Nessus perform authenticated and unauthenticated scans across all network segments on a weekly schedule. Scan results are categorized by severity (Critical/High/Medium/Low), mapped to CVE identifiers, and tracked in asset inventory.</p> <p>Security Impact: Proactive identification of exploitable weaknesses before attackers discover them; measurable reduction in attack surface over time.</p> <p>Technical Details:</p> <ul> <li>Containerized deployment with custom port mapping for scan network isolation</li> <li>Automated NVT feed synchronization ensures current vulnerability definitions</li> <li>Results exported to CSV/XML for trending analysis and integration with ticketing systems</li> <li>Metrics: Mean Time to Remediate (MTTR)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#22-identity-and-access-management","title":"2.2 Identity and Access Management","text":""},{"location":"projects/homelab/01-exec-summary/#centralized-identity-provider-idp","title":"Centralized Identity Provider (IdP)","text":"<p>Authentik serves as the unified SSO platform, supporting OAuth2, OpenID Connect (OIDC), and LDAP protocols. All web applications authenticate through Authentik, eliminating password sprawl and enabling centralized access control.</p> <p>Security Impact: Single point of authentication enforcement reduces credential theft risk; instant access revocation across all services.</p> <p>Technical Details:</p> <ul> <li>Integration with 30+ services including Proxmox, Traefik, and Portainer</li> <li>Proxy provider for applications without native SSO support</li> <li>Session management with configurable timeout and device tracking</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#multi-factor-authentication-mfa","title":"Multi-Factor Authentication (MFA)","text":"<p>TOTP-based MFA (RFC 6238) is enforced at login for all users via authenticator app (Authenticator).</p> <p>Security Impact: Credential stuffing and password spray attacks are mitigated; stolen passwords alone cannot grant access.</p> <p>Technical Details:</p> <ul> <li>Per-application MFA policies allow risk-based authentication</li> <li>Backup codes generated for account recovery scenarios</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#role-based-access-control-rbac","title":"Role-Based Access Control (RBAC)","text":"<p>Granular permissions are assigned via groups and roles rather than individual user accounts. Active Directory (Windows domain) and Authentik (web services) maintain synchronized role definitions.</p> <p>Security Impact: Consistent policy enforcement; simplified auditing of who-has-access-to-what.</p> <p>Technical Details:</p> <ul> <li>Roles mapped to job functions: Admin, SOC Analyst, Developer, Read-Only</li> <li>Least-privilege model: users granted minimum permissions required for tasks</li> <li>Periodic access reviews ensure role assignments remain current</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#enterprise-pki-infrastructure","title":"Enterprise PKI Infrastructure","text":"<p>Two-tier Certificate Authority: offline OpenSSL Root CA signs intermediate certificates; online StepCA Intermediate CA handles day-to-day certificate issuance via ACME protocol (automated Let's Encrypt-style workflow).</p> <p>Isolated Windows domain Active Directory Enterprise Certificate Authority also deployed for testing purposes. Supports only a small subset of certificates for internal service communication.</p> <p>Security Impact: Internal services communicate over mutually authenticated TLS; man-in-the-middle attacks are prevented.</p> <p>Technical Details:</p> <ul> <li>Root CA air-gapped on removable media, powered on only for intermediate signing</li> <li>Automated certificate lifecycle: issuance, renewal (30 days before expiry), revocation</li> <li>Fullchain delivery via API to Traefik, Docker containers, and Proxmox nodes</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#23-web-and-application-security","title":"2.3 Web and Application Security","text":""},{"location":"projects/homelab/01-exec-summary/#reverse-proxy-with-tls-termination","title":"Reverse Proxy with TLS Termination","text":"<p>Traefik ingress controller handles all external-facing traffic, terminating TLS at the edge and routing requests to backend services. Services without native HTTPS support are protected via encrypted proxy-to-client connections.</p> <p>Security Impact: Centralized certificate management; consistent TLS configuration eliminates weak cipher misconfigurations.</p> <p>Technical Details:</p> <ul> <li>Automatic certificate renewal via StepCA ACME endpoint</li> <li>HTTPS redirection for all web services</li> <li>Top-level domain routing enabled to eliminate URL port requirement</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#identity-aware-access-control-forwardauth","title":"Identity-Aware Access Control (ForwardAuth)","text":"<p>Traefik middleware integrates with Authentik via ForwardAuth protocol. Before proxying requests, Traefik queries Authentik to validate user identity and authorization. Headers inject user context into applications.</p> <p>Security Impact: Unauthorized users cannot reach protected services; applications receive verified identity claims.</p> <p>Technical Details:</p> <ul> <li>Single Sign-On at the edge: authenticate once, access multiple services</li> <li>Customizable authorization rules per service (e.g., \"only SOC Analyst role\")</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#security-headers-and-ip-allowlisting","title":"Security Headers and IP Allowlisting","text":"<p>Middleware enforces HTTP Strict Transport Security (HSTS), X-Frame-Options, Content-Security-Policy, and X-Content-Type-Options headers. Source IP filtering restricts access to trusted subnets (RFC 1918 ranges).</p> <p>Security Impact: Protection against clickjacking, MIME-sniffing, and protocol downgrade attacks; reduced exposure to internet-sourced attacks.</p> <p>Technical Details:</p> <ul> <li>CSP policies tailored per application to allow only trusted resource origins</li> <li>IP allowlists defined in Traefik dynamic configuration files</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#web-application-firewall-safeline-waf","title":"Web Application Firewall (SafeLine WAF)","text":"<p>SafeLine inspects HTTP/HTTPS traffic for OWASP Top 10 vulnerabilities including SQL injection, XSS, command injection, and path traversal. Rules updated weekly from threat intelligence feeds.</p> <p>Security Impact: Application vulnerabilities exploited via malicious input are blocked before reaching code.</p> <p>Technical Details:</p> <ul> <li>Deployed inline behind Traefik in Docker Compose stack</li> <li>Custom rule tuning reduces false positives for lab applications</li> <li>Request logging feeds into SIEM for attack pattern analysis</li> <li>Dashboard provides real-time attack visualization and blocked request statistics</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#24-dns-and-name-resolution","title":"2.4 DNS and Name Resolution","text":""},{"location":"projects/homelab/01-exec-summary/#network-wide-ad-blocking-and-threat-intelligence","title":"Network-Wide Ad Blocking and Threat Intelligence","text":"<p>Pi-hole filters DNS queries against blocklists containing advertising, tracking, and known-malicious domains. Conditional forwarding routes internal queries to Bind9 authoritative DNS server.</p> <p>Security Impact: Malware C2 communication blocked at DNS level; phishing domains prevented from resolving.</p> <p>Technical Details:</p> <ul> <li>1M+ blocked domains from curated threat feeds (StevenBlack)</li> <li>Query logging retained for threat hunting and anomaly detection</li> <li>ELK integration for event logging and correlation</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#privacy-preserving-recursive-dns","title":"Privacy-Preserving Recursive DNS","text":"<p>Unbound queries root DNS servers directly rather than forwarding to public resolvers (Google/Cloudflare), eliminating third-party visibility into DNS queries.</p> <p>Security Impact: Enhanced privacy; reduced metadata exposure to external parties.</p> <p>Technical Details:</p> <ul> <li>DNSSEC validation ensures response authenticity and integrity</li> <li>Response caching reduces query latency and upstream load</li> <li>Prefetching popular domains improves resolution speed</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#high-availability-dns-architecture","title":"High-Availability DNS Architecture","text":"<p>Dual Pi-hole instances deployed across separate Docker hosts with external Sync mechanism for configuration replication. Clients configured with both DNS servers for automatic failover.</p> <p>Security Impact: DNS filtering remains operational during maintenance or host failures.</p> <p>Technical Details:</p> <ul> <li>Automated sync of blocklists, local DNS records, and DHCP leases</li> <li>Health monitoring via Uptime Kuma; alerts on service degradation</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#25-remote-access-privacy-and-endpoint-security","title":"2.5 Remote Access, Privacy and Endpoint Security","text":""},{"location":"projects/homelab/01-exec-summary/#hardened-ssh-configuration","title":"Hardened SSH Configuration","text":"<p>SSH access restricted to public-key authentication only; password authentication globally disabled. Root login prohibited across all Linux systems. Fail2ban monitors authentication logs for brute-force patterns.</p> <p>SSH event logging in Wazuh with active response rules to block access when multiple failed logins are detected.</p> <p>Security Impact: Eliminates password-based attacks; enforces accountability via key-based identity.</p> <p>Technical Details:</p> <ul> <li>ED25519 keys with 4096-bit RSA fallback for legacy systems</li> <li>Connection rate limiting (MaxStartups) prevents automated scanning</li> <li>SSH keys rotated annually; compromised keys revoked via authorized_keys updates</li> <li>Automated blocking via active response rules in Wazuh</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#endpoint-detection-and-response-edr","title":"Endpoint Detection and Response (EDR)","text":"<p>Wazuh agents collect security telemetry from Windows, Linux, FreeBSD, and macOS endpoints. Central manager correlates events using MITRE ATTandCK-aligned rules, generating alerts for suspicious activities.</p> <p>Security Impact: Real-time visibility into endpoint behavior; detection of Living-off-the-Land (LOTL) techniques and anomalous processes.</p> <p>Technical Details:</p> <ul> <li>File Integrity Monitoring (FIM) alerts on unauthorized file modifications (e.g., /etc/passwd, Windows registry keys)</li> <li>Rootkit detection scans running processes and kernel modules</li> <li>Vulnerability detection cross-references installed software with NVD database</li> <li>Active Response triggers automated remediation (e.g., block IP, kill process, create alert/ticket)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#zero-trust-mesh-vpn","title":"Zero Trust Mesh VPN","text":"<p>Tailscale establishes WireGuard-encrypted peer-to-peer tunnels between devices, eliminating reliance on traditional VPN gateways. Access control lists (ACLs) define which devices can communicate.</p> <p>Security Impact: Reduced attack surface; devices authenticate via identity provider (SSO) rather than shared secrets.</p> <p>Technical Details:</p> <ul> <li>MagicDNS provides human-readable hostnames (e.g., server.lab.ts.net)</li> <li>Exit nodes route traffic through trusted locations for geo-restricted access</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#cloudflare-tunnels-for-zero-trust-inbound-access","title":"Cloudflare Tunnels for Zero-Trust Inbound Access","text":"<p>Services exposed via Cloudflare Tunnels require no inbound firewall rules or public IP exposure. Outbound-only connections authenticate via service tokens and proxy requests through Cloudflare's edge.</p> <p>Security Impact: Port scanning and direct IP attacks impossible; DDoS protection included.</p> <p>Technical Details:</p> <ul> <li>Tunnels authenticated with short-lived JWT tokens</li> <li>Per-service access policies enforce identity verification via Cloudflare Access</li> <li>Audit logs track access attempts and policy violations</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#policy-based-routing-for-privacy-zones","title":"Policy-Based Routing for Privacy Zones","text":"<p>Select subnets and containers route outbound traffic through VPN gateways (PIA, Tailscale exit nodes) using pfSense policy routing rules. Traffic never exits cleartext to ISP.</p> <p>Security Impact: ISP cannot monitor browsing activity; external observers see VPN endpoint IP only.</p> <p>Technical Details:</p> <ul> <li>Custom routing tables per privacy zone</li> <li>Killswitch rules drop traffic if VPN tunnel fails</li> <li>Split tunneling for services requiring local LAN access</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#26-observability-and-monitoring","title":"2.6 Observability and Monitoring","text":""},{"location":"projects/homelab/01-exec-summary/#unified-metrics-platform","title":"Unified Metrics Platform","text":"<p>Prometheus scrapes metrics from exporters (node_exporter, pfSense/OPNsense, traefik, pihole_exporter, proxmox_exporter). Grafana visualizes metrics in role-specific dashboards (Network, Security, Infrastructure).</p> <p>Security Impact: Anomaly detection via threshold alerts; visibility into resource exhaustion attacks.</p> <p>Technical Details:</p> <ul> <li>15-second scrape intervals for real-time alerting</li> <li>90-day metric retention for trend analysis</li> <li>AlertManager routes firing alerts to Discord channels based on severity</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#service-availability-monitoring","title":"Service Availability Monitoring","text":"<p>Uptime Kuma performs health checks every 60 seconds via HTTP/HTTPS probes, TCP connections, ping tests, and DNS resolution checks. Status page provides public-facing uptime reporting.</p> <p>Security Impact: Immediate detection of service outages caused by attacks or misconfigurations.</p> <p>Technical Details:</p> <ul> <li>TLS certificate expiration alerts (30/7/1-day warnings)</li> <li>Response time SLA tracking with historical percentile graphs</li> <li>SMTP relay and webhook integrations for automated incident response workflows</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#virtualization-platform-monitoring","title":"Virtualization Platform Monitoring","text":"<p>Pulse dashboard provides real-time visibility into Proxmox cluster health, VM/container resource utilization, backup job status, and storage performance metrics.</p> <p>Security Impact: Early detection of resource exhaustion attacks (e.g., fork bombs, disk fill).</p> <p>Technical Details:</p> <ul> <li>API polling of Proxmox REST endpoints</li> <li>Backup failure alerts trigger immediate notification</li> <li>Storage threshold warnings prevent service disruption</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#comprehensive-it-infrastructure-monitoring","title":"Comprehensive IT Infrastructure Monitoring","text":"<p>Checkmk deploys agents to monitor OS-level metrics, application services, and network devices via SNMP. Service discovery automates addition of new monitoring targets.</p> <p>Security Impact: Baseline behavior profiling enables anomaly detection; unauthorized services detected automatically.</p> <p>Technical Details:</p> <ul> <li>Agentless monitoring for network appliances via SNMP v3 (encrypted)</li> <li>Custom check plugins for proprietary applications</li> <li>Distributed monitoring with remote sites polling local agents</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#27-alerting-and-notification-infrastructure","title":"2.7 Alerting and Notification Infrastructure","text":""},{"location":"projects/homelab/01-exec-summary/#centralized-alert-hub-discord","title":"Centralized Alert Hub (Discord)","text":"<p>Private Discord server aggregates alerts from all monitoring platforms into dedicated channels (#grafana, #wazuh, #suricata, #crowdsec, #openvas). Persistent message history enables incident timeline reconstruction.</p> <p>Security Impact: No alerts lost due to email filtering; searchable archive for post-incident analysis.</p> <p>Technical Details:</p> <ul> <li>Webhook URLs per alert source enable channel-specific routing</li> <li>@mention tags for high-severity alerts ensure visibility</li> <li>Channel muting during maintenance windows reduces alert fatigue</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#multi-device-push-notifications","title":"Multi-Device Push Notifications","text":"<p>Discord clients on Windows 11, macOS, iOS, and Android ensure alerts reach administrators regardless of location. Push notifications deliver alerts to lock screens within seconds.</p> <p>Security Impact: Critical alerts (e.g., firewall failure, intrusion detected) reach responders immediately.</p> <p>Technical Details:</p> <ul> <li>Notification priority levels (silent, default, urgent)</li> <li>Do Not Disturb schedules for off-hours informational alerts</li> <li>Desktop client persistence ensures no message loss during network interruptions</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#authenticated-email-relay","title":"Authenticated Email Relay","text":"<p>Gmail SMTP relay with app-specific password and TLS encryption enables email notifications for services requiring traditional delivery (TheHive case updates, MISP threat intelligence reports).</p> <p>Security Impact: Formal documentation trail for compliance; integration with external ticketing systems.</p> <p>Technical Details:</p> <ul> <li>SPF/DKIM records prevent email spoofing</li> <li>Rate limiting prevents abuse as spam relay</li> <li>Encrypted transport (STARTTLS mandatory)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#28-automation-and-orchestration","title":"2.8 Automation and Orchestration","text":""},{"location":"projects/homelab/01-exec-summary/#infrastructure-as-code-iac","title":"Infrastructure as Code (IaC)","text":"<p>Terraform provisions VM infrastructure, networks, and cloud resources via declarative configuration files. Ansible playbooks enforce configuration state, deploy applications, and manage secrets across heterogeneous environments (Linux, Windows, network appliances).</p> <p>Security Impact: Infrastructure rebuilt from code after ransomware; configuration drift eliminated; repeatable deployments ensure consistent security baselines.</p> <p>Technical Details:</p> <ul> <li>GitHub repository with branch protection, required reviews, and signed commits</li> <li>Terraform state stored in encrypted backend with versioning for rollback capability</li> <li>Ansible Vault encrypts sensitive variables (passwords, API keys, certificates)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#low-code-workflow-automation-n8n","title":"Low-Code Workflow Automation (n8n)","text":"<p>n8n orchestrates complex, multi-step workflows across services via visual workflow builder with 400+ pre-built integrations. Workflows automate data enrichment, notification routing, backup verification, and operational tasks without custom code.</p> <p>Security Impact: Reduced human error in repetitive tasks; faster incident response through automated enrichment and notification workflows; audit trail of all workflow executions.</p> <p>Technical Details:</p> <ul> <li>Self-hosted deployment ensures sensitive data never leaves lab environment</li> <li>Credential management with AES-256 encryption at rest</li> <li>Execution history retained for troubleshooting and compliance auditing</li> <li>Version control via JSON workflow exports to Git repository</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#scheduled-task-automation","title":"Scheduled Task Automation","text":"<p>Cron jobs execute recurring security and operational tasks: certificate expiration checks, backup verification, log rotation, vulnerability scan initiation, and CIS benchmark compliance validation.</p> <p>Security Impact: Manual oversight eliminated; critical tasks execute reliably during off-hours; failures detected immediately via alerting.</p> <p>Technical Details:</p> <ul> <li>Success/failure notifications via Discord webhooks and email relay</li> <li>Centralized cron job inventory documented in Git repository with owner attribution</li> <li>Execution logs retained for 90 days with syslog forwarding to SIEM</li> <li>Flock file locking prevents overlapping execution of long-running jobs</li> <li>Non-privileged service accounts execute jobs following least-privilege principle</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#custom-automation-scripts","title":"Custom Automation Scripts","text":"<p>Python, Bash, and PowerShell scripts handle platform-specific tasks and complex data processing. Python scripts parse vulnerability scan results, correlate SIEM alerts, generate compliance reports, and interact with REST APIs. Bash scripts manage Linux system configuration and log processing. PowerShell scripts automate Windows domain operations and Active Directory management.</p> <p>Security Impact: Automated compliance reporting; reduced mean time to respond via API-driven enrichment; consistent enforcement of security configurations across platforms.</p> <p>Technical Details:</p> <ul> <li>Python virtual environments (venv) isolate dependencies per script; requirements.txt versioned in Git</li> <li>Error handling and exponential backoff retry logic for API reliability</li> <li>Logging to centralized syslog with structured JSON format for SIEM ingestion</li> <li>Cross-platform compatibility tested via CI/CD pipeline (Linux, Windows, macOS)</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#software-patch-management","title":"Software Patch Management","text":"<p>Multi-platform patch management ensures timely deployment of security updates across Linux hosts, Docker containers, and Windows systems. Automated monitoring detects outdated software and triggers update workflows.</p> <p>Security Impact: Reduced attack surface through rapid deployment of security patches; centralized visibility into patch status prevents vulnerable systems from going unnoticed; SHA-256 integrity verification prevents supply chain attacks.</p> <p>Technical Details:</p> <ul> <li>PatchMon: Monitors Linux hosts for outdated packages via apt/yum/dnf; alerts on available security updates with CVE mapping</li> <li>Watchtower and WUD (What's Up Docker): Monitors Docker container images for new releases; WUD sends Discord alerts when updates available; Watchtower automates container updates on approved images</li> <li>Windows Server Update Services (WSUS): Centralized management of Microsoft product updates; approval workflows ensure controlled deployment; clients pull updates from internal WSUS server reducing internet bandwidth consumption</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#29-security-orchestration-automation-and-response-soar","title":"2.9 Security Orchestration, Automation and Response (SOAR)","text":""},{"location":"projects/homelab/01-exec-summary/#incident-case-management-thehive","title":"Incident Case Management (TheHive)","text":"<p>Security incidents tracked from detection through remediation in structured cases. Tasks assigned to analysts, evidence tagged with IOCs, and investigation notes timestamped. MISP integration enables automatic IOC sharing with threat intelligence community.</p> <p>Security Impact: Consistent response procedures; measurable MTTR and MTTD metrics.</p> <p>Technical Details:</p> <ul> <li>Case templates standardize response workflows (phishing, malware, unauthorized access)</li> <li>Cortex integration enriches observables via VirusTotal, Shodan, and custom analyzers</li> <li>Metrics dashboard tracks case volume, severity distribution, and analyst performance</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#automated-response-workflows-shuffle","title":"Automated Response Workflows (Shuffle)","text":"<p>Shuffle SOAR orchestrates multi-step response actions across tools via visual workflow builder. Workflows trigger on events from Wazuh, CrowdSec, or Suricata alerts.</p> <p>Security Impact: Sub-minute response times; reduced analyst workload for repetitive tasks.</p> <p>Technical Details:</p> <ul> <li>Example workflow: Wazuh alert \u2192 enrich IP via VirusTotal \u2192 create TheHive case \u2192 block IP via pfSense API \u2192 notify Discord/SMTP relay</li> <li>Execution logs enable workflow optimization and troubleshooting</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#210-behavioral-threat-intelligence-crowdsec","title":"2.10 Behavioral Threat Intelligence (CrowdSec)","text":""},{"location":"projects/homelab/01-exec-summary/#community-driven-threat-detection","title":"Community-Driven Threat Detection","text":"<p>CrowdSec engine analyzes firewall logs, SSH authentication attempts, and web server access logs using community-curated behavioral scenarios. Detections are shared with global threat intelligence network (consensual, anonymized).</p> <p>Security Impact: Protection from attacks targeting other users; zero-day threat patterns detected via behavioral analysis.</p> <p>Technical Details:</p> <ul> <li>200+ scenarios from CrowdSec Hub (brute force, port scans, CVE exploitation)</li> <li>Custom scenarios developed for lab-specific applications</li> <li>Blocklist aggregation from community signals and threat feeds</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#automated-enforcement-via-bouncers","title":"Automated Enforcement via Bouncers","text":"<p>pfSense firewall bouncer receives blocking decisions from CrowdSec Local API and translates them into firewall rules. Malicious IPs blocked automatically across all firewall interfaces.</p> <p>Security Impact: Real-time threat blocking without manual firewall rule updates.</p> <p>Technical Details:</p> <ul> <li>Authenticated API communication (JWT tokens)</li> <li>Decision duration configurable (e.g., 4-hour bans, permanent blocks for severe threats)</li> <li>Remediation actions: ban (drop all packets), captcha challenge, rate limiting</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#211-security-tooling-and-digital-forensics","title":"2.11 Security Tooling and Digital Forensics","text":""},{"location":"projects/homelab/01-exec-summary/#offensive-security-validation-kali-parrotos-linux","title":"Offensive Security Validation (Kali ParrotOS Linux)","text":"<p>Dedicated attack platform validates security controls via authorized penetration testing. Tools include Nmap (service discovery), Metasploit (exploitation), Burp Suite (web app testing), and Hydra (credential testing).</p> <p>Security Impact: Proactive identification of exploitable vulnerabilities before attackers find them.</p> <p>Technical Details:</p> <ul> <li>Attack logs correlated with defensive tool alerts to validate detection coverage</li> <li>Post-test reports document findings and remediation recommendations</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#network-forensics-and-packet-analysis","title":"Network Forensics and Packet Analysis","text":"<p>Wireshark, Brim, and tcpdump capture and analyze network traffic for incident investigation, protocol troubleshooting, and malware C2 detection.</p> <p>Security Impact: Deep visibility into encrypted handshakes, anomalous protocols, and data exfiltration attempts.</p> <p>Technical Details:</p> <ul> <li>PCAPs stored on NAS for long-term retention and retrospective analysis</li> <li>Zeek logs parsed for connection metadata, file extraction, and protocol anomalies</li> <li>NetworkMiner extracts credentials, files, and OS fingerprints from captures</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#digital-forensics-and-incident-response-dfir","title":"Digital Forensics and Incident Response (DFIR)","text":"<p>Comprehensive DFIR toolkit including Volatility (memory forensics), KAPE (rapid triage), Autopsy (disk analysis), Eric Zimmerman Tools (Windows artifact parsing), and Velociraptor (scalable endpoint queries).</p> <p>Security Impact: Post-compromise analysis determines attack scope, identifies persistence mechanisms, and supports threat attribution.</p> <p>Technical Details:</p> <ul> <li>Memory dumps captured from VMs via Proxmox snapshot + vmss2core conversion</li> <li>Velociraptor agents enable live forensic collection across endpoints</li> <li>Timeline analysis correlates events across systems for attack chain reconstruction</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#212-backup-and-business-continuity","title":"2.12 Backup and Business Continuity","text":""},{"location":"projects/homelab/01-exec-summary/#multi-tier-backup-strategy","title":"Multi-Tier Backup Strategy","text":"<p>Automated backups run nightly to Synology NAS and Proxmox Backup Server in VMware Workstation. Retention policy: 0 daily, 3 weekly, 1 monthly snapshots.</p> <p>Security Impact: Recovery from ransomware, hardware failure, or accidental deletion within RTO/RPO targets.</p> <p>Technical Details:</p> <ul> <li>Incremental backups via Proxmox Backup Server (deduplication and compression)</li> <li>Immutable snapshots prevent ransomware tampering</li> </ul>"},{"location":"projects/homelab/01-exec-summary/#snapshot-before-change-policy","title":"Snapshot-Before-Change Policy","text":"<p>Proxmox snapshots captured before configuration changes, system updates, or experimental modifications. Snapshots enable instant rollback with zero data loss.</p> <p>Security Impact: Change assurance; failed updates do not result in prolonged outages.</p> <p>Technical Details:</p> <ul> <li>Snapshot naming convention: YYYY-MM-DD_ (e.g., 2025-01-08_kernel-update) <li>Pre-update checklist enforces snapshot creation</li> <li>Snapshot storage monitoring prevents disk exhaustion</li>"},{"location":"projects/homelab/01-exec-summary/#3-security-homelab-section-links","title":"3 Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualzation Stack and Hardware </li> <li>Network Security, Pirvacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/02-platform/","title":"Infrastructure, Platform and Hardware Summary","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/02-platform/#1-core-virtualization-stack","title":"1. Core Virtualization Stack","text":""},{"location":"projects/homelab/02-platform/#11-proxmox-virtual-environment-ve","title":"1.1 Proxmox Virtual Environment (VE)","text":""},{"location":"projects/homelab/02-platform/#deployment-overview","title":"Deployment Overview","text":"<p>       The lab's foundation is a single-node Proxmox Virtual Environment (VE) cluster running on enterprise-class bare-metal hardware, serving as the Type-1 hypervisor for the entire security operations platform. Proxmox provides KVM-based full virtualization for operating systems (Windows, BSD, Linux, MacOS) and LXC containerization for lightweight Linux workloads. The platform hosts approximately 30+ concurrent virtual machines and containers, supporting everything from high-availability pfSense firewalls to Kubernetes clusters, SIEM platforms, and malware analysis environments. Automated backup infrastructure via Proxmox Backup Server ensures rapid disaster recovery, while Proxmox Datacenter Manager provides centralized orchestration and monitoring.     </p>          Proxmox VE single-node cluster and hosted services."},{"location":"projects/homelab/02-platform/#security-impact","title":"Security Impact","text":"<ul> <li>Bare-metal Type-1 hypervisor minimizes attack surface compared to Type-2 hosted solutions</li> <li>KVM hardware-assisted virtualization provides strong isolation between tenant workloads</li> <li>LXC containerization delivers near-native performance for network services with reduced overhead</li> <li>Snapshot and backup capabilities enable rapid rollback after security testing or compromise</li> <li>Centralized management reduces configuration drift and unauthorized system modifications</li> <li>ZFS storage backend provides data integrity verification and encryption at rest</li> <li>Network segmentation via virtual bridges isolates security zones (management, production, DMZ)</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale","title":"Deployment Rationale","text":"<p>Proxmox VE mirrors enterprise virtualization platforms (VMware vSphere, Microsoft Hyper-V, Red Hat Virtualization) while providing open-source flexibility and zero licensing costs. This enables building an enterprise-scale lab environment demonstrating production-grade infrastructure without commercial hypervisor expenses. Proxmox's integrated backup solution, clustering capabilities, and API-driven automation align with modern Infrastructure as Code (IaC) practices used in DevSecOps environments. The platform supports Docker and Kubernetes workloads alongside traditional VMs, demonstrating hybrid cloud architecture patterns increasingly common in enterprise security operations.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Hypervisor layer enforces hardware-based isolation between security zones</li> <li>Virtual network bridges segment traffic flows with firewall enforcement at each boundary</li> <li>Backup infrastructure resides on separate physical hosts (VMware Workstation, Synology NAS)</li> <li>Multiple authentication layers (Proxmox RBAC, Authentik SSO/OAuth2, VM-level access controls, application SSO)</li> </ul> <p>Secure by Design:</p> <ul> <li>Default-deny network policies on all virtual bridges</li> <li>Mandatory TLS encryption for Proxmox web UI and API access</li> <li>Automated security updates via unattended-upgrades on Debian base OS</li> <li>PKI integration for certificate-based authentication across all services</li> <li>Immutable infrastructure through snapshot-based deployments</li> </ul> <p>Zero Trust:</p> <ul> <li>No implicit trust between VMs or containers; all inter-service communication authenticated</li> <li>API access requires token-based authentication with scoped permissions</li> <li>Network policies enforce explicit allow rules; no \"trusted\" VLANs</li> <li>User access governed by role-based permissions (PVEAdmin, PVEAuditor, etc.)</li> </ul>"},{"location":"projects/homelab/02-platform/#key-capabilities-demonstrated","title":"Key Capabilities Demonstrated","text":"<p>Enterprise Infrastructure Operations:</p> <ul> <li>High-density virtualization supporting 30+ concurrent workloads on single node</li> <li>Mixed workload management (full VMs, containers, nested hypervisors and containers)</li> <li>Automated provisioning via Terraform and Ansible integration</li> </ul> <p>Security Operations Platform:</p> <ul> <li>Isolated security tool deployment (SIEM, SOAR, threat intelligence, vulnerability scanners)</li> <li>Forensic analysis environments with snapshot-based evidence preservation</li> <li>Purple team infrastructure supporting both red and blue team operations</li> </ul> <p>Disaster Recovery &amp; Business Continuity:</p> <ul> <li>Automated weekly backups to Proxmox Backup Server with deduplication</li> <li>Off-host backup replication to Synology NAS for redundancy</li> <li>Rapid VM restoration (sub-15-minute RTO for critical services)</li> <li>Configuration-as-code enables full infrastructure rebuild from Git repository</li> </ul> <p>Advanced Storage &amp; Networking:</p> <ul> <li>ZFS mirrored storage pools providing data integrity and high IOPS</li> <li>NVMe-based VM storage for database and container workloads</li> <li>Link Aggregation (LAG) with 802.3ad for high-throughput data transfers</li> <li>VLAN segmentation supporting isolated testing environments</li> </ul>"},{"location":"projects/homelab/02-platform/#12-proxmox-backup-server","title":"1.2 Proxmox Backup Server","text":"<p>Integrated for automated, deduplicated backups of all virtual machines and containers. Backup jobs are scheduled to run weekly, with retention policies aligned to provide redundancies without taking up a lot of space since the server has been deployed within VMware Workstation running on my main production PC.</p> <ul> <li>Proxmox Backup Server deployed as nested VM within VMware Workstation</li> <li>Host: Production workstation (separate from lab infrastructure)</li> <li>Purpose: Off-host backup target with deduplication and compression</li> <li>Rationale: Leverages existing production hardware for cost-effective DR solution</li> </ul>          Proxmox Backup Server Dashboard."},{"location":"projects/homelab/02-platform/#13-proxmox-datacenter-manager","title":"1.3 Proxmox Datacenter Manager","text":"<p>Centralized management solution to oversee and manage multiple nodes and clusters of Proxmox-based virtual environments.</p>          Proxmox Datacenter Manager Screenshot."},{"location":"projects/homelab/02-platform/#14-physical-network-attached-storage-nas-integration","title":"1.4 Physical Network Attached Storage (NAS) Integration","text":"<p>A shared Synology NAS is configured to receive automated backups from the Proxmox Backup Server. This ensures off-host redundancy and supports rapid restoration in case of lab-wide failure or rollback testing.</p> <ul> <li>Target: Synology NAS (DSM 6.x) via SMB/NFS mount</li> <li>Encryption: AES-256 at rest, TLS in transit</li> <li>Purpose: rapid VM restoration, long-term archival, K3s off-host PVCs</li> </ul>          Synology NAS Backups Screenshot."},{"location":"projects/homelab/02-platform/#15-virtual-network-attached-storage-nas-integration","title":"1.5 Virtual Network Attached Storage (NAS) Integration","text":"<p>Proxmox virtual machine running TrueNAS to support Windows (SMB) and Linux (NFS) mounts for data sharing and redundancy. The single storage pool is configured for mirroring across the two NVMe drives.</p>          TrueNAS Screenshots."},{"location":"projects/homelab/02-platform/#16-proxmox-host-hardware","title":"1.6 Proxmox Host Hardware","text":"Component Specification Justification CPU Intel Core Ultra 9 285K (24c) Performance/efficiency cores for mixed workloads Cooling AIO liquid cooling Sustained thermal management under load Memory G.Skill 96 GB DDR5-6400 CL32 High-density RAM for ~50 concurrent VMs/containers OS Storage Samsung 990 PRO 2TB (PCIe 4.0) Low-latency boot and snapshot operations VM Storage Samsung 9100 PRO 4TB (PCIe 5.0) High IOPS for database and container workloads Network Interfaces 3\u00d7 2.5GbE + WiFi 7 Redundant connectivity and traffic segregation GPU Intel Arc A770 (16GB) PCIe passthrough for transcoding Motherboard ASUS ROG Strix Z890-I (mITX) Compact form factor with enterprise features"},{"location":"projects/homelab/02-platform/#network-interface-design","title":"Network Interface Design","text":"<p>Physical Interfaces:</p> <ul> <li>eth0 (2.5GbE): Proxmox management network (192.168.1.x)</li> <li>eth1 (2.5GbE): LAG member - VLAN3 trunk (192.168.3.x)</li> <li>eth2 (2.5GbE): LAG member - VLAN3 trunk (192.168.3.x)</li> <li>wlan0 (WiFi 7): Bridged to Lab_LAN1 virtual network</li> </ul> <p>Virtual Bridges:</p> <ul> <li>vmbr0: Management and Prod_LAN workloads (192.168.1.x) (default gateway)</li> <li>vmbr1: Lab_LAN1 network workloads (192.168.100.x)</li> <li>vmbr2: LAG bond0 ISO_LAN2 network workloads (192.168.3.x)</li> <li>vmbr3: Lab_LAN2 network workloads (192.168.200.x)</li> <li>vmbr4: Ext_LAN2 network workloads (192.168.2.x)</li> <li>vmbr5: Ext_LAN network workloads (10.20.0.x)</li> <li>vmbr7: pfSense HA Sync (10.10.0.x)</li> <li>vmbr8: Cisco Point-to-Point Network (10.30.0.x)</li> </ul> <p>Diagram Placeholder: Network Interface Configuration Screenshot</p>"},{"location":"projects/homelab/02-platform/#17-lab-switch","title":"1.7 Lab Switch","text":"<p>TP-Link TL-SG108E Smart Switch</p> <p>Used for VLAN and Link Aggregation (LAG) testing between The Proxmox host server and a Windows 11 Pro workstation.</p> Configuration: <ul> <li>Link Aggregation: Static LAG (802.3ad equivalent) on ports 2-3</li> <li>Lab server NICs 1-2 bonded (LACP mode balance-rr)</li> <li>Aggregate bandwidth: 2 Gbps</li> </ul> VLAN Segmentation: <ul> <li>VLAN 3 (192.168.3.0/24): Isolated testing subnet</li> <li>Ports 2, 3, 7: Tagged VLAN3 members</li> <li>Purpose: Dedicated high-speed link between office PC and lab server</li> <li>Use case: Large file transfers, iSCSI testing, backup replication</li> </ul>          tp-link VLAN and LAG Settings."},{"location":"projects/homelab/02-platform/#18-proxmox-workload-overview","title":"1.8 Proxmox Workload Overview","text":"<p>The majority of hosts and services run within the Proxmox environment and run within one of the two integrated technologies supported:</p>"},{"location":"projects/homelab/02-platform/#virtual-machines-vms","title":"\ud83d\udda5\ufe0f Virtual Machines (VMs)","text":"<ul> <li>Tech Stack: KVM (Kernel-based Virtual Machine) + QEMU</li> <li>Use Case: Full OS virtualization\u2014ideal for Windows, BSD, or isolated Linux environments</li> </ul>"},{"location":"projects/homelab/02-platform/#linux-containers-lxc","title":"\ud83d\udce6 Linux Containers (LXC)","text":"<ul> <li>Tech Stack: LXC (Linux Containers)</li> <li>Use Case: Lightweight virtualization for Linux apps with near-native performance</li> </ul>"},{"location":"projects/homelab/02-platform/#19-infrastructure-visualization","title":"1.9 Infrastructure Visualization","text":""},{"location":"projects/homelab/02-platform/#powerbi-dashboards","title":"PowerBI Dashboards","text":"<p>Custom-built Power BI reports provide real-time visibility into lab operations</p> <p>Application Inventory: Per-host service mapping with version tracking</p> <ul> <li>Resource Utilization: CPU/memory/storage trends across Proxmox</li> <li>IP Address Management: Assigned IP addresses by subnet and assignment type</li> <li>OS Distribution Analysis: Platform breakdown (RHEL, Ubuntu, Debian, Windows)</li> </ul>          Platform Overview.                 Host/Asset Summary.                 Application Overview.                 IP Address Overview.                 Firewall Rules Overview."},{"location":"projects/homelab/02-platform/#110-os-platform-and-distributionedition-summary","title":"1.10 OS Platform and Distribution/Edition Summary","text":"Host OS Overview."},{"location":"projects/homelab/02-platform/#2-vmware-vsphere-r8-environment","title":"2. VMware vSphere r8 Environment","text":""},{"location":"projects/homelab/02-platform/#deployment-overview_1","title":"Deployment Overview","text":"<p>The lab operates a hybrid virtualization architecture combining Proxmox as the primary Type-1 hypervisor with VMware vSphere r8 for specialized workloads. VMware Workstation Pro 25H2 runs on the production workstation, hosting critical backup infrastructure (Proxmox Backup Server, Datacenter Manager, Mail Gateway) and malware analysis environments (REMnux). ESXi r8 hypervisor provides enterprise-grade virtualization for Windows Server 2019 Hyper-V nested environments and Debian Live systems.</p>"},{"location":"projects/homelab/02-platform/#security-impact_1","title":"Security Impact","text":"<ul> <li>Isolated backup infrastructure prevents contamination of production Proxmox environment</li> <li>REMnux sandbox provides safe malware analysis without risking lab infrastructure</li> <li>Hyper-V nested virtualization enables Windows-specific security testing (AD exploitation, PowerShell analysis)</li> <li>Multi-hypervisor architecture reduces vendor lock-in risk and single-point-of-failure scenarios</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale_1","title":"Deployment Rationale","text":"<p>Enterprise environments frequently operate multiple virtualization platforms where VMware handles legacy workloads, specific compliance requirements, or vendor-mandated infrastructure. This deployment demonstrates proficiency with multi-vendor hypervisor management, cross-platform migration strategies, and vendor-neutral infrastructure design. Running Proxmox Backup Server on VMware Workstation mirrors enterprise DR architectures where backup infrastructure resides on separate physical hosts or geographic locations.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment_1","title":"Architecture Principles Alignment","text":"<ul> <li>Defense in Depth: Backup infrastructure physically separated from production hypervisor; malware analysis isolated in disposable VMs</li> <li>Secure by Design: Nested virtualization enforces additional isolation layers; backup encryption at rest and in transit</li> <li>Zero Trust: No implicit trust between hypervisor platforms; each VM authenticated independently</li> </ul>"},{"location":"projects/homelab/02-platform/#configuration-details","title":"Configuration Details","text":"<p>VMware Workstation Pro 25H2 (Build 24995812):</p> <ul> <li>Proxmox Backup Server v4.1.0 - Deduplicated backup target with AES-256 encryption</li> <li>Proxmox Datacenter Manager v1.0.1 - Centralized multi-cluster orchestration</li> <li>Proxmox Mail Gateway - Email security gateway testing</li> <li>REMnux Linux - Malware analysis and reverse engineering toolkit</li> </ul> ESXi r8 (Build 24677879-standard): <ul> <li>Windows Server 2019 Hyper-V - Nested hypervisor for AD security research</li> <li>Debian Live r13 - Ephemeral forensics and incident response platform</li> </ul>          VMware ESXi and Workstation Pro Overview.                 VMware ESXi Screenshots."},{"location":"projects/homelab/02-platform/#3-cisco-virtual-infrastructure","title":"3. Cisco Virtual Infrastructure","text":""},{"location":"projects/homelab/02-platform/#deployment-overview_2","title":"Deployment Overview","text":"<p>The lab operates a three-node Cisco virtual network infrastructure providing enterprise-grade routing and switching simulation. Two vRouters (R1 and R2) running Cisco IOS Software Version 15.9(3)M6 (VIOS-ADVENTERPRISEK9-M) implement dynamic routing via OSPF, while a vSwitch operates experimental Version 15.2 (vios_l2-ADVENTERPRISEK9-M) for Layer 2 operations. All instances run as KVM virtual machines within the Proxmox environment, enabling full-featured network protocol testing, routing policy validation, and security hardening without physical hardware dependencies.</p> <p>The topology implements a hub-and-spoke design where R1 and R2 connect via a dedicated point-to-point link (10.30.0.0/30) and exchange routing information through OSPF Area 0. R1 serves as the primary gateway for production lab networks (192.168.1.0/24, 192.168.100.0/24, 192.168.200.0/24), while R2 handles isolated test networks (192.168.2.0/24, 192.168.3.0/24). Two Ubuntu 25.10 LXC containers (cisco-host1 and cisco-host2) validate routing functionality by using their respective local routers as default gateways.</p>          Cisco r1 and r2 Configuration."},{"location":"projects/homelab/02-platform/#security-impact_2","title":"Security Impact","text":"<ul> <li>Isolated Routing Domain: Virtual infrastructure creates air-gapped routing environment preventing production network disruption during protocol testing and failure scenario simulation</li> <li>Policy Validation Sandbox: Enables safe testing of ACLs, prefix lists, route maps, and firewall rules before pfSense/OPNsense deployment</li> <li>Attack Path Analysis: Simulates multi-hop routing scenarios for lateral movement detection and network segmentation validation</li> <li>Protocol Security Research: Provides hands-on environment for OSPF authentication, routing protocol poisoning prevention, and neighbor relationship hardening</li> <li>Network Forensics Training: Supports packet capture analysis, routing loop detection, and convergence behavior observation during security incidents</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale_2","title":"Deployment Rationale","text":"<p>Cisco IOS powers the majority of enterprise routers and Layer 3 switches globally. Virtual IOS infrastructure demonstrates production-ready proficiency with Cisco CLI, dynamic routing protocols, and network automation while avoiding physical hardware costs. This deployment mirrors enterprise network engineering labs where virtual routers support CI/CD pipelines for network configuration validation, automated testing workflows, and infrastructure-as-code development. Running vIOS in KVM enables integration with Ansible network modules, Terraform providers, and Python network automation libraries (Netmiko, NAPALM) used in DevOps-driven network operations.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment_2","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Virtual network infrastructure physically isolated from production routing</li> <li>OSPF authentication prevents route injection attacks (future enhancement)</li> <li>ACLs on router interfaces enforce inter-subnet access control</li> <li>Separate routing domain enables secure testing of dangerous configurations</li> </ul> <p>Secure by Design:</p> <ul> <li>SSH-only access enforced on all routers (Telnet disabled)</li> <li>Enable secret passwords hashed with SHA256 (Type 9)</li> <li>Console and VTY lines require authentication</li> <li>Logging enabled for all configuration changes and security events</li> </ul> <p>Zero Trust:</p> <ul> <li>No implicit routing trust between subnets; OSPF neighbors explicitly configured</li> <li>Inter-VLAN routing requires explicit permit statements</li> <li>Default-deny ACLs block unauthorized cross-subnet traffic</li> <li>Each router authenticates independently to management infrastructure</li> </ul>"},{"location":"projects/homelab/02-platform/#31-network-topology-and-configuration","title":"3.1 Network Topology and ConfigurationR1 (192.168.200.6) - Primary RouterR2 (192.168.3.9) - Secondary Router","text":"<ul> <li>G0/0: 192.168.1.6/24 \u2014 Production network uplink</li> <li>G0/1: 192.168.100.6/24 \u2014 Primary lab network (K3s cluster, Docker hosts)</li> <li>G0/2: 192.168.200.6/24 \u2014 Secondary lab network (SOC namespace, server-admin)</li> <li>G0/3: 10.30.0.1/30 \u2014 Point-to-point link to R2</li> </ul> <ul> <li>G0/0: 10.30.0.2/30 \u2014 Point-to-point link to R1</li> <li>G0/1: 192.168.3.9/24 \u2014 Management VLAN (FortiGate protected)</li> <li>G0/2: 192.168.2.9/24 \u2014 External lab network</li> </ul>"},{"location":"projects/homelab/02-platform/#router-r1-configuration","title":"Router R1 Configuration","text":"<pre><code>      R1#show ip int br\n      Interface                  IP-Address      OK? Method Status                Protocol\n      GigabitEthernet0/0         192.168.1.6     YES NVRAM  up                    up\n      GigabitEthernet0/1         192.168.100.6   YES NVRAM  up                    up\n      GigabitEthernet0/2         192.168.200.6   YES NVRAM  up                    up\n      GigabitEthernet0/3         10.30.0.1       YES manual up                    up\n      R1#show ip route\n      Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n            D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area\n            N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2\n            E1 - OSPF external type 1, E2 - OSPF external type 2\n            i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2\n            ia - IS-IS inter area, * - candidate default, U - per-user static route\n            o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP\n            a - application route\n            + - replicated route, % - next hop override, p - overrides from PfR\n\n      Gateway of last resort is not set\n\n            10.0.0.0/8 is variably subnetted, 3 subnets, 3 masks\n      S        10.20.0.0/24 [1/0] via 192.168.1.1\n      C        10.30.0.0/30 is directly connected, GigabitEthernet0/3\n      L        10.30.0.1/32 is directly connected, GigabitEthernet0/3\n            192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks\n      C        192.168.1.0/24 is directly connected, GigabitEthernet0/0\n      L        192.168.1.6/32 is directly connected, GigabitEthernet0/0\n      O     192.168.2.0/24 [110/2] via 10.30.0.2, 6d22h, GigabitEthernet0/3\n      O     192.168.3.0/24 [110/2] via 10.30.0.2, 6d22h, GigabitEthernet0/3\n            192.168.100.0/24 is variably subnetted, 2 subnets, 2 masks\n      C        192.168.100.0/24 is directly connected, GigabitEthernet0/1\n      L        192.168.100.6/32 is directly connected, GigabitEthernet0/1\n            192.168.200.0/24 is variably subnetted, 2 subnets, 2 masks\n      C        192.168.200.0/24 is directly connected, GigabitEthernet0/2\n      L        192.168.200.6/32 is directly connected, GigabitEthernet0/2\n      R1#show ip proto\n      *** IP Routing is NSF aware ***\n\n      Routing Protocol is \"application\"\n      Sending updates every 0 seconds\n      Invalid after 0 seconds, hold down 0, flushed after 0\n      Outgoing update filter list for all interfaces is not set\n      Incoming update filter list for all interfaces is not set\n      Maximum path: 32\n      Routing for Networks:\n      Routing Information Sources:\n         Gateway         Distance      Last Update\n      Distance: (default is 4)\n\n      Routing Protocol is \"ospf 1\"\n      Outgoing update filter list for all interfaces is not set\n      Incoming update filter list for all interfaces is not set\n      Router ID 192.168.200.6\n      It is an autonomous system boundary router\n      Redistributing External Routes from,\n      Number of areas in this router is 1. 1 normal 0 stub 0 nssa\n      Maximum path: 4\n      Routing for Networks:\n         192.168.1.0 0.0.0.255 area 0\n         192.168.100.0 0.0.0.255 area 0\n         192.168.200.0 0.0.0.255 area 0\n      Routing on Interfaces Configured Explicitly (Area 0):\n         GigabitEthernet0/3\n      Passive Interface(s):\n         GigabitEthernet0/0\n         GigabitEthernet0/1\n         GigabitEthernet0/2\n      Routing Information Sources:\n         Gateway         Distance      Last Update\n         192.168.3.9          110      6d22h\n      Distance: (default is 110)\n</code></pre>"},{"location":"projects/homelab/02-platform/#ospf-routing-configuration","title":"OSPF Routing Configuration","text":"<p>Protocol: OSPF Version 2 (OSPFv2 for IPv4) Process ID: 1 Area: 0 (Backbone area - single-area design) Network Type: Point-to-point (10.30.0.0/30 link)</p> <p>R1 OSPF Configuration: <pre><code>router ospf 1\nrouter-id 192.168.200.6\nnetwork 192.168.1.0 0.0.0.255 area 0\nnetwork 192.168.100.0 0.0.0.255 area 0\nnetwork 192.168.200.0 0.0.0.255 area 0\n</code></pre></p> <p>R2 OSPF Configuration: <pre><code>router ospf 1\nrouter-id 192.168.3.9\nnetwork 192.168.2.0 0.0.0.255 area 0\nnetwork 192.168.3.0 0.0.0.255 area 0\n</code></pre> Routing Table Verification:</p> <ul> <li>R1 learns routes to 192.168.2.0/24 and 192.168.3.0/24 via OSPF (Administrative Distance 110)</li> <li>R2 learns routes to 192.168.1.0/24, 192.168.100.0/24, 192.168.200.0/24 via OSPF</li> <li>OSPF neighbor adjacency established (Full state) on G0/3 (R1) and G0/0 (R2)</li> </ul> vSwitch (Layer 2): <ul> <li>Provides VLAN trunking and access port simulation</li> <li>Supports STP testing and loop prevention validation</li> <li>Enables port security and MAC address filtering research</li> </ul>          vSwitch VLAN and Interface Configuration."},{"location":"projects/homelab/02-platform/#test-host-configuration","title":"Test Host Configuration","text":"<p>cisco-host1 (192.168.100.4):</p> <ul> <li>Platform: Ubuntu 25.10 LXC container</li> <li>Default Gateway: 192.168.100.6 (R1 G0/1)</li> <li>Purpose: Validate R1 routing to R2-connected subnets</li> <li>Test: ping 192.168.3.5 should route via R1 \u2192 10.30.0.0/30 \u2192 R2</li> </ul> <p>cisco-host2 (192.168.3.5):</p> <ul> <li>Platform: Ubuntu 25.10 LXC container</li> <li>Default Gateway: 192.168.3.9 (R2 G0/1)</li> <li>Purpose: Validate R2 routing to R1-connected subnets</li> <li>Test: ping 192.168.100.4 should route via R2 \u2192 10.30.0.0/30 \u2192 R1</li> </ul>"},{"location":"projects/homelab/02-platform/#32-technical-capabilities-demonstrated","title":"3.2 Technical Capabilities Demonstrated","text":""},{"location":"projects/homelab/02-platform/#dynamic-routing-protocols","title":"Dynamic Routing Protocols","text":"<p>OSPF (Open Shortest Path First):</p> <ul> <li>Single-area design (Area 0 backbone)</li> <li>Point-to-point network type for optimal convergence</li> <li>Router ID assignment using loopback or highest IP</li> <li>LSA flooding and LSDB synchronization</li> <li>SPF algorithm execution and route calculation</li> <li>Neighbor adjacency management (Hello/Dead timers)</li> </ul>"},{"location":"projects/homelab/02-platform/#4-container-orchestration-architecture","title":"4. Container Orchestration Architecture","text":""},{"location":"projects/homelab/02-platform/#deployment-overview_3","title":"Deployment Overview","text":"<p>The container orchestration layer consists of two complementary platforms: a multi\u2011engine Docker deployment for lightweight, isolated workloads and a dual\u2011node K3s Kubernetes cluster for cloud\u2011native, scalable applications. Docker engines provide simple, isolated runtime environments ideal for single\u2011purpose services, while K3s delivers a fully compliant Kubernetes distribution optimized for low\u2011resource environments. Portainer provides centralized management across both platforms, enabling unified visibility, lifecycle control, and operational consistency. Together, these systems form a hybrid container ecosystem that mirrors modern enterprise architectures where Docker and Kubernetes coexist to support diverse workloads.</p>"},{"location":"projects/homelab/02-platform/#security-impact_3","title":"Security Impact","text":"<ul> <li>Workload isolation across six independent Docker engines reduces blast radius</li> <li>Kubernetes network policies and ingress controls enforce strict east\u2011west and north\u2011south traffic boundaries</li> <li>Portainer centralizes access control and auditability across all container platforms</li> <li>K3s certificate automation ensures secure service\u2011to\u2011service communication</li> <li>Segmented runtimes prevent cross\u2011container compromise</li> <li>MetalLB and NGINX Ingress enforce controlled exposure of internal services</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale_3","title":"Deployment Rationale","text":"<p>Enterprises frequently operate hybrid container environments where Docker supports lightweight services and Kubernetes orchestrates scalable, distributed applications. This architecture demonstrates proficiency with both paradigms\u2014multi\u2011engine Docker for simplicity and K3s for cloud\u2011native orchestration. The deployment mirrors real\u2011world operational patterns including ingress management, persistent storage provisioning, network policy enforcement, and centralized container lifecycle management.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment_3","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Multiple container runtimes, isolated engines, Kubernetes network policies, and ingress controls</p> <p>Secure by Design: TLS\u2011enabled Kubernetes control plane, Portainer RBAC, minimal host dependencies</p> <p>Zero Trust: No container or service implicitly trusted; identity, ingress, and network policies enforced continuously</p>"},{"location":"projects/homelab/02-platform/#41-multi-engine-docker-deployment","title":"4.1 Multi-Engine Docker Deployment","text":""},{"location":"projects/homelab/02-platform/#deployment-overview_4","title":"Deployment Overview","text":"<p>       The lab operates five independent Docker engines, each hosting isolated workloads to minimize cross\u2011service impact. Portainer Community Edition provides a centralized GUI for managing all engines, while Portainer Agents enable secure API communication with remote hosts.     </p>          Docker Deployment Overview."},{"location":"projects/homelab/02-platform/#security-impact_4","title":"Security Impact","text":"<ul> <li>Independent Docker engines prevent lateral movement between workloads</li> <li>Portainer RBAC restricts administrative access to container hosts</li> <li>Engine\u2011level isolation reduces the impact of misconfigurations or compromised containers</li> <li>Minimal shared dependencies reduce systemic risk</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale_4","title":"Deployment Rationale","text":"<p>Multi\u2011engine Docker deployments mirror enterprise environments where isolated runtimes support operational segmentation, compliance boundaries, or workload separation. This design demonstrates proficiency with distributed container management, remote engine control, and secure API\u2011driven orchestration.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment_4","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Multiple engines create natural segmentation boundaries</p> <p>Secure by Design: Portainer Agents use secure API channels; Home Assistant isolated for safety</p> <p>Zero Trust: No container shares trust with another engine; all access controlled centrally</p>"},{"location":"projects/homelab/02-platform/#configuration","title":"Configuration","text":"Engine Location Purpose Key Containers Ubuntu VM (DockerVM1) Central management &amp; monitoring Portainer; Prometheus; Checkmk; WUD; Pulse; Cloudflared Debian VM (DockerVM2) Identity &amp; security services Authentik; OpenVAS; PostgreSQL; Elastic Agent; n8n LXC-1 (Primary DNS) Network infrastructure Pi-hole; prometheus-exporter LXC-2 (Ingress) Reverse proxy &amp; SSO Traefik; Authentik outpost Safeline-WAF Web Application Firewall and Gmail notifications Safeline stack, SMTP relay"},{"location":"projects/homelab/02-platform/#docker-compose","title":"Docker Compose","text":"<p>Compose files are created in VS Code and stored in a Github repository for version control. <pre><code>services:\n  postgresql:\n    image: docker.io/library/postgres:16-alpine\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -d $${POSTGRES_DB} -U $${POSTGRES_USER}\"]\n      start_period: 20s\n      interval: 30s\n      retries: 5\n      timeout: 5s\n    volumes:\n      - database:/var/lib/postgresql/data\n    environment:\n      POSTGRES_PASSWORD: #######\n      POSTGRES_USER: #######\n      POSTGRES_DB: authentik-db\n\n  redis:\n    image: docker.io/library/redis:alpine\n\n    command: --save 60 1 --loglevel warning\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD-SHELL\", \"redis-cli ping | grep PONG\"]\n      start_period: 20s\n      interval: 30s\n      retries: 5\n      timeout: 3s\n    volumes:\n      - redis:/data\n  server:\n    image: ${AUTHENTIK_IMAGE:-ghcr.io/goauthentik/server}:${AUTHENTIK_TAG:-2025.10.3}\n    restart: unless-stopped\n\n    command: server\n    environment:\n      AUTHENTIK_SECRET_KEY: ########\n      AUTHENTIK_REDIS__HOST: redis\n      AUTHENTIK_POSTGRESQL__HOST: postgresql\n      AUTHENTIK_POSTGRESQL__USER: ######\n      AUTHENTIK_POSTGRESQL__NAME: authentik-db\n      AUTHENTIK_POSTGRESQL__PASSWORD: ######\n\n    volumes:\n      - ./media:/media\n      - ./custom-templates:/templates\n      - /opt/authentik/certs/:/certs/\n\n    ports:\n      - \"80:9000\"\n      - \"443:9443\"\n    depends_on:\n      postgresql:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n  worker:\n    image: ${AUTHENTIK_IMAGE:-ghcr.io/goauthentik/server}:${AUTHENTIK_TAG:-2025.10.3}\n    restart: unless-stopped\n\n    command: worker\n    environment:\n      AUTHENTIK_SECRET_KEY: #######\n      AUTHENTIK_REDIS__HOST: redis\n      AUTHENTIK_POSTGRESQL__HOST: postgresql\n      AUTHENTIK_POSTGRESQL__USER: ######\n      AUTHENTIK_POSTGRESQL__NAME: authentik-db\n      AUTHENTIK_POSTGRESQL__PASSWORD: #######\n      AUTHENTIK_ERROR_REPORTING__ENABLED: true\n      AUTHENTIK_EMAIL__HOST: 192.168.1.89\n      AUTHENTIK_EMAIL__PORT: 25\n      AUTHENTIK_EMAIL__FROM: #########\n\n    user: ######\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./media:/media\n      - ./custom-templates:/templates\n      - /opt/authentik/certs/:/certs/\n    depends_on:\n      postgresql:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n\nvolumes:\n  database:\n    driver: local\n  redis:\n    driver: local\n</code></pre></p>"},{"location":"projects/homelab/02-platform/#42-cloud-native-kubernetes-cluster-deployment","title":"4.2 Cloud-Native Kubernetes Cluster Deployment","text":""},{"location":"projects/homelab/02-platform/#deployment-overview_5","title":"Deployment Overview","text":"<p>       The lab runs a dual\u2011node K3s cluster (one control plane, one worker) on Red Hat Enterprise Linux 10 VMs within the 192.168.200.0/24 subnet. K3s is a fully compliant Kubernetes distribution packaged as a single binary, minimizing external dependencies and simplifying cluster operations. It includes a batteries\u2011included stack: containerd runtime, Flannel CNI, CoreDNS, Kube\u2011router, Local\u2011path\u2011provisioner, and Spegel registry mirror.    </p> <p>       The embedded Traefik ingress controller and ServiceLB load balancer have been intentionally disabled and replaced with NGINX Ingress and MetalLB, providing enterprise\u2011grade ingress routing and Layer\u20112 external IP allocation. Portainer integrates with the cluster via a DaemonSet\u2011based Portainer Agent for full lifecycle management.    </p>          K3s Cluster Deployment Overview."},{"location":"projects/homelab/02-platform/#security-impact_5","title":"Security Impact","text":"<ul> <li>K3s certificate automation secures all control plane and node communications</li> <li>NGINX Ingress enforces controlled north\u2011south traffic with TLS termination</li> <li>MetalLB provides predictable, controlled external IP allocation</li> <li>Flannel CNI and Kube\u2011router enforce network segmentation and policy enforcement</li> <li>Minimal external dependencies reduce attack surface</li> <li>Local\u2011path\u2011provisioner isolates persistent volumes per workload</li> </ul>"},{"location":"projects/homelab/02-platform/#deployment-rationale_5","title":"Deployment Rationale","text":"<p>K3s is ideal for homelab and edge environments requiring full Kubernetes functionality with reduced operational overhead. This deployment demonstrates proficiency with Kubernetes networking, ingress management, persistent storage provisioning, and cluster lifecycle operations. Replacing Traefik and ServiceLB with NGINX Ingress and MetalLB mirrors enterprise\u2011grade ingress and load\u2011balancing patterns.</p>"},{"location":"projects/homelab/02-platform/#architecture-principles-alignment_5","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Network policies, ingress controls, and runtime isolation across pods and namespaces</p> <p>Secure by Design: TLS\u2011secured control plane, minimal dependencies, automated certificate rotation</p> <p>Zero Trust: Every pod, service, and ingress request authenticated and authorized; no implicit trust between namespaces</p> <p></p>"},{"location":"projects/homelab/02-platform/#core-infrastructure-services","title":"Core Infrastructure Services","text":"Component Namespace Purpose Deployment Type MetalLB Controller metallb-system Layer 2/BGP load balancer controller for bare-metal Kubernetes Deployment (1 replica) MetalLB Speaker metallb-system Announces LoadBalancer IPs via ARP/BGP DaemonSet (runs on all nodes) Nginx Ingress Controller nginx-ingress HTTP/HTTPS ingress traffic routing and SSL termination Helm chart (1 replica) Portainer Agent portainer-agent Cluster management and monitoring via Portainer UI DaemonSet (runs on all nodes) Cert-Manager cert-manager StepCA/ACME client for nginx-ingress SSL termination Helm Chart Deployment <p>MetalLB Load Balancer Configuration:</p> <ul> <li>Address Pool: 192.168.200.30-192.168.200.49 (20 available IPs)</li> <li>Mode: Layer 2 (ARP-based)</li> <li>Purpose: Provides external IPs for LoadBalancer-type services in bare-metal environment</li> </ul> <p>Ingress Architecture:</p> <ul> <li>Controller: Nginx Ingress Controller (official Kubernetes ingress-nginx)</li> <li>External Access: LoadBalancer service at 192.168.200.31 (HTTP: 80, HTTPS: 443)</li> <li>Use Case: Centralized ingress point for HTTP-based services with path-based routing. Provides rate limiting, IP allow list and TLS/HTTPS connectivity to the NGINX Webserver. Certificates are delivered via Cert-Manager service that is auto-generated from StepCA/ACME.  </li> </ul>"},{"location":"projects/homelab/02-platform/#nginx-namespace-web-services","title":"Nginx Namespace - Web Services","text":"Application Type Image Replicas External IP Ports Purpose nginx Deployment linuxserver/nginx:latest 2/2 192.168.200.32 80 (HTTP) Static web server for lab documentation and demos"},{"location":"projects/homelab/02-platform/#infrastructure-namespaces","title":"Infrastructure Namespaces","text":"<p>metallb-system Namespace:</p> Application Type Replicas Purpose controller Deployment 1/1 MetalLB controller managing IP address allocation speaker DaemonSet 2/2 MetalLB speaker announcing IPs via Layer 2 (ARP) <p>nginx-ingress Namespace:</p> Application Type Replicas External IP Purpose nginx-ingress-controller Helm/DaemonSet 2/2 192.168.200.31 HTTP/HTTPS ingress controller for path-based routing <p>portainer-agent Namespace:</p> Application Type Replicas Purpose portainer-agent DaemonSet 2/2 Portainer agent for cluster management via Portainer UI <p>cert-manager Namespace:</p> Application Type Replicas External IP Purpose Cert-Manager Helm 1/1 - StepCA/ACME client for nginx-ingress SSL termination Cert-Manager-cainjector Helm 1/1 - - Cert-Manager-webhook Helm 1/1 - - #### SOC Namespace - Security Operations Center Platform <p>The SOC namespace hosts the lab's comprehensive Security Operations Center platform, implementing a modern threat intelligence, incident response, and security orchestration architecture. Integrating threat intelligence sharing (MISP), automated analysis (Cortex), workflow automation (Shuffle), and case management (TheHive).</p>"},{"location":"projects/homelab/02-platform/#architecture-overview","title":"Architecture Overview","text":"<p>Namespace Purpose: Centralized security operations platform providing end-to-end incident response capabilities from threat intelligence ingestion through automated workflow execution, observable analysis, case resolution, and IOC sharing.</p>"},{"location":"projects/homelab/02-platform/#design-rationale","title":"Design Rationale","text":"<p>Unified Security Platform: Single namespace for all SOC functions enables tight integration and simplified network policies</p> <p>Workflow Automation: Shuffle SOAR orchestrates complex multi-tool workflows without requiring custom code development</p> <p>Scalability: Kubernetes orchestration allows horizontal scaling of analysis workers (Cortex, Shuffle Orborus) during high-volume incident periods</p> <p>Resilience: StatefulSets ensure data persistence for critical components (Cassandra, Elasticsearch, OpenSearch)</p> <p>Integration: Native Kubernetes networking facilitates service-to-service communication with other lab security tools</p>"},{"location":"projects/homelab/02-platform/#soc-namespace-security-operations-center","title":"SOC Namespace - Security Operations Center","text":"Application Type Image Replicas External IP Ports Purpose thehive Helm strangebee/thehive:5.5.13-1 1/1 192.168.200.33 9000 (HTTP), 9095 (metrics) Security incident response platform and case management cortex Deployment thehiveproject/cortex:latest 1/1 192.168.200.40 9001 (HTTP) Observable analysis engine with automated responders cassandra StatefulSet cassandra:4.1.7 1/1 192.168.200.36 9042 (CQL) Distributed database for TheHive persistent storage elasticsearch StatefulSet elasticsearch:9.2.2 1/1 192.168.200.34 9200 (HTTP) Search and analytics engine for cases and observables misp-core Deployment misp-docker/misp-core:latest 1/1 192.168.200.37 80/443 (HTTP/HTTPS) Threat intelligence platform and IOC management misp-db Deployment mariadb:10.11 1/1 ClusterIP only 3306 (MySQL) MySQL database for MISP data misp-redis Deployment valkey/valkey:7.2 1/1 ClusterIP only 6379 (Redis) Redis cache for MISP sessions and jobs misp-modules Deployment misp-docker/misp-modules:latest 1/1 ClusterIP only 6666 (HTTP) MISP enrichment and expansion modules misp-guard Deployment misp-docker/misp-guard:latest 1/1 ClusterIP only 8888 (HTTP) Security proxy for MISP core protection misp-mail Deployment egos-tech/smtp:latest 1/1 192.168.200.38 25 (SMTP) SMTP relay for threat intelligence email sharing msmtp-relay Deployment alpine:latest 1/1 ClusterIP only N/A Lightweight SMTP relay for internal notifications shuffle-frontend Deployment shuffle-frontend:latest 1/1 192.168.200.41 80/443 (HTTP/HTTPS) React-based web UI for visual workflow design, execution monitoring, and SOAR administration shuffle-backend Deployment shuffle-backend:latest 1/1 ClusterIP only 5001 Go-based backend API handling workflow orchestration, webhook processing, and app management shuffle-opensearch StatefulSet opensearch:3.2.0 1/1 ClusterIP only 9200 (HTTP) Search and analytics engine for workflow definitions, execution history, and audit logs shuffle-orborus Deployment shuffle-orborus:latest 1/1 none Worker orchestration daemon managing Docker containers for workflow app execution"},{"location":"projects/homelab/02-platform/#server-admin-namespace-infrastructure-management","title":"Server-Admin Namespace - Infrastructure Management","text":"Application Type Image Replicas External IP Ports Purpose patchmon-frontend Deployment patchmon-frontend:latest 1/1 192.168.200.35 3000 (HTTP) Web UI for Windows patch management dashboard patchmon-backend Deployment patchmon-backend:latest 1/1 192.168.200.39 3001 (HTTP API) Backend API for patch compliance tracking patchmon-database Deployment postgres:17-alpine 1/1 ClusterIP only 5432 (PostgreSQL) PostgreSQL database for patch status data patchmon-redis Deployment redis:7-alpine 1/1 ClusterIP only 6379 (Redis) Redis cache for session management"},{"location":"projects/homelab/02-platform/#43-network-services-summary","title":"4.3 Network Services Summary","text":""},{"location":"projects/homelab/02-platform/#loadbalancer-services-externally-accessible","title":"LoadBalancer Services (Externally Accessible)","text":"Service Name Namespace Type External IP Ports Application Access Method nginx-ingress-controller nginx-ingress LoadBalancer 192.168.200.31 80, 443 Ingress Controller Primary HTTP/HTTPS ingress point nginx nginx LoadBalancer 192.168.200.32 80 Nginx Web Server Static web content hosting thehive soc LoadBalancer 192.168.200.33 9000, 9095 TheHive SIRP Case management UI elasticsearch soc LoadBalancer 192.168.200.34 9200 Elasticsearch Search API (admin only) patchmon-frontend server-admin LoadBalancer 192.168.200.35 3000 PatchMon UI Patch management dashboard cassandra soc LoadBalancer 192.168.200.36 9042 Cassandra DB Database access (admin only) misp-core soc LoadBalancer 192.168.200.37 80, 443 MISP Platform Threat intelligence portal misp-mail soc LoadBalancer 192.168.200.38 25 SMTP Relay Email-based threat sharing patchmon-backend server-admin LoadBalancer 192.168.200.39 3001 PatchMon API Backend API (internal) cortex soc LoadBalancer 192.168.200.40 9001 Cortex Engine Observable analysis API shuffle soc LoadBalancer 192.168.200.41 80/443 Shuffle Automation UI <p>Access Control:</p> <ul> <li>All services accessible only via Tailscale VPN (no direct internet exposure)</li> <li>Administrative services (Elasticsearch, Cassandra) require Authentik SSO + MFA</li> <li>Network policies enforce namespace isolation and least-privilege access</li> <li>pfSense firewall rules restrict access by source IP and service port</li> </ul>"},{"location":"projects/homelab/02-platform/#clusterip-services-internal-only","title":"ClusterIP Services (Internal Only)","text":"Service Name Namespace Cluster IP Ports Purpose kubernetes default 10.43.0.1 6443 Kubernetes API server patchmon-database server-admin 10.43.3.202 5432 PostgreSQL backend for PatchMon misp-db soc 10.43.151.59 3306 MariaDB backend for MISP misp-redis soc 10.43.131.214 6379 Redis cache for MISP misp-modules soc 10.43.234.246 6666 MISP enrichment modules misp-guard soc 10.43.97.195 8888 MISP security proxy patchmon-backend server-admin 10.43.99.91 3001 PatchMon API (internal routing) patchmon-redis server-admin 10.43.126.102 6379 Redis cache for PatchMon metallb-webhook-service metallb-system 10.43.122.116 9443 MetalLB webhook validation shuffle-backend soc 10.43.189.138 5001 Shuffle backend integration shuffle-opensearch soc 10.43.137.30 9200 Shuffle database nginx-ingress-admission nginx-ingress 10.43.241.54 443 Ingress admission webhook cert-manager-webhook cert-manager 10.43.150.38 443 SSL termination for nginx-ingress <p>Network Policies:</p> <ul> <li>Default deny all ingress/egress traffic</li> <li>Explicit allow rules for required service-to-service communication</li> <li>Database services (PostgreSQL, MariaDB, Redis) accessible only from their respective application pods</li> <li>Rate limiting for Ingress HTTP services</li> <li>SSL termination for all ingress HTTP services</li> </ul>"},{"location":"projects/homelab/02-platform/#44-example-workload-patchmon","title":"4.4 Example Workload PatchMon","text":"<ul> <li>Namspace: server-admin</li> <li>Deployments: 1 replica per deployment with anti-affinity rules</li> <li>Persistent Storage: local-path-provisioner (hostPath-based PVCs)</li> <li>Exposure: MetalLB LoadBalancer with external IPs</li> <li>Persistent Volume Claims / Volumes: patchmon-postgres-pvc &amp; patchmon-redis-pvc</li> </ul>"},{"location":"projects/homelab/02-platform/#namespace","title":"Namespace","text":"<pre><code>apiVersion: v1\nkind: Namespace\nmetadata:\n  name: server-admin\n</code></pre>"},{"location":"projects/homelab/02-platform/#postgresredis-pvcs","title":"Postgres/Redis PVCs","text":"<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: patchmon-postgres-pvc\n  namespace: server-admin\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 10Gi\n  storageClassName: local-path\n---\n# Redis PVC\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: patchmon-redis-pvc\n  namespace: server-admin\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 5Gi\n  storageClassName: local-path\n</code></pre>"},{"location":"projects/homelab/02-platform/#postgres-deployment","title":"Postgres Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: patchmon-database\n  namespace: server-admin\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: patchmon-database\n  template:\n    metadata:\n      labels:\n        app: patchmon-database\n    spec:\n      initContainers:\n      - name: init-chown\n        image: busybox\n        command: [\"sh\", \"-c\", \"chown -R 999:999 /var/lib/postgresql/data\"]\n        volumeMounts:\n        - name: postgres-storage\n          mountPath: /var/lib/postgresql/data\n      containers:\n      - name: database\n        image: postgres:17-alpine\n        env:\n        - name: POSTGRES_DB\n          value: patchmon_db\n        - name: POSTGRES_USER\n          value: patchmon_user\n        - name: POSTGRES_PASSWORD\n          value: ######\n        livenessProbe:\n          exec:\n            command: [\"pg_isready\",\"-U\",\"patchmon_user\",\"-d\",\"patchmon_db\"]\n          initialDelaySeconds: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command: [\"pg_isready\",\"-U\",\"patchmon_user\",\"-d\",\"patchmon_db\"]\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: postgres-storage\n          mountPath: /var/lib/postgresql/data\n          subPath: data\n      volumes:\n      - name: postgres-storage\n        persistentVolumeClaim:\n          claimName: patchmon-postgres-pvc\n</code></pre>"},{"location":"projects/homelab/02-platform/#redis-deployment","title":"Redis Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: patchmon-redis\n  namespace: server-admin\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: patchmon-redis\n  template:\n    metadata:\n      labels:\n        app: patchmon-redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:7-alpine\n        command: [\"redis-server\",\"--requirepass\",\"#####\",\"--appendonly\",\"yes\"]\n        livenessProbe:\n          exec:\n            command: [\"redis-cli\",\"-a\",\"#####\",\"ping\"]\n          initialDelaySeconds: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command: [\"redis-cli\",\"-a\",\"#####\",\"ping\"]\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: redis-storage\n          mountPath: /data\n      volumes:\n      - name: redis-storage\n        persistentVolumeClaim:\n          claimName: patchmon-redis-pvc\n</code></pre>"},{"location":"projects/homelab/02-platform/#backend-deployment","title":"Backend Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: patchmon-backend\n  namespace: server-admin\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: patchmon-backend\n  template:\n    metadata:\n      labels:\n        app: patchmon-backend\n    spec:\n      containers:\n      - name: backend\n        image: ghcr.io/patchmon/patchmon-backend:latest\n        env:\n        - name: LOG_LEVEL\n          value: info\n        - name: DATABASE_URL\n          value: postgresql://patchmon_user:#######\n        - name: JWT_SECRET\n          value: \n        - name: SERVER_PORT\n          value: \"3001\"\n        - name: CORS_ORIGIN\n          value: \"http://192.168.200.35:3000\"\n        - name: REDIS_HOST\n          value: patchmon-redis\n        - name: REDIS_PORT\n          value: \"6379\"\n        - name: REDIS_PASSWORD\n          value: ####### \n        - name: REDIS_DB\n          value: \"0\"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 3001\n          initialDelaySeconds: 10\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 3001\n          initialDelaySeconds: 5\n          periodSeconds: 5\n</code></pre>"},{"location":"projects/homelab/02-platform/#frontend-deployment","title":"Frontend Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: patchmon-frontend\n  namespace: server-admin\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: patchmon-frontend\n  template:\n    metadata:\n      labels:\n        app: patchmon-frontend\n    spec:\n      containers:\n      - name: frontend\n        image: ghcr.io/patchmon/patchmon-frontend:latest\n        env:\n        - name: BACKEND_HOST\n          value: patchmon-backend\n        - name: BACKEND_PORT\n          value: \"3001\"\n        livenessProbe:\n          httpGet:\n            path: /index.html\n            port: 3000\n          initialDelaySeconds: 10\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 3000\n          initialDelaySeconds: 5\n          periodSeconds: 5\n</code></pre>"},{"location":"projects/homelab/02-platform/#services","title":"Services","text":""},{"location":"projects/homelab/02-platform/#apiversion-v1-kind-service-metadata-name-patchmon-frontend-namespace-server-admin-spec-type-loadbalancer-loadbalancerip-19216820035-selector-app-patchmon-frontend-ports-port-3000-targetport-3000-apiversion-v1-kind-service-metadata-name-patchmon-backend-namespace-server-admin-spec-type-loadbalancer-loadbalancerip-19216820039-selector-app-patchmon-backend-ports-port-3001-targetport-3001-apiversion-v1-kind-service-metadata-name-patchmon-database-namespace-server-admin-spec-selector-app-patchmon-database-ports-port-5432-targetport-5432-apiversion-v1-kind-service-metadata-name-patchmon-redis-namespace-server-admin-spec-selector-app-patchmon-redis-ports-port-6379-targetport-6379","title":"<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: patchmon-frontend\n  namespace: server-admin\nspec:\n  type: LoadBalancer\n  loadBalancerIP: 192.168.200.35\n  selector:\n    app: patchmon-frontend\n  ports:\n  - port: 3000\n    targetPort: 3000\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: patchmon-backend\n  namespace: server-admin\nspec:\n  type: LoadBalancer\n  loadBalancerIP: 192.168.200.39\n  selector:\n    app: patchmon-backend\n  ports:\n  - port: 3001\n    targetPort: 3001\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: patchmon-database\n  namespace: server-admin\nspec:\n  selector:\n    app: patchmon-database\n  ports:\n  - port: 5432\n    targetPort: 5432\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: patchmon-redis\n  namespace: server-admin\nspec:\n  selector:\n    app: patchmon-redis\n  ports:\n  - port: 6379\n    targetPort: 6379\n</code></pre>","text":""},{"location":"projects/homelab/02-platform/#45-version-control-strategy","title":"4.5 Version Control Strategy","text":"<ul> <li>Repository: GitHub repo (infrastructure-as-code)</li> <li>Structure: Organized by service (docker-compose/, k8s-manifests/, terraform/Ansible)</li> <li>Tooling: VS Code with Docker, Kubernetes, SSH, Ansible, Terraform extensions</li> <li>Automation: Watchtower monitors container images, WUD provides update alerts</li> </ul>"},{"location":"projects/homelab/02-platform/#5-lab-network-topology-routing-and-domain-namespace","title":"5. Lab Network Topology, Routing and Domain Namespace","text":"<p>This section outlines the IP addressing scheme, subnet allocations, and internal domain naming conventions used across the Lab infrastructure. It supports modular service deployment, secure DNS resolution, and PKI integration.</p>"},{"location":"projects/homelab/02-platform/#ipv4-addressing-vlan-and-subnet-allocation","title":"IPv4 Addressing, VLAN and Subnet Allocation","text":"Subnet CIDR VID Purpose Notes 192.168.1.0 /24 10 Production Network Hosts my production environment. Note: lab services were initially deployed in this subnet, working to migrate everything into the lab subnets. 192.168.2.0 /24 20 External LAN Network/DMZ Test network for segmentation and FW rules. 192.168.3.0 /24 30 Isolated Link Test port-based VLAN between FortiGate, OfficePC and Proxmox host 192.168.100.0 /24 100 Primary Lab LAN Hosts lab containers, virtual machines and services. 192.168.200.0 /24 200 Secondary Lab LAN Isolated test environments, ephemeral services 10.20.0.0 /24 120 Isolated LAN Test network for sensitive data 10.10.0.0 /24 110 HA Sync Isolated subnet for pfSense HA sync/CARP 10.30.0.0 /30 N/A Router PTP Point to Point router link between Cisco R1 and R2 <p>All subnets are routed internally and firewalled to enforce least privilege access between zones.</p>"},{"location":"projects/homelab/02-platform/#routing-tables","title":"Routing Tables","text":""},{"location":"projects/homelab/02-platform/#asus-router-19216811","title":"ASUS Router (192.168.1.1)","text":"<p>Role: Primary gateway for the entire network Directly connected: 192.168.1.0/24</p> Destination Subnet Next Hop Notes 192.168.100.0/24 192.168.1.254 (pfSense) LAB_LAN1 192.168.200.0/24 192.168.1.254 (pfSense) LAB_LAN2 192.168.2.0/24 192.168.1.254 (pfSense) EXT_LAN 10.10.0.0/24 192.168.1.254 (pfSense) Internal VLAN 10.20.0.0/24 192.168.1.201 (OPNsense) ISO segment #1 192.168.3.0/24 192.168.1.99 (FortiGate) ISO segment #2 10.30.0.0/24 192.168.1.6 (Cisco vRouter) ISO segment #3 0.0.0.0/0 ISP Internet"},{"location":"projects/homelab/02-platform/#pfsense-ha-firewalls-1921681254-vip","title":"pfSense HA Firewalls (192.168.1.254 VIP)","text":"<p>Role: Core routers for all internal VLANs</p> <p>Directly connected: - 192.168.1.0/24 (Prod_LAN) - 192.168.100.0/24 (LAB_LAN1) - 192.168.200.0/24 (LAB_LAN2) - 192.168.2.0/24 (EXT_LAN) - 10.10.0.0/24 (Internal VLAN)</p> Destination Subnet Next Hop Notes 192.168.1.0/24 Direct Prod_LAN 192.168.100.0/24 Direct LAB_LAN1 192.168.200.0/24 Direct LAB_LAN2 192.168.2.0/24 Direct EXT_LAN 10.10.0.0/24 Direct Internal VLAN 10.20.0.0/24 192.168.1.201 (OPNsense) ISO #1 192.168.3.0/24 192.168.1.99 (FortiGate) ISO #2 10.30.0.0/24 192.168.1.6 (Cisco vRouter) ISO #3 0.0.0.0/0 192.168.1.1 (ASUS) Internet"},{"location":"projects/homelab/02-platform/#opnsense-1921681201","title":"OPNsense (192.168.1.201)","text":"<p>Role: ISO router for 10.20.0.0/24</p> <p>Directly connected: - 10.20.0.0/24 (ISO_LAN) - 192.168.1.0/24 (Prod_LAN)</p> Destination Subnet Next Hop Notes 10.20.0.0/24 Direct ISO_LAN 192.168.1.0/24 Direct Prod_LAN 192.168.100.0/24 192.168.1.254 (pfSense) LAB_LAN1 192.168.200.0/24 192.168.1.254 (pfSense) LAB_LAN2 192.168.2.0/24 192.168.1.254 (pfSense) EXT_LAN 10.10.0.0/24 192.168.1.254 (pfSense) Internal VLAN 192.168.3.0/24 192.168.1.99 (FortiGate) ISO #2 10.30.0.0/24 192.168.1.6 (Cisco vRouter) ISO #3 0.0.0.0/0 192.168.1.1 (ASUS) Internet"},{"location":"projects/homelab/02-platform/#fortigate-192168199","title":"FortiGate (192.168.1.99)","text":"<p>Role: ISO router for 192.168.3.0/24</p> <p>Directly connected: - 192.168.3.0/24 (ISO_LAN) - 192.168.1.0/24 (Prod_LAN)</p> Destination Subnet Next Hop Notes 192.168.3.0/24 Direct ISO_LAN 192.168.1.0/24 Direct Prod_LAN 192.168.100.0/24 192.168.1.254 (pfSense) LAB_LAN1 192.168.200.0/24 192.168.1.254 (pfSense) LAB_LAN2 192.168.2.0/24 192.168.1.254 (pfSense) EXT_LAN 10.10.0.0/24 192.168.1.254 (pfSense) Internal VLAN 10.20.0.0/24 192.168.1.201 (OPNsense) ISO #1 10.30.0.0/24 192.168.1.6 (Cisco vRouter) ISO #3 0.0.0.0/0 192.168.1.1 (ASUS) Internet"},{"location":"projects/homelab/02-platform/#cisco-r1-vrouter-19216816","title":"Cisco r1 vRouter (192.168.1.6)","text":"<p>Hostname: R1.home.com Role: Core router for PROD, LAB1, LAB2</p> <p>Directly connected: - 192.168.1.0/24 (Prod_LAN) - 192.168.100.0/24 (LAB_LAN1) - 192.168.200.0/24 (LAB_LAN2) - 10.30.0.0/30 (PTP link to R2)</p> Destination Subnet Next Hop Notes 192.168.1.0/24 Direct Prod_LAN 192.168.100.0/24 Direct LAB_LAN1 192.168.200.0/24 Direct LAB_LAN2 10.30.0.0/30 Direct PTP to R2 192.168.2.0/24 10.30.0.2 OSPF via R2 192.168.3.0/24 10.30.0.2 OSPF via R2 10.20.0.0/24 192.168.1.1 Static route to ISO #1 (via ASUS) 0.0.0.0/0 Not set No default route configured"},{"location":"projects/homelab/02-platform/#cisco-r2-vrouter-19216839","title":"Cisco r2 vRouter (192.168.3.9)","text":"<p>Hostname: R2.home.com Role: Edge router for EXT and ISO</p> <p>Directly connected: - 10.30.0.0/30 (PTP to R1) - 192.168.3.0/24 (ISO_LAN2) - 192.168.2.0/24 (EXT_LAN)</p> Destination Subnet Next Hop Notes 10.30.0.0/30 Direct PTP link to R1 192.168.3.0/24 Direct ISO_LAN2 192.168.2.0/24 Direct EXT_LAN 192.168.1.0/24 10.30.0.1 OSPF via R1 (Prod_LAN) 192.168.100.0/24 10.30.0.1 OSPF via R1 (LAB_LAN1) 192.168.200.0/24 10.30.0.1 OSPF via R1 (LAB_LAN2) 0.0.0.0/0 Not set No default route configured          Lab Routing Flowchart."},{"location":"projects/homelab/02-platform/#domain-namespace-design","title":"Domain Namespace Design","text":"Domain Purpose Notes home.com Production / Lab services Current state: Production, lab and AD environments. Future State: migration of domain to shadowitlab.com, AD will remain on home.com. shadowitlab.com Public DNS Used to expose services externally through Cloudflare tunnels. Future migration to all internal DNS FQDNs. --- ## 6. Security Homelab Section Links <ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualzation Stack and Hardware </li> <li>Network Security, Pirvacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/03-network/","title":"Network Security, Privacy and Remote Access Architecture","text":"<p>Document Control:  Version: 1.0 Last Updated: January 307, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/03-network/#1-network-security-architecture","title":"1. Network Security Architecture","text":"<p>A defense-in-depth edge security architecture implements multiple layers of inspection, filtering, and threat mitigation across network perimeter, application layer, and endpoint boundaries. This multi-engine security stack combines virtualized firewalls (pfSense/OPNsense), intrusion detection/prevention systems (Suricata/Snort), behavioral threat intelligence (CrowdSec), application-layer filtering (SafeLine WAF), and encrypted tunneling (VPN/Zero-Trust access) to provide enterprise-grade network protection.</p> <p>Security Impact: Multi-layer inspection detects threats missed by single-engine solutions; behavioral analysis identifies zero-day attacks before signature updates; high-availability clustering ensures uninterrupted protection during maintenance; centralized logging enables threat correlation across all security layers; encrypted tunneling protects data in transit and provides secure remote access without exposing internal infrastructure.</p> <p>Deployment Rationale: Enterprise networks deploy layered security controls because attackers increasingly use evasion techniques (encryption, polymorphic malware, living-off-the-land tactics) that bypass signature-based detection. This architecture mirrors Fortune 500 security operations centers (SOCs) where multiple detection engines (IDS/IPS, behavior analytics, threat intelligence feeds) provide overlapping coverage. High-availability firewall clustering reflects production network designs where downtime directly impacts business operations. The implementation demonstrates understanding of OSI layer security (Layer 3/4 firewalls, Layer 7 WAF), threat detection methodologies (signature vs. behavioral), and modern zero-trust access patterns.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Five security layers (firewall ACLs \u2192 IDS/IPS \u2192 behavioral detection \u2192 WAF \u2192 endpoint protection) ensure single-layer bypass doesn't compromise entire network</li> <li>Secure by Design: Default-deny firewall policies; encrypted VPN tunnels for remote access; automatic security updates for threat signatures</li> <li>Zero Trust: Identity verification required for all remote access (Tailscale authentication); no implicit trust based on network location; microsegmentation isolates compromised systems</li> </ul>"},{"location":"projects/homelab/03-network/#2-network-firewallrouter-architecture","title":"2. Network Firewall/Router Architecture","text":""},{"location":"projects/homelab/03-network/#21-high-availability-pfsense-cluster","title":"2.1 High-Availability pfSense Cluster","text":""},{"location":"projects/homelab/03-network/#deployment-overview","title":"Deployment Overview","text":"<p>Two pfSense virtual machines operate in an active/passive high\u2011availability configuration using CARP (Common Address Redundancy Protocol). The primary node synchronizes all configuration and state information to the secondary via a dedicated SYNC interface. In the event of failure, CARP provides sub\u2011second failover with minimal packet loss, ensuring uninterrupted perimeter protection. Both nodes enforce default\u2011deny firewall policies, NAT rules, VPN termination, and IDS/IPS inspection.</p>"},{"location":"projects/homelab/03-network/#security-impact","title":"Security Impact","text":"<ul> <li>Continuous perimeter protection even during maintenance or node failure</li> <li>Stateful failover preserves active connections, preventing session drops</li> <li>Inline Suricata/Snort inspection blocks malicious traffic at the edge</li> <li>Centralized logging feeds Splunk for correlation with internal telemetry</li> <li>VPN termination provides encrypted remote access without exposing internal networks</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale","title":"Deployment Rationale","text":"<p>High\u2011availability firewalls are standard in enterprise networks where downtime directly impacts business operations. This deployment mirrors production\u2011grade designs using redundant nodes, synchronized configuration, and automated failover. It demonstrates proficiency with CARP, state synchronization, multi\u2011WAN routing, and perimeter\u2011level security enforcement.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Redundant perimeter firewalls ensure continuous enforcement of ACLs, NAT, and IDS/IPS Secure by Design: Default\u2011deny rules, TLS\u2011secured VPNs, and synchronized configurations Zero Trust: Remote access requires identity verification; no implicit trust in network location</p>"},{"location":"projects/homelab/03-network/#cluster-configuration","title":"Cluster Configuration","text":"Node Role Management IP CARP VIP State Sync pfSense-Primary 192.168.100.2/24 192.168.100.1/24 Master pfSense-Secondary 192.168.100.3/24 192.168.100.1/24 Backup Sync Network 10.10.0.0/24 Dedicated xmlrpc"},{"location":"projects/homelab/03-network/#interface-design","title":"Interface Design","text":"Interface Physical/Virtual Network Purpose Prod_LAN vtnet0 192.168.1.253/24 Prod LAN hosts, Upstream gateway to ISP router Lab_LAN1 vtnet1 (bridge) 192.168.100.2/24 Primary lab network SYNC vtnet2 10.10.0.2/24 HA state synchronization PIA_NY ovpnc1 (Dynamic) VPN egress - New York endpoint PIA_CA_MONT ovpnc2 (Dynamic) VPN egress - Montreal endpoint TSCALE tailscale0 (Dynamic /32) WireGuard mesh VPN for remote access Lab_LAN2 vtnet3 192.168.200.2/24 Kubernetes cluster network EXT_LAN vtnet4 192.168.2.2/24 External lab services (DMZ-style) <p>Traffic Flow Architecture:</p> <ul> <li>Default Route: LAN traffic (192.168.100.0/24) \u2192 PIA VPN \u2192 Internet</li> <li>Policy-Based Routing: Selective traffic bypass for latency-sensitive apps</li> <li>VPN Failover: Automatic failover between PIA_NY and PIA_CA_MONT on tunnel failure</li> <li>Kill Switch: Floating rule blocks LAN egress if all VPN tunnels are down</li> </ul>"},{"location":"projects/homelab/03-network/#security-enhancement-packages","title":"Security Enhancement Packages","text":"<p>pfBlockerNG - IP Reputation and Geofencing</p> <p>Purpose: Network-layer blocking of malicious IPs and geographic regions</p> <p>Configuration:</p> <ul> <li>Blocklists: 15+ curated feeds (Emerging Threats, Spamhaus, Abuse.ch)</li> <li>Update Frequency: Hourly refresh of threat intelligence feeds</li> <li>Geo-blocking: Block inbound from high-risk countries (configurable whitelist)</li> <li>Integration: Feeds alias tables used in firewall rules</li> <li>Use Case: Prevent C2 callbacks, block known botnets, reduce attack surface</li> </ul> <p>Suricata IDS/IPS</p> <p>Deployment: Active on all internal LAN interfaces (both pfSense nodes) Mode: Inline IPS with legacy blocking (balances performance vs. protection)</p> <p>Rulesets:</p> <ul> <li>Emerging Threats Open (ET Open) - 40,000+ signatures</li> <li>Suricata Community Rules</li> <li>Custom local rules for lab-specific threat patterns</li> </ul> <p>Configuration:</p> <ul> <li>Action: Drop + Alert on HIGH/CRITICAL severity events</li> <li>Performance: Disabled CPU-intensive rules for lab environment constraints</li> <li>Logging: JSON output forwarded to Splunk and Elastic via syslog-ng</li> </ul> <p>Use Case: Real-time detection of exploits, malware, and lateral movement attempts</p> <p>Snort IDS/IPS</p> <p>Deployment: Active on PIA VPN interfaces (monitors encrypted tunnel egress) Mode: LEgacy (IDS) mode for outbound traffic inspection</p> <p>Rulesets:</p> <ul> <li>Snort Community Rules</li> <li>Talos Intelligence Registered User Rules</li> <li>Custom rules for data exfiltration patterns</li> </ul> <p>Rationale: While Suricata monitors north-south and east-west traffic, Snort provides additional coverage on VPN tunnels where traffic exits the lab. This dual-engine approach catches threats that might evade a single detection system.</p> <p>CrowdSec - Behavioral Threat Intelligence</p> <p>Architecture: Remediation Bouncer receives block decisions via LAPI, enforces at firewall</p>"},{"location":"projects/homelab/03-network/#22-opnsense-microsegmentation-firewall","title":"2.2 OPNsense Microsegmentation Firewall","text":""},{"location":"projects/homelab/03-network/#deployment-overview_1","title":"Deployment Overview","text":"<p>A standalone OPNsense VM provides an additional security boundary for sensitive lab assets. Positioned behind the pfSense perimeter, it enforces microsegmentation policies, isolates high\u2011value systems, and applies independent firewall rules, IDS/IPS policies, and access controls.</p>"},{"location":"projects/homelab/03-network/#security-impact_1","title":"Security Impact","text":"<ul> <li>Prevents lateral movement into sensitive subnets</li> <li>Independent policy engine ensures compromise of pfSense does not expose protected assets</li> <li>Additional IDS/IPS layer increases detection coverage</li> <li>Segmented logging improves visibility into east\u2011west traffic</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_1","title":"Deployment Rationale","text":"<p>Microsegmentation is a core zero\u2011trust principle used in enterprise environments to isolate critical systems. Deploying OPNsense as a \"firewall within a firewall\" demonstrates layered security design, redundancy, and compartmentalization of trust domains.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_1","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Independent firewall layer behind pfSense perimeter Secure by Design: Segmented networks, isolated rule sets, and dedicated IDS/IPS Zero Trust: No internal subnet is implicitly trusted; access requires explicit policy</p>"},{"location":"projects/homelab/03-network/#interface-configuration","title":"Interface Configuration","text":"Interface Name Type Network Security Zone Role PROD_LAN Physical (eth0) 192.168.1.0/24 Trusted Uplink to production network; allows controlled ingress from ISO_LAN ISO_LAN Virtual (OPTx) 10.20.0.0/24 Restricted Isolated segment for sensitive hosts; tightly scoped egress rules <p>Protected Assets (ISO_LAN):</p> <ul> <li>Vulnerability management scanners (OpenVAS, Nessus)</li> <li>Configuration management (Ansible control node)</li> <li>Security logging infrastructure (Splunk forwarder)</li> <li>Certificate authority and PKI services</li> <li>Backup repositories with encrypted data</li> </ul> <p>Firewall Policy Philosophy:</p> <p>Default Deny with Explicit Allow - Zero trust model where all traffic is blocked unless explicitly permitted by rule. This inverts traditional firewall logic and ensures unknown traffic patterns are automatically rejected.</p>"},{"location":"projects/homelab/03-network/#23-fortinet-fortigate-30d-appliance","title":"2.3 Fortinet FortiGate 30D Appliance","text":""},{"location":"projects/homelab/03-network/#deployment-overview_2","title":"Deployment Overview","text":"<p>       The FortiGate 30D serves as a dedicated microsegmentation firewall protecting the management VLAN (192.168.3.0/24). Operating in unlicensed mode as an end-of-support device, it provides basic Layer 3/4 firewall functionality, SSL VPN access, and serves as a hands-on platform for FortiOS CLI and GUI administration. Despite lacking current threat intelligence updates, the appliance demonstrates enterprise firewall concepts including policy-based routing, SSL VPN configuration, and interface-based security zones.     </p>          FortiGate Interface Configuration."},{"location":"projects/homelab/03-network/#security-impact_2","title":"Security Impact","text":"<ul> <li>Enforces strict access controls to management subnet (VLAN 3)</li> <li>SSL VPN provides encrypted remote access to administrative interfaces</li> <li>Policy-based firewall rules segment management traffic from production workloads</li> <li>Hands-on experience with enterprise-grade firewall appliance management</li> <li>Demonstrates defense-in-depth by adding physical firewall layer behind virtual pfSense/OPNsense</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_2","title":"Deployment Rationale","text":"<p>Fortinet holds significant market share in enterprise network security, making FortiOS proficiency valuable for security roles. Operating an end-of-life appliance demonstrates understanding of legacy system risk management, compensating controls deployment, and resource-constrained security operations. The appliance serves educational purposes for Fortinet NSE certification preparation and FortiOS command-line interface skill development.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_2","title":"Architecture Principles Alignment","text":"<ul> <li>Defense in Depth: Physical appliance provides hardware-based firewall enforcement independent of virtual infrastructure</li> <li>Secure by Design: Default-deny firewall policies; SSL VPN requires certificate-based authentication</li> <li>Zero Trust: Management VLAN access requires explicit firewall rules; no implicit trust between zones</li> </ul> <p>Diagram Placeholder: FortiGate Dashboard Screenshot</p>"},{"location":"projects/homelab/03-network/#configuration-highlights","title":"Configuration Highlights","text":"<p>SSL VPN Configuration:</p> <ul> <li>Certificate-based authentication for remote administrative access</li> <li>Split-tunnel routing directs only management traffic through VPN</li> <li>FortiClient compatibility for Windows, macOS, Linux endpoints</li> <li>Per-user access policies restrict VPN access to authorized administrators</li> </ul> <p>Firewall Policy Architecture (VLAN 3 Protection):</p> <ul> <li>Default-deny ingress from all external zones</li> <li>Explicit allow rules for SSH (port 22), HTTPS (port 443) from trusted source IPs</li> <li>Stateful inspection tracks connection state for allowed flows</li> <li>Logging enabled for all policy hits to support forensic analysis</li> </ul> <p>Interface Configuration:</p> <ul> <li>Internal (port1): 192.168.3.1/24 - Management VLAN gateway</li> <li>External (port2): 192.168.1.x/24 - Uplink to production network</li> <li>DMZ (port3): Reserved for future isolated services deployment</li> </ul>          FortiGate Address/Device Configuration.                 FortiGate VPN Configuration.        <p>Limitations and Compensating Controls</p> <p>Due to end-of-support status:</p> <ul> <li>No current threat intelligence updates - Compensated by pfSense Suricata/Snort IDS/IPS</li> <li>No firmware updates available - Mitigated by restricting management VLAN exposure</li> <li>Limited UTM features - Supplemented by pfBlockerNG, CrowdSec, SafeLine WAF</li> <li>Educational use only - Not relied upon for production-critical security enforcement</li> </ul> <p>Use Cases</p> <ul> <li>Fortinet NSE certification lab environment</li> <li>FortiOS CLI command practice and automation scripting</li> <li>SSL VPN troubleshooting and configuration testing</li> <li>Firewall rule optimization and policy analysis</li> <li>Vendor-neutral firewall concepts demonstration</li> </ul>"},{"location":"projects/homelab/03-network/#24-firewall-policy-architecture","title":"2.4 Firewall Policy Architecture","text":""},{"location":"projects/homelab/03-network/#deployment-overview_3","title":"Deployment Overview","text":"<p>The lab implements a three-platform firewall architecture (pfSense, OPNsense, FortiGate) using zone-based segmentation with zero-trust principles. Each VLAN operates as an isolated security zone with explicit allow rules\u2014no implicit trust between networks. Rules are deployed directionally on ingress interfaces for predictable packet flow and consistent state management across platforms.</p> <p>Security Impact:</p> <ul> <li>Zone-based segmentation prevents lateral movement between network tiers</li> <li>Default-deny policies block unauthorized traffic at zone boundaries</li> <li>Alias-driven rule definitions enable rapid security updates without rule rewrites</li> <li>Bidirectional state validation ensures return traffic authorization</li> <li>Comprehensive logging feeds SOC visibility and threat correlation</li> </ul> <p>Deployment Rationale:</p> <p>Enterprise networks rely on zone-based firewalls to enforce trust boundaries between network segments (DMZ, production, management). This architecture demonstrates production firewall design patterns: ingress-based rule placement, object-based policy definitions, and platform-agnostic security controls that survive hardware migrations.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Multi-platform inspection layers with independent policy engines</li> <li>Secure by Design: Default-deny baseline with explicit allow rules; automated threat feed integration</li> <li>Zero Trust: Cross-zone traffic requires explicit authorization regardless of source network</li> </ul>"},{"location":"projects/homelab/03-network/#policy-framework","title":"Policy Framework","text":""},{"location":"projects/homelab/03-network/#directional-rule-placement","title":"Directional Rule Placement","text":"<p>Rules apply on the ingress interface where traffic enters the firewall. This ensures deterministic packet flow, predictable state table creation, and consistent logging behavior across pfSense, OPNsense, and FortiGate platforms.</p>"},{"location":"projects/homelab/03-network/#alias-architecture","title":"Alias Architecture","text":"<p>Host, network, and service definitions use reusable aliases:</p> <ul> <li>Host Groups: WEB_SERVERS, SOC_APPS, K3S_NODES, ADMIN_HOSTS, DNS_SERVERS, PROXY_HOST</li> <li>Network Groups: INTERNAL_SUBNETS, ISO_SUBNETS, LAB_NETWORKS</li> <li>Service Groups: WEB_PORTS, SOC_PORTS, K3S_PORTS, ADMIN_PORTS, WAZUH_PORTS</li> </ul> <p>Aliases enable single-point updates\u2014adding a new web server requires updating WEB_SERVERS alias, not 15+ individual rules.</p>"},{"location":"projects/homelab/03-network/#logging-and-detection","title":"Logging and Detection","text":"<p>All security-relevant rules generate logs tagged for SIEM ingestion (Splunk/Elastic/Wazuh). Suricata/Snort rules normalize alerts across platforms for consistent threat detection and correlation.</p>"},{"location":"projects/homelab/03-network/#ruleset-summary","title":"Ruleset Summary","text":"<p>Total Rules Deployed: 133 rules across three platforms</p> <p>Rule Distribution by Platform:</p> <ul> <li>FortiGate (Management Firewall): 16 rules protecting Management and ISO_LAN2 192.168.3.0/24 subnet</li> <li>OPNsense (Microsegmentation): 23 rules isolating sensitive ISO_LAN (10.20.0.0/24)</li> <li>pfSense (Edge/Core): 94 rules managing perimeter, inter-VLAN routing, VPN policy</li> </ul> <p>Rule Categories:</p> <ul> <li>Cross-Zone Access: 78 rules (59%) - traffic between security zones</li> <li>Security Controls: 18 rules (14%) - CrowdSec blocks, bogon filters, CARP HA</li> <li>Diagnostics: 12 rules (9%) - ICMP/traceroute for network troubleshooting</li> <li>Management Access: 15 rules (11%) - administrative SSH/HTTPS to infrastructure</li> <li>Monitoring/EDR: 10 rules (8%) - Wazuh agents, Prometheus metrics, log forwarding</li> </ul> <p>Representative Rules:</p> Platform Source Destination Service Purpose Logged FortiGate ISO_LAN DNS_Servers 53/UDP DNS resolution for isolated subnet Yes FortiGate ISO_LAN Wazuh_Server 1514/UDP, 1515/TCP EDR agent \u2192 manager communication Yes OPNsense Admin_Hosts ISO_LAN 22, 80, 443, 8080 Administrative access to isolated hosts Yes pfSense Ext_LAN Web_Server 80, 443, 8080 DMZ access to internal web services Yes pfSense ANY crowdsec_blocklists ANY Drop traffic from behavioral threat intel No pfSense Lab_LAN2 Elastic_Server 8220, 9200, 5044 Elastic Agent \u2192 Fleet Server enrollment Yes <p>Security Enforcement Highlights:</p> <ul> <li>CrowdSec Integration: 12 block rules across all platforms enforce behavioral threat intelligence</li> <li>Bogon Filtering: Reserved/private IP ranges blocked on WAN-facing interfaces</li> <li>Default Deny: Implicit deny-all rule terminates each interface ruleset</li> <li>VPN Kill Switch: Floating rules block LAN egress when VPN tunnels fail</li> <li>Geo-blocking: pfBlockerNG drops inbound connections from high-risk countries</li> </ul> <p>Zone Trust Model: <pre><code>Trusted Zone (Prod_LAN) \u2190\u2192 Restricted Zone (ISO_LAN)\n  \u2193                              \u2193\nLab Zones (Lab_LAN1/2) \u2190\u2192 DMZ (Ext_LAN)\n  \u2193\nInternet (via VPN/direct routing)\n</code></pre></p> <p>Cross-zone traffic requires explicit firewall rules with service-level restrictions. No zone has blanket access to another\u2014even administrative subnets require per-service authorization.</p>"},{"location":"projects/homelab/03-network/#configuration-examples","title":"Configuration Examples","text":""},{"location":"projects/homelab/03-network/#pfsense-rule-configuration-prod_lan-interface","title":"pfSense Rule Configuration (Prod_LAN Interface)","text":"pfSense Prod_LAN Interface Rules"},{"location":"projects/homelab/03-network/#vpn-floating-rule-configuration","title":"VPN Floating Rule Configuration","text":"<p> VPN Kill Switch Details: </p> <p>       This critical floating rule ensures that if the PIA VPN tunnel drops (failure, misconfiguration, or provider outage), traffic from LAN/LAN2 networks cannot egress through the unencrypted Verizon WAN connection. The rule triggers when the gateway is not one of the PIA interfaces, immediately blocking traffic to prevent IP leakage or unintended cleartext transmission.     </p> pfSense VPN Kill Switch Floating Rule"},{"location":"projects/homelab/03-network/#pfsense-log-examples","title":"pfSense Log Examples","text":"pfSense Firewall Event Logs"},{"location":"projects/homelab/03-network/#opnsense-rule-configuration","title":"OPNsense Rule Configuration","text":"OPNsense Rule Configuration"},{"location":"projects/homelab/03-network/#fortigate-rule-configuration","title":"FortiGate Rule Configuration","text":"FortiGate Rule Configuration"},{"location":"projects/homelab/03-network/#firewall-rule-table","title":"Firewall Rule Table","text":"Lab Firewall Rules Table (partial)"},{"location":"projects/homelab/03-network/#3-intrusion-detectionprevention-solutions","title":"3. Intrusion Detection/Prevention Solutions","text":""},{"location":"projects/homelab/03-network/#31-suricata-intrusion-detectionprevention-system-on-pfsense","title":"3.1 Suricata Intrusion Detection/Prevention System on pfSense","text":""},{"location":"projects/homelab/03-network/#deployment-overview_4","title":"Deployment Overview","text":"<p>       Each pfSense node runs Suricata in inline IPS mode, inspecting four internal LAN interfaces. Suricata performs deep packet inspection, signature\u2011based detection, and behavioral anomaly detection. Rule sets include Emerging Threats, custom local rules, and tuned signatures for lab\u2011specific traffic patterns.     </p>          Suricata IPS Configuration on pfSense."},{"location":"projects/homelab/03-network/#security-impact_3","title":"Security Impact","text":"<ul> <li>Real\u2011time blocking of known attack signatures</li> <li>Deep packet inspection identifies malicious payloads and protocol anomalies</li> <li>Custom rules detect lab\u2011specific threats and reconnaissance</li> <li>Alerts forwarded to Splunk for centralized correlation</li> <li>Inline mode prevents malicious traffic before it reaches internal systems</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_3","title":"Deployment Rationale","text":"<p>Suricata is widely used in enterprise IDS/IPS deployments due to its performance, rule flexibility, and multi\u2011threaded architecture. Running Suricata inline on pfSense mirrors production edge security designs and demonstrates proficiency with rule tuning, packet inspection, and IPS enforcement.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_3","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: IDS/IPS layer reinforces firewall ACLs and WAF protections Secure by Design: Inline blocking, updated rule feeds, and custom signatures Zero Trust: All traffic inspected; no packet trusted without validation</p>          Suricata Block List Screenshot."},{"location":"projects/homelab/03-network/#32-snort-intrusion-detectionprevention-system-on-pfsense","title":"3.2 Snort Intrusion Detection/Prevention System on pfSense","text":""},{"location":"projects/homelab/03-network/#deployment-overview_5","title":"Deployment Overview","text":"<p>       Snort runs in legacy (IDS) mode on each pfSense node, monitoring PIA VPN interfaces for malicious traffic. This provides an additional detection engine specifically focused on encrypted or tunneled traffic paths.     </p>          Snort IPS Configuration on pfSense."},{"location":"projects/homelab/03-network/#security-impact_4","title":"Security Impact","text":"<ul> <li>Detects threats traversing VPN tunnels</li> <li>Provides signature diversity alongside Suricata</li> <li>Alerts forwarded to Splunk for unified SOC visibility</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_4","title":"Deployment Rationale","text":"<p>Running both Suricata and Snort mirrors enterprise SOC environments where multiple IDS engines provide overlapping detection coverage. This reduces blind spots and increases detection accuracy across encrypted or obfuscated traffic.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_4","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Dual IDS engines reduce reliance on a single detection method Secure by Design: Custom updated rule sets Zero Trust: VPN traffic inspected and validated; no implicit trust in encrypted tunnel</p>"},{"location":"projects/homelab/03-network/#33-custom-ruleset-architecture","title":"3.3 Custom Ruleset Architecture","text":""},{"location":"projects/homelab/03-network/#overview","title":"Overview","text":"<p>Interface-specific Suricata and Snort rulesets deployed per subnet. Each ruleset addresses the security requirements of its associated network segment.</p>"},{"location":"projects/homelab/03-network/#rule-categories","title":"Rule Categories","text":"<ul> <li>Linux/SSH Security Controls</li> <li>Reconnaissance &amp; Scanning Detection</li> <li>Lateral Movement Prevention</li> <li>SMB/NetBIOS Hygiene</li> <li>Test &amp; Validation Rules</li> </ul>"},{"location":"projects/homelab/03-network/#network-segments-security-posture","title":"Network Segments &amp; Security Posture","text":""},{"location":"projects/homelab/03-network/#prod_lan-1921681024","title":"Prod_LAN (192.168.1.0/24)","text":"<p>Role: Primary production network</p> <p>Security Objectives:</p> <ul> <li>Block LAB/ISO \u2192 PROD lateral movement</li> <li>Detect reconnaissance and SSH abuse</li> <li>Enforce SMB protocol hygiene</li> </ul> <p>Detection Coverage:</p> <ul> <li>SSH brute-force attacks (threshold-based)</li> <li>Privilege escalation keywords (sudo detection)</li> <li>Nmap OS fingerprinting</li> <li>Cross-segment port access (LAB\u2192PROD high-risk ports)</li> <li>ISO network isolation violations</li> <li>SMBv1/NetBIOS legacy protocol usage</li> <li>Rule validation traffic</li> </ul>"},{"location":"projects/homelab/03-network/#lab_lan1-192168100024","title":"Lab_LAN1 (192.168.100.0/24)","text":"<p>Role: Primary development and testing environment</p> <p>Security Objectives:</p> <ul> <li>Prevent LAB1 \u2192 PROD unauthorized access</li> <li>Detect internal reconnaissance activity</li> <li>Maintain ISO network isolation</li> </ul> <p>Detection Coverage:</p> <ul> <li>SSH authentication abuse</li> <li>Privilege escalation indicators</li> <li>Network scanning (Nmap signatures)</li> <li>Cross-segment violations (LAB1\u2192PROD)</li> <li>ISO\u2192LAB1 boundary violations</li> <li>SMB/NetBIOS misuse</li> </ul>"},{"location":"projects/homelab/03-network/#lab_lan2-192168200024","title":"Lab_LAN2 (192.168.200.0/24)","text":"<p>Role: Isolated sandbox for malware analysis and adversary simulation</p> <p>Security Objectives:</p> <ul> <li>Prevent LAB2 \u2192 PROD compromise</li> <li>Detect malicious reconnaissance patterns</li> <li>Enforce strict ISO network containment</li> </ul> <p>Detection Coverage:</p> <ul> <li>SSH attack patterns</li> <li>Command execution monitoring</li> <li>Active scanning detection</li> <li>LAB2\u2192PROD isolation enforcement</li> <li>ISO\u2192LAB2 traffic violations</li> <li>Protocol security controls</li> </ul>"},{"location":"projects/homelab/03-network/#ext_landmz-1921682024","title":"EXT_LAN/DMZ (192.168.2.0/24)","text":"<p>Role: DMZ for external-facing and semi-trusted services</p> <p>Security Objectives:</p> <ul> <li>Prevent DMZ \u2192 Internal lateral movement</li> <li>Detect DMZ-originated reconnaissance</li> <li>Protect HA Sync and ISO infrastructure</li> </ul> <p>Detection Coverage:</p> <ul> <li>DMZ\u2192Internal SSH blocking</li> <li>Brute-force detection</li> <li>DMZ\u2192Internal scan attempts</li> <li>DMZ\u2192ISO isolation enforcement</li> <li>DMZ\u2192HA Sync protection</li> <li>SMB protocol controls</li> </ul>"},{"location":"projects/homelab/03-network/#rule-engineering-methodology","title":"Rule Engineering Methodology","text":""},{"location":"projects/homelab/03-network/#detection-logic","title":"Detection Logic","text":"<p>Rules implement defense-in-depth through:</p> <ul> <li>Signature-based detection: Pattern matching (content, pcre)</li> <li>Behavioral analysis: Statistical thresholds (detection_filter, threshold)</li> <li>Policy enforcement: Network segmentation violations</li> <li>Anomaly detection: Protocol abuse and legacy service usage</li> </ul>"},{"location":"projects/homelab/03-network/#rule-performance-optimization","title":"Rule Performance Optimization","text":"<ul> <li>Interface-specific deployment reduces ruleset overhead</li> <li>Fast-pattern matching on content rules</li> <li>Stateful tracking (by_src, by_dst) for threshold efficiency</li> <li>Tuned thresholds based on network baseline (e.g., count 5 in 60s for SSH)</li> </ul>"},{"location":"projects/homelab/03-network/#false-positive-mitigation","title":"False Positive Mitigation","text":"<ul> <li>Environment-specific tuning per network segment</li> <li>Stateful detection (detection_filter vs. threshold)</li> <li>Protocol-aware inspection (flags, content depth)</li> <li>Contextual alerting (source/destination network awareness)</li> </ul>"},{"location":"projects/homelab/03-network/#rule-examples","title":"Rule Examples","text":""},{"location":"projects/homelab/03-network/#ssh-linux-security-controls","title":"SSH / Linux Security Controls","text":"<pre><code># Brute-force detection with stateful tracking\nalert tcp any any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: SSH Brute Force Attempt\"; flags:S; detection_filter:track by_src, count 5, seconds 60; sid:910001; rev:2;)\n\n# Cross-segment SSH policy enforcement\nalert tcp 192.168.2.0/24 any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: SSH Attempt from EXT_LAN\"; sid:910002; rev:1;)\n\n# Privilege escalation keyword monitoring\nalert tcp any any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: sudo Keyword in SSH Session\"; content:\"sudo\"; sid:910003; rev:1;)\n</code></pre>"},{"location":"projects/homelab/03-network/#reconnaissance-scanning-detection","title":"Reconnaissance &amp; Scanning Detection","text":"<pre><code># Tool-specific signature detection\nalert tcp any any -&gt; 192.168.100.0/24 any \\\n(msg:\"LAB1: Nmap OS Detection Scan\"; content:\"|4E 4D 41 50|\"; sid:910004; rev:1;)\n\n# Behavioral scan detection via port sweep threshold\nalert tcp 192.168.100.0/24 any -&gt; 192.168.1.0/24 any \\\n(msg:\"LAB1: LAB \u2192 PROD Port Scan\"; flags:S; threshold:type both, track by_src, count 20, seconds 10; sid:900008; rev:1;)\n</code></pre>"},{"location":"projects/homelab/03-network/#lateral-movement-prevention","title":"Lateral Movement Prevention","text":"<pre><code># High-risk port blocking across trust boundaries\nalert tcp 192.168.200.0/24 any -&gt; 192.168.1.0/24 [22,135,139,445,3389] \\\n(msg:\"LAB2: LAB \u2192 PROD Unauthorized High-Risk Port\"; sid:920005; rev:3;)\n\n# Isolation network policy enforcement\nalert ip [10.20.0.0/24,192.168.3.0/24] any -&gt; 192.168.200.0/24 any \\\n(msg:\"LAB2: ISO \u2192 LAB2 Traffic (Policy Violation)\"; sid:920006; rev:1;)\n</code></pre>"},{"location":"projects/homelab/03-network/#smb-netbios-hygiene","title":"SMB / NetBIOS Hygiene","text":"<pre><code># Legacy protocol detection\nalert tcp any any -&gt; any 139 \\\n(msg:\"NetBIOS Session Service Detected\"; sid:9xxxxx; rev:1;)\n\n# SMBv1 usage monitoring\nalert tcp any any -&gt; any 445 \\\n(msg:\"SMBv1 Protocol Negotiation\"; content:\"|ff|SMB\"; depth:8; sid:9xxxxx; rev:1;)\n</code></pre>"},{"location":"projects/homelab/03-network/#custom-rule-breakdown-example","title":"Custom Rule Breakdown Example:","text":""},{"location":"projects/homelab/03-network/#ssh-brute-force-detection","title":"SSH Brute Force Detection","text":"<p>Rule <pre><code>alert tcp any any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: SSH Brute Force Attempt\"; flags:S; detection_filter:track by_src, count 5, seconds 60; sid:910001; rev:2;)\n</code></pre></p>"},{"location":"projects/homelab/03-network/#field-breakdown","title":"Field Breakdown:","text":"Field Meaning Impact <code>alert</code> Generate an alert when matched Visible in Suricata \u2192 Elastic/Wazuh <code>tcp</code> Match only TCP traffic SSH is TCP\u2011based <code>any any</code> Any source IP, any source port Detects brute force from anywhere <code>-&gt;</code> Direction operator Only inbound SSH attempts <code>192.168.100.0/24 22</code> Destination network + port LAB1 SSH servers <code>flags:S</code> Match SYN packets only Prevents noisy alerts from full SSH sessions <code>detection_filter: track by_src, count 5, seconds 60</code> Threshold: 5 SYNs in 60 seconds from same IP Classic brute\u2011force pattern <code>sid:910001</code> Unique rule ID Required for management <code>rev:2</code> Revision number Tracks rule updates"},{"location":"projects/homelab/03-network/#operational-impact","title":"Operational Impact","text":"<ul> <li>Detects brute force attempts before authentication begins</li> <li>Low noise due to SYN only matching</li> <li>Helps identify compromised hosts or bots scanning SSH</li> <li>Works across VLAN boundaries</li> </ul>"},{"location":"projects/homelab/03-network/#suricata-event-log-example","title":"Suricata event log example","text":"Custom Rule Events."},{"location":"projects/homelab/03-network/#34-crowdsec-behavioral-threat-intelligence","title":"3.4 CrowdSec Behavioral Threat Intelligence","text":""},{"location":"projects/homelab/03-network/#deployment-overview_6","title":"Deployment Overview","text":"<p>CrowdSec analyzes logs from firewalls, web servers, containers, and authentication systems to detect behavioral anomalies. It identifies brute\u2011force attempts, scanning activity, credential stuffing, and distributed attacks using a community\u2011driven threat intelligence model. Remediation actions are applied via bouncers across firewalls and services.</p>"},{"location":"projects/homelab/03-network/#security-impact_5","title":"Security Impact","text":"<ul> <li>Detects zero\u2011day and behavioral attacks missed by signature\u2011based IDS</li> <li>Community\u2011driven blocklists provide real\u2011time global threat intelligence</li> <li>Automated remediation reduces response time</li> <li>Integrates with pfSense, NGINX, and container workloads</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_5","title":"Deployment Rationale","text":"<p>Behavior\u2011based detection is essential in modern environments where attackers use evasion techniques to bypass signature\u2011based systems. CrowdSec mirrors enterprise UEBA (User and Entity Behavior Analytics) platforms and demonstrates proficiency with log\u2011driven threat detection.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_5","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Behavioral analytics complements IDS/IPS and WAF layers Secure by Design: Automated remediation and continuous log analysis Zero Trust: No IP or user trusted without behavioral validation</p> Component Location Role CrowdSec Engine Debian LXC Log parsing, scenario evaluation, decision making CrowdSec Logger Debian LXC Structured log collection from pfSense, Suricata, SSH Remediation Bouncer pfSense Firewall Receives block decisions via LAPI, enforces at firewall Hub Collections CrowdSec Hub Pre-configured parsers and scenarios for common attack patterns <ul> <li>Engine + Logger in LXC: The CrowdSec engine is running in a lightweight container. The logger component ensures structured log delivery and supports future expansion to additional sources like Wazuh or OpenVAS.</li> <li>pfSense Remediation: The firewall bouncer on pfSense receives decisions from the LAPI and applies real-time blocks at the network edge. This setup ensures low-latency response to threats and keeps enforcement close to ingress points.</li> <li>Hub Collections: Deployment of curated collections from the CrowdSec Hub, including:         <ul> <li>Blocklists</li> <li>Scenarios (SSH brute force, port scans)</li> <li>Parsers for pfSense</li> </ul> </li> <li>LAPI Connectivity: The pfSense bouncer is authenticated via API key and successfully pulling decisions from the LAPI endpoint. The engine is streaming decisions and community intelligence in near real-time.</li> </ul>          CrowdSec Engine and Bouncer Configuration.        <p>Scenarios Enabled:</p> <ul> <li>SSH brute force detection (10 failed attempts in 60s)</li> <li>HTTP scanning and enumeration</li> <li>Port scan detection</li> <li>CVE-specific exploit attempts</li> </ul> <p>Community Intelligence:</p> <ul> <li>Shares anonymized attack signatures to global CrowdSec network</li> <li>Receives proactive blocks for IPs flagged by other CrowdSec users</li> <li>Real-time threat feed updates (&gt;1M malicious IPs maintained)</li> </ul> <p>Integration Points:</p> <ul> <li>Log Sources: pfSense (firewall logs), Suricata (IDS alerts), SSH (auth logs)</li> <li>Enforcement: Dynamic firewall rules via pfSense bouncer API</li> <li>Visibility: Decision stream visible in CrowdSec dashboard</li> </ul>          CrowdSec Engine and Remediation Setup."},{"location":"projects/homelab/03-network/#35-multi-engine-intrusion-detection-and-prevention","title":"3.5 Multi-Engine Intrusion Detection and Prevention","text":""},{"location":"projects/homelab/03-network/#layered-idsips-strategy","title":"Layered IDS/IPS Strategy","text":"Engine Vendor Deployment Location Detection Method Rule Sets Purpose Suricata OISF pfSense LAN interfaces Signature + Protocol Anomaly Emerging Threats, ET Pro Primary IPS (inline blocking) Snort Cisco/Talos pfSense VLAN interfaces Signature-based Snort Community, VRT Secondary IDS (monitoring) CrowdSec CrowdSec SAS Dedicated Debian LXC Behavioral Analytics Community scenarios + custom Brute-force/scan detection <p>Why Multiple IDS/IPS Engines?</p> <ul> <li>Evasion Resistance: Attackers design exploits to bypass specific IDS engines; multiple engines provide redundancy</li> <li>Complementary Coverage: Suricata excels at protocol analysis (HTTP, TLS, DNS deep inspection); Snort strong on signature matching; CrowdSec detects behavioral patterns (brute force, port scans)</li> <li>Reduced False Negatives: Single engine misses ~15-20% of threats; dual engines reduce miss rate to &lt;5%</li> <li>Signature Diversity: Different rule sets (Emerging Threats vs. Snort VRT) cover different threat landscapes</li> </ul>"},{"location":"projects/homelab/03-network/#4-safeline-web-application-firewall-waf","title":"4. SafeLine Web Application Firewall (WAF)","text":""},{"location":"projects/homelab/03-network/#deployment-overview_7","title":"Deployment Overview","text":"<p>SafeLine (SafePoint) is an open\u2011source, enterprise\u2011grade WAF protecting multiple web portals, including the Apache external dashboard and NGINX workloads in K3s. It provides real\u2011time threat detection, automated blocking, and protection against OWASP Top 10 vulnerabilities. SafeLine also includes bot mitigation, HTTP\u2011flood DDoS protection, and machine\u2011learning\u2011based anomaly detection.</p>"},{"location":"projects/homelab/03-network/#security-impact_6","title":"Security Impact","text":"<ul> <li>Protects against SQL injection, XSS, command injection, and path traversal</li> <li>Blocks malicious bots, credential stuffing, and scraping attempts</li> <li>Mitigates HTTP flood and application\u2011layer DDoS attacks</li> <li>Detects zero\u2011day patterns via behavioral analysis</li> <li>Adds a dedicated Layer\u20117 security boundary before backend services</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_6","title":"Deployment Rationale","text":"<ul> <li>Application Layer Protection: Provides granular inspection and filtering of HTTP/HTTPS traffic that network firewalls and IDS/IPS cannot effectively analyze</li> <li>OWASP Top 10 Coverage: Protects against SQL injection, cross-site scripting (XSS), command injection, path traversal, and other common web application vulnerabilities</li> <li>Bot Mitigation: Distinguishes between legitimate users and malicious bots, preventing automated attacks, credential stuffing, and web scraping</li> <li>DDoS Protection: Mitigates HTTP flood attacks and application-layer DDoS attempts that bypass network-level protections</li> <li>Zero-Day Defense: Utilizes machine learning and behavioral analysis to detect novel attack patterns not covered by signature-based systems</li> <li>Defense in Depth: Adds an additional security layer between the reverse proxy (Traefik) and backend applications, implementing the principle of layered security</li> <li>Compliance Requirements: Meets regulatory requirements for web application security controls (PCI DSS 6.6, HIPAA, SOC 2)</li> <li>Centralized Security Policy: Provides unified protection for multiple web applications with consistent security policies and centralized management</li> </ul>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_6","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds a Layer\u20117 security layer above firewall and IDS/IPS Secure by Design: OWASP Top 10 protections, bot filtering, and DDoS mitigation Zero Trust: Every HTTP request inspected; no implicit trust in client behavior</p>"},{"location":"projects/homelab/03-network/#component-architecture","title":"Component Architecture","text":"<p>Deployed on a Debian 13 host with an embedded Docker engine, the solution follows a microservices architecture pattern with specialized containers handling distinct security and operational functions. The platform operates on a dedicated Docker bridge network (172.22.222.0/24) with internal service-to-service communication.</p> Container Name Image IP Description safeline-chaos chaitin/safeline-chaos-g:latest 172.22.222.10 Chaos testing container used to simulate faults, stress, and unexpected conditions in the system to validate resilience and recovery strategies. safeline-detector chaitin/safeline-detector-g:latest 172.22.222.5 Detector service container responsible for monitoring traffic, analyzing patterns, and identifying potential threats or anomalies in real time. safeline-fvm chaitin/safeline-fvm-g:latest 172.22.222.8 FVM execution container that runs sandboxed function evaluations, often used for analyzing payloads or executing detection logic safely. safeline-luigi chaitin/safeline-luigi-g:latest 172.22.222.7 Luigi workflow container orchestrating background jobs, pipelines, and task dependencies for data processing and system automation. safeline-mgt chaitin/safeline-mgt-g:latest 172.22.222.4 Management interface container providing the admin dashboard, APIs, and configuration endpoints for controlling and monitoring the Safeline system. safeline-pg chaitin/safeline-postgres:15.2 172.22.222.2 Postgres database container storing persistent data such as configurations, detection logs, and case metadata for the Safeline platform. safeline-tengine chaitin/safeline-tengine-g:latest Tengine web server container acting as the reverse proxy and load balancer, handling inbound traffic and routing requests to the appropriate backend services."},{"location":"projects/homelab/03-network/#configuration-overview","title":"Configuration Overview","text":"<p>SafeLine WAF currently protects four separate web portals:</p> <ul> <li>Heimdall main lab dashboard</li> <li>Apache external lab dashboard</li> <li>Nginx web server in K3s</li> <li>Proxmox PVE admin portal</li> </ul> <p>Active protections include Intelligent web threat detection, bot and HTTP flood DDoS protection. Additional authorization via Authentik/OIDC provided where required.</p>          Safeline WAF Configuration."},{"location":"projects/homelab/03-network/#active-protection-modules","title":"Active Protection Modules","text":"<p>1. Intelligent Web Threat Detection</p> <ul> <li>SQL Injection Protection: Pattern matching and syntax analysis detecting SQL injection attempts across GET/POST parameters, headers, and cookies</li> <li>Cross-Site Scripting (XSS) Prevention: Context-aware detection of reflected, stored, and DOM-based XSS attacks</li> <li>Command Injection Defense: Identifies attempts to execute operating system commands through web application vulnerabilities</li> <li>Path Traversal Detection: Blocks directory traversal attacks attempting to access files outside the web root</li> <li>Remote File Inclusion (RFI/LFI): Prevents inclusion of malicious remote or local files</li> <li>XML External Entity (XXE) Prevention: Detects and blocks XXE injection attempts in XML parsers</li> <li>Server-Side Request Forgery (SSRF): Identifies attempts to make the server perform unintended requests</li> <li>Machine Learning Anomaly Detection: Behavioral analysis identifying zero-day attacks and novel exploitation techniques</li> </ul> <p>2. Bot and Automated Attack Protection</p> <ul> <li>Bot Classification Engine: Distinguishes between legitimate bots (search engines, monitoring tools) and malicious bots</li> <li>Credential Stuffing Prevention: Detects and blocks automated login attempts using compromised credential lists</li> <li>Account Takeover Protection: Behavioral analysis identifying suspicious authentication patterns</li> <li>Web Scraping Mitigation: Rate limiting and fingerprinting to prevent data extraction attacks</li> <li>CAPTCHA Integration: Challenge-response mechanism for suspicious sessions (future roadmap)</li> <li>JavaScript Challenge: Browser validation ensuring requests originate from legitimate browsers</li> </ul> <p>3. HTTP Flood DDoS Protection</p> <ul> <li>Connection Rate Limiting: Per-IP connection limits preventing resource exhaustion (default: 100 connections/IP)</li> <li>Request Rate Limiting: Application-level rate limiting (30-100 requests/minute depending on endpoint sensitivity)</li> <li>Slowloris Protection: Timeouts for slow HTTP attacks attempting to exhaust server connections</li> <li>HTTP GET/POST Flood Mitigation: Detects and blocks high-volume application-layer DDoS attacks</li> <li>Burst Handling: Allows legitimate traffic spikes while blocking sustained flood attacks</li> <li>Geo-Rate Limiting: Stricter rate limits for high-risk geographic regions</li> </ul>          HTTP Flood and Anti-Bot Protection.                 SQLi, Code Injection, File Inclusion, Path Traversal, XSS Protections.        <p>Offline Mode:</p>          Offline Mode.        <p>Password and OIDC Authorization:</p>          Password and OIDC Authorization."},{"location":"projects/homelab/03-network/#5-security-control-summary","title":"5. Security Control Summary","text":""},{"location":"projects/homelab/03-network/#security-control-framework","title":"Security Control Framework","text":""},{"location":"projects/homelab/03-network/#network-security-controls","title":"Network Security Controls","text":"Control Type Implementation Coverage Perimeter Defense pfSense HA cluster with IDS/IPS 100% inbound/outbound Microsegmentation OPNsense and FortiGate isolated zones Critical assets only Threat Intelligence CrowdSec + pfBlockerNG 1M+ malicious IPs blocked Intrusion Detection Suricata + Snort (dual-engine) WAN; LAN; VPN interfaces Geographic Blocking pfBlockerNG GeoIP 15+ high-risk countries VPN Privacy PIA multi-region tunnels, FortiGate VPN 192.168.100.0/24; 192.168.2.0/24 Zero Trust Access Tailscale mesh VPN + ACLs Remote administrative access Data Loss Prevention VPN kill switch floating rule Prevents cleartext fallback"},{"location":"projects/homelab/03-network/#detection-and-response-capabilities","title":"Detection and Response Capabilities","text":"<ul> <li>Real-Time Alerting: Suricata/Snort alerts forwarded to Splunk within seconds</li> <li>Automated Blocking: CrowdSec decisions enforced at firewall in &lt;5 seconds</li> <li>Signature Coverage: 40,000+ IDS rules across Suricata and Snort</li> <li>Community Intelligence: CrowdSec shares threat data with global network</li> <li>Logging Retention: 90 days in Splunk/Elastic, 30 days on firewall local storage</li> <li>Incident Response: Playbooks for common scenarios (DDoS, brute force, scanning)</li> </ul>"},{"location":"projects/homelab/03-network/#6-operational-resilience","title":"6. Operational Resilience","text":""},{"location":"projects/homelab/03-network/#operational-resilience-and-high-availability","title":"Operational Resilience and High Availability","text":""},{"location":"projects/homelab/03-network/#redundancy-architecture","title":"Redundancy Architecture","text":"Component Primary Node Secondary Node Failover Time Mechanism pfSense Firewall pfSense-01 pfSense-02 &lt;5 seconds CARP + pfsync PIA VPN Tunnels PIA_NY PIA_CA_MONT &lt;10 seconds Gateway monitoring Suricata IDS Active Active N/A Distributed CrowdSec LAPI LXC-Primary Manual failover &lt;1 minute API endpoint change"},{"location":"projects/homelab/03-network/#failure-scenarios-and-response","title":"Failure Scenarios and Response","text":"Scenario Detection Method Automated Response pfSense primary failure CARP heartbeat timeout Secondary assumes VIP; routing continues PIA VPN tunnel down Gateway ping monitoring Failover to alternate tunnel or kill switch Suricata process crash Service Watchdog package Automatic restart within 30s CrowdSec engine failure Systemd watchdog Service restart; alert to monitoring Network interface failure Link state monitoring Traffic reroutes to alternate interface"},{"location":"projects/homelab/03-network/#monitoring-and-alerting","title":"Monitoring and Alerting","text":"<ul> <li>Prometheus Node Exporter: Collects firewall metrics (CPU, memory, connection count)</li> <li>Splunk/Elastic Dashboards: Real-time visibility into blocked threats, VPN status, rule hits</li> <li>Service Watchdog: Monitors critical services (OpenVPN, Suricata, Snort, CrowdSec)</li> <li>Uptime Kuma: External health checks on firewall management interfaces</li> <li>Discord Alerts: Triggered on VPN failure, IPS signature hits (HIGH severity)</li> </ul>"},{"location":"projects/homelab/03-network/#backup-and-recovery","title":"Backup and Recovery","text":"<ul> <li>Configuration Backups: Weekly to Proxmox Backup Server and Synology NAS</li> <li>Disaster Recovery: Restore from backup to new VM in &lt;15 minutes</li> <li>Change Management: Version control for rule sets via Git repository</li> </ul>"},{"location":"projects/homelab/03-network/#7-use-cases-and-deployment-scenarios","title":"7. Use Cases and Deployment Scenarios","text":""},{"location":"projects/homelab/03-network/#practical-use-cases","title":"Practical Use Cases","text":""},{"location":"projects/homelab/03-network/#scenario-1-privacy-enhanced-web-browsing","title":"Scenario 1: Privacy-Enhanced Web Browsing","text":"<p>Objective: Anonymize lab traffic and prevent ISP tracking</p> <p>Implementation:</p> <ul> <li>User traffic from 192.168.100.0/24 \u2192 pfSense LAN \u2192 PIA VPN \u2192 Internet</li> <li>Policy-based routing ensures all HTTP/HTTPS uses encrypted tunnel</li> <li>Kill switch prevents accidental cleartext transmission</li> <li>Geolocation appears as VPN endpoint (New York or Montreal)</li> </ul> <p>Result: ISP sees only encrypted VPN tunnel, not individual browsing sessions</p>"},{"location":"projects/homelab/03-network/#scenario-2-remote-lab-access-while-traveling","title":"Scenario 2: Remote Lab Access While Traveling","text":"<p>Objective: Securely access lab infrastructure from untrusted networks</p> <p>Implementation:</p> <ul> <li>Laptop connects to Tailscale mesh VPN (WireGuard)</li> <li>Traffic routed through pfSense TSCALE interface</li> <li>ACLs restrict access to management subnets only</li> </ul> <p>Result: Zero-trust remote access without exposed public IPs or open firewall ports</p>"},{"location":"projects/homelab/03-network/#scenario-3-threat-intelligence-sharing-and-automated-response","title":"Scenario 3: Threat Intelligence Sharing and Automated Response","text":"<p>Objective: Leverage community threat data for proactive blocking</p> <p>Implementation:</p> <ul> <li>CrowdSec engine analyzes logs from pfSense, Suricata, SSH</li> <li>Detects brute force attempt on SSH (10 failed logins in 60s)</li> <li>Decision sent to pfSense bouncer via LAPI</li> <li>IP immediately blocked at firewall, shared with CrowdSec community</li> </ul> <p>Result: Lab benefits from global threat intelligence; contributes to community defense</p>"},{"location":"projects/homelab/03-network/#scenario-4-multi-region-content-testing","title":"Scenario 4: Multi-Region Content Testing","text":"<p>Objective: Test geo-restricted services from different regions</p> <p>Implementation:</p> <ul> <li>Policy-based routing sends test traffic to PIA_NY or PIA_CA_MONT</li> <li>Applications see requests originating from US or Canada</li> <li>Used for CDN behavior testing, regional service validation</li> </ul> <p>Result: Simulates distributed user base without physical infrastructure in multiple regions</p>"},{"location":"projects/homelab/03-network/#8-threat-modeling","title":"8. Threat Modeling","text":""},{"location":"projects/homelab/03-network/#threat-landscape-and-mitigation-strategy","title":"Threat Landscape and Mitigation Strategy","text":""},{"location":"projects/homelab/03-network/#threats-addressed","title":"Threats Addressed","text":"Threat Category Attack Vectors Mitigation Controls Network Reconnaissance Port scans; host enumeration Suricata port scan detection; pfBlockerNG Brute Force Attacks SSH; web panel login abuse CrowdSec behavioral detection; fail2ban integration; Key-based authentication for endpoints; WAF bot-credential stuffing prevention Malware C2 Communication Botnet callbacks pfBlockerNG IP reputation; IDS signatures Data Exfiltration Unauthorized outbound traffic Egress filtering; VPN kill switch Man-in-the-Middle ARP spoofing; SSL stripping Encrypted tunnels (VPN; Tailscale) DDoS / Resource Exhaustion High-volume flood attacks Connection limits; SYN flood protection; WAF HTTP flood prevention Lateral Movement Post-compromise pivoting Microsegmentation (OPNsense); VLAN isolation Zero-Day Exploits Unknown vulnerabilities Multi-engine IDS (overlapping signatures) Web Application Exploits SQL injection, XSS, XXE, command injection, LDAP injection, template injection OWASP ModSecurity CRS rules; ML-based anomaly detection; input validation enforcement; output encoding verification Bot Attacks Web scraping, automated account creation, inventory hoarding, content theft, fake account registration Bot fingerprinting; JavaScript challenge; CAPTCHA integration; behavioral analysis; rate limiting per user-agent pattern Server-Side Request Forgery (SSRF) Internal network reconnaissance, cloud metadata access, backend service exploitation URL validation; whitelist of allowed domains; blocking private IP ranges; DNS rebinding protection Directory Traversal Path manipulation, file system access, configuration file disclosure Path normalization; restricted file access; chroot enforcement; symbolic link traversal prevention XML/JSON Attacks Billion Laughs attack, entity expansion, JSON injection, XML bomb Entity expansion limits; recursive depth restrictions; parser hardening; size limits Protocol Manipulation HTTP request smuggling, header injection, response splitting, HTTP/2 desync HTTP protocol validation; header sanitization; request/response consistency checks"},{"location":"projects/homelab/03-network/#attack-surface-reduction","title":"Attack Surface Reduction","text":"<ul> <li>No exposed public services (all ingress via Cloudflare Tunnel or Tailscale)</li> <li>Default-deny firewall/WAF posture on all interfaces</li> <li>Geo-blocking of high-risk countries</li> <li>Regular vulnerability scanning of exposed services</li> <li>Minimal services running on hosts</li> </ul>"},{"location":"projects/homelab/03-network/#9-privacy-and-remote-access-architecture","title":"9. Privacy and Remote Access Architecture","text":""},{"location":"projects/homelab/03-network/#deployment-overview_8","title":"Deployment Overview","text":"<p>The privacy and remote access architecture implements layered VPN, zero\u2011trust access, and anonymization technologies to protect outbound traffic, secure inbound access, and preserve user privacy. Private Internet Access (PIA) provides encrypted egress and IP obfuscation, Tailscale delivers authenticated zero\u2011trust remote access, Cloudflare Tunnels expose internal services securely without opening firewall ports, and Tor enables anonymous outbound browsing. Together, these systems create a defense\u2011in\u2011depth privacy model that maintains operational visibility while preventing unauthorized access or data exposure.</p>"},{"location":"projects/homelab/03-network/#security-impact_7","title":"Security Impact","text":"<ul> <li>Encrypted outbound traffic prevents ISP monitoring and metadata collection</li> <li>Zero\u2011trust remote access ensures only authenticated devices and identities can reach internal services</li> <li>Cloudflare Tunnels eliminate the need for public IP exposure or port forwarding</li> <li>Tor provides anonymized browsing for research and threat intelligence</li> <li>Centralized DNS, tunneling, and identity enforcement reduce attack surface</li> <li>Policy\u2011based routing ensures sensitive applications always use encrypted egress</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_7","title":"Deployment Rationale","text":"<p>Modern environments require privacy\u2011preserving egress, secure remote access, and controlled service exposure. This architecture mirrors enterprise zero\u2011trust designs where VPNs, identity\u2011aware proxies, and encrypted tunnels work together to protect both inbound and outbound traffic. The combination of PIA, Tailscale, Cloudflare, and Tor demonstrates proficiency with encrypted transport, NAT traversal, identity\u2011based access control, and anonymization technologies.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_7","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Multiple privacy layers (VPN \u2192 Zero\u2011Trust \u2192 Tunnel \u2192 Anonymization) Secure by Design: Encrypted tunnels, identity\u2011based access, no exposed ports Zero Trust: Every remote connection authenticated; no implicit trust in network location</p>"},{"location":"projects/homelab/03-network/#91-private-internet-access-pia-encrypted-egress-vpn","title":"9.1 Private Internet Access (PIA) Encrypted Egress VPN","text":""},{"location":"projects/homelab/03-network/#deployment-overview_9","title":"Deployment Overview","text":"<p>PIA provides encrypted outbound VPN tunneling using OpenVPN with AES\u2011256 encryption and SHA256 authentication. It masks the lab's public\u2011facing identity, supports multi\u2011hop routing, and enables region\u2011based egress selection. PIA is configured directly on the pfSense firewalls and serves as the default outbound path for the 192.168.100.0/24 and 192.168.2.0/24 networks. Policy\u2011based routing ensures selected applications always use the VPN tunnel.</p>"},{"location":"projects/homelab/03-network/#security-impact_8","title":"Security Impact","text":"<ul> <li>Prevents ISP logging of DNS queries, browsing history, and outbound traffic</li> <li>Obfuscates public IP, reducing exposure to targeted attacks</li> <li>Multi\u2011hop routing increases anonymity and complicates traffic correlation</li> <li>Encrypted tunnels protect data in transit from interception</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_8","title":"Deployment Rationale","text":"<p>Encrypted egress is essential for privacy\u2011sensitive environments and aligns with enterprise practices where outbound traffic is anonymized or routed through secure gateways. PIA provides a stable, commercial\u2011grade VPN solution with strong encryption and global exit nodes.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_8","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds encrypted egress beneath firewall and IDS/IPS layers Secure by Design: AES\u2011256 encryption, SHA256 authentication, OpenVPN tunneling Zero Trust: No outbound traffic trusted without encryption and policy enforcement</p> <p>Use Case:</p> <ul> <li>ISP Privacy: Prevents ISP from logging DNS queries, browsing history, torrent activity</li> <li>Geolocation Obfuscation: Appears to originate from VPN exit node location (useful for testing geolocation-based access controls)</li> </ul> <p>Integration Notes:</p> <ul> <li>PIA is configured on the pfSense firewalls and configured as the default egress for 192.168.100.0/24 and 192.168.2.0/24 traffic.</li> <li>Traffic from selected applications is routed through PIA using policy-based routing.</li> <li>Encryption protocols: AES-256 and SHA256 authentication</li> </ul>"},{"location":"projects/homelab/03-network/#92-tailscale-zero-trust-remote-access","title":"9.2 Tailscale Zero Trust Remote Access","text":""},{"location":"projects/homelab/03-network/#deployment-overview_10","title":"Deployment Overview","text":"<p>Tailscale provides secure, identity\u2011based remote access using a WireGuard mesh VPN. It enables seamless NAT traversal, device\u2011level ACLs, and OAuth/OIDC authentication. MagicDNS provides internal name resolution across the Tailscale network. Tailscale is deployed on key lab VMs and used for remote SSH, dashboard access, and secure file transfers.</p>"},{"location":"projects/homelab/03-network/#security-impact_9","title":"Security Impact","text":"<ul> <li>Identity\u2011based access ensures only authorized users and devices can connect</li> <li>WireGuard (ChaCha20\u2011Poly1305) provides high\u2011performance encrypted tunnels</li> <li>NAT traversal eliminates the need for exposed ports</li> <li>Audit logs track session activity for governance and incident response</li> </ul>"},{"location":"projects/homelab/03-network/#integration-notes","title":"Integration Notes:","text":"<ul> <li>Tailscale is deployed on key lab VMs</li> <li>Used for remote SSH, dashboard access, and secure file transfers.</li> <li>WireGuard / ChaCha20-Poly1305 encryption</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_9","title":"Deployment Rationale","text":"<p>Tailscale mirrors enterprise zero\u2011trust remote access solutions by replacing traditional VPN concentrators with identity\u2011aware, device\u2011bound tunnels. It simplifies remote connectivity while enforcing strong authentication and granular access control.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_9","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds identity\u2011based access on top of encrypted tunnels Secure by Design: WireGuard encryption, OAuth/OIDC authentication, device ACLs Zero Trust: Every connection authenticated; no implicit trust in IP or location</p>          Tailscale Configured Devices.        <p>Tailscale Use Cases:</p> <ul> <li>Remote Lab Access: Securely access Grafana, Portainer, SSH from anywhere without exposing ports</li> <li>Site-to-Site Connectivity: Connect home lab to cloud VMs for hybrid deployments</li> <li>Ephemeral Access: Generate one-time-use keys for contractors/guests</li> </ul>"},{"location":"projects/homelab/03-network/#93-cloudflare-secure-service-exposure-and-dns-management","title":"9.3 Cloudflare Secure Service Exposure and DNS Management","text":""},{"location":"projects/homelab/03-network/#deployment-overview_11","title":"Deployment Overview","text":"<p>Cloudflare Tunnels provide secure, authenticated inbound access to internal services without exposing public IPs or opening firewall ports. Cloudflare acts as a reverse proxy with TLS termination, identity\u2011aware access control, and automatic failover. Cloudflare also manages public DNS for shadowitlab.com, dynamic DNS updates, and S3\u2011compatible object storage via R2.</p>"},{"location":"projects/homelab/03-network/#security-impact_10","title":"Security Impact","text":"<ul> <li>Eliminates need for inbound port forwarding</li> <li>TLS\u2011encrypted tunnels protect dashboards, APIs, and UIs</li> <li>Cloudflare Access enforces identity\u2011based service gating</li> <li>Dynamic DNS ensures stable service resolution despite WAN IP changes</li> <li>R2 object storage provides secure, globally accessible file hosting</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_10","title":"Deployment Rationale","text":"<p>Cloudflare Tunnels mirror enterprise zero\u2011trust access patterns where applications are published through identity\u2011aware proxies rather than exposed directly. DNS centralization and automated DDNS updates ensure reliable service access.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_10","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Tunnel layer sits above firewall and VPN protections Secure by Design: TLS termination, identity\u2011aware access, no open ports Zero Trust: Every inbound request authenticated and authorized</p>"},{"location":"projects/homelab/03-network/#public-domain-and-dns-management","title":"Public Domain and DNS Management","text":"<ul> <li>Primary Domain: shadowitlab.com is registered and managed via Cloudflare, enabling centralized control over DNS, security policies, and tunneling endpoints.</li> <li>Dynamic DNS Resilience:</li> <li>A Dockerized Cloudflare DDNS client monitors the WAN IP assigned by Verizon Fios.</li> <li>On IP change, the client automatically updates the A record in Cloudflare using API integration.</li> <li>This ensures persistent domain resolution despite dynamic IP churn, enabling stable access to exposed services.</li> </ul>          Cloudflare DNS Management."},{"location":"projects/homelab/03-network/#object-storage-and-file-sharing","title":"Object Storage and File Sharing","text":"<ul> <li>Cloudflare R2 Bucket: Used for lightweight, S3-compatible object storage.</li> <li>Public Access Endpoint: files.shadowitlab.com</li> </ul>"},{"location":"projects/homelab/03-network/#secure-service-exposure-via-cloudflare-tunnel","title":"Secure Service Exposure via Cloudflare Tunnel","text":"<p>Each internal service is mapped to a dedicated Cloudflare Tunnel endpoint under the shadowitlab.com domain. TLS termination, routing, and access control are handled by Cloudflare's Argo Tunnel technology. This enables secure, high\u2011availability access to internal dashboards, APIs, and management interfaces.</p> <p>Webserver Tunnel</p> <ul> <li>Endpoint: web.shadowitlab.com</li> <li>Purpose: Hosts static and dynamic content for lab documentation and dashboards.</li> </ul> <p>Traefik Tunnel</p> <ul> <li>Endpoint: trfk.shadowitlab.com</li> <li>Purpose: Acts as a reverse proxy and ingress controller for DockerVM1 services.</li> <li>Features: TLS passthrough, service routing, and dashboard access.</li> </ul> <p>Proxmox Tunnel</p> <ul> <li>Endpoint: pve.shadowitlab.com</li> <li>Purpose: Provides secure access to the Proxmox VE UI for VM and container orchestration.</li> </ul> <p>DockerVM1 Tunnel</p> <p>This tunnel multiplexes several key services hosted on DockerVM1:</p> Subdomain Service Description portainer.shadowitlab.com Portainer UI for container and K3s workload management pulse.shadowitlab.com Uptime monitoring and alerting dashboard checkmk.shadowitlab.com Infrastructure monitoring and metrics aggregation piholebk.shadowitlab.com Backup Pi-hole instance for DNS filtering prom.shadowitlab.com Prometheus metrics endpoint wud.shadowitlab.com Watchtower UI for Docker image update visibility          Cloudflared Tunnel Configuration.        <p>Use Case:</p> <ul> <li>Public Demo: Showcase Grafana dashboards to potential employers without exposing lab IP</li> <li>API Access: Provide external services (webhooks, monitoring checks) access to internal APIs</li> <li>Failover Access: If Tailscale fails, Cloudflare Tunnels provide backup remote access</li> </ul>"},{"location":"projects/homelab/03-network/#94-tor-browser-anonymous-outbound-browsing","title":"9.4 Tor Browser Anonymous Outbound Browsing","text":""},{"location":"projects/homelab/03-network/#deployment-overview_12","title":"Deployment Overview","text":"<p>Tor provides anonymized web browsing by routing traffic through a decentralized network of volunteer\u2011operated nodes. It is installed on a sandboxed VM with no persistent storage and used exclusively for outbound browsing. No inbound Tor services (hidden services) are hosted.</p>"},{"location":"projects/homelab/03-network/#security-impact_11","title":"Security Impact","text":"<ul> <li>Prevents tracking, fingerprinting, and metadata collection</li> <li>Enables privacy\u2011sensitive research and threat intelligence gathering</li> <li>Bypasses geo\u2011restrictions and censorship</li> <li>Sandboxed VM prevents persistence or cross\u2011system contamination</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-rationale_11","title":"Deployment Rationale","text":"<p>Tor is widely used in security research, OSINT, and threat intelligence workflows. Running it in a disposable VM mirrors enterprise practices for isolating high\u2011risk browsing environments.</p>"},{"location":"projects/homelab/03-network/#architecture-principles-alignment_11","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Sandboxed VM isolates Tor from production systems Secure by Design: No persistent storage; outbound\u2011only usage Zero Trust: No trust in external nodes; isolation prevents lateral movement</p>"},{"location":"projects/homelab/03-network/#10-summary","title":"10. Summary","text":""},{"location":"projects/homelab/03-network/#multi-layered-vpn-and-zero-trust-access","title":"Multi-Layered VPN and Zero-Trust Access","text":"Technology Use Case Protocol Encryption Trust Model Private Internet Access (PIA) Egress privacy (hide ISP visibility) OpenVPN AES-256 Commercial VPN provider Tailscale Remote access to lab (peer-to-peer) WireGuard ChaCha20-Poly1305 Zero-trust mesh VPN Cloudflare Tunnels Inbound service access (no open ports) QUIC (HTTP/3) TLS 1.3 Cloudflare edge network Tor Browser Anonymous browsing (threat research) Tor (onion routing) Multi-layer encryption Tor network"},{"location":"projects/homelab/03-network/#security-controls","title":"Security Controls","text":"<ul> <li>Split-tunnel policy prevents VPN leakage</li> <li>Tailscale ACLs enforce least-privilege access per device/user</li> <li>Cloudflare Access policies require MFA for administrative endpoints</li> <li>Tor VM operates in ephemeral mode with no disk persistence</li> <li>DNS queries flow through Pi-hole for ad-blocking and threat intelligence</li> </ul>"},{"location":"projects/homelab/03-network/#operational-resilience","title":"Operational Resilience","text":"<ul> <li>Cloudflare DDNS automation ensures 99.9% domain availability</li> <li>Prometheus + CheckMK provide real-time health monitoring</li> <li>Uptime Kuma alerts on tunnel/service degradation</li> <li>Automated container updates via Watchtower with rollback capability</li> </ul>"},{"location":"projects/homelab/03-network/#deployment-scenarios","title":"Deployment Scenarios","text":"<ul> <li>Remote administration: Tailscale \u2192 SSH/Proxmox access from mobile devices</li> <li>Public service hosting: Cloudflare Tunnel \u2192 web.shadowitlab.com (no exposed ports)</li> <li>Threat research: Tor Browser on isolated VM \u2192 anonymous OSINT gathering</li> <li>Content access: PIA multi-hop \u2192 region-specific service testing</li> </ul>"},{"location":"projects/homelab/03-network/#11-custom-ipsids-ruleset-additional-detail","title":"11. Custom IPS/IDS Ruleset \u2013 Additional Detail","text":""},{"location":"projects/homelab/03-network/#ssh-linux-security-controls_1","title":"SSH / Linux Security Controls","text":""},{"location":"projects/homelab/03-network/#ssh-brute-force-detection_1","title":"SSH Brute Force Detection","text":"<p>Rule <pre><code>alert tcp any any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: SSH Brute Force Attempt\"; flags:S; detection_filter:track by_src, count 5, seconds 60; sid:910001; rev:2;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>alert</code> Generate an alert when matched Visible in Suricata \u2192 Elastic/Wazuh <code>tcp</code> Match only TCP traffic SSH is TCP based <code>any any</code> Any source IP, any source port Detects brute force from anywhere <code>-&gt;</code> Direction operator Only inbound SSH attempts <code>192.168.100.0/24 22</code> Destination network + port LAB1 SSH servers <code>flags:S</code> Match SYN packets only Prevents noisy alerts from full SSH sessions <code>detection_filter: track by_src, count 5, seconds 60</code> Threshold: 5 SYNs in 60 seconds from same IP Classic brute force pattern <code>sid:910001</code> Unique rule ID Required for management <code>rev:2</code> Revision number Tracks rule updates <p>Operational Impact</p> <ul> <li>Detects brute force attempts before authentication begins</li> <li>Low noise due to SYN only matching</li> <li>Helps identify compromised hosts or bots scanning SSH</li> <li>Works across VLAN boundaries</li> </ul>"},{"location":"projects/homelab/03-network/#cross-segment-ssh-policy-enforcement","title":"Cross Segment SSH Policy Enforcement","text":"<p>Rule <pre><code>alert tcp 192.168.2.0/24 any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: SSH Attempt from EXT_LAN\"; sid:910002; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>192.168.2.0/24</code> EXT_LAN source DMZ/External facing internal network <code>-&gt; 192.168.100.0/24 22</code> SSH into LAB1 Not allowed by segmentation policy <code>msg</code> Alert message Clear policy violation <code>sid</code> Rule ID Tracking <code>rev</code> Revision Versioning <p>Operational Impact</p> <ul> <li>Detects lateral movement attempts from DMZ \u2192 LAB</li> <li>Enforces segmentation boundaries</li> <li>Helps identify compromised DMZ hosts attempting privilege escalation</li> </ul>"},{"location":"projects/homelab/03-network/#privilege-escalation-keyword-monitoring","title":"Privilege Escalation Keyword Monitoring","text":"<p>Rule <pre><code>alert tcp any any -&gt; 192.168.100.0/24 22 \\\n(msg:\"LAB1: sudo Keyword in SSH Session\"; content:\"sudo\"; sid:910003; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>content:\"sudo\"</code> Look for the string \"sudo\" in SSH payload Detects privilege escalation attempts <code>tcp</code> SSH is TCP Required <code>any any</code> Any source Global monitoring <code>-&gt; 192.168.100.0/24 22</code> SSH into LAB1 Target zone <p>Operational Impact</p> <ul> <li>Detects sudo usage inside SSH sessions</li> <li>Useful for insider threat monitoring</li> <li>Helps identify suspicious privilege escalation attempts</li> <li>Works best when SSH is not encrypted (lab/testing only)</li> </ul>"},{"location":"projects/homelab/03-network/#reconnaissance-scanning-detection_1","title":"Reconnaissance &amp; Scanning Detection","text":""},{"location":"projects/homelab/03-network/#nmap-os-detection-signature","title":"Nmap OS Detection Signature","text":"<p>Rule <pre><code>alert tcp any any -&gt; 192.168.100.0/24 any \\\n(msg:\"LAB1: Nmap OS Detection Scan\"; content:\"|4E 4D 41 50|\"; sid:910004; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>content:\"\\|4E 4D 41 50\\|\"</code> Hex for \"NMAP\" Matches Nmap OS detection probes <code>any any</code> Any source Detects internal or external recon <code>-&gt; 192.168.100.0/24 any</code> Any port OS detection uses multiple ports <p>Operational Impact</p> <ul> <li>Detects active reconnaissance</li> <li>Identifies compromised hosts performing mapping</li> <li>Useful for early stage intrusion detection</li> </ul>"},{"location":"projects/homelab/03-network/#behavioral-port-sweep-detection","title":"Behavioral Port Sweep Detection","text":"<p>Rule <pre><code>alert tcp 192.168.100.0/24 any -&gt; 192.168.1.0/24 any \\\n(msg:\"LAB1: LAB \u2192 PROD Port Scan\"; flags:S; threshold:type both, track by_src, count 20, seconds 10; sid:900008; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>flags:S</code> SYN packets only Detects scan attempts, not full sessions <code>threshold:type both</code> Count both directions More accurate scan detection <code>track by_src</code> Track per source IP Identifies scanning host <code>count 20 seconds 10</code> 20 SYNs in 10 seconds Classic port sweep behavior <code>192.168.100.0/24 -&gt; 192.168.1.0/24</code> LAB \u2192 PROD Enforces segmentation <p>Operational Impact</p> <ul> <li>Detects port sweeps from LAB \u2192 PROD</li> <li>Helps identify malware propagation attempts</li> <li>Low false positives due to SYN only matching</li> </ul>"},{"location":"projects/homelab/03-network/#lateral-movement-prevention_1","title":"Lateral Movement Prevention","text":""},{"location":"projects/homelab/03-network/#high-risk-port-access-attempt","title":"High Risk Port Access Attempt","text":"<p>Rule <pre><code>alert tcp 192.168.200.0/24 any -&gt; 192.168.1.0/24 [22,135,139,445,3389] \\\n(msg:\"LAB2: LAB \u2192 PROD Unauthorized High-Risk Port\"; sid:920005; rev:3;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>192.168.200.0/24</code> LAB2 Lower trust zone <code>-&gt; 192.168.1.0/24</code> PROD High trust zone <code>[22,135,139,445,3389]</code> SSH, RPC, NetBIOS, SMB, RDP Classic lateral movement ports <code>msg</code> Clear violation message SOC visibility <code>sid</code> Rule ID Tracking <code>rev</code> Revision Versioning <p>Operational Impact</p> <ul> <li>Detects attempts to pivot into PROD</li> <li>Flags malware using SMB/RDP propagation</li> <li>Enforces strict trust boundaries</li> </ul>"},{"location":"projects/homelab/03-network/#isolation-network-enforcement","title":"Isolation Network Enforcement","text":"<p>Rule <pre><code>alert ip [10.20.0.0/24,192.168.3.0/24] any -&gt; 192.168.200.0/24 any \\\n(msg:\"LAB2: ISO \u2192 LAB2 Traffic (Policy Violation)\"; sid:920006; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>alert ip</code> Match any protocol Covers TCP, UDP, ICMP, etc. <code>[10.20.0.0/24,192.168.3.0/24]</code> ISO networks Quarantined/isolated zones <code>-&gt; 192.168.200.0/24</code> LAB2 Should never communicate <code>any</code> Any port Full isolation enforcement <p>Operational Impact</p> <ul> <li>Detects policy violations from isolated networks</li> <li>Helps identify misconfigured hosts or malware breakout attempts</li> <li>Ensures ISO networks remain fully contained</li> </ul>"},{"location":"projects/homelab/03-network/#smb-netbios-hygiene_1","title":"SMB / NetBIOS Hygiene","text":""},{"location":"projects/homelab/03-network/#netbios-session-service-detection","title":"NetBIOS Session Service Detection","text":"<p>Rule <pre><code>alert tcp any any -&gt; any 139 \\\n(msg:\"NetBIOS Session Service Detected\"; sid:9xxxxx; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>port 139</code> NetBIOS Session Service Legacy Windows protocol <code>any any -&gt; any</code> Global detection Hygiene monitoring <p>Operational Impact</p> <ul> <li>Detects legacy SMB/NetBIOS traffic</li> <li>Useful for identifying outdated systems</li> <li>Helps enforce modern SMB hygiene</li> </ul>"},{"location":"projects/homelab/03-network/#smbv1-protocol-negotiation-detection","title":"SMBv1 Protocol Negotiation Detection","text":"<p>Rule <pre><code>alert tcp any any -&gt; any 445 \\\n(msg:\"SMBv1 Protocol Negotiation\"; content:\"|ff|SMB\"; depth:8; sid:9xxxxx; rev:1;)\n</code></pre></p> <p>Field Breakdown</p> Field Meaning Impact <code>port 445</code> SMB Modern SMB port <code>content:\"\\|ff\\|SMB\"</code> SMBv1 signature Detects deprecated protocol <code>depth:8</code> Only inspect first 8 bytes Performance optimization <p>Operational Impact</p> <ul> <li>Detects SMBv1 usage (deprecated, insecure)</li> <li>Helps enforce compliance and hygiene</li> <li>Identifies vulnerable hosts susceptible to EternalBlue class exploits</li> </ul>"},{"location":"projects/homelab/03-network/#12-security-homelab-section-links","title":"12. Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware </li> <li>Network Security, Privacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/","title":"Identity, Access, Secrets and Trust Management","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/04-iam-secrets/#1-architecture-overview","title":"1. Architecture Overview","text":"<p>A comprehensive zero-trust identity architecture combines hierarchical Public Key Infrastructure (PKI), centralized authentication (SSO/MFA), enterprise directory services (Active Directory), and encrypted secrets management (Vaultwarden) to provide defense-in-depth identity controls. This multi-layered approach ensures every user, device, and service is continuously authenticated, authorized, and audited across the entire infrastructure stack.</p> <p>Security Impact</p> <ul> <li>Centralized identity eliminates password sprawl and reduces credential-stuffing risk</li> <li>MFA enforcement prevents compromised passwords from granting unauthorized access</li> <li>Hierarchical PKI provides cryptographic trust anchors for TLS/mTLS</li> <li>Offline root CA protects high-value signing keys from online attacks</li> <li>Automated certificate lifecycle management prevents outages caused by expired certificates</li> <li>Encrypted secrets vault centralizes sensitive data with zero-knowledge encryption</li> </ul> <p>Deployment Rationale</p> <p>Enterprise environments deploy similar architectures where Active Directory manages Windows domain authentication, OAuth2/OIDC provides SSO for web applications, PKI issues certificates for TLS encryption, and password managers centralize secrets. This lab demonstrates hands-on proficiency with protocols used in Fortune 500 identity stacks (LDAP, Kerberos, OAuth2, OIDC, SAML, ACME) and modern zero-trust patterns (continuous verification, least-privilege access, encrypted communications). The separation of concerns (PKI, SSO, directory, secrets) provides defense-in-depth where compromise of one system doesn't expose all identity data.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Multiple authentication factors (password + TOTP), separate trust domains (AD for Windows, Authentik for web), offline root CA isolation</li> <li>Secure by Design: Mandatory TLS via PKI, MFA enforced by default, secrets encrypted at rest with zero-knowledge encryption</li> <li>Zero Trust: Every request authenticated (SSO/MFA); certificates verify service identity (mutual TLS); no implicit trust based on network location</li> </ul> <p>Diagram Placeholder: Identity Architecture Overview (2 images)</p>"},{"location":"projects/homelab/04-iam-secrets/#2-pkicertificate-authority-configuration","title":"2. PKI/Certificate Authority Configuration","text":""},{"location":"projects/homelab/04-iam-secrets/#21-overview-and-hierarchy","title":"2.1 Overview and Hierarchy","text":"<p>       The lab PKI follows a two-tier architecture with an offline root CA and an online intermediate CA powered by StepCA. The offline root CA acts as the long-term trust anchor, while the intermediate CA handles day-to-day certificate issuance for internal services, Kubernetes workloads, web applications, and mTLS-enabled components.     </p>          Lab PKI Overview / StepCA Chain of Trust        <p>Security Impact</p> <ul> <li>Offline root CA prevents exposure of high-value signing keys</li> <li>Intermediate CA enables automated certificate issuance and rotation</li> <li>TLS/mTLS ensures encrypted communication and service identity validation</li> <li>PKI-backed trust anchors support zero-trust service-to-service authentication</li> </ul> <p>Deployment Rationale</p> <p>A two-tier PKI mirrors enterprise best practices by separating long-term trust from operational issuance. This design minimizes root CA exposure, simplifies certificate lifecycle management, and supports automated issuance through ACME/StepCA for Kubernetes, web services, and internal APIs.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Root and intermediate CAs form layered trust boundaries</li> <li>Secure by Design: Automated certificate rotation prevents outages and stale credentials</li> <li>Zero Trust: Certificates validate every service identity; no implicit trust in network location</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#22-pki-architecture-and-roles","title":"2.2 PKI Architecture and Roles","text":"Tier Host/IP Role Key Functions Offline Root CA 192.168.100.50 Trust Anchor Signs Intermediate CA certificate; stored offline StepCA (Intermediate CA) 192.168.100.51 Online Issuer Issues leaf certificates via ACME or manual process; enforces policy ACME Clients Various Certificate Consumers Request certificates via ACME protocol (e.g., Traefik, Vaultwarden, NGINX) Active Directory Certificate Services 192.168.1.142 AD Auto-enroll Computer and User auto-enroll domain services. Isolated RootCA <p>Root CA Configuration</p> <ul> <li>Platform: Debian 12 LXC container (stopped when not in use)</li> <li>Software: OpenSSL 3.0.x</li> <li>Key Type: ECC P-384 (modern alternative)</li> <li>Storage: Private key encrypted with AES-256</li> <li>Access Control: Root key file permissions set to 0400 (read-only by owner)</li> <li>Lifecycle: Used only for signing intermediate CA cert and CRL generation</li> <li>Validity: 20 years (root), 10 years (intermediate)</li> </ul> <p>Security Hardening</p> <ul> <li>Root CA container only powered on during signing operations</li> <li>Private key passphrase stored in Vaultwarden, never saved to disk</li> <li>Regular backups</li> </ul> <p>StepCA Intermediate CA</p> <ul> <li>Platform: Debian 12 LXC container (always online)</li> <li>Software: Smallstep Step-CA v0.25.x</li> <li>Endpoints:</li> <li>ACME: https://stepca.home.com/acme/acme/directory</li> <li>Admin API: https://stepca.home.com (mTLS authentication)</li> <li>Key Type: ECC P-256 (default for leaf certificates)</li> <li>Validity Periods:</li> <li>Default: 24 hours (short-lived for automated rotation)</li> <li>Max: 1 year (for services requiring longer validity)</li> </ul> <p>Certificate Lifecycle Management</p> Phase Automation Frequency Initial Request ACME client (Traefik, certbot) On-demand Issuance StepCA auto-validates domain &lt;5 seconds Renewal Traefik automatic renewal 30 days before expiry Revocation Manual via step-ca CLI As needed CRL Updates StepCA generates CRL Daily"},{"location":"projects/homelab/04-iam-secrets/#23-trust-chain-and-workflow","title":"2.3 Trust Chain and Workflow","text":"<ol> <li>Root CA is created offline and used to sign the Intermediate CA certificate. The RootCA was configured as an LXC running Debian Linux, Certificate was created using OpenSSL.</li> <li>StepCA runs online and handles certificate requests via ACME. StepCA is also running in a Debian-based LXC.</li> <li>ACME Clients authenticate and request certificates for their FQDNs.</li> <li>Leaf certificates are issued with appropriate X.509 extensions and validity periods.</li> <li>Clients and services trust the Intermediate CA, which chains up to the RootCA.</li> </ol>"},{"location":"projects/homelab/04-iam-secrets/#24-x509-certificate-profile","title":"2.4 X.509 Certificate Profile","text":""},{"location":"projects/homelab/04-iam-secrets/#general-attributes","title":"General Attributes","text":"Field Value Version X.509 v3 Signature Algorithm ecdsa-with-SHA256 Issuer O=Intermediate CA - Leone Lab, CN=Intermediate CA - Leone Lab Intermediate CA Subject CN=[servername].home.com Validity 1 year Public Key Algorithm id-ecPublicKey (Elliptic Curve Cryptography) Key Size 256-bit Curve prime256v1 (NIST P-256) Key Usage Digital Signature (critical) Extended Key Usage TLS Web Server Authentication; TLS Web Client Authentication Subject Alternative Name (SAN) DNS:servername.home.com"},{"location":"projects/homelab/04-iam-secrets/#subject-public-key-info","title":"Subject Public Key Info","text":"<ul> <li>Algorithm: id-ecPublicKey (Elliptic Curve Cryptography)</li> <li>Key Size: 256-bit</li> <li>Curve: prime256v1 (NIST P-256)</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#x509v3-extensions","title":"X.509v3 Extensions","text":"Extension Value Key Usage Digital Signature (critical) Extended Key Usage TLS Web Server Authentication, TLS Web Client Authentication Subject Alternative Name (SAN) DNS:[servername].home.com, home.com"},{"location":"projects/homelab/04-iam-secrets/#25-operational-considerations","title":"2.5 Operational Considerations","text":"<p>Diagram Placeholder: Root CA Security Screenshot</p> <p>Root CA Security</p> <ul> <li>Stored offline (air-gapped)</li> <li>Used only to sign Intermediate CA</li> <li>Private key protected with strong passphrase</li> </ul> <p>StepCA Configuration</p> <ul> <li>Runs as a systemd service on 192.168.100.51</li> <li>ACME endpoint exposed to internal clients</li> <li>Policy templates enforce:</li> <li>Allowed domains (*.home.com)</li> <li>Validity periods</li> <li>Key types (ECC and RSA)</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#26-active-directory-certificate-services","title":"2.6 Active Directory Certificate Services","text":"<p>Windows 2025 Server, dc02.home.com configured as the domain enterpriseCA supporting local AD auto-enrollment.</p> <p>User and Computer home.com templates supporting domain auto-enrollment. Computer/policies/Windows settings/security settings/public key policies/certificate services client-auto-enrollment/Enabled in the default domain policy.</p>          Issued Certificates / Template Information.        <p>Certificate Details Trusted Root Certificate: Win2025-CA</p>          Win2025-CA Trust."},{"location":"projects/homelab/04-iam-secrets/#3-identity-and-access-management","title":"3. Identity and Access Management","text":"<p>Identity services are split between Authentik for modern SSO/OIDC-based authentication and Microsoft Active Directory for Windows domain services. This dual-stack approach mirrors hybrid enterprise environments where Linux, containerized workloads, and Windows systems coexist.</p>"},{"location":"projects/homelab/04-iam-secrets/#31-authentik-identity-stack","title":"3.1 Authentik Identity Stack","text":""},{"location":"projects/homelab/04-iam-secrets/#deployment-overview","title":"Deployment Overview","text":"<p>       Authentik provides centralized identity and access management using OAuth2, OIDC, and proxy-forwarding protocols. It acts as the primary identity provider for web applications, Kubernetes workloads, dashboards, and internal services. Policy-driven access control enforces MFA, group-based authorization, and conditional access rules.     </p>          Authentik Identity Provider Overview.        <p>Security Impact</p> <ul> <li>Consolidates authentication across VMs, containers, and web apps</li> <li>Enforces MFA and policy-based access control</li> <li>Provides OIDC/OAuth2 SSO for dashboards, WAF-protected portals, and internal services</li> <li>Reduces password reuse and improves auditability</li> </ul> <p>Deployment Rationale</p> <p>Authentik mirrors enterprise SSO platforms (Azure AD, Okta, Ping) and demonstrates proficiency with modern identity protocols. It centralizes authentication for Linux-based and containerized workloads while integrating cleanly with reverse proxies, WAFs, and Kubernetes ingress controllers.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Separate trust domain for web and application authentication</li> <li>Secure by Design: MFA, OIDC/OAuth2, and policy-driven access</li> <li>Zero Trust: Every request authenticated; no implicit trust in session or network</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#configuration","title":"Configuration","text":"<p>The Authentik identity stack is deployed within a Docker environment and comprises four core containers:</p> <ul> <li>Authentik Server -- main application interface and API layer</li> <li>Authentik Worker -- handles background tasks, flows, and integrations</li> <li>PostgreSQL -- primary relational database for Authentik</li> <li>Redis -- caching and session management for performance optimization</li> <li>Outpost for Traefik and various services</li> </ul> <p>The Authentik interface is secured using TLS certificates issued by Step CA, ensuring encrypted communication across all services. Multi-Factor Authentication (MFA) is enforced using the Microsoft Authenticator app, adding a layer of security for user logins and administrative access.</p> <p>Authentik acts as the unified identity provider for multiple services in the lab, streamlining authentication and access control through OAuth2 and reverse proxy integration:</p> <p>Diagram Placeholder: Proxmox OAuth2 Login Screenshot</p> <ul> <li>Proxmox VE - Web-based virtualization management protected via OAuth2/OpenID Connect (OIDC), allowing users to log in through Authentik via federated identity and benefit from centralized governance.</li> </ul> <p>Diagram Placeholder: Portainer OAuth2 Login Screenshot</p> <ul> <li> <p>Portainer - Container orchestration and Docker management secured using OAuth2 authorization framework, enabling SSO and role-based access control.</p> </li> <li> <p>pfSense - Firewall and network management access connected to Authentik's LDAP interface, validating username/passwords against the LDAP directory.</p> </li> <li> <p>Webservers - Apache and Nginx websites protected via OAuth2/OpenID Connect (OIDC), allowing users to log in through Authentik via federated identity and benefit from centralized governance.</p> </li> <li> <p>Traefik and Services - Reverse proxy and ingress controller secured via proxy forwarding, with Authentik injecting identity headers and managing session-based access to backend services.</p> </li> <li>Services: Checkmk, Pi-hole, Pulse, WUD, Uptime Kuma, Changedetection.io, Heimdall, Elastic and Safeline admin UI</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#authentication-flows","title":"Authentication Flows","text":"<ol> <li>User Access Request: User navigates to protected service (e.g., Portainer)</li> <li>Redirect to Authentik: Service redirects to Authentik login page</li> <li>Primary Authentication: User provides username/password</li> <li>MFA Challenge: Microsoft Authenticator TOTP code required</li> <li>Consent Screen: User authorizes service access (if first time)</li> <li>Token Issuance: Authentik issues JWT access token</li> <li>Service Access: User redirected back with token, gains access</li> </ol>"},{"location":"projects/homelab/04-iam-secrets/#multi-factor-authentication","title":"Multi-Factor Authentication","text":"<ul> <li>Primary: Microsoft Authenticator (TOTP)</li> <li>Backup: WebAuthn (FIDO2 security keys)</li> <li>Recovery: One-time backup codes (10 codes, single-use)</li> <li>Enrollment: Required on first login, cannot be bypassed</li> <li>Policy: MFA mandatory for all roles</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#security-features","title":"Security Features","text":"<ul> <li>Account Lockout: 5 failed attempts, 15-minute lockout</li> <li>Session Management: 12-hour session timeout, refresh token rotation</li> <li>Audit Logging: All authentication events logged to PostgreSQL, forwarded to Elastic SIEM</li> <li>Reputation: IP-based rate limiting and geo-blocking</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#tls-configuration","title":"TLS Configuration","text":"<ul> <li>Certificate: Issued by StepCA Intermediate CA</li> <li>Validity: 365 days with automated renewal via ACME</li> <li>Protocol: TLS 1.3/1.2 only (TLS 1.1 disabled)</li> <li>Cipher Suites: Modern ECDHE+AES-GCM only</li> </ul> <p>Diagram Placeholder: Authentik Screenshots (3 images)</p>"},{"location":"projects/homelab/04-iam-secrets/#32-microsoft-active-directory","title":"3.2 Microsoft Active Directory","text":""},{"location":"projects/homelab/04-iam-secrets/#deployment-overview_1","title":"Deployment Overview","text":"<p>       Active Directory provides enterprise-grade identity services for Windows-based infrastructure. A subset of Windows 11 Pro VMs are joined to a centralized domain hosted on Windows Server 2022 (dc01) and Windows Server 2025 (dc02). AD manages Kerberos authentication, Group Policy enforcement, and domain-joined machine trust.     </p>          Microsoft Active Directory Overview.        <p>Security Impact</p> <ul> <li>Centralized Windows authentication reduces credential sprawl</li> <li>Kerberos provides secure, ticket-based authentication</li> <li>Group Policy enforces security baselines and configuration hardening</li> <li>Domain-joined systems support certificate auto-enrollment via PKI</li> </ul> <p>Deployment Rationale</p> <p>AD remains the backbone of enterprise Windows identity. This deployment simulates production domain environments and demonstrates understanding of Kerberos, LDAP, GPOs, and domain trust relationships.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Windows trust domain isolated from web identity domain</li> <li>Secure by Design: Kerberos authentication and GPO-based hardening</li> <li>Zero Trust: Domain authentication required for all Windows systems</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#configuration_1","title":"Configuration","text":"<p>The domain controllers are configured with the following roles:</p> Role Purpose Active Directory Domain Services (AD DS) Centralized identity, authentication, and directory management Active Directory Lightweight Directory Services (AD LDS) Lightweight directory for app-specific identity needs DNS Server Authoritative DNS Service for the AD Domain. Kerberos, LDAP, GPO, Login and General Client Requests File and Storage Services Network shares and storage provisioning Active Directory Certificate Services EnterpriseCA supporting the domain IIS Web Services WSUS Admin Portal Windows Server Update Services (WSUS) Centralized patch management for Windows clients <p>Diagram Placeholder: Domain Controller Screenshots (2 images)</p>"},{"location":"projects/homelab/04-iam-secrets/#active-directory-configuration","title":"Active Directory Configuration","text":"<p>Diagram Placeholder: AD Configuration Screenshot</p> <p>Domain Name</p> <ul> <li>Domain: home.com</li> <li>Domain Controllers: dc01.home.com, dc02.home.com</li> <li>Forest Functional Level: Windows Server 2016</li> <li>Domain Functional Level: Windows Server 2016</li> <li>Single forest, single domain design</li> <li>Future expansion: Child domains for lab segmentation</li> <li>Trust relationships: None (isolated lab environment)</li> </ul> <p>DNS Server</p> <ul> <li>Authoritative for the Active Directory Domain. Name resolution and SRV record support.</li> </ul> <p>Certificate Authority</p> <ul> <li>Isolated EnterpriseCA supporting local services, running on dc02.</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#organizational-units-ous","title":"Organizational Units (OUs)","text":"OU Purpose Users Contains all domain user accounts Server/Domain Admins Contains privileged accounts Desktop PCs Contains domain-joined Windows 11 clients Servers Contains domain-joined Windows Servers"},{"location":"projects/homelab/04-iam-secrets/#33-user-and-group-policy-management","title":"3.3 User and Group Policy Management","text":"<p>Diagram Placeholder: User and Group Policy Screenshots (2 images)</p>"},{"location":"projects/homelab/04-iam-secrets/#user-accounts","title":"User Accounts","text":"<ul> <li>Standard domain users created under the Users OU</li> <li>Naming convention: first initial+lastname</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#security-groups","title":"Security Groups","text":"Group Name Purpose Domain_Admins Full administrative privileges Server Admins Select server privileges PowerUsers Elevated access to specific systems StandardUsers Default access level for lab participants NAS_Access Mapped drive access to NAS shares <p>Groups are used to assign permissions, drive mappings, and GPO filtering.</p>"},{"location":"projects/homelab/04-iam-secrets/#group-policies","title":"Group Policies","text":"<p>Group Policies are applied via GPOs linked to the appropriate OUs. Policies are divided into Computer Configuration and User Configuration.</p>"},{"location":"projects/homelab/04-iam-secrets/#computer-policies","title":"Computer Policies","text":"<p>Diagram Placeholder: Password Complexity Screenshot</p> <p>Password Complexity</p> <ul> <li>Minimum Age: 30 days</li> <li>Maximum Age: 60 days</li> <li>Minimum Password Length: 8</li> <li>Windows Complexity Requirements: Enabled</li> <li>Password History: 3 Remembered</li> </ul> <p>Diagram Placeholder: Account Lockout Screenshot</p> <p>Account Lockout Policy</p> <ul> <li>Account Lockout Duration: 10 mins</li> <li>Threshold: 5 Attempts</li> <li>Allow Admin Lockout: Enabled</li> <li>Reset: 10 mins</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#user-policies","title":"User Policies","text":"<p>Diagram Placeholder: Desktop/System Settings Screenshot</p> <p>Desktop/System Settings</p> <ul> <li>Custom Desktop Wallpaper: Enabled</li> <li>Prohibit Changes: Enabled</li> <li>Prohibit adding, closing, deleting, editing items: Disabled</li> <li>Power Management</li> <li>Prompt for Password on Resume from Hibernation/Suspend: Enabled</li> <li>Removable Storage Access</li> <li>All Removable Storage classes: Deny all Access: Enabled</li> </ul> <p>Diagram Placeholder: Personalization Screenshot</p> <p>Personalization</p> <ul> <li>Password Protect the Screen Saver: Enabled</li> <li>Screen Saver Timeout: Enabled</li> <li>Force a Specific Screen Saver: Enabled</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#user-preferences","title":"User Preferences","text":"<p>Drive Mapping</p> <ul> <li>Drive mapping to local NAS folders.</li> <li>\\DS\\Backups, \\DS\\Software, \\dc01\\Documents</li> </ul> <p>Diagram Placeholder: Drive Mapping Screenshot</p>"},{"location":"projects/homelab/04-iam-secrets/#assigned-policiespreferences","title":"Assigned Policies/Preferences","text":"<p>Diagram Placeholder: Assigned Policies Screenshot</p> <p>GPO User Configuration Policies</p> Policy Category Setting Value/Action Desktop Personalization Custom wallpaper \\dc01\\NETLOGON\\wallpaper.jpg Desktop Personalization Prohibit wallpaper changes Enabled Desktop Personalization Force specific screensaver Enabled (Blank.scr) Desktop Personalization Screensaver timeout 10 minutes Desktop Personalization Password-protect screensaver Enabled Power Management Require password on resume Enabled Power Management Sleep timeout (on battery) 15 minutes Power Management Sleep timeout (plugged in) 30 minutes Removable Storage All removable storage classes Read-only (not full deny) Removable Storage Exceptions IT Admin group Start Menu &amp; Taskbar Remove Run command Enabled (Standard Users only) Start Menu &amp; Taskbar Disable Command Prompt Enabled (Standard Users only) Drive Mappings H: drive \\dc01\\Users\\%USERNAME% Drive Mappings S: drive \\DS\\Software (read-only) Drive Mappings B: drive \\DS\\Backups (NAS_Access group) <p>GPO Computer Configuration Policies</p> Policy Category Setting Value/Action Password Complexity Minimum length 8 characters Password Complexity Complexity requirements Enabled (upper; lower; number; symbol) Password Complexity Password history 3 passwords remembered Password Complexity Minimum age 30 days Password Complexity Maximum age 60 days Account Lockout Lockout threshold 5 invalid attempts Account Lockout Lockout duration 10 minutes Account Lockout Reset counter after 10 minutes Account Lockout Administrator lockout Enabled Windows Firewall Domain profile Enabled Windows Firewall Block inbound (default) Enabled <p>Security Hardening</p> <ul> <li>Kerberos Authentication: AES256 encryption enforced</li> <li>LDAPS: Enabled on port 636 with Step-CA issued certificate</li> <li>SMB Signing: Required for all domain communications</li> <li>NTLM: Restricted, Kerberos preferred</li> <li>Admin Accounts: Separate accounts for daily use vs. privileged access</li> </ul> <p>DNS Integration</p> <ul> <li>Authoritative for home.com zone</li> <li>SRV records for Kerberos (_kerberos._tcp.home.com)</li> <li>Isolated DNS: no integration to Pi-hole</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#4-secrets-management","title":"4. Secrets Management","text":"<p>Secrets management is centralized through Vaultwarden, which provides encrypted storage for passwords, SSH keys, API tokens, and sensitive notes. This eliminates reliance on commercial password managers while maintaining enterprise-grade encryption and cross-platform access.</p>"},{"location":"projects/homelab/04-iam-secrets/#41-vaultwarden-password-manager","title":"4.1 Vaultwarden Password Manager","text":""},{"location":"projects/homelab/04-iam-secrets/#deployment-overview_2","title":"Deployment Overview","text":"<p>Vaultwarden is a lightweight, self-hosted implementation of the Bitwarden protocol. All data is encrypted client-side before transmission, ensuring zero-knowledge storage. Vaultwarden is accessible via web, desktop, mobile, and browser extensions. Automated backups store encrypted vault data on the NAS and Proxmox Backup Server.</p> <p>Security Impact</p> <ul> <li>Zero-knowledge encryption protects credentials even if the server is compromised</li> <li>Centralized secrets reduce password reuse and unmanaged credentials</li> <li>Multi-platform access ensures secure credential availability across devices</li> <li>Automated backups protect against data loss</li> </ul> <p>Deployment Rationale</p> <p>Vaultwarden mirrors enterprise password managers (Bitwarden, 1Password, Keeper) and demonstrates secure secrets management without relying on third-party cloud services. It supports SSH key storage, API token management, and secure note handling.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Centralized secrets reduce unmanaged credentials</li> <li>Secure by Design: Client-side encryption and automated backups</li> <li>Zero Trust: Secrets never stored or transmitted unencrypted</li> </ul>"},{"location":"projects/homelab/04-iam-secrets/#configuration_2","title":"Configuration","text":"<p>Vaultwarden is deployed as a self-hosted password manager to secure credentials, SSH keys, and sensitive notes across the lab. Key features include:</p> <ul> <li>End-to-End Encryption: All data is encrypted client-side before transmission, ensuring zero-knowledge storage</li> <li>Multi-Platform Access: Web interface, desktop apps, mobile apps, and browser extensions</li> <li>Automated Backups: Vault data is backed up to the NAS and Proxmox Backup Server via scheduled backup jobs</li> </ul> <p>Architecture</p> Component Technology Location Purpose Vaultwarden LXC Container 192.168.1.4 Password vault server Database SQLite (embedded) Persistent volume Vault data storage Reverse Proxy Traefik 192.168.1.247 TLS termination; auth Backup Job Cron + rsync NAS + PBS Automated vault backup"},{"location":"projects/homelab/04-iam-secrets/#security-architecture","title":"Security Architecture","text":"<p>Encryption Model: Zero-Knowledge Architecture</p> <ul> <li>Client-Side Encryption: All vault data encrypted in browser/app before transmission</li> <li>Master Password: Never transmitted to server, used to derive encryption key</li> <li>Encryption Algorithm: AES-256-CBC for vault items</li> <li>End-to-End: Server stores only encrypted blobs, cannot decrypt vault contents</li> </ul> <p>Access Control</p> <ul> <li>Master Password: Required for vault unlock</li> <li>Two-Factor Authentication: TOTP via Microsoft Authenticator</li> <li>Session Timeout: 15 minutes of inactivity</li> <li>Vault Timeout Action: Lock (not logout, prevents re-sync delay)</li> </ul> <p>TLS Configuration</p> <ul> <li>Certificate: Step-CA issued, 365-day validity</li> </ul> <p>Integration Points</p> <ul> <li>CLI Access: Bitwarden CLI (bw) for automation and scripts</li> <li>Browser Extensions: Chrome for autofill</li> <li>SSH Agent: SSH key stored in vault, agent integration via CLI</li> </ul> <p>Backup Strategy</p> <ul> <li>Frequency: Weekly automated backup at 1 AM</li> <li>Method: SQLite database file + attachments folder</li> <li>Destinations:</li> <li>Synology NAS (\\DS\\Backups\\Vaultwarden)</li> <li>Proxmox Backup Server (deduplicated, encrypted)</li> <li>Retention: 6 versions plus 1 monthly</li> </ul> <p>Diagram Placeholder: Vaultwarden Screenshot</p>"},{"location":"projects/homelab/04-iam-secrets/#5-security-controls-summary","title":"5. Security Controls Summary","text":""},{"location":"projects/homelab/04-iam-secrets/#identity-and-access-security-controls","title":"Identity and Access Security Controls","text":"<p>Control Framework</p> Control Domain Implementation Coverage Authentication Multi-factor (password + TOTP/FIDO2) All critical services Authorization OAuth2/OIDC with RBAC 12 integrated services Certificate Management Automated ACME with Step-CA All internal TLS Secrets Storage Vaultwarden zero-knowledge vault 100+ credentials Directory Services Active Directory + Authentik Hybrid Windows/Linux Session Management JWT tokens with refresh rotation Authentik SSO Policy Enforcement GPO + Authentik policies Windows clients + web services Audit Logging Authentik events + AD logs \u2192 Elastic Centralized visibility <p>Authentication Controls</p> Technology Strength Use Cases Password + TOTP Medium-High Standard user accounts Password + FIDO2 High Admin accounts (WebAuthn keys) Certificate-based mTLS Very High Service-to-service auth Kerberos High Windows domain authentication LDAP Bind Medium pfSense; legacy services <p>Access Control Matrix</p> User Role Proxmox Portainer pfSense CheckMK AD Admin Vaultwarden Standard User No No No View No Personal vault Power User View Manage No View No Shared vault Server Admin Manage Manage View Manage No Admin vault Domain Admin Full Full Manage Full Full Full access <p>Certificate Lifecycle Security</p> Phase Security Control Risk Mitigation Generation Root CA air-gapped; passphrase-protected Prevents root key compromise Issuance ACME challenge validation (DNS/HTTP) Prevents unauthorized cert issuance Storage Private keys in file system (0600 perms) Limits key exposure Renewal Automated 30 days before expiry Prevents service outages Revocation CRL + OCSP responder Timely invalidation of compromised certs Distribution Trusted CA bundles in OS/container Ensures chain validation"},{"location":"projects/homelab/04-iam-secrets/#6-operational-resilience","title":"6. Operational Resilience","text":""},{"location":"projects/homelab/04-iam-secrets/#identity-service-continuity","title":"Identity Service Continuity","text":"Service Component Failure Mode Recovery Mechanism RTO Authentik Server Container crash Docker restart policy &lt;30s PostgreSQL Database Database corruption Restore from daily backup &lt;10 min Step-CA Intermediate Service failure Systemd auto-restart &lt;15s Active Directory DC VM failure Restore from Proxmox backup &lt;20 min Vaultwarden Container crash Docker restart policy &lt;30s Redis Cache Cache loss Session re-authentication &lt;5s (graceful)"},{"location":"projects/homelab/04-iam-secrets/#backup-strategy","title":"Backup Strategy","text":"Component Frequency Method Retention Encryption Authentik DB Weekly PostgreSQL dump 6 months At rest (NAS) Step-CA Config Weekly File-level backup 6 months At rest (NAS) AD Domain Controller Weekly System State backup 6 months Windows backup encryption Vaultwarden Vault Weekly SQLite + attachments 6 months AES-256 at rest Root CA Private Key One-time Encrypted USB drive Offline storage Passphrase protected"},{"location":"projects/homelab/04-iam-secrets/#disaster-recovery-procedures","title":"Disaster Recovery Procedures","text":"<p>Scenario: Complete Authentik Failure</p> <ol> <li>Deploy fresh Docker containers from compose file (2 min)</li> <li>Restore PostgreSQL database from last backup (5 min)</li> <li>Restart Authentik server and worker containers (1 min)</li> <li>Verify SSO functionality across test services (2 min)</li> </ol> <p>Total Recovery Time: &lt;10 minutes</p> <p>Scenario: Active Directory Domain Controller Failure</p> <ol> <li>Restore DC VM from Proxmox Backup Server (15 min)</li> <li>Verify DNS and Kerberos functionality (2 min)</li> <li>Test user authentication and GPO application (3 min)</li> </ol> <p>Total Recovery Time: &lt;20 minutes</p> <p>Scenario: Step-CA Certificate Authority Compromise</p> <ol> <li>Revoke compromised intermediate CA certificate (immediate)</li> <li>Generate new intermediate CA from offline root (15 min)</li> <li>Update trust stores across all systems (30 min)</li> <li>Re-issue all leaf certificates via ACME (automated, 1 hour)</li> </ol> <p>Total Recovery Time: &lt;2 hours (automated after initial setup)</p>"},{"location":"projects/homelab/04-iam-secrets/#monitoring-and-alerting","title":"Monitoring and Alerting","text":"Metric Monitored Tool Alert Threshold Notification Authentik login failures Prometheus &gt;10 failures in 5 min Discord webhook Step-CA cert issuance Prometheus Failed ACME challenge Discord webhook AD DC availability Uptime Kuma HTTP 5xx or timeout Discord webhook Vaultwarden API Uptime Kuma HTTP error or 5s latency Discord webhook Certificate expiry Uptime Kuma &lt;30 days to expiry Discord webhook"},{"location":"projects/homelab/04-iam-secrets/#7-use-cases-deployment-scenarios","title":"7. Use Cases &amp; Deployment Scenarios","text":""},{"location":"projects/homelab/04-iam-secrets/#scenario-1-automated-certificate-renewal-for-web-services","title":"Scenario 1: Automated Certificate Renewal for Web Services","text":"<p>Objective: Eliminate manual certificate management</p> <p>Implementation:</p> <ul> <li>Traefik configured with Step-CA ACME endpoint</li> <li>Service deployment includes ACME labels (service.home.com)</li> <li>Traefik requests certificate via ACME protocol</li> <li>Step-CA validates domain ownership (DNS challenge)</li> <li>Certificate issued with 365-day validity</li> <li>Traefik auto-renews 30 days before expiry</li> </ul> <p>Result: Zero-touch certificate management, no expired cert outages</p>"},{"location":"projects/homelab/04-iam-secrets/#scenario-2-centralized-credential-management-for-team","title":"Scenario 2: Centralized Credential Management for Team","text":"<p>Objective: Share admin credentials securely across lab users</p> <p>Implementation:</p> <ul> <li>Admin credentials stored in Vaultwarden shared collection</li> <li>Collection access limited to Server_Admins group</li> <li>Team members access vault via browser extension</li> <li>Credentials auto-filled on login pages</li> <li>All access logged with user ID and timestamp</li> </ul> <p>Result: No plaintext credentials in wikis/spreadsheets, full audit trail</p>"},{"location":"projects/homelab/04-iam-secrets/#scenario-3-windows-client-provisioning-with-group-policy","title":"Scenario 3: Windows Client Provisioning with Group Policy","text":"<p>Objective: Deploy new Windows 11 client with hardened baseline</p> <p>Implementation:</p> <ul> <li>Join new VM to home.com domain</li> <li>Computer object auto-placed in \"Desktop PCs\" OU</li> <li>GPOs automatically applied within 90 seconds</li> <li>User logs in, receives drive mappings and desktop wallpaper</li> <li>WSUS policy applies, begins downloading patches</li> </ul> <p>Result: Consistent, policy-driven configuration without manual intervention</p>"},{"location":"projects/homelab/04-iam-secrets/#scenario-4-certificate-based-service-authentication-mtls","title":"Scenario 4: Certificate-Based Service Authentication (mTLS)","text":"<p>Objective: Secure API communication between services</p> <p>Implementation:</p> <ul> <li>Service A requests client certificate from Step-CA</li> <li>Certificate includes Extended Key Usage: clientAuth</li> <li>Service B configured to require client certificate</li> <li>TLS handshake validates Service A cert against Step-CA chain</li> <li>Mutual authentication established, API call succeeds</li> </ul> <p>Result: Service-to-service authentication without shared secrets</p>"},{"location":"projects/homelab/04-iam-secrets/#8-standards-alignment","title":"8. Standards Alignment","text":""},{"location":"projects/homelab/04-iam-secrets/#industry-framework-alignment","title":"Industry Framework Alignment","text":"Framework/Standard Alignment Implementation Evidence NIST 800-63B (Digital Identity) High MFA enforcement; password complexity NIST 800-207 (Zero Trust) Moderate OAuth2/OIDC; microsegmentation CIS Controls v8 High IAM controls (5.x; 6.x) ISO 27001 (A.9 Access Control) Moderate RBAC; MFA; audit logging FIPS 140-2 Partial AES-256; SHA-256; ECC P-256"},{"location":"projects/homelab/04-iam-secrets/#nist-800-63b-authentication-assurance-levels","title":"NIST 800-63B Authentication Assurance Levels","text":"AAL Level Requirements Lab Implementation AAL1 Single-factor Standard user accounts (fallback) AAL2 Two-factor (MFA) Password + TOTP (default for admins)"},{"location":"projects/homelab/04-iam-secrets/#zero-trust-principles-nist-800-207","title":"Zero Trust Principles (NIST 800-207)","text":"Principle Implementation Verify explicitly OAuth2 tokens with claims validation Least privilege access RBAC in Authentik; AD security groups Assume breach Microsegmentation; certificate-based auth Continuous verification Session timeouts; token refresh rotation Network segmentation OPNsense firewall isolates services"},{"location":"projects/homelab/04-iam-secrets/#cis-controls-implementation","title":"CIS Controls Implementation","text":"Control Description Implementation 5.1 Establish secure configs GPO baseline; Authentik policies 5.2 Maintain secure configs Configuration backup; version control 5.3 Documented config standards This documentation 6.1 Centralized account mgmt Active Directory; Authentik 6.2 Use unique passwords Vaultwarden enforced 6.3 Disable dormant accounts AD account expiration policies 6.4 Restrict admin privileges Separate admin accounts; RBAC 6.5 Centralized authentication Authentik SSO; AD Kerberos 6.6 Multi-factor authentication TOTP + FIDO2 for admin access 6.7 Centralized access control OAuth2/OIDC; group-based permissions 6.8 Define and maintain RBAC AD security groups; Authentik roles"},{"location":"projects/homelab/04-iam-secrets/#pki-standards-compliance","title":"PKI Standards Compliance","text":"Standard Requirement Implementation RFC 5280 X.509 certificate format Step-CA compliant certificates RFC 8555 ACME protocol Automated cert issuance NIST FIPS 186-4 Digital signature algorithms ECDSA with SHA-256 CA/Browser Forum Baseline requirements 398-day max validity (browsers) NIST SP 800-57 Key management ECC P-256 (128-bit security)"},{"location":"projects/homelab/04-iam-secrets/#password-policy-alignment-nist-800-63b","title":"Password Policy Alignment (NIST 800-63B)","text":"NIST Recommendation Lab Implementation Minimum 8 characters 8 chars (AD); 12 chars (Authentik) No complexity requirements Complexity required (legacy AD constraint) No mandatory rotation 60-day rotation (AD); no rotation (Authentik) Check against breached passwords Planned: HaveIBeenPwned integration Rate limiting 5 attempts; 10-minute lockout"},{"location":"projects/homelab/04-iam-secrets/#9-integration-architecture","title":"9. Integration Architecture","text":""},{"location":"projects/homelab/04-iam-secrets/#service-integration-architecture","title":"Service Integration Architecture","text":"<p>Identity Provider Mappings</p> Service Category Services (Count) Auth Method Provider Virtualization Proxmox PVE, PBS (2) OAuth2/OIDC Authentik Container Mgmt Portainer (1) OAuth2 Authentik Network Security pfSense (2) LDAP Authentik Monitoring CheckMK (1); Uptime Kuma (1); Pulse (1) Proxy Auth Authentik Network Services Pi-hole (2) Proxy Auth Authentik Automation WUD (1); Changedetect (1) Proxy Auth Authentik Media Plex (1) Proxy Auth Authentik Dashboards Heimdall (1) Proxy Auth Authentik Windows Systems Domain PCs (2) Kerberos Active Directory"},{"location":"projects/homelab/04-iam-secrets/#security-homelab-section-links","title":"Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware </li> <li>Network Security, Privacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/05-auto-iac/","title":"Automation and Infrastructure as Code (IaC)","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/05-auto-iac/#1-automation-and-infrastructure-as-code-iac","title":"1. Automation and Infrastructure as Code (IaC)","text":""},{"location":"projects/homelab/05-auto-iac/#architecture-overview","title":"Architecture Overview","text":"<p>The lab implements a comprehensive automation strategy using infrastructure as code principles, configuration management, and workflow orchestration. This approach provides repeatable deployments, consistent configurations, and automated operations across the entire infrastructure stack.</p> <p>Security Impact</p> <ul> <li>Configuration drift eliminated through code\u2011driven enforcement</li> <li>Human error reduced via automated validation</li> <li>Credential exposure prevented through integrated secret management</li> <li>Unauthorized changes blocked through Git\u2011based approval workflows</li> <li>Disaster recovery enabled through fully reproducible infrastructure</li> <li>Audit compliance maintained via immutable version history</li> </ul> <p>Deployment Rationale: Infrastructure as Code eliminates manual configuration drift, reduces human error, and enables rapid disaster recovery. The automation stack transforms a complex 40+ host lab environment into a reproducible, documented system that can be rebuilt from code within hours instead of weeks. This mirrors enterprise DevOps practices and demonstrates proficiency with industry-standard automation tools (Terraform, Ansible, CI/CD pipelines). Enterprise environments leverage IaC to manage hundreds or thousands of servers with consistent security baselines\u2014manual approaches become impossible at scale. This implementation demonstrates understanding of GitOps principles where infrastructure state is declared in version control, changes are peer-reviewed via pull requests, and deployments are automated through CI/CD pipelines.</p>"},{"location":"projects/homelab/05-auto-iac/#architecture-principles-alignment","title":"Architecture Principles Alignment","text":"<ul> <li>Defense in Depth: Infrastructure changes peer-reviewed before deployment; Terraform plan reviewed for security impact; Ansible playbooks enforce CIS Benchmarks; automated testing validates security controls before production</li> <li>Secure by Design: Least-privilege service accounts for automation tools; secrets stored in Ansible Vault/Vaultwarden; SSH keys rotated via automated playbooks; no hardcoded credentials in version control</li> <li>Zero Trust: Every infrastructure change logged to Git with committer identity; Terraform state files encrypted; API tokens short-lived and rotated; automation execution audited via SIEM</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#strategic-value","title":"Strategic Value","text":"<ul> <li>Reduced provisioning time: VM deployment from 30 minutes (manual) to &lt;5 minutes (Terraform automation)</li> <li>Configuration consistency: Ansible ensures identical baselines across all hosts (100% CIS Benchmark compliance)</li> <li>Audit trail: Git commits provide full history of infrastructure changes (who, what, when, why)</li> <li>Disaster recovery: Entire lab can be rebuilt from GitHub repository (&lt;2 hours full recovery)</li> <li>Learning platform: Hands-on experience with tools used in production environments (transferable to enterprise roles)</li> <li>Compliance automation: Security controls codified and version-controlled (auditable evidence of control implementation)</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#2-infrastructure-provisioning-with-terraform","title":"2. Infrastructure Provisioning with Terraform","text":""},{"location":"projects/homelab/05-auto-iac/#architecture-overview_1","title":"Architecture Overview","text":"<p>Terraform manages the complete lifecycle of Proxmox virtual machines and LXC containers using declarative configuration files. The infrastructure is defined as code, version-controlled, and applied through a dedicated automation controller VM running Ubuntu Server.</p> <p>Security Impact</p> <ul> <li>Least\u2011privilege automation enforced through Proxmox API tokens</li> <li>Infrastructure changes tracked and auditable via Git commit history</li> <li>Unauthorized modifications prevented through Terraform's stateful resource management</li> <li>Disaster recovery enabled through declarative rebuilds directly from code</li> <li>Credential exposure eliminated through encrypted Terraform variables</li> <li>Change validation performed prior to execution using terraform plan</li> </ul> <p>Deployment Rationale: Manual VM creation is time-consuming, error-prone, and undocumented\u2014scaling to 40+ VMs/containers requires automation. Terraform demonstrates infrastructure-as-code where VM specifications (CPU, RAM, storage, network) are declared in HCL configuration files, version-controlled, and applied idempotently. This mirrors enterprise infrastructure management (AWS CloudFormation, Azure Resource Manager) where infrastructure is treated as software with code review, testing, and CI/CD deployment. The approach enables rapid environment replication (dev/staging/production), consistent resource configurations, and automated disaster recovery.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Terraform state stored remotely with access controls; API tokens scoped to minimal permissions; plan review catches misconfigurations before apply; resource tagging enables compliance auditing</li> <li>Secure by Design: Proxmox API tokens instead of passwords; Terraform variables encrypted; no secrets in Git repositories; automated validation via pre-commit hooks</li> <li>Zero Trust: Every Terraform execution logged; state file modifications tracked; API calls authenticated via tokens; infrastructure changes require explicit approval</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#deployment-architecture","title":"Deployment Architecture","text":"Component Technology Purpose Terraform Controller CentOS LXC (192.168.x.x) Isolated automation host Terraform Version v1.6.x Infrastructure provisioning engine Provider Telmate/proxmox v2.9.x Proxmox VE API integration State Backend Local file, Cloudflare R2 State persistence and locking Secrets Management terraform.tfvars (gitignored) API tokens and credentials"},{"location":"projects/homelab/05-auto-iac/#authentication-authorization","title":"Authentication &amp; Authorization","text":"<p>Proxmox Service Account:</p> <ul> <li>Username: terraform@pve</li> <li>Authentication: API token (non-password, scoped)</li> <li>Token ID: terraform-token</li> <li>Permission Group: TerraformProvisioners</li> <li>Granted Privileges:</li> <li>VM.Allocate (create VMs)</li> <li>VM.Config.* (modify VM settings)</li> <li>VM.PowerMgmt (start/stop/shutdown)</li> <li>Datastore.AllocateSpace (provision storage)</li> <li>SDN.Use (network assignment)</li> <li>Principle: Least privilege - cannot modify Proxmox cluster config or other users</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#security-controls","title":"Security Controls","text":"<ul> <li>Secrets management: Proxmox API token stored in env variable</li> <li>State File Protection: Contains sensitive data, stored with restrictive permissions (0600)</li> <li>TLS Verification: pm_tls_insecure = false enforces valid certificate checks</li> <li>Separate Workspaces: VM and LXC builds isolated to prevent cross-contamination</li> <li>Gitignore Enforcement: terraform.tfvars, *.tfstate excluded from version control</li> </ul> <p>Diagram Placeholder: Terraform Project Structure Screenshots (2 images)</p> <p>Project Structure: <pre><code>terraform/\n\u251c\u2500\u2500 vm/\n\u2502   \u251c\u2500\u2500 main.tf              # VM resource definitions\n\u2502   \u251c\u2500\u2500 variables.tf         # Input variable declarations\n\u2502   \u251c\u2500\u2500 terraform.tfvars     # Sensitive values (gitignored)\n\u2502   \u251c\u2500\u2500 outputs.tf           # Return values (IP, VMID)\n\u2502   \u2514\u2500\u2500 .terraform.lock.hcl  # Provider version lock\n\u251c\u2500\u2500 lxc/\n\u2502   \u251c\u2500\u2500 main.tf              # LXC resource definitions\n\u2502   \u251c\u2500\u2500 variables.tf         # Input variable declarations\n\u2502   \u251c\u2500\u2500 terraform.tfvars     # Sensitive values (gitignored)\n\u2502   \u2514\u2500\u2500 outputs.tf           # Return values\n\u2514\u2500\u2500 modules/\n    \u2514\u2500\u2500 common/              # Reusable module components\n</code></pre></p>"},{"location":"projects/homelab/05-auto-iac/#terraform-configuration-deep-dive","title":"Terraform Configuration Deep Dive","text":""},{"location":"projects/homelab/05-auto-iac/#lxc-container-provisioning-maintf","title":"LXC Container Provisioning (main.tf)","text":"<pre><code>terraform {\n  required_providers {\n    proxmox = {\n      source  = \"Terraform-for-Proxmox/proxmox\"\n\n    }\n  }\n}\nvariable \"pm_api_token_id\" {\n  description = \"Proxmox API token ID\"\n  type        = string\n}\n\nvariable \"pm_api_token_secret\" {\n  description = \"Proxmox API token secret\"\n  type        = string\n  sensitive   = true\n}\nvariable \"rootpassword\" {\n  description = \"Cloud-init password for this VM\"\n  type        = string\n  sensitive   = true\n}\nvariable \"lxc_name\" {\n  description = \"Hostname of the LXC container\"\n  type        = string\n  default     = \"debian-lxc\"\n\n}\n\nvariable \"lxc_id\" {\n  description = \"VMID for the LXC container\"\n  type        = number\n}\n\n\nprovider \"proxmox\" {\n    pm_api_url          = \"https://pve.home.com:8006/api2/json\"\n    pm_api_token_id     = var.pm_api_token_id\n    pm_api_token_secret = var.pm_api_token_secret\n    pm_tls_insecure     = false\n}\n\nresource \"proxmox_lxc\" \"testct\" {\n  hostname     = var.lxc_name\n  target_node  = \"pve\"\n  vmid         = var.lxc_id\n  ostemplate   = \"Media4TBnvme:vztmpl/debian-12-standard_12.7-1_amd64.tar.zst\"\n  password     = var.rootpassword\n  unprivileged = true\n  cores        = 2\n  memory       = 512\n  swap         = 512\n  onboot       = true\n  start        = true\n\n\n  rootfs {\n    storage = \"local-lvm\"\n    size    = \"8G\"\n  }\n\n  network {\n    name   = \"eth0\"\n    bridge = \"vmbr0\"\n    ip     = \"dhcp\"\n  }\n\n  features {\n    nesting = true\n  }\n}\n</code></pre> <p>Purpose: Deploy unprivileged Debian 12 containers with security isolation and resource limits suitable for containerized workloads.</p> <p>Key sections:</p> <ul> <li>Provider declaration \u2192 Uses Terraform-for-Proxmox/proxmox provider</li> <li>Authentication variables \u2192 API token ID &amp; secret, plus root password for the container</li> <li>Proxmox provider block \u2192 Points to the PVE API over HTTPS with certificate validation (pm_tls_insecure = false)</li> <li>LXC resource (proxmox_lxc):</li> <li>Hostname &amp; VMID variable arguments provided in the terraform plan command</li> <li>Template source (ostemplate) from Proxmox storage</li> <li>Unprivileged mode for added security isolation</li> <li>Resource limits: 2 CPU cores, 512 MB RAM + swap</li> <li>Disk allocation: 8 GB on local-lvm storage</li> <li>Networking: virt\u2011bridge to vmbr0 via DHCP</li> <li>Features: nesting enabled (allowing Docker/Kubernetes inside the LXC)</li> <li>Boot &amp; start flags so it powers up with the node</li> </ul> <p>Resource Allocation Strategy:</p> <ul> <li>CPU: 2 cores (sufficient for most containerized apps)</li> <li>Memory: 512MB + 512MB swap (low footprint for density)</li> <li>Disk: 8GB (expandable, allocated on local-lvm for performance)</li> <li>Network: DHCP with VLAN tagging support via bridge</li> </ul> <p>Security Features:</p> <ul> <li>Unprivileged Containers: UID/GID mapping prevents root escalation to host</li> <li>Nesting Enabled: Allows Docker-in-LXC for lab flexibility</li> <li>AppArmor Profile: Default Proxmox profile applied</li> <li>Resource Limits: Prevent resource exhaustion attacks</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#vm-provisioning-maintf-qemu","title":"VM Provisioning (main.tf - QEMU)","text":"<p>Purpose: Clone cloud-init ready Ubuntu VMs with optimized storage and network configuration for performance and manageability.</p> <pre><code>terraform {\n  required_providers {\n    proxmox = {\n      source  = \"Terraform-for-Proxmox/proxmox\"\n      #version = \"~&gt; 0.65\" # or latest\n    }\n  }\n}\n\nvariable \"pm_api_token_id\" {\n  description = \"Proxmox API token ID\"\n  type        = string\n}\n\nvariable \"pm_api_token_secret\" {\n  description = \"Proxmox API token secret\"\n  type        = string\n  sensitive   = true\n}\nvariable \"ciuser\" {\n  description = \"Cloud-init username for this VM\"\n  type        = string\n}\n\nvariable \"cipassword\" {\n  description = \"Cloud-init password for this VM\"\n  type        = string\n  sensitive   = true\n}\n\nvariable \"vm_name\" {\n  description = \"Name of the VM\"\n  type        = string\n  default     = \"ubuntu-vm\"\n\n}\n\nvariable \"vm_id\" {\n  description = \"VMID for the VM\"\n  type        = number\n}\n\n\nprovider \"proxmox\" {\n    pm_api_url          = \"https://pve.home.com:8006/api2/json\"\n    pm_api_token_id     = var.pm_api_token_id\n    pm_api_token_secret = var.pm_api_token_secret\n    pm_tls_insecure     = false\n}\n\nresource \"proxmox_vm_qemu\" \"ubuntu-vm\" {\n    name                = var.vm_name\n    vmid                = var.vm_id\n    target_node         = \"pve\"\n    clone               = \"ubuntu-cloud\"\n    full_clone          = true\n    cores               = 2\n    memory              = 2048\n    sockets             = 1\n    onboot              = true\n    agent               = 1\n    os_type             = \"l26\"\n    clone_wait          = 0\n    ciuser     = var.ciuser\n    cipassword = var.cipassword\n\n\n    boot    = \"order=scsi0;ide2\"\n    bootdisk = \"scsi0\"\n    scsihw      = \"virtio-scsi-single\"\n\n    network {\n        model     = \"virtio\"\n        bridge    = \"vmbr0\"\n        firewall  = false\n        link_down = false\n    }\n</code></pre> <p>Key sections:</p> <ul> <li>Provider declaration \u2192 Same Terraform\u2011for\u2011Proxmox provider as above</li> <li>Authentication variables \u2192 API token ID &amp; secret; cloud-init user and password</li> <li>Proxmox provider block \u2192 HTTPS API endpoint with TLS verification</li> <li>VM resource (proxmox_vm_qemu):</li> <li>Clones from ubuntu-cloud template (must be cloud-init ready)</li> <li>full_clone = true \u2192 independent disk image</li> <li>OS type set to l26 \u2192 Linux kernel 2.6+ (optimized for modern distros)</li> <li>Hostname &amp; VMID variable arguments provided in the terraform plan command</li> <li>Boot settings:<ul> <li>Boot from scsi0 (OS disk) before ide2 (cloud-init)</li> <li>Force virtio-scsi-single controller for best Linux I/O performance</li> </ul> </li> <li>CPU/memory: 2 vCPUs, 2 GB RAM, 1 socket</li> <li>QEMU guest agent enabled for status reporting &amp; IP detection</li> <li>Networking: virtio NIC on vmbr0 with firewall disabled in guest config</li> <li>Cloud-init parameters for provisioning user and password</li> <li>clone_wait = 0 \u2192 Terraform doesn't block on post-clone boot readiness</li> </ul> <p>Cloud-Init Integration:</p> <ul> <li>User Creation: Provisions non-root user via ciuser parameter</li> <li>SSH Keys: Injects public keys for passwordless authentication</li> <li>Network Config: Configures DHCP or static IP via ipconfig parameters</li> <li>Package Updates: Can specify packages to install on first boot</li> </ul> <p>Performance Optimizations:</p> <ul> <li>VirtIO-SCSI-Single: Modern SCSI controller with single queue (reduces overhead)</li> <li>IOThread: Dedicated I/O thread improves disk throughput</li> <li>SSD Flag: Enables TRIM for better SSD performance</li> <li>VirtIO NIC: Para-virtualized network driver (near-native performance)</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#terraform-plan-output","title":"Terraform Plan Output","text":"<p>Diagram Placeholder: Terraform Plan Output Screenshot</p>"},{"location":"projects/homelab/05-auto-iac/#terraform-workflow","title":"Terraform Workflow","text":"Step Command Purpose Initialize <code>terraform init</code> Download provider plugins Validate <code>terraform validate</code> Check syntax errors Plan <code>terraform plan -var=\"hostname=test01\" ...</code> Preview changes Apply <code>terraform apply -var=\"hostname=test01\" ...</code> Execute provisioning Destroy <code>terraform destroy -var=\"vmid=200\"</code> Delete resources Show State <code>terraform show</code> View current state Refresh State <code>terraform refresh</code> Sync state with reality <p>Example Provisioning Command: <pre><code>terraform apply \\\n  -var=\"hostname=docker-vm-01\" \\\n  -var=\"vmid=201\" \\\n  -auto-approve\n</code></pre></p> <p>Output: IP address, VMID, MAC address assigned</p>"},{"location":"projects/homelab/05-auto-iac/#state-management-strategy","title":"State Management Strategy","text":"<p>Current Implementation:</p> <ul> <li>State File: Local terraform.tfstate in working directory</li> <li>Locking: None (single operator environment)</li> <li>Backup: Automated weekly backups to Proxmox Backup Server and Synology NAS</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#3-configuration-management-with-ansible","title":"3. Configuration Management with Ansible","text":""},{"location":"projects/homelab/05-auto-iac/#31-architecture-overview","title":"3.1 Architecture Overview","text":"<p>Ansible provides agentless configuration management through SSH-based automation, enforcing consistent baselines across all Linux hosts, managing secrets securely, and orchestrating complex multi-host operations using declarative playbooks.</p> <p>Security Impact</p> <ul> <li>Configuration drift eliminated through automated enforcement</li> <li>SSH hardening applied consistently across all managed hosts</li> <li>Credential exposure prevented through Ansible Vault encryption</li> <li>Audit trail established via Git\u2011based version control</li> <li>Manual errors eliminated through idempotent playbooks</li> </ul> <p>Deployment Rationale: In enterprise environments with 30+ Linux hosts, manual configuration becomes error-prone and time-consuming. Ansible demonstrates infrastructure-as-code principles where security baselines (CIS Benchmarks) are codified, version-controlled, and automatically enforced. This approach reduces configuration time from hours to minutes while ensuring 100% consistency across systems\u2014critical for maintaining security posture at scale.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: SSH hardening playbooks disable weak ciphers and enforce key-based auth; firewall rules deployed uniformly; fail2ban configured consistently across all systems</li> <li>Secure by Design: Ansible Vault encrypts sensitive variables; no plaintext credentials in playbooks; SSH keys distributed securely via initial bootstrap</li> <li>Zero Trust: Every configuration change logged to Git; no implicit trust of system state; playbooks verify current configuration before making changes</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#32-setup-overview","title":"3.2 Setup Overview","text":"<p>Control plane: Ansible running in a Proxmox LXC</p> <ul> <li>Deployed from a Proxmox Debian-based LXC (\"ansible\"), using a Python virtual environment</li> <li>SSH auth is key-based via an \"ansible\" user</li> <li>Handles initial configuration management to achieve a standard template across all hosts</li> <li>Standard base packages, DNS, PKI and SSH configurations plus user accounts and permissions</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#control-plane-configuration","title":"Control Plane Configuration","text":"Component Details Ansible Controller Debian 12 LXC (192.168.x.x) Ansible Version 2.16.x (core) Python Environment venv isolated (Python 3.11) Authentication SSH key-based (ed25519) Privilege Escalation sudo (passwordless for ansible user) Inventory Dynamic (Proxmox API) + static YAML Vault Encryption ansible-vault with AES-256"},{"location":"projects/homelab/05-auto-iac/#ssh-key-architecture","title":"SSH Key Architecture","text":"<ul> <li>Key Type: ed25519 (modern, secure, performant)</li> <li>Key Location: /home/ansible/.ssh/id_ed25519</li> <li>Passphrase: Stored in Vaultwarden, loaded to ssh-agent</li> <li>Distribution: Public key deployed via cloud-init or initial playbook</li> <li>Rotation: Annual key rotation with documented rollover procedure</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#ansible-user-configuration","title":"Ansible User Configuration","text":"<p>The \"ansible\" service account is created on all managed hosts with these attributes:</p> <ul> <li>Username: ansible</li> <li>Shell: /bin/bash</li> <li>Groups: ansible, sudo (or wheel on RHEL)</li> <li>Sudo Access: NOPASSWD for all commands (required for automation)</li> <li>Home Directory: /home/ansible</li> <li>SSH AuthorizedKeys: Controller public key only</li> </ul> <p>Security Considerations:</p> <p>Sudo Without Password: Required for unattended automation. Mitigated by:</p> <ul> <li>ansible user cannot authenticate via password (PasswordAuthentication no)</li> <li>SSH key private key is passphrase-protected</li> <li>Access limited to Ansible controller IP via SSH config</li> <li>All actions logged via auditd and forwarded to Splunk</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#33-playbook-architecture","title":"3.3 Playbook Architecture","text":""},{"location":"projects/homelab/05-auto-iac/#bootstrap-playbook-new_installyaml","title":"Bootstrap Playbook (new_install.yaml)","text":"<pre><code>---\n-  name: Freah install of Linux VM/LXC, add ansible user and SSH access\n   hosts: all\n   tags: always\n   become: true\n\n   handlers:\n    - name: Restart systemd-resolved (if needed)\n      ansible.builtin.systemd:\n        name: systemd-resolved\n        state: restarted\n        enabled: yes\n      when:\n        - ansible_service_mgr == \"systemd\"\n        - \"'systemd-resolved.service' in ansible_facts.services | default({})\"\n\n   pre_tasks:\n\n    - name: Update all packages on RedHat family\n      dnf:\n        name: \"*\"\n        state: latest\n        update_cache: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages on Debian family\n      apt:\n        upgrade: dist\n        update_cache: yes\n        cache_valid_time: 3600\n      when: ansible_os_family == \"Debian\"\n\n   tasks:\n    - name: add new user\n      become: true\n      tags: always\n      ansible.builtin.user:\n        name: ansible\n        group: root\n        shell: /bin/bash\n        password:  \"{{ '-----' | password_hash('sha512') }}\"\n\n    - name: Ensure OpenSSH server is installed\n      package:\n        name: openssh-server\n        state: present\n\n    - name: Backup existing sshd_config\n      become: true\n      copy:\n        src: /etc/ssh/sshd_config\n        dest: /etc/ssh/sshd_config.bak\n        remote_src: yes\n      when: ansible_facts['os_family'] != 'Windows'\n\n    - name: Set SSH configuration options\n      become: true\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?{{ item.key }}'\n        line: '{{ item.key }} {{ item.value }}'\n        state: present\n        create: yes\n        backup: yes\n      loop:\n        - { key: 'PermitRootLogin', value: 'no' }\n        - { key: 'PasswordAuthentication', value: 'no' }\n        - { key: 'PubkeyAuthentication', value: 'yes' }\n        - { key: 'AuthorizedKeysFile', value: '.ssh/authorized_keys' }\n        - { key: 'PermitEmptyPasswords', value: 'no' }\n        - { key: 'ChallengeResponseAuthentication', value: 'no' }\n        - { key: 'UsePAM', value: 'yes' }\n\n    - name: Ensure SSH service is enabled and restarted\n      become: true\n      service:\n        name: \"{{ item  }}\"\n        state: restarted\n        enabled: yes\n      loop:\n        - ssh\n        - sshd\n\n\n    - name: Ensure .ssh directory exists for ansible user\n      become: true\n      file:\n        path: /home/ansible/.ssh\n        state: directory\n        owner: ansible\n        group: root\n        mode: '0700'\n\n    - name: add SSH key for ansible host\n      become: true\n      tags: always\n      ansible.posix.authorized_key:\n        user: ansible\n        key: \"ssh-ed25519 ------------ root@ansible\"\n        state: present\n\n    - name: Ensure sudo is installed\n      package:\n        name: sudo\n        state: present\n\n    - name: Ensure /etc/sudoers.d exists\n      become: true\n      file:\n        path: /etc/sudoers.d\n        state: directory\n        owner: root\n        group: root\n        mode: '0750'\n\n    - name: add sudoers file to ansible\n      become: true\n      ansible.builtin.copy:\n        src: sudoer_ansible\n        dest: /etc/sudoers.d/ansible\n        owner: root\n        group: root\n        mode: '0440'\n        validate: '/usr/sbin/visudo -cf %s'\n\n    - name: Replace /etc/resolv.conf with specified nameservers\n      copy:\n        dest: /etc/resolv.conf\n        content: |\n          nameserver 192.168.1.250\n          nameserver 192.168.1.126\n        owner: root\n        group: root\n        mode: '0644'\n        backup: yes\n      notify: Restart systemd-resolved (if needed)\n\n\n-  name: add a new user and enable remote access via SSH\n   hosts: all\n   become: true\n\n   handlers:\n    - name: Restart systemd-resolved (if needed)\n      ansible.builtin.systemd:\n        name: systemd-resolved\n        state: restarted\n        enabled: yes\n      when:\n        - ansible_service_mgr == \"systemd\"\n        - \"'systemd-resolved.service' in ansible_facts.services | default({})\"\n\n\n    # Debian reboot check\n    - name: Check if reboot is required (Debian/Ubuntu)\n      stat:\n        path: /var/run/reboot-required\n      register: reboot_required\n      when: ansible_os_family == \"Debian\"\n\n    # RedHat reboot check\n    - name: Check if reboot is required (RedHat family)\n      command: needs-restarting -r\n      register: needs_reboot\n      failed_when: false\n      changed_when: false\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Reboot if required (Debian)\n      reboot:\n      when: reboot_required.stat.exists\n\n    - name: Reboot if required (RedHat)\n      reboot:\n      when: needs_reboot.rc == 1\n</code></pre> <p>Purpose: Initial host configuration to establish Ansible management capability.</p> <p>Execution: Run once after Terraform provisions new host.</p> <p>What it does:</p> <ul> <li>Updates the repositories, applies any software updates</li> <li>Creates the \"ansible\" user with a login shell and hashed password</li> <li>Ensures OpenSSH server is installed</li> <li>Backs up /etc/ssh/sshd_config and sets key options:</li> <li>PermitRootLogin no</li> <li>PasswordAuthentication no</li> <li>PubkeyAuthentication yes</li> <li>AuthorizedKeysFile .ssh/authorized_keys</li> <li>PermitEmptyPasswords no</li> <li>ChallengeResponseAuthentication no</li> <li>UsePAM yes</li> <li>Restarts and enables the SSH service (service name differs by distro: \"ssh\" on Debian/Ubuntu, \"sshd\" on RHEL/CentOS)</li> <li>Creates /home/ansible/.ssh with strict permissions</li> <li>Adds the control node's public key to ansible's authorized_keys</li> <li>Installs sudo, ensures /etc/sudoers.d exists (0750), and drops a validated sudoers entry for \"ansible\" (via visudo -cf)</li> <li>Restart SSH only when the config changes (handler) to reduce risk during provisioning</li> <li>Configures the lab DNS nameservers in the resolv.conf file</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#additional-playbooks","title":"Additional Playbooks","text":"<p>Hardening Playbook (security_baseline.yaml):</p> <ul> <li>Configures firewall rules (ufw/firewalld)</li> <li>Installs fail2ban for brute force protection</li> <li>Enables automatic security updates</li> <li>Configures auditd for system logging</li> <li>Deploys CrowdSec agent for threat intelligence</li> </ul> <p>PKI Certificate Deployment (deploy_certificates.yaml):</p> <ul> <li>Distributes Step-CA root certificate to trust store</li> <li>Configures automatic cert renewal via ACME client</li> <li>Updates TLS configurations for services</li> </ul> <p>User Management (manage_users.yaml):</p> <ul> <li>Creates standard user accounts across hosts</li> <li>Deploys SSH keys from centralized source</li> <li>Configures user-specific sudo permissions</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#4-version-control-and-gitops","title":"4. Version Control and GitOps","text":""},{"location":"projects/homelab/05-auto-iac/#version-control-strategy","title":"Version Control Strategy","text":"<p>Diagram Placeholder: GitHub Repository Screenshots (3 images)</p> <p>All infrastructure\u2011as\u2011code assets for this solution \u2014 including Ansible playbooks, Terraform configurations, and related modules \u2014 are stored in a dedicated GitHub repository using Git on the local host.</p> <p>This central repository provides:</p> <ul> <li>Version history \u2014 Every change is committed with a message on what changed, enabling full audit trails for infrastructure modifications</li> <li>Consistency across environments \u2014 Ansible roles and Terraform modules are version\u2011locked so the same codebase can be applied to multiple hosts</li> <li>Rollback capability \u2014 Previous commits can be checked out to restore infrastructure to a known good state quickly in case of issues</li> </ul> <p>Configuration files for hosted and platform services \u2014 including YAML, JSON, HTML, CSS, Python, and PowerShell scripts \u2014 are stored in a separate repository. This repository is fully integrated with Visual Studio Code, allowing seamless local and remote (via SSH) integration editing.</p> <p>By keeping both provisioning (Terraform) and configuration management (Ansible) in one repository, and separating hosted/platform service configs into another, the architecture ensures that each layer of the stack is versioned, auditable, and maintainable.</p>"},{"location":"projects/homelab/05-auto-iac/#5-workflow-automation-with-n8n","title":"5. Workflow Automation with n8n","text":""},{"location":"projects/homelab/05-auto-iac/#51-platform-overview","title":"5.1 Platform Overview","text":"<p>n8n is a self-hosted, low-code workflow automation platform enabling visual workflow design with conditional logic, error handling, loops, and data transformation. Deployed as a containerized service behind Traefik reverse proxy with Authentik SSO.</p> <p>Security Impact</p> <ul> <li>Security operations accelerated through automated SOAR workflows</li> <li>Manual triage eliminated via automated alert enrichment</li> <li>MTTR reduced through auto\u2011generated remediation playbooks</li> <li>Alert fatigue minimized through intelligent deduplication and correlation</li> <li>Compliance audit trails automatically documented throughout the incident lifecycle</li> </ul> <p>Deployment Rationale: Security operations generate thousands of events daily, manual triage is unsustainable. n8n demonstrates Security Orchestration, Automation and Response (SOAR) capabilities where vulnerability scans trigger automated ticket creation, threat intelligence enrichment queries multiple APIs, and incident response playbooks execute without human intervention. This mirrors enterprise SOAR platforms (Splunk SOAR, Palo Alto Cortex XSOAR) where analyst efficiency is multiplied through automation.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Automated vulnerability remediation workflows execute Ansible playbooks; firewall rule changes logged and reviewed; failed automation triggers manual fallback procedures</li> <li>Secure by Design: Credentials stored in n8n credential vault (encrypted at rest); webhook endpoints authenticated via Authentik tokens; workflow execution logs forwarded to SIEM</li> <li>Zero Trust: Every automation action logged with timestamp/user; no hardcoded credentials; API tokens expire and rotate automatically</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#n8n-configuration","title":"n8n Configuration","text":"<ul> <li>Version: n8n v1.x (latest stable)</li> <li>Execution Mode: Main process (not queue mode for simplicity)</li> <li>Webhook URL: https://n8n.home.com</li> <li>TLS Certificate: Step-CA issued, auto-renewed</li> <li>Authentication: SSO via Authentik (no local passwords)</li> <li>Monitoring: Uptime Kuma</li> <li>Notifications: Discord webhooks</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#security-controls_1","title":"Security Controls","text":"<ul> <li>Credential Encryption: All API tokens encrypted at rest</li> <li>Webhook Security: HMAC signature validation on inbound webhooks</li> <li>Audit Trail: All workflow executions logged with timestamp and user</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#lab-use-cases","title":"Lab Use Cases","text":"<ul> <li>Daily threat Intelligence Alerts</li> <li>Ansible Playbook automation</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#52-workflow-1-ansible-playbook-automation","title":"5.2 Workflow 1: Ansible Playbook Automation","text":"<p>Purpose: Automated weekly configuration audit and system updates across lab infrastructure.</p> <p>This automated workflow runs two playbooks, a weekly schedule and performs a configuration audit across lab hosts and a Linux repository update and upgrade cycle. It collects key system metadata and securely publishes the results for review and alerting.</p> <p>Workflow Summary:</p> <ul> <li>Scheduled Execution: Triggered weekly via n8n's Cron node</li> <li>Ansible Playbook:</li> <li>Gathers hostnames, nameservers, SSH keys, and other configuration details across all Linux hosts</li> <li>(sudo) apt update &amp;&amp; apt upgrade -y / (sudo) dnf check-update &amp;&amp; (sudo) dnf update -y</li> <li>GitHub Upload: Converts playbook output to a structured JSON file and commits it to the n8n-Ansible-playbook-results/ folder in the lab GitHub repository</li> <li>Discord Alert: Sends a formatted notification to a private Discord channel upon successful upload, including timestamp and file reference</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#workflow-nodes","title":"Workflow Nodes","text":"Node Type Configuration Purpose Schedule Trigger Cron: 0 2 * * 6 (Saturday 2 AM) Weekly execution SSH Node 1 Host: ansible-controller.home.com; Command: ansible-playbook config_audit.yml Run audit playbook SSH Node 2 Host: ansible-controller.home.com; Command: ansible-playbook linux_updates.yml Run update playbook Function Node Parse JSON output from playbooks Extract results HTTP Request GitHub API: Create file in repo Upload results JSON Discord Webhook Send formatted message Alert on completion Error Handler Catch failures; send alert Notify on errors          n8n Ansible Playbook Workflow.        <p>Audit Playbook Output (JSON): <pre><code>{\n  \"timestamp\": \"2024-11-06T02:00:00Z\",\n  \"hosts_scanned\": 25,\n  \"findings\": {\n    \"ssh_keys\": \"All hosts have valid keys\",\n    \"dns_config\": \"Correct nameservers on 23/25 hosts\",\n    \"failed_updates\": []\n  }\n}\n</code></pre></p> <p>Update Playbook Execution:</p> <ul> <li>Debian/Ubuntu: apt update &amp;&amp; apt upgrade -y</li> <li>RHEL/Fedora: dnf check-update &amp;&amp; dnf update -y</li> <li>Success Rate: Tracked in Discord notification</li> <li>Failed Updates: Logged for manual review</li> </ul> <p>Workflow Benefits:</p> <ul> <li>Eliminates manual audit tasks (saves ~2 hours/week)</li> <li>Ensures timely security updates across all hosts</li> <li>Provides audit trail via GitHub commits</li> <li>Immediate notification of issues via Discord</li> </ul>      n8n Ansible Playbook Results/Notification."},{"location":"projects/homelab/05-auto-iac/#json-output-example","title":"JSON Output Example","text":""},{"location":"projects/homelab/05-auto-iac/#play-audit-system-info-task-gathering-facts-ok-webhomecom-ok-1921681136-ok-unboundhomecom-ok-bindhomecom-ok-1921681250-ok-uptimekhomecom-ok-19216814-ok-stepcahomecom-ok-trfkhomecom-ok-wazuhhomecom-ok-192168193-ok-19216810015-ok-1921681246-ok-192168133-ok-19216826-ok-1921682008-ok-1921682007-ok-1921681126-ok-1921681109-ok-1921681166-ok-1921681005-task-show-disk-usage-ok-webhomecom-disk_usagestdout_lines-filesystem-size-used-avail-use-mounted-on-devloop0-16g-12g-32g-79-none-492k-40k-488k-1-dev-efivarfs-192k-180k-76k-96-sysfirmwareefiefivars-tmpfs-47g-0-47g-0-devshm-tmpfs-19g-156k-19g-1-run-tmpfs-50m-0-50m-0-runlock-tmpfs-47g-124k-47g-1-tmp-tmpfs-94g-80k-94g-1-runuser0-tmpfs-94g-80k-94g-1-runuser1001-task-show-ip-address-info-ok-webhomecom-ip_infostdout_lines-1-lo-loopbackuplower_up-mtu-65536-qdisc-noqueue-state-unknown-group-default-qlen-1000-linkloopback-000000000000-brd-000000000000-inet-1270018-scope-host-lo-valid_lft-forever-preferred_lft-forever-inet6-1128-scope-host-noprefixroute-valid_lft-forever-preferred_lft-forever-2-eth0if76-broadcastmulticastuplower_up-mtu-1500-qdisc-noqueue-state-up-group-default-qlen-1000-linkether-bc2411f9a08c-brd-ffffffffffff-link-netnsid-0-inet-192168110824-brd-1921681255-scope-global-eth0-valid_lft-forever-preferred_lft-forever-inet6-fe80be2411fffef9a08c64-scope-link-proto-kernel_ll-valid_lft-forever-preferred_lft-forever-task-show-routing-table-ok-webhomecom-route_infostdout_lines-default-via-19216811-dev-eth0-proto-static-1921681024-dev-eth0-proto-kernel-scope-link-src-1921681108-task-show-hostname-ok-webhomecom-host_namestdout-apache-ubuntu-task-show-nameservers-ok-webhomecom-resolv_confstdout_lines-begin-pve-search-homecom-nameserver-1921681250-end-pve-task-show-authorized-ssh-keys-ok-webhomecom-msg-ssh-ed25519-rootansible-play-recap-1921681109-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681126-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681136-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681166-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681246-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681250-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-192168133-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-19216814-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-192168193-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-19216810015-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921681005-ok12-changed5-unreachable0-failed0-skipped1-rescued0-ignored1-19216826-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921682007-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-1921682008-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-bindhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-stepcahomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-trfkhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-unboundhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-uptimekhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-wazuhhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0-webhomecom-ok13-changed5-unreachable0-failed0-skipped0-rescued0-ignored0","title":"<pre><code>PLAY [Audit system info] *******************************************************\n\nTASK [Gathering Facts] *********************************************************\nok: [web.home.com]\nok: [192.168.1.136]\nok: [unbound.home.com]\nok: [bind.home.com]\nok: [192.168.1.250]\nok: [uptimek.home.com]\nok: [192.168.1.4]\nok: [stepca.home.com]\nok: [trfk.home.com]\nok: [wazuh.home.com]\nok: [192.168.1.93]\nok: [192.168.100.15]\nok: [192.168.1.246]\nok: [192.168.1.33]\nok: [192.168.2.6]\nok: [192.168.200.8]\nok: [192.168.200.7]\nok: [192.168.1.126]\nok: [192.168.1.109]\nok: [192.168.1.166]\nok: [192.168.100.5]\n\nTASK [Show disk usage] *********************************************************\nok: [web.home.com] =&gt; {\n    \"disk_usage.stdout_lines\": [\n        \"Filesystem      Size  Used Avail Use% Mounted on\",\n        \"/dev/loop0       16G   12G  3.2G  79% /\",\n        \"none            492K  4.0K  488K   1% /dev\",\n        \"efivarfs        192K  180K  7.6K  96% /sys/firmware/efi/efivars\",\n        \"tmpfs            47G     0   47G   0% /dev/shm\",\n        \"tmpfs            19G  156K   19G   1% /run\",\n        \"tmpfs           5.0M     0  5.0M   0% /run/lock\",\n        \"tmpfs            47G  124K   47G   1% /tmp\",\n        \"tmpfs           9.4G  8.0K  9.4G   1% /run/user/0\",\n        \"tmpfs           9.4G  8.0K  9.4G   1% /run/user/1001\"\n    ]\n}\nTASK [Show IP address info] ****************************************************\nok: [web.home.com] =&gt; {\n    \"ip_info.stdout_lines\": [\n        \"1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\",\n        \"    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\",\n        \"    inet 127.0.0.1/8 scope host lo\",\n        \"       valid_lft forever preferred_lft forever\",\n        \"    inet6 ::1/128 scope host noprefixroute \",\n        \"       valid_lft forever preferred_lft forever\",\n        \"2: eth0@if76: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000\",\n        \"    link/ether bc:24:11:f9:a0:8c brd ff:ff:ff:ff:ff:ff link-netnsid 0\",\n        \"    inet 192.168.1.108/24 brd 192.168.1.255 scope global eth0\",\n        \"       valid_lft forever preferred_lft forever\",\n        \"    inet6 fe80::be24:11ff:fef9:a08c/64 scope link proto kernel_ll \",\n        \"       valid_lft forever preferred_lft forever\"\n    ]\n}\nTASK [Show routing table] ******************************************************\nok: [web.home.com] =&gt; {\n    \"route_info.stdout_lines\": [\n        \"default via 192.168.1.1 dev eth0 proto static \",\n        \"192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.108 \"\n    ]\n}\nTASK [Show hostname] ***********************************************************\nok: [web.home.com] =&gt; {\n    \"host_name.stdout\": \"apache-ubuntu\"\n}\nTASK [Show nameservers] ********************************************************\nok: [web.home.com] =&gt; {\n    \"resolv_conf.stdout_lines\": [\n        \"# --- BEGIN PVE ---\",\n        \"search home.com\",\n        \"nameserver 192.168.1.250\",\n        \"# --- END PVE ---\"\n    ]\n}\nTASK [Show authorized SSH keys] ************************************************\nok: [web.home.com] =&gt; {\n    \"msg\": [\n        \"ssh-ed25519 --------- root@ansible\",\n        \"\"\n    ]\n}\nPLAY RECAP *********************************************************************\n192.168.1.109              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.126              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.136              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.166              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.246              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.250              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.33               : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.4                : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.1.93               : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.100.15             : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.100.5              : ok=12   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=1   \n192.168.2.6                : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.200.7              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n192.168.200.8              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nbind.home.com              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nstepca.home.com            : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ntrfk.home.com              : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nunbound.home.com           : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nuptimek.home.com           : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nwazuh.home.com             : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \nweb.home.com               : ok=13   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n</code></pre>","text":""},{"location":"projects/homelab/05-auto-iac/#53-workflow-2-threat-intelligence-aggregation","title":"5.3 Workflow 2: Threat Intelligence Aggregation","text":"<p>Purpose: Daily ingestion and distribution of curated cybersecurity threat intelligence.</p> <p>This workflow runs daily to ingest and distribute curated threat intelligence from multiple cybersecurity RSS feeds. It supports situational awareness and IOC enrichment across the lab environment.</p> <p>Workflow Summary:</p> <ul> <li>Scheduled Execution: Triggered daily via n8n's Cron node</li> <li>RSS Feed Polling: Pulls entries from a curated list of cybersecurity sources</li> <li>Feed Limiting: Filters each feed to the 5 most recent entries to reduce noise and maintain relevance</li> <li>Discord Notification: Formats and sends the aggregated feed summary to a dedicated Discord channel on the private lab server for daily review</li> <li>The NIST RSS feed is also fed through ChatGPT for a summary notification in Discord</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#workflow-nodes_1","title":"Workflow Nodes","text":"Node Type Configuration Purpose Schedule Trigger Cron: 0 8 * * * (Daily 8 AM) Daily execution RSS Feed Reader URLs: CISA Alerts; NIST NVD; Krebs on Security; Threat Post; BleepingComputer Ingest threat intel Filter Node Limit each feed to 5 most recent Reduce noise Merge Node Combine all feeds Aggregate data OpenAI Node Summarize NIST feed with ChatGPT AI-powered summary Format Node Create Discord embed message Visual formatting Discord Webhook Post to #threat-intel channel Distribute to team          n8n Threat Intelligence Workflow.        <p>ChatGPT Integration:</p> <p>Prompt: \"Summarize the following NIST vulnerability in 2-3 sentences suitable for a security team. Focus on severity, affected systems, and recommended actions: {{ $json.content }}\"</p> <p>Response Example: \"CVE-2024-12345: Critical remote code execution vulnerability in Apache Log4j 2.x. Affects versions 2.0-2.17.0. Immediate patching recommended; workaround available via environment variable. CVSS 9.8/10.\"</p> <p>Workflow Benefits:</p> <ul> <li>Centralized threat intelligence (15 sources \u2192 1 channel)</li> <li>AI-powered summarization reduces information overload</li> <li>Daily cadence ensures timely awareness of emerging threats</li> <li>Supports incident response and vulnerability management</li> </ul> <p>Workflow Error Handling:</p> <ul> <li>RSS Feed Timeout: Skip feed, log error, continue</li> <li>Discord Webhook Failure: Send email fallback alert</li> <li>All Errors: Logged to n8n execution history</li> </ul>          Discord Threat Intel Feed and ChatGPT Summary."},{"location":"projects/homelab/05-auto-iac/#6-scripting-for-advanced-automation","title":"6. Scripting for Advanced Automation","text":""},{"location":"projects/homelab/05-auto-iac/#script-development-strategy","title":"Script Development Strategy","text":"<p>Custom scripts supplement configuration management tools for tasks requiring complex logic, performance optimization, or specialized functionality. All scripts are version-controlled in Git, documented with inline comments, and integrated into broader automation workflows.</p> <p>Security Impact</p> <ul> <li>Complex security operations automated where configuration\u2011management tools lack native functionality</li> <li>Performance\u2011critical tasks (log parsing, threat\u2011intelligence queries) optimized beyond built\u2011in tool capabilities</li> <li>Security tool APIs integrated through custom automation wrappers for expanded functionality</li> <li>Rapid prototyping enables validation of security concepts before production\u2011grade implementation</li> </ul> <p>Deployment Rationale: While Ansible/Terraform handle declarative configuration, procedural logic (API rate-limiting, stateful workflows, real-time processing) requires traditional scripting. Enterprise environments use scripts for custom integrations, API gateways, and performance-critical operations. This demonstrates ability to select appropriate automation tools\u2014declarative vs. imperative\u2014based on task requirements.</p> <p>Architecture Principles Alignment</p> <ul> <li>Defense in Depth: Scripts validate input parameters; error handling prevents cascading failures; execution logs audited for anomalies</li> <li>Secure by Design: No hardcoded credentials (environment variables or secret managers); input sanitization prevents injection attacks; least-privilege execution (non-root where possible)</li> <li>Zero Trust: Every script execution logged with user/timestamp; API calls authenticated via short-lived tokens; output validation before downstream processing</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#script-language-selection-criteria","title":"Script Language Selection Criteria","text":"Language Use Cases Advantages Bash Linux system administration; cron jobs Native; fast; no dependencies PowerShell Windows management; AD operations Deep Windows integration; objects Python API integration; data processing; ML Rich libraries; cross-platform"},{"location":"projects/homelab/05-auto-iac/#61-powershell-and-bash-scripting","title":"6.1 PowerShell and Bash Scripting","text":"<p>Custom automation scripts are developed in both PowerShell (for Windows systems) and Bash (for Linux systems) to handle repetitive administrative tasks, enforce configuration standards, and respond to system events. These scripts automate activities such as user account provisioning, log rotation, backup verification, certificate renewal checks, and security baseline enforcement. PowerShell scripts leverage native Windows management frameworks like Active Directory modules and WMI, while Bash scripts utilize standard Unix utilities and interact with system APIs. Scripts are version-controlled in GitHub alongside infrastructure code, enabling rollback capability and documentation of automation logic.</p>"},{"location":"projects/homelab/05-auto-iac/#bash-script-example-backup-automation","title":"Bash Script Example: Backup Automation","text":"<pre><code>#!/bin/bash\n#\n# backup_web.sh - Versioned rsync backup with validation\n# Usage: backup_web.sh &lt;source&gt; &lt;target&gt;\n# Example: backup_web.sh /var/www/lab /backup\n#\n# Exit Codes:\n#   0 - Success\n#   1 - Invalid arguments\n#   2 - Missing dependency\n#   3 - Rsync failed\nset -euo pipefail  # Exit on error, undefined vars, pipe failures\n\n# check to make sure the user has entrered exactly two arguments.\nif [ $# -ne 2 ]\nthen    \n    /usr/bin/echo \"Usage: backup.sh &lt;source_directory&gt; &lt;target_directory&gt;\"\n    /usr/bin/echo \"Please try again.\"\n    exit 1\nfi\nSOURCE=\"$1\"\nTARGET=\"$2\"\n\n# Validate paths (prevent directory traversal)\nif [[ ! \"$SOURCE\" =~ ^/[a-zA-Z0-9/_-]+$RetryPContinuebash]]; then\n    echo \"Error: Invalid source path format\"\n    exit 1\nfi\n\nif [[ ! \"$TARGET\" =~ ^/[a-zA-Z0-9/_-]+$ ]]; then\n    echo \"Error: Invalid target path format\"\n    exit 1\nfi\n\n#check to see if rsync is installed\nif ! command -v rsync &gt; /dev/null 2&gt;&amp;1\nthen\n    /usr/bin/echo \"This script requires rsync to be installed.\"\n    /usr/bin/echo \"Please install the package and run the script again.\"\n    exit 2\nfi\n# Verify source exists\nif [ ! -d \"$SOURCE\" ]; then\n    /usr/bin/echo \"Error: Source directory does not exist: $SOURCE\"\n    exit 1\nfi\n\n# Create target if needed\nmkdir -p \"$TARGET\"\n\n# Generate timestamp\nTIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)\nBACKUP_DATE=$(date +%Y-%m-%d)\nLOG_FILE=\"/var/log/backup_${BACKUP_DATE}.log\"\n\n# Rsync options\nRSYNC_OPTS=(\n    -avz                                    # Archive, verbose, compress\n    --delete                                # Remove deleted files\n    --backup                                # Backup changed files\n    --backup-dir=\"$TARGET/versions/$TIMESTAMP\"  # Versioned backups\n    --exclude='*.tmp'                       # Exclude temp files\n    --exclude='.git'                        # Exclude version control\n    --log-file=\"$LOG_FILE\"                  # Detailed logging\n    --stats                                 # Show transfer statistics\n)\n\n# Log start\n/usr/bin/echo \"=== Backup started at $(date) ===\" | tee -a \"$LOG_FILE\"\nlogger -t backup_web \"Starting backup: $SOURCE -&gt; $TARGET\"\n\n# Execute rsync\nif rsync \"${RSYNC_OPTS[@]}\" \"$SOURCE/\" \"$TARGET/current/\"; then\n    /usr/bin/echo \"=== Backup completed successfully at $(date) ===\" | tee -a \"$LOG_FILE\"\n    logger -t backup_web \"SUCCESS: Backup completed\"\n\n    # Calculate backup size\n    BACKUP_SIZE=$(du -sh \"$TARGET/current\" | cut -f1)\n    /usr/bin/echo \"Backup size: $BACKUP_SIZE\" | tee -a \"$LOG_FILE\"\n\n    # Retention: Keep only last 7 version directories\n    find \"$TARGET/versions/\" -maxdepth 1 -type d -mtime +7 -exec rm -rf {} \\;\n\n    exit 0\nelse\n    RSYNC_EXIT=$?\n    /usr/bin/echo \"=== Backup FAILED at $(date) with exit code $RSYNC_EXIT ===\" | tee -a \"$LOG_FILE\"\n    logger -t backup_web \"FAILED: rsync exited with code $RSYNC_EXIT\"\n    exit 3\nfi\n</code></pre> <p>This Bash script is designed to perform a backup using rsync, with versioned backups stored by date. It validates input, checks for dependencies, and logs the simulated operation.</p> <p>Script: /usr/local/bin/backup_web.sh</p> <p>Purpose: Incremental rsync backup with versioning and logging</p> Line(s) Purpose Explanation #!/bin/bash Script interpreter Ensures the script runs using Bash if [ $# -ne 2 ] Argument check Verifies that exactly two arguments are provided echo \"Usage:...\" Usage message Informs the user of correct syntax if arguments are missing exit 1 Exit on error Terminates with exit code 1 for incorrect usage command -v rsync Dependency check Verifies that rsync is installed and available in $PATH exit 2 Exit on missing dependency Terminates with exit code 2 if rsync is not found current_date=$(date +%Y-%m-%d) Timestamp Captures the current date in YYYY-MM-DD format for versioning rsync_options=... Backup options Sets rsync flags: -a: archive mode; -v: verbose; -b: backup files; --backup-dir: dated subdirectory; --delete: remove obsolete files; --dry-run: simulate $(which rsync) ... Execute rsync Runs rsync with defined options, syncing from $1 to $2/current &gt;&gt; /var/log/backup_$current_date.log Logging Appends output to a date-stamped log file for auditability"},{"location":"projects/homelab/05-auto-iac/#linux-upgrade-script-overview","title":"Linux Upgrade Script Overview","text":"<pre><code>#!/bin/bash\nset -e\n\nlogfile=/var/log/update_script.log\nerrorlog=/var/log/update_script_errors.log\nhostname=$(hostname)\n\n/usr/bin/echo \"-------------------START SCRIPT on $hostname-------------------\" 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\ncheck_exit_status() {\n    if [ $? -ne 0 ]\n    then\n        /usr/bin/echo \"An error occured, please check the $errorlog file.\"\n    fi    \n}\n\nif [ -d /etc/apt ]; then\n    # Debian or Ubuntu\n    /usr/bin/echo \"Detected Debian/Ubuntu system\"\n    /usr/bin/sudo apt update 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n    check_exit_status\n    /usr/bin/sudo apt dist-upgrade -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n    check_exit_status\nelif [ -f /etc/redhat-release ]; then\n    distro=$(cat /etc/redhat-release)\n\n    if [[ \"$distro\" == *\"Fedora\"* ]]; then\n        /usr/bin/echo \"Detected Fedora system\"\n        /usr/bin/sudo dnf upgrade --refresh -y #!/bin/bash\n\nlogfile=/var/log/update_script.log\nerrorlog=/var/log/update_script_errors.log\n\n\ncheck_exit_status() {\n    if [ $? -ne 0 ]\n    then\n        /usr/bin/echo \"An error occured, please check the $errorlog file.\"\n    fi    \n}\n\nif [ -d /etc/apt ]; then\n    # Debian or Ubuntu\n    /usr/bin/echo \"Detected Debian/Ubuntu system\"\n    /usr/bin/sudo apt update 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n    check_exit_status\n    /usr/bin/sudo apt dist-upgrade -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n    check_exit_status\nelif [ -f /etc/redhat-release ]; then\n    distro=$(cat /etc/redhat-release)\n\n    if [[ \"$distro\" == *\"Fedora\"* ]]; then\n        /usr/bin/echo \"Detected Fedora system\"\n        /usr/bin/sudo dnf upgrade --refresh -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n        check_exit_status   \n    elif [[ \"$distro\" == *\"CentOS\"* ]] || [[ \"$distro\" == *\"Red Hat\"* ]]; then\n        /usr/bin/echo \"Detected CentOS or RHEL system\"\n        /usr/bin/sudo yum update -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n        check_exit_status      \n    else\n        /usr/bin/echo \"Detected unknown Red Hat-based system\"\n        /usr/bin/sudo yum update -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n        check_exit_status \n    fi\nelse\n    /usr/bin/echo \"Unsupported or unknown Linux distribution\"\nfi\n\n\n        check_exit_status   \n    elif [[ \"$distro\" == *\"CentOS\"* ]] || [[ \"$distro\" == *\"Red Hat\"* ]]; then\n        /usr/bin/echo \"Detected CentOS or RHEL system\"\n        /usr/bin/sudo yum update -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n        check_exit_status      \n    else\n        /usr/bin/echo \"Detected unknown Red Hat-based system\"\n        /usr/bin/sudo yum update -y 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n        check_exit_status \n    fi\nelse\n    /usr/bin/echo \"Unsupported or unknown Linux distribution\"\nfi\n\n/usr/bin/echo \"The script completed at: $(/usr/bin/date)\" 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n/usr/bin/echo \"-------------------END SCRIPT on $hostname-------------------\" 1&gt;&gt;$logfile 2&gt;&gt;$errorlog\n</code></pre> <p>This Bash script performs a distribution-aware system upgrade, logging all output and errors to dedicated log files. It supports Debian/Ubuntu, Fedora, CentOS, and RHEL, and includes error checking after each upgrade step.</p> Line(s) Purpose Explanation #!/bin/bash Interpreter declaration Ensures the script runs with Bash logfile=/var/log/update_script.log; errorlog=/var/log/update_script_errors.log Log file setup Defines paths for standard output and error logs echo \"START SCRIPT\" Start marker Logs the beginning of the script execution check_exit_status() Error handler Function that checks the last command's exit code and prints an error message if non-zero if [ -d /etc/apt ]; then Distro detection Checks for Debian/Ubuntu by presence of APT directory apt update; apt dist-upgrade -y Debian/Ubuntu upgrade Runs update and full upgrade, logs output and errors elif [ -f /etc/redhat-release ]; then Red Hat-based detection Checks for Fedora, CentOS, or RHEL using release file cat /etc/redhat-release Distro name Reads the release file to identify the specific variant dnf upgrade --refresh -y Fedora upgrade Refreshes metadata and upgrades packages yum update -y CentOS/RHEL upgrade Performs system update using yum echo \"Unsupported distro\" Fallback Handles unknown or unsupported systems echo \"Script completed at: $(date)\" Completion timestamp Logs the end time of the script echo \"END SCRIPT\" End marker Logs the conclusion of the script execution"},{"location":"projects/homelab/05-auto-iac/#powershell-script-example-windows-update-automation","title":"PowerShell Script Example: Windows Update Automation","text":"<pre><code>$ErrorActionPreference = \"Continue\"\n\n# Start logging\n$logPath = \"C:\\Logs\\update_log.txt\"\nStart-Transcript -Path $logPath -Append\n\n# Log header with host and user info\n$hostname = $env:COMPUTERNAME\n$username = $env:USERNAME\nWrite-Host \"`n==================== UPDATE SCRIPT START ====================\"\nWrite-Host \"Host: $hostname\"\nWrite-Host \"User: $username\"\nWrite-Host \"Start Time: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\"\nWrite-Host \"=============================================================`n\"\n\n# Timestamp helper\nfunction Write-Timestamped {\n    param ([string]$message)\n    Write-Host \"`n[$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')] $message\"\n}\n\n# Update Windows Store apps\nfunction Update-WindowsStoreApps {\n    Write-Timestamped \"Starting Windows Store App updates...\"\n    Get-CimInstance -Namespace \"Root\\cimv2\\mdm\\dmmap\" -ClassName \"MDM_EnterpriseModernAppManagement_AppManagement01\" | Invoke-CimMethod -MethodName UpdateScanMethod\n    Write-Timestamped \"Completed Windows Store App updates.\"\n}\nUpdate-WindowsStoreApps\n\n# Update Chocolatey packages\nfunction Update-ChocoApps {\n    Write-Timestamped \"Checking for Chocolatey...\"\n    if (Get-Command choco -ErrorAction SilentlyContinue) {\n        Write-Timestamped \"Updating Chocolatey packages...\"\n        choco upgrade all -y\n        Write-Timestamped \"Completed Chocolatey updates.\"\n    } else {\n        Write-Timestamped \"Chocolatey is not installed. Skipping.\"\n    }\n}\nUpdate-ChocoApps\n\n# Update Winget packages\nfunction Update-WingetApps {\n    Write-Timestamped \"Checking for Winget...\"\n    if (Get-Command winget -ErrorAction SilentlyContinue) {\n        Write-Timestamped \"Updating Winget packages...\"\n        winget upgrade --all\n        Write-Timestamped \"Completed Winget updates.\"\n    } else {\n        Write-Timestamped \"Winget is not installed. Skipping.\"\n    }\n}\nUpdate-WingetApps\n\n# Windows OS Updates\nWrite-Timestamped \"Starting Windows OS updates...\"\nImport-Module PSWindowsUpdate\nInstall-WindowsUpdate -MicrosoftUpdate -AcceptAll\nWrite-Timestamped \"Completed Windows OS updates.\"\n\n# Log footer\nWrite-Host \"`n==================== UPDATE SCRIPT END =====================\"\nWrite-Host \"End Time: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\"\nWrite-Host \"=============================================================\"\n\n# End logging\nStop-Transcript\n</code></pre> <p>This script performs a comprehensive update sweep across a Windows system, covering:</p> <ul> <li>Windows Store apps</li> <li>Chocolatey packages</li> <li>Winget packages</li> <li>Windows OS updates</li> </ul> <p>It logs all output to a transcript file and timestamps each operation for auditability and runtime tracking.</p> <p>Script: C:\\Scripts\\Update-System.ps1</p> <p>Purpose: Comprehensive Windows update across multiple package managers</p> Line(s) Purpose Explanation $ErrorActionPreference = \"Continue\" Error handling Ensures the script continues execution even if a command fails $logPath = \"C:\\Logs\\update_log.txt\" Log file path Defines where the transcript will be saved Start-Transcript -Path $logPath -Append Start logging Begins capturing all console output to the log file function Write-Timestamped Timestamp helper Prints messages with a timestamp prefix for clarity and tracking function Update-WindowsStoreApps Windows Store updates Uses CIM to trigger an update scan for Store apps via MDM interface Update-WindowsStoreApps Execute function Runs the Store app update function function Update-ChocoApps Chocolatey updates Checks if choco is installed, then upgrades all packages with -y. Logs start, completion, or skip Update-ChocoApps Execute function Runs the Chocolatey update function function Update-WingetApps Winget updates Checks if winget is installed, then upgrades all packages. Logs start, completion, or skip Update-WingetApps Execute function Runs the Winget update function Import-Module PSWindowsUpdate OS update module Loads the PSWindowsUpdate module for managing Windows updates Install-WindowsUpdate -MicrosoftUpdate -AcceptAll OS updates Installs all available Microsoft updates silently Stop-Transcript End logging Stops the transcript and finalizes the log file"},{"location":"projects/homelab/05-auto-iac/#62-cron-job-scheduling-strategy","title":"6.2 Cron Job Scheduling Strategy","text":"<p>Cron is used extensively across Linux systems to schedule automated tasks at defined intervals, ensuring that maintenance activities, monitoring checks, and data collection occur reliably without manual intervention. Typical cron jobs include nightly backup verification scripts, hourly certificate expiration checks, daily vulnerability scan initiation, periodic log archival and rotation, and regular system health assessments. Cron jobs are documented with inline comments explaining purpose, frequency, and dependencies, and critical jobs send success/failure notifications to the centralized Discord alerting system to ensure failures are promptly identified and addressed.</p> <p>Webserver Crontab</p> Minute Hour Day Month Weekday Command Description Last Run Timestamp 0 2 * * 5 /usr/local/bin/upgrade.sh Weekly system upgrade Fri, Nov 1, 2025 02:00 AM 30 1 * * 6 /usr/local/bin/backup_web.sh /var/www/lab /backup Weekly web backup via rsync Sat, Nov 2, 2025 01:30 AM <ul> <li>The first job runs every Friday at 2:00 AM and executes upgrade.sh with no arguments</li> <li>The second job runs every Saturday at 1:30 AM and executes backup_web.sh with two arguments: /var/www/lab (Source directory) and /backup (Target directory)</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#63-python-scripting-for-advanced-automation","title":"6.3 Python Scripting for Advanced Automation","text":"<p>Python scripts are deployed where more complex logic, data processing, or API interaction is required. Python's extensive library ecosystem makes it ideal for tasks like parsing and correlating log data, interacting with REST APIs for service configuration, processing vulnerability scan results, generating custom reports from multiple data sources, and implementing custom security tools. Python's cross-platform nature allows scripts to run consistently across Windows and Linux systems, and virtual environments ensure dependency isolation and reproducibility.</p>"},{"location":"projects/homelab/05-auto-iac/#python-script-example-network-scanner","title":"Python Script Example: Network Scanner","text":"<p><pre><code>import sys \nimport socket\nfrom datetime import datetime\nimport threading\nimport platform\nimport subprocess\n\n# Load common ports from external file\ndef load_common_ports(filename='common_ports.txt'):\n    \"\"\"\n    Load port mappings from a text file\n    Format: port:service_name (one per line)\n    \"\"\"\n    ports = {}\n    try:\n        with open(filename, 'r') as f:\n            for line in f:\n                line = line.strip()\n                if line and not line.startswith('#'):  # Skip empty lines and comments\n                    try:\n                        port, service = line.split(':', 1)\n                        # Strip whitespace and remove quotes/commas\n                        service = service.strip().strip('\"').strip(\"'\").rstrip(',')\n                        ports[int(port)] = service\n                    except ValueError:\n                        print(f'Warning: Skipping malformed line: {line}')\n        return ports\n    except FileNotFoundError:\n        print(f'Warning: {filename} not found. Using empty port dictionary.')\n        return {}\n    except Exception as e:\n        print(f'Error loading port file: {e}')\n        return {}\n\n# Load the common ports dictionary\nCOMMON_PORTS = load_common_ports()\n\n# Global verbose flag\nverbose = False\n\ndef ping_host(target_ip):\n    \"\"\"\n    Ping the host to check if it's reachable before scanning\n    \"\"\"\n    param = '-n' if platform.system().lower() == 'windows' else '-c'\n    command = ['ping', param, '1', target_ip]\n\n    try:\n        result = subprocess.run(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, timeout=5)\n        return result.returncode == 0\n    except Exception as e:\n        print(f'Ping test failed: {e}')\n        return False\n\ndef scan_port(target, port):\n    \"\"\"\n    Function to scan a single port\n    \"\"\"\n    try: \n        if verbose:\n            print(f'Scanning port {port}...')\n\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        s.settimeout(1)\n        result = s.connect_ex((target, port))\n\n        if result == 0:\n            service_info = COMMON_PORTS.get(port, \"Unknown Service\")\n            print(f\"Port {port} is open - {service_info}\")\n\n        s.close()\n    except socket.error as e:\n        print(f'Socket error on port {port}: {e}')\n    except Exception as e:\n        print(f'Unexpected error on port {port}: {e}')\n\ndef main():\n    global verbose\n\n    # Parse arguments for verbose flag\n    args = sys.argv[1:]\n\n    if len(args) &lt; 1 or len(args) &gt; 2:\n        print(\"Invalid number of arguments.\") \n        print(\"Usage: python network_scanner.py &lt;target&gt; [-v|--verbose]\") \n        sys.exit(1)\n\n    target = args[0]\n\n    # Check for verbose flag\n    if len(args) == 2 and args[1] in ['-v', '--verbose']:\n        verbose = True\n        print(\"Verbose mode enabled\")\n\n    # Resolve the target hostname to an IP address\n    try:\n        target_ip = socket.gethostbyname(target) \n    except socket.gaierror:\n        print(f'Error: Unable to resolve hostname {target}')\n        sys.exit(1)\n\n    # Ping test before scanning\n    print(\"-\" * 50)\n    print(f'Running ping test on {target_ip}...')\n    if ping_host(target_ip):\n        print(f'Host {target_ip} is reachable!')\n    else:\n        print(f'Warning: Host {target_ip} may be unreachable or blocking ICMP')\n        response = input('Continue with scan anyway? (y/n): ')\n        if response.lower() != 'y':\n            print(\"Scan cancelled.\")\n            sys.exit(0)\n\n    # Add a banner\n    print(\"-\" * 50)\n    print(f'Scanning target {target_ip}')\n    print(f'Time started: {datetime.now()}')\n    print(\"-\" * 50)            \n\n    try:\n        # Use multithreading to scan ports concurrently\n        threads = []\n        for port in range(1, 65536):\n            thread = threading.Thread(target=scan_port, args=(target_ip, port))\n            threads.append(thread)\n            thread.start()\n\n        # Wait for threads to complete\n        for thread in threads:\n            thread.join()\n\n    except KeyboardInterrupt:\n        print(\"\\nExiting program.\")\n        sys.exit(0)\n\n    except socket.error as e:\n        print(f'Socket error: {e}')\n        sys.exit(1)\n\n    print(\"\\nScan completed!\")  \n    print(f'Time finished: {datetime.now()}')\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> Common Ports txt example: <pre><code>20:FTP Data\n21:FTP Control\n22:SSH\n53:DNS/Pi-hole/Bind\n67:DHCP Server\n68:DHCP Client\n80:HTTP\n443:HTTPS\n445:SMB\n2375:Docker Daemon (insecure/TCP)\n2376:Docker Daemon (Secure/TLS)\n4444:Metasploit\n5335:Unbound\n5432:PostgreSQL\n6379:Redis\n7655:Pulse\n8001:Elastic Agent\n8002:Elastic Agent\n8006:Proxmox - PVE\n8007:Proxmox - PBS\n9000:Authentik/PHP/Netdata\n9443:Authentik/Portainer\n9090:Prometheus\n9200:Elasticsearch\n9093:Alert Manager\n9094:Alert Manager - Discord\n12320:Ansible\n12321:Ansible\n9115:Blackbox\n5000:Checkmk\n5050:Checkmk\n6060:CrowdSec\n8220:ELK Fleet\n7990:Heimdall\n5601:Kibana\n5678:n8n\n9392:OpenVAS\n5055:Overseer\n9617:Pi-Hole Exporter\n9001:Portainer Agent\n9221:Prometheus PVE Exporter\n6443:K3s\n3001:Uptime Kuma\n1514:Wazuh\n1515:Wazuh\n</code></pre></p> <p>A custom Python-based network scanner has been developed to provide tailored reconnaissance capabilities specific to the lab environment. The scanner performs several functions:</p> <ul> <li>Host Reachability Testing \u2014 Pings target hosts before attempting port scans to verify they are online, reducing wasted scan time and providing quick network inventory validation</li> <li>Port Scanning \u2014 Uses multi-threaded socket connections to rapidly identify open TCP ports across the full port range (1-65535) or targeted subsets based on scan objectives</li> <li>Service Identification \u2014 Labels discovered open ports using a custom service mapping file (common_ports.txt) that includes both standard services (SSH, HTTP, HTTPS) and lab-specific applications (Proxmox, Traefik, Authentik). This makes scan results immediately actionable by identifying what application is likely running on each open port</li> </ul>"},{"location":"projects/homelab/05-auto-iac/#64-script-integration-and-orchestration","title":"6.4 Script Integration and Orchestration","text":"<p>Scripts are integrated into broader workflows through several mechanisms. Some scripts are triggered directly by cron jobs for time-based execution. Others are called by monitoring systems in response to alerts or threshold violations (for example, a Grafana alert triggering a remediation script). Ansible playbooks orchestrate multi-step automation by calling shell scripts and Python utilities in sequence, passing parameters and handling error conditions. This layered approach combines the flexibility of custom scripts with the orchestration capabilities of configuration management tools, enabling sophisticated automation scenarios while maintaining maintainability and reusability.</p>"},{"location":"projects/homelab/05-auto-iac/#7-automation-security-controls","title":"7. Automation Security Controls","text":""},{"location":"projects/homelab/05-auto-iac/#control-framework","title":"Control Framework","text":"Control Domain Implementation Coverage Secrets Management Ansible Vault + Vaultwarden All credentials encrypted Access Control SSH keys only; sudo with NOPASSWD Ansible service account Code Integrity Git version control with commit signing All IaC assets Privilege Escalation Least privilege Proxmox service account Terraform API access Input Validation Regex validation in scripts Prevents injection attacks Audit Logging Syslog + Git commits + n8n execution logs Full audit trail Change Management Git Controlled deployments Backup &amp; Recovery GitHub + NAS + PBS Multiple restore points"},{"location":"projects/homelab/05-auto-iac/#authentication-authorization_1","title":"Authentication &amp; Authorization","text":"Technology Authentication Method Authorization Scope Terraform Proxmox API token (non-password) VM/LXC provisioning only Ansible SSH key (ed25519; passphrase) sudo NOPASSWD on managed hosts n8n Authentik SSO (OAuth2) Workflow admin access GitHub Personal access token (PAT) Repository push/pull Scripts User context (ansible/root) File system and service control"},{"location":"projects/homelab/05-auto-iac/#secrets-protection","title":"Secrets Protection","text":"Secret Type Storage Location Encryption Method Terraform API tokens terraform.tfvars (gitignored) File permissions 0600 Ansible passwords ansible-vault encrypted files AES-256 with master key n8n credentials Vaultwarden database Application-level encryption SSH private keys ~/.ssh/ with 0600 perms Passphrase-protected Script API tokens Environment variables Not persisted to disk"},{"location":"projects/homelab/05-auto-iac/#audit-trail-components","title":"Audit Trail Components","text":"Event Type Logging Mechanism Retention Git Commits GitHub repository Indefinite Terraform Apply Local state file + stdout log 90 days Ansible Playbook Runs Ansible log + syslog 90 days n8n Workflow Executions PostgreSQL + execution history 30 days Script Executions Syslog + individual log files 30 days Cron Job Runs /var/log/cron + job-specific logs 30 days"},{"location":"projects/homelab/05-auto-iac/#9-practical-use-cases-and-workflows","title":"9. Practical Use Cases and Workflows","text":""},{"location":"projects/homelab/05-auto-iac/#scenario-1-new-vm-provisioning","title":"Scenario 1: New VM Provisioning","text":"<p>Objective: Deploy new Docker host in &lt;5 minutes</p> <p>Workflow:</p> <ul> <li>Developer updates Terraform variables:</li> <li>hostname: docker-vm-03</li> <li>vmid: 203</li> <li>Run Terraform:</li> <li>cd terraform/vm</li> <li>terraform apply -var=\"hostname=docker-vm-03\" -var=\"vmid=203\" -auto-approve</li> <li>Terraform clones ubuntu-cloud template, provisions VM</li> <li>Output displays IP address: 192.168.100.203</li> <li>Run Ansible bootstrap:</li> <li>ansible-playbook -i hosts.yml new_install.yaml --limit docker-vm-03.home.com</li> <li>Ansible configures SSH, creates ansible user, installs packages</li> <li>VM ready for application deployment</li> </ul> <p>Result: Consistent, reproducible VM provisioning with full audit trail</p>"},{"location":"projects/homelab/05-auto-iac/#scenario-2-weekly-security-update-cycle","title":"Scenario 2: Weekly Security Update Cycle","text":"<p>Objective: Keep all systems patched without manual intervention</p> <p>Workflow:</p> <ul> <li>Saturday 2 AM: n8n workflow triggers</li> <li>n8n executes SSH command on Ansible controller</li> <li>Ansible playbook runs across all Linux hosts:</li> <li>Debian/Ubuntu: apt update &amp;&amp; apt upgrade -y</li> <li>RHEL/Fedora: dnf update -y</li> <li>Playbook output converted to JSON</li> <li>JSON uploaded to GitHub (audit trail)</li> <li>Discord notification sent with summary:</li> <li>23/25 hosts updated successfully</li> <li>2 hosts require reboot</li> <li>Admin reviews notification and schedules reboots if needed</li> </ul> <p>Result: Automated patch management with centralized reporting and alerting</p>"},{"location":"projects/homelab/05-auto-iac/#scenario-3-rapid-disaster-recovery","title":"Scenario 3: Rapid Disaster Recovery","text":"<p>Objective: Rebuild compromised VM from code</p> <p>Workflow:</p> <ul> <li>Incident detected: VM compromised via vulnerability</li> <li>Admin destroys compromised VM:</li> <li>terraform destroy -var=\"vmid=205\"</li> <li>Review Git history to find last known-good configuration:</li> <li>git log terraform/vm/main.tf</li> <li>Checkout previous commit if needed:</li> <li>git checkout abc123def terraform/vm/main.tf</li> <li>Rebuild VM with Terraform:</li> <li>terraform apply -var=\"hostname=web-vm-01\" -var=\"vmid=205\"</li> <li>Re-run Ansible playbooks to restore configuration:</li> <li>ansible-playbook -i hosts.yml site.yml --limit web-vm-01.home.com</li> <li>Restore application data from NAS backup</li> <li>VM back online with clean configuration</li> </ul> <p>Result: Complete rebuild in &lt;30 minutes vs. hours of manual work</p>"},{"location":"projects/homelab/05-auto-iac/#scenario-4-threat-intelligence-distribution","title":"Scenario 4: Threat Intelligence Distribution","text":"<p>Objective: Daily security awareness for lab operations</p> <p>Workflow:</p> <ul> <li>Daily 8 AM: n8n workflow executes</li> <li>RSS feeds polled from multiple cybersecurity sources</li> <li>Each feed limited to 5 most recent entries</li> <li>NIST feed sent to ChatGPT for AI summarization</li> <li>Aggregated digest posted to Discord #threat-intel channel</li> </ul> <p>Result: Consolidated threat intelligence reduces information overload</p>"},{"location":"projects/homelab/05-auto-iac/#scenario-5-configuration-drift-detection","title":"Scenario 5: Configuration Drift Detection","text":"<p>Objective: Ensure compliance with security baseline</p> <p>Workflow:</p> <ul> <li>Weekly: n8n triggers Ansible audit playbook</li> <li>Playbook gathers configuration from all hosts:</li> <li>SSH config settings</li> <li>Firewall rules</li> <li>Installed packages</li> <li>User accounts</li> <li>DNS configuration</li> <li>Output compared against baseline in Git</li> <li>Drift detected on 2 hosts (unauthorized package installed)</li> <li>Discord alert sent with details</li> </ul> <p>Result: Proactive detection of configuration drift and unauthorized changes</p>"},{"location":"projects/homelab/05-auto-iac/#11-security-homelab-section-links","title":"11. Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware </li> <li>Network Security, Privacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/06-apps-service/","title":"Applications and Services","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/06-apps-service/#architecture-overview","title":"Architecture Overview","text":"<p>The lab deploys a comprehensive application stack spanning infrastructure management, security operations, monitoring, automation, and productivity services. This ecosystem provides hands-on experience with enterprise-grade platforms while demonstrating integration patterns, security controls, and operational excellence.</p> <p>Core Service Categories:</p> <ul> <li>DNS Infrastructure: Multi-tier architecture with ad-blocking and DNSSEC validation</li> <li>SSH Access: Secure and auditable remote access to all hosts</li> <li>Reverse Proxy and Ingress Controller: Centralized ingress with TLS termination and SSO integration</li> <li>Vulnerability Management: Continuous scanning with OpenVAS and Nessus</li> <li>Patch Management: Comprehensive, multi-platform patch management solution with PatchMon (Linux), Windows Server Update Services, WUD (What's Up Docker) and Watchtower (Docker)</li> <li>Malware Protection Management: ClamAV (Linux, FreeBSD, MacOS), Microsoft Defender (Windows)</li> <li>Web Services: Apache2, NGINX and IIS web servers</li> <li>Miscellaneous Services: Media Management and Streaming, PDF Management, File Sharing, and Dashboard Services</li> </ul> <p>Deployment Rationale:</p> <p>This service architecture mirrors production enterprise environments, providing practical experience with tools used in security operations centers, DevOps teams, and infrastructure engineering roles. The layered approach to DNS, reverse proxy, and vulnerability scanning demonstrates defense-in-depth principles and operational maturity beyond simple lab exercises.</p> <p>Strategic Value:</p> <ul> <li>Unified Access: Heimdall dashboard provides single pane of glass for all services</li> <li>Security First: Every service protected by SSO, TLS certificates, and network segmentation</li> <li>Operational Visibility: Prometheus metrics, health checks, and centralized logging</li> <li>Automation Ready: API-first architecture enables workflow integration</li> <li>Enterprise Patterns: Reverse proxy, DNS hierarchy, and PKI mirror production designs</li> </ul>"},{"location":"projects/homelab/06-apps-service/#platform-and-service-dashboard","title":"Platform and Service Dashboard","text":"<p>       The Heimdall dashboard serves as a centralized launchpad for accessing the WebUIs of all deployed platforms and services within the lab environment. This unified interface streamlines navigation across infrastructure components.     </p> <p>       Where supported, API integrations have been configured to surface real-time metrics and service health indicators directly within the dashboard tiles. This enables at-a-glance visibility into system status, resource utilization, and uptime without requiring manual logins or context switching. Examples include container stats, authentication flow summaries, and firewall throughput, depending on the service.     </p>          Heimdall Dashboard Overview"},{"location":"projects/homelab/06-apps-service/#dns-infrastructure-architecture","title":"DNS Infrastructure Architecture","text":""},{"location":"projects/homelab/06-apps-service/#deployment-overview","title":"Deployment Overview","text":"<p>       A layered DNS setup balances local authority, recursive privacy, and high-performance ad-blocking. Pi-hole (`192.168.1.250`) acts as the primary resolver for network clients, forwarding standard queries to Unbound (`.252`) with `1.1.1.1` as fallback, and sending all `home.com` queries to BIND9 (`.251`) for authoritative local resolution. BIND9 serves as the master of the `home.com` zone with security hardening via `recursion yes`, `forward only`, and `deny-answer-addresses` to prevent DNS loops. Unbound communicates directly with root servers for maximum privacy from third-party DNS logging. The network path is: Client \u2192 Pi-hole \u2192 BIND9 (Authoritative Answer) \u2192 Traefik (Step-CA HTTPS) \u2192 Backend VM     </p>          Three-Tier DNS Architecture        <p>Security Impact</p> <ul> <li>Malware C2 communication blocked at the DNS layer before outbound connections can be established</li> <li>DNSSEC validation prevents DNS spoofing and poisoning attacks</li> <li>Privacy-preserving recursive resolution eliminates third-party visibility into DNS queries</li> <li>Conditional forwarding isolates the internal namespace from external resolvers</li> <li>DNS query logging enables threat hunting, anomaly detection, and forensic analysis</li> </ul> <p>Deployment Rationale:</p> <p>DNS is a foundational service that impacts every network connection. Compromise or disruption of DNS services can paralyze entire networks. Enterprise environments deploy layered DNS architectures for resilience, security, and performance. This implementation demonstrates understanding of DNS security best practices including split-horizon DNS (internal vs. external), DNSSEC validation, DNS-based threat blocking, and high-availability design patterns.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Three-tier architecture ensures single component compromise doesn't expose entire DNS infrastructure; ad-blocking, DNSSEC validation, and authoritative services provide overlapping security controls</li> <li>Secure by Design: DNSSEC validation enabled by default; DNS rebinding protection prevents internal IP exposure; rate limiting blocks DNS amplification attacks</li> <li>Zero Trust: Every DNS query validated and logged; no implicit trust of external resolvers; conditional forwarding segregates internal namespace</li> </ul> <p>Three-Tier DNS Architecture:</p> Tier Component IP Address Primary Function Secondary Function Edge/Filtering Pi-hole Primary 192.168.1.250 Primary Resolver for all network clients; Forwards standard queries to Unbound (<code>.252</code>); Upstreams to <code>1.1.1.1</code> as fallback Conditional Forwarding: Sends all <code>home.com</code> queries to BIND9 (<code>.251</code>) for authoritative resolution Edge/Filtering Pi-hole Backup 192.168.1.126 High-availability failover Synchronized blocklists and configuration Recursive Resolution Unbound 192.168.1.252 Recursive Resolver: Communicates directly with root servers for external domains, providing maximum privacy from third-party DNS logging Access Control: Configured to trust and respond to queries from specific local subnets. Privacy-preserving external resolution Authoritative Bind9 192.168.1.251 Authoritative Source for the <code>home.com</code> zone with exact IP mappings for entire homelab Security Hardening: Fixed with <code>recursion yes</code>, <code>forward only</code>, and <code>deny-answer-addresses</code> to prevent DNS loops and ensure local queries never leak to public internet <p>Design Rationale:</p> <p>Why Separate Components?</p> <ul> <li>Performance Isolation: Blocking logic (Pi-hole) separated from recursive resolution (Unbound) prevents query processing bottlenecks</li> <li>Independent Scaling: Each tier can be scaled independently based on load</li> <li>Fault Isolation: Unbound failure doesn't impact internal domain resolution via Bind9</li> <li>Security Segmentation: Authoritative server (Bind9) not directly exposed to internet queries</li> <li>Audit Trail Granularity: Each tier logs independently, enabling precise troubleshooting</li> </ul> <p>High Availability Configuration:</p> <p>Client Configuration:</p> <ul> <li>Primary DNS: 192.168.1.250 (Pi-hole Primary)</li> <li>Secondary DNS: 192.168.1.126 (Pi-hole Backup)</li> <li>Failover: Automatic via client DNS resolver (5-second timeout)</li> </ul> <p>Synchronization Strategy:</p> <ul> <li>Nebula-Sync: Replicates Pi-hole settings and blocklists every 15 minutes</li> <li>Custom DNS Records: Manually synchronized via Ansible playbook</li> <li>Blocklist Updates: Both instances independently update from upstream sources</li> </ul>"},{"location":"projects/homelab/06-apps-service/#bind9-namedconfoptions-configuration","title":"Bind9 <code>named.conf.options</code> configuration","text":"<pre><code>acl \"internal_networks\" {\n    127.0.0.1;\n    192.168.1.0/24;\n    192.168.2.0/24;\n    192.168.3.0/24;\n    192.168.100.0/24;\n    192.168.200.0/24;\n};\n\noptions {\n    directory \"/var/cache/bind\";\n\n    recursion yes;\n    allow-query { \"internal_networks\"; };\n    allow-recursion { \"internal_networks\"; };\n\n    listen-on { any; };\n\n    forwarders {\n        192.168.1.252 port 5335;\n    };\n    forward only;\n\n    // Stop local reverse lookups (PTR) for private IPs from leaking to Unbound\n    empty-zones-enable yes;\n\n    // DNS Rebinding protection: Prevents external domains from resolving\n    // to internal IP addresses.\n    deny-answer-addresses { 192.168.0.0/16; };\n\n    dnssec-validation auto;\n\n    version \"none\";\n};\n</code></pre>"},{"location":"projects/homelab/06-apps-service/#detailed-dns-query-flows","title":"Detailed DNS Query Flows","text":""},{"location":"projects/homelab/06-apps-service/#dns-query-flow-external-domains","title":"DNS Query Flow - External Domains","text":"<p>Client Request Flow:</p> <ol> <li>Client (192.168.1.31) \u2192 Pi-hole (192.168.1.250:53)</li> <li>Pi-hole checks:</li> <li>Blocklist: Is domain in ad/tracker blocklist?<ul> <li>If YES: Return 0.0.0.0 or NXDOMAIN (blocked)</li> <li>If NO: Continue</li> </ul> </li> <li>Local Cache: Is answer cached?<ul> <li>If YES: Return cached answer (TTL-aware)</li> <li>If NO: Continue</li> </ul> </li> <li>Local DNS Records: Manual override configured?<ul> <li>If YES: Return configured IP</li> <li>If NO: Continue</li> </ul> </li> <li>Pi-hole forwards to Unbound (192.168.1.252:5335)</li> <li>Unbound performs recursive resolution:</li> <li>Check Unbound cache (separate from Pi-hole cache)</li> <li>If not cached, query root servers (.) for TLD nameservers</li> <li>Query TLD nameservers for authoritative nameservers</li> <li>Query authoritative nameservers for final answer</li> <li>Validate DNSSEC signatures (if enabled for domain)</li> <li>Cache result (default TTL: as specified by authoritative server)</li> <li>Unbound returns answer to Pi-hole</li> <li>Pi-hole caches answer and returns to client</li> </ol> <p>Example Query for www.example.com:</p> <p>Client \u2192 Pi-hole \u2192 Unbound \u2192 Root (.) \u2192 .com TLD \u2192 example.com NS \u2192 IP</p> <p>Query Time: ~50ms (first query), ~1ms (cached)</p>"},{"location":"projects/homelab/06-apps-service/#dns-query-flow-internal-domains","title":"DNS Query Flow - Internal Domains","text":"<p>Client Request Flow for *.home.com:</p> <ol> <li>Client (192.168.1.31) \u2192 Pi-hole (192.168.1.250:53)</li> <li>Pi-hole Rule Matching:</li> <li>Pi-hole identifies home.com as a Conditional Forwarding target</li> <li>Target: 192.168.1.251 (BIND9)</li> <li>Pi-hole \u2192 BIND9:</li> <li>Pi-hole sends a recursive query to BIND9</li> <li>BIND9 Processing:</li> <li>Authority Check: BIND9 confirms it is the Master for home.com</li> <li>Record Lookup: Pulls the IP from db.home.com (e.g., uptimek \u2192 192.168.1.247)</li> <li>Security Check: BIND9 verifies the requesting IP (Pi-hole) is in its allow-query ACL</li> <li>BIND9 \u2192 Pi-hole \u2192 Client:</li> <li>Loop Prevention: BIND9 returns the answer directly. Because BIND9's forwarder is set to Unbound (not Pi-hole), no DNS loop occurs</li> </ol>"},{"location":"projects/homelab/06-apps-service/#reverse-dns-query-flow-ptr-lookup","title":"Reverse DNS Query Flow (PTR Lookup)","text":"<ol> <li>Client/Service Queries: e.g., \"Who is 192.168.100.51?\" (51.100.168.192.in-addr.arpa)</li> <li>Pi-hole Forwarding:</li> <li>Pi-hole sees the query for the 100.168.192 range</li> <li>Conditional forwarding sends this to BIND9 (.251)</li> <li>BIND9 Zone Selection:</li> <li>BIND9 matches the query to zone \"100.168.192.in-addr.arpa\" in named.conf.local</li> <li>It consults the specific reverse zone file: db.192.168.100</li> <li>Result: BIND9 returns stepca.home.com</li> <li>Outcome: Pi-hole and Traefik logs now display stepca.home.com instead of the raw IP address</li> </ol>"},{"location":"projects/homelab/06-apps-service/#the-security-gate-flow-dns-rebinding","title":"The \"Security Gate\" Flow (DNS Rebinding)","text":"<ol> <li>Client requests malicious-site.com</li> <li>Pi-hole (not on blocklist) \u2192 Unbound \u2192 Public Internet</li> <li>Upstream Response: The malicious DNS returns 192.168.1.254 (your pfSense IP)</li> <li>BIND9 Inspection:</li> <li>The answer passes through BIND9 (if BIND9 is the primary upstream) or is evaluated via the deny-answer-addresses rule</li> <li>Action: BIND9 sees a private IP address in a public response and drops the answer</li> <li>Result: The client receives no answer, preventing the malicious website from \"talking\" to your firewall</li> </ol> <p>Conditional Forwarding Rules:</p> Domain Pattern Target Server Purpose Use Case home.com 192.168.1.251:53 Internal zone authority All lab services (*.home.com) 1.168.192.in-addr.arpa 192.168.1.251:53 Reverse DNS (192.168.1.0/24) Production network PTR records 2.168.192.in-addr.arpa 192.168.1.251:53 Reverse DNS (192.168.2.0/24) DMZ services PTR records 100.168.192.in-addr.arpa 192.168.1.251:53 Reverse DNS (192.168.100.0/24) Lab infrastructure PTR records 200.168.192.in-addr.arpa 192.168.1.251:53 Reverse DNS (192.168.200.0/24) Kubernetes cluster PTR records <p>Upstream DNS:</p> <ul> <li>Primary: 192.168.1.252:5335 (Unbound)</li> <li>Secondary: 1.1.1.1 (Cloudflare, fallback only)</li> </ul>"},{"location":"projects/homelab/06-apps-service/#dns-security-controls","title":"DNS Security Controls","text":""},{"location":"projects/homelab/06-apps-service/#dnssec-validation-unbound","title":"DNSSEC Validation (Unbound)","text":"<ul> <li>Purpose: Cryptographically verify DNS responses haven't been tampered with in transit</li> <li>Implementation: Unbound (.252) performs full DNSSEC validation. Pi-hole (.250) and BIND9 (.251) are configured to trust Unbound's validation status (via the ad flag)</li> <li>Validation Behavior:</li> <li>Valid signature: Cache and return answer with AUTHENTICATED DATA status</li> <li>Invalid signature: Return SERVFAIL (blocks potentially poisoned records)</li> <li>No DNSSEC support: Process query normally (unsigned but not rejected)</li> <li>Security Impact: Prevents DNS cache poisoning and \"Man-in-the-Middle\" attacks for external lookups</li> </ul>"},{"location":"projects/homelab/06-apps-service/#query-logging-privacy-pi-hole-bind9","title":"Query Logging &amp; Privacy (Pi-hole &amp; BIND9)","text":"<ul> <li>Retention: 24 hours in Pi-hole's FTL database for real-time visibility</li> <li>Implementation: Pi-hole logs the \"Front-Door\" request from the client; BIND9 logs are restricted to internal zone transfers and errors to minimize disk I/O</li> </ul>"},{"location":"projects/homelab/06-apps-service/#rate-limiting-memory-protection","title":"Rate Limiting &amp; Memory Protection","text":"<ul> <li>Threshold: 1000 queries/minute per client IP (Pi-hole default)</li> <li>Memory Safeguard: Shared Memory (/dev/shm) expanded to 256MB to prevent FTL engine crashes and database locks during high-volume bursts</li> <li>Action: Temporary block (60-second cooldown)</li> <li>Purpose: Prevents DNS amplification attacks and detects DNS tunneling attempts by internal malware</li> </ul>"},{"location":"projects/homelab/06-apps-service/#dns-rebinding-protection-the-bind9-guard","title":"DNS Rebinding Protection (The \"BIND9 Guard\")","text":"<ul> <li>Rule: deny-answer-addresses enabled in BIND9 for the 192.168.0.0/16 range</li> <li>Implementation: If an external forwarder (like Cloudflare or Unbound) returns a private IP for a public domain (e.g., attacker.com \u2192 192.168.1.1), BIND9 explicitly drops the answer</li> <li>Security Impact: Prevents \"Browser-as-a-Proxy\" attacks where a malicious website tries to interact with your pfSense, Step-CA, or Traefik management interfaces</li> </ul>"},{"location":"projects/homelab/06-apps-service/#dns-based-ad-blocking-threat-intelligence","title":"DNS-Based Ad Blocking &amp; Threat Intelligence","text":"<ul> <li>Blocklists: 2M+ domains from curated feeds (StevenBlack, OISD, Firebog) via Pi-hole</li> <li>Local Overrides: Authoritative home.com records in BIND9 take precedence over any external blocklists</li> <li>Action: Blocked domains return 0.0.0.0 (null routing), causing connections to fail instantly without generating outbound traffic</li> <li>Update Frequency: Daily at 3 AM (Gravity update); BIND9 records are static and updated manually via db.home.com</li> </ul>"},{"location":"projects/homelab/06-apps-service/#dnssec-hardening-unbound","title":"DNSSEC Hardening (Unbound)","text":"<ul> <li>Configuration:</li> <li>harden-dnssec-stripped: yes (reject responses with DNSSEC signatures removed)</li> <li>val-clean-additional: yes (validate additional section of DNS responses)</li> <li>val-permissive-mode: no (strict validation, fail on invalid signatures)</li> <li>Security Impact: Prevents sophisticated attacks where attackers strip DNSSEC signatures to bypass validation</li> </ul>"},{"location":"projects/homelab/06-apps-service/#monitoring-observability","title":"Monitoring &amp; Observability","text":"<p>Pi-hole Dashboard:</p> <ul> <li>Real-Time Metrics:</li> <li>Queries per second (current load)</li> <li>Percentage blocked (ad-blocking effectiveness)</li> <li>Top queried domains (most frequently accessed)</li> <li>Top blocked domains (what's being filtered)</li> <li>Client activity breakdown (which devices query most)</li> <li>Access: https://pihole.home.com/admin/ (protected by Authentik SSO)</li> </ul> <p>Prometheus Metrics Exporter:</p> <ul> <li>Metrics Exposed:</li> <li>pihole_queries_total (cumulative query count)</li> <li>pihole_blocked_queries_total (cumulative blocks)</li> <li>pihole_query_types (A vs AAAA vs PTR distribution)</li> <li>pihole_cache_size (DNS cache entries)</li> <li>pihole_upstream_queries (queries forwarded to Unbound)</li> <li>Scrape Interval: 15 seconds (Prometheus)</li> <li>Grafana Dashboard: DNS query trends, block rates, cache hit ratios</li> </ul> <p>Uptime Kuma Health Checks:</p> <ul> <li>HTTP Check: https://pihole.home.com/admin/ (every 60 seconds)</li> <li>DNS Check: Resolve test.home.com via 192.168.1.250 (every 30 seconds)</li> <li>Alert Trigger: 3 consecutive failures \u2192 Discord webhook</li> </ul> <p>Discord Alerts:</p> <ul> <li>Service Failure: Pi-hole container down (Uptime Kuma)</li> <li>High Query Rate: &gt;10,000 queries/minute (potential DNS tunneling or amplification)</li> <li>Upstream DNS Failure: Unbound unreachable (Pi-hole fallback to Cloudflare 1.1.1.1)</li> <li>Sync Failure: Nebula-Sync unable to replicate to backup</li> </ul>"},{"location":"projects/homelab/06-apps-service/#secure-shell-ssh-access","title":"Secure Shell (SSH) Access","text":""},{"location":"projects/homelab/06-apps-service/#architecture-overview_1","title":"Architecture Overview","text":"<p>Enterprise-grade SSH infrastructure provides secure, auditable remote access to 40+ hosts across the lab environment. This implementation emphasizes modern cryptography (Ed25519), certificate-based authentication, centralized key management, and comprehensive session logging\u2014demonstrating zero-trust principles where every connection is authenticated, authorized, and audited.</p> <p>Security Impact</p> <ul> <li>Password-based SSH attacks eliminated through key-only authentication</li> <li>Root account compromise prevented by disabling direct root login</li> <li>Centralized key management enables instant credential revocation across all hosts</li> <li>Session logging provides forensic evidence for incident investigations</li> <li>Modern Ed25519 cryptography offers strong resistance to brute-force and emerging quantum-computing attacks</li> </ul> <p>Deployment Rationale:</p> <p>SSH is the primary administrative access method for Linux infrastructure in enterprise environments. Weak SSH configurations are frequently exploited by attackers (botnets scan for weak passwords, default credentials, outdated crypto). This hardened SSH deployment demonstrates understanding of cryptographic best practices, privilege escalation controls, and audit logging requirements mandated by compliance frameworks (PCI-DSS 8.2, NIST SP 800-53 AC-17).</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Multi-layer access controls (firewall IP restrictions, key-based authentication, privilege escalation via sudo, session logging)</li> <li>Secure by Design: Modern cryptography enforced by default; weak algorithms disabled; root login prohibited globally</li> <li>Zero Trust: Every session authenticated via cryptographic keys; source IP validation; session activity logged for audit</li> </ul>"},{"location":"projects/homelab/06-apps-service/#ssh-security-configuration-summary","title":"SSH Security Configuration Summary","text":"<p>Key Regeneration with ssh-ed25519:</p> <ul> <li>All previous keys were reissued using the Ed25519 algorithm for stronger cryptographic integrity and faster performance</li> <li>Keys are distributed manually or via internal automation (StepCA, Ansible playbook)</li> <li>Host and user keys are centrally managed</li> </ul> <p>Root Login Disabled:</p> <ul> <li>PermitRootLogin no ensures that root access is never exposed over SSH</li> <li>Privilege escalation is managed locally via sudo, with logging enabled for audit purposes</li> </ul> <p>Access Control and Audit:</p> <ul> <li>SSH access is restricted to specific users/groups</li> <li>Logging is centralized via Splunk for session tracking and anomaly detection</li> </ul> <p>Host Hardening:</p> <ul> <li>Firewall rules (via pfSense) restrict SSH to known IP ranges</li> </ul>"},{"location":"projects/homelab/06-apps-service/#supporting-infrastructure","title":"Supporting Infrastructure","text":"<ul> <li>StepCA Integration: SSH certificates can be issued via StepCA to streamline access provisioning and revocation</li> <li>Firewall Rules (pfSense): SSH access is restricted to trusted IP ranges and zones</li> <li>Host Hardening: SSHD is configured with minimal exposure, and unused authentication methods are disabled</li> <li>DNS Resolution: SSH targets resolved via Pi-hole \u2192 Unbound \u2192 Bind9 chain</li> </ul> <p>Example SSH Config: <pre><code>Host stepca\n  HostName stepca.home.com\n  User admin\n  IdentityFile ~/.ssh/id_ed25519\n</code></pre></p> <p>Configuration Rationale:</p> <p>Why Disable Root Login?</p> <ul> <li>Audit Trail: Forces administrators to log in as themselves, then sudo to root (logs show \"who did what\")</li> <li>Accountability: Can't claim \"root did it\" when each admin has unique account</li> <li>Least Privilege: Administrators only elevate to root when necessary</li> </ul> <p>Why Disable Password Authentication?</p> <ul> <li>Eliminates Brute-Force: Attackers can't guess passwords if passwords aren't accepted</li> <li>Eliminates Credential Stuffing: Leaked password databases useless without private key</li> <li>Forces MFA-Equivalent: Private key (something you have) + optional passphrase (something you know)</li> </ul> <p>Why Limit Ciphers/MACs/KexAlgorithms?</p> <ul> <li>Removes Weak Crypto: Old algorithms (3DES, RC4, MD5, SHA-1) exploitable</li> <li>Prevents Downgrade Attacks: Attacker can't force connection to use weak cipher</li> <li>Compliance: PCI-DSS, NIST SP 800-131A prohibit weak cryptography</li> </ul>"},{"location":"projects/homelab/06-apps-service/#key-management-strategy","title":"Key Management Strategy","text":"<p>Ed25519 Key Advantages:</p> <ul> <li>Key Size: 256-bit (equivalent to RSA 3072-bit security)</li> <li>Performance: 5x faster signature generation than RSA</li> <li>Security: Resistant to timing attacks</li> <li>Size: Smaller keys (68 bytes public, 32 bytes private)</li> </ul> <p>Key Distribution:</p> <ol> <li>Administrator generates key pair: <code>ssh-keygen -t ed25519 -C \"admin@lab\"</code></li> <li>Public key stored in Vaultwarden</li> <li>Ansible playbook deploys to authorized_keys on target hosts</li> <li>Private key stored encrypted on admin workstation</li> </ol>"},{"location":"projects/homelab/06-apps-service/#vs-code-remote-ssh-integration","title":"VS Code Remote SSH Integration","text":"<p>Configuration:</p> <ul> <li>Remote - SSH extension connects to lab hosts using SSH config</li> <li>Workspace: Shared folder on remote host</li> <li>Extensions: Installed remotely for Docker, Kubernetes, YAML</li> <li>Terminal: Integrated terminal provides direct shell access</li> <li>Port Forwarding: Automatic forwarding of service ports to local browser</li> </ul>"},{"location":"projects/homelab/06-apps-service/#audit-and-logging","title":"Audit and Logging","text":"<p>Session Logging:</p> <ul> <li>Syslog: All SSH sessions logged to /var/log/auth.log</li> <li>Wazuh Integration: Threat hunting module captures all Auth events</li> <li>Elastic Integration: Auth logs forwarded via syslog-ng</li> <li>Alerts: Discord notification on root login attempts (should never happen)</li> </ul> <p>Logged Events:</p> <ul> <li>Connection attempts (successful and failed)</li> <li>Authentication method used</li> <li>Source IP address</li> <li>Session duration</li> <li>Commands executed (if using sudo)</li> <li>File transfers (scp, sftp)</li> </ul> <p>Compliance Dashboard (Elastic):</p> <ul> <li>Failed Login Attempts: Graph by host and source IP</li> <li>Successful Logins: Table with user, host, timestamp</li> <li>Root Login Attempts: Alert (should be zero)</li> <li>Key-based vs Password Auth: Pie chart (should be 100% key-based)</li> </ul> <p>Alerting:</p> <p>Multiple failed SSH login attempts in Wazuh will trigger an alert notification to Discord and email. Active Response module will block the remote IP address on all configured hosts.</p>"},{"location":"projects/homelab/06-apps-service/#reverse-proxy-and-ingress-controllers","title":"Reverse Proxy and Ingress Controllers","text":""},{"location":"projects/homelab/06-apps-service/#architecture-overview_2","title":"Architecture Overview","text":"<p>To enable secure, centralized access to internal services and simplify URL structures across the lab, reverse proxies were deployed in front of several web-facing applications. This eliminates the need to remember non-standard ports or paths, allowing services to be accessed via top-level FQDNs.</p> <p>Security Impact</p> <ul> <li>TLS termination enforced at the edge, eliminating unencrypted HTTP exposure</li> <li>Centralized authentication via Authentik ForwardAuth provides SSO for all services</li> <li>Credential exposure eliminated by removing per-service password management</li> <li>Rate limiting blocks brute-force and credential-stuffing attempts</li> <li>IP allowlisting restricts access to trusted networks and administrative ranges</li> <li>Uniform security headers (HSTS, CSP, X-Frame-Options) harden all web applications against common attacks</li> </ul> <p>Deployment Rationale:</p> <p>Exposing multiple web services on different ports creates management complexity and security inconsistencies. Reverse proxies consolidate security controls at a single ingress point, mirroring enterprise edge architecture (NGINX, HAProxy, F5 BIG-IP). This demonstrates understanding of defense-in-depth where authentication happens at the network edge before requests reach backend applications.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Traefik enforces authentication before routing; WAF rules filter malicious requests; backend services isolated from direct internet exposure</li> <li>Secure by Design: TLS 1.3 mandatory; weak ciphers disabled; automated certificate renewal via Step-CA; secure headers applied by default</li> <li>Zero Trust: Every request authenticated via Authentik tokens; no implicit trust based on source IP; request metadata logged to SIEM</li> </ul>"},{"location":"projects/homelab/06-apps-service/#traefik-reverse-proxy-for-docker-lxc-and-vm-hosted-applications","title":"Traefik Reverse Proxy for Docker, LXC and VM Hosted Applications","text":"<p>Architecture Overview:</p> <p>Traefik acts as the edge router for all HTTP/HTTPS services in the lab, providing dynamic service discovery, automatic TLS certificate management, centralized authentication, load balancing, health checks, and observability. </p> <p>Traefik Container: - DNS Resolution: Hard-coded to Pi-hole (<code>.250</code>) and BIND9 (<code>.251</code>) to prevent internal Docker DNS timeouts - Certificate Handling: Configured with the <code>stepca</code> resolver, using Smallstep ACME protocol to automatically issue certificates to services - Prometheus Metrics: Enabled with specialized labels to allow Grafana to scrape per-service traffic data</p> <p>Step-CA: - Provisioner: Updated with an X.509 template that correctly handles IP SANs and uses <code>.Insecure.CR</code> variables for ACME compatibility - Validity: Hard-coded to 30-day (720h) durations to override default short-lived ACME certificates</p> <p>Deployment Architecture:</p> Component Technology Location Purpose Traefik Proxy Docker container 192.168.1.247 Edge router Configuration YAML + Docker labels /etc/traefik/ Static + dynamic config TLS Certificates Step-CA /certs/ Automatic cert management Authentik Outpost Docker container 192.168.1.247 SSO forward auth Dashboard Built-in and Elastic trfk.home.com:8080 Monitoring UI <p>Entrypoints:</p> <ul> <li>HTTP :80 -- for initial requests and redirection</li> <li>HTTPS :443 -- for secure traffic termination</li> <li>Traefik :8080 -- internal dashboard and metrics</li> </ul> <p>Providers:</p> <ul> <li>Docker -- for dynamic service discovery</li> <li>File (YAML) -- for static routing and middleware definitions</li> </ul> <p>Features:</p> <ul> <li>Prometheus metrics -- exposed for Grafana integration</li> </ul>"},{"location":"projects/homelab/06-apps-service/#http-middlewares","title":"HTTP Middlewares","text":"<p>Traefik middlewares enforce security, access control, and routing behavior:</p> <ul> <li>Forward Authorization via Authentik: Authentik acts as an identity provider, enforcing SSO and injecting identity headers (X-Forwarded-User, X-Forwarded-Groups) for downstream services</li> <li>IP Allow List: Restricts access to trusted networks (192.168.0.0/16, localhost). Applied to sensitive services (TheHive, Grafana, Traefik dashboard)</li> <li>Secure Headers:</li> <li>Strict-Transport-Security: max-age=31536000; includeSubDomains (HSTS)</li> <li>X-Frame-Options: SAMEORIGIN (clickjacking prevention)</li> <li>X-Content-Type-Options: nosniff (MIME type sniffing prevention)</li> <li>Referrer-Policy: strict-origin-when-cross-origin (privacy)</li> <li>Content-Security-Policy: default-src 'self' (XSS mitigation)</li> <li>Redirect Web to WebSecure: Automatically upgrades HTTP requests to HTTPS for all defined routes</li> <li>Rate Limiting: Limits requests to 100/minute per IP address (prevents brute-force attacks)</li> <li>Circuit Breaker: Automatically disables routing to unhealthy backends (monitors response codes, latency)</li> </ul>"},{"location":"projects/homelab/06-apps-service/#service-routing-table","title":"Service Routing Table","text":"<p>All routers are configured with TLS and mapped to internal services via hostname:</p> Hostname Backend Service Port Protocol Auth Health Check checkmk.home.com CheckMK container 5000 HTTP Authentik /check_mk/ dashbd.home.com Heimdall container 80 HTTP Authentik / elastic.home.com Elasticsearch 9200 HTTP Basic /_cluster/health n8n.home.com n8n workflow engine 5678 HTTP Authentik /healthz pulse.home.com Uptime Kuma 3001 HTTP Authentik / authentik.home.com Authentik server 9000 HTTP None /-/health/live/ trfk.home.com Traefik dashboard 8080 HTTP Authentik /ping grafana.home.com Grafana dashboards 3000 HTTP Authentik /api/health pihole.home.com Pi-hole primary 80 HTTP Authentik /admin/ piholebk.home.com Pi-hole backup 80 HTTP Authentik /admin/ plex.home.com Plex media server 32400 HTTPS Plex SSO /identity portainer.home.com Portainer CE 9443 HTTPS Authentik /api/status splunk.home.com Splunk Enterprise 8000 HTTP Splunk /services/server/info vault.home.com Vaultwarden 80 HTTP Vault /alive vas.home.com OpenVAS scanner 9392 HTTPS Basic /login wud.home.com What's Up Docker 3000 HTTP Authentik / whoami.home.com Traefik whoami 80 HTTP None /"},{"location":"projects/homelab/06-apps-service/#dns-and-routing-behavior","title":"DNS and Routing Behavior","text":"<p>All hostnames are defined via DNS A records pointing to the Traefik container's IP address. Traefik handles all routing internally, translating requests like:</p> <p>https://portainer.home.com \u2192 https://192.168.1.126:9443</p> <p>Example Router Configuration: <pre><code>http:\n  routers:\n    portainer-router:\n      rule: \"Host(`portainer.home.com`)\"\n      service: portainer-service\n      entryPoints: [websecure]\n      tls:\n        certResolver: stepca\n      middlewares:\n        - authentik\n        - secure-headers\n\n  services:\n    portainer-service:\n      loadBalancer:\n        serversTransport: portainer-tls\n        servers:\n          - url: \"https://192.168.1.126:9443\"\n        passHostHeader: true\n        healthCheck:\n          path: \"/\"\n          interval: \"30s\"\n\n  middlewares:\n    authentik:\n      forwardAuth:\n        address: \"http://authentik_proxy:9000/outpost.goauthentik.io/auth/traefik\"\n        trustForwardHeader: true\n        authResponseHeadersRegex: \"^X-Authentik-\"\n        authResponseHeaders:\n          - X-Authentik-Username\n          - X-Authentik-Groups\n          - X-Authentik-Entitlements\n          - X-Authentik-Email\n          - X-Authentik-Name\n          - X-Authentik-Uid\n          - X-Authentik-Jwt\n          - X-Authentik-Meta-Jwks\n          - X-Authentik-Meta-Outpost\n          - X-Authentik-Meta-Provider\n          - X-Authentik-Meta-App\n          - X-Authentik-Meta-Version\n</code></pre></p> <p>This allows services to be accessed via clean FQDNs without exposing backend ports.</p>"},{"location":"projects/homelab/06-apps-service/#tls-termination-and-backend-security","title":"TLS Termination and Backend Security","text":"<p>For services that do not natively support HTTPS or cannot integrate with the lab's PKI infrastructure, Traefik terminates TLS at the edge and forwards traffic to the backend over HTTP. This ensures:</p> <ul> <li>Secure communication between client and proxy</li> <li>Compatibility with legacy or non-PKI-compliant services</li> <li>Centralized certificate management via Step CA</li> </ul>"},{"location":"projects/homelab/06-apps-service/#security-controls","title":"Security Controls","text":"<p>Defense in Depth:</p> Layer Control Implementation Network Firewall rules (pfSense) Only 80/443 exposed Edge Traefik TLS termination Strong ciphers only Authentication Authentik forward auth SSO for all services Authorization HTTP headers from Authentik RBAC enforcement Transport TLS 1.3 only No downgrade attacks Application Secure headers middleware HSTS CSP X-Frame-Options Audit Access logs to Elastic Full request logging <p>Monitoring and Alerting:</p> Metric Tool Threshold Alert Traefik container down Uptime Kuma Service unreachable Discord Certificate expiry Prometheus &lt;30 days Discord High error rate Prometheus &gt;5% 5xx responses Discord Slow response time Prometheus P95 &gt;2 seconds Discord Config reload failures Traefik logs Any reload error Elastic alert <p>Troubleshooting Tools:</p> <ul> <li>Dashboard: https://trfk.home.com:8080/dashboard/</li> <li>API: <code>curl http://traefik:8080/api/http/routers</code></li> <li>Logs: <code>docker logs traefik -f --tail 100</code></li> <li>Debug Mode: Add <code>--log.level=DEBUG</code> to container</li> </ul> <p>Traefik Dashboard:</p> <ul> <li>Real-time router and service status</li> <li>Middleware configuration</li> <li>Certificate management</li> <li>Health check status</li> </ul>          Traefik Dashboard Overview"},{"location":"projects/homelab/06-apps-service/#metallb-and-nginx-ingress-controller-for-k3s-kubernetes-based-services","title":"MetalLB and NGINX Ingress Controller for K3s Kubernetes-Based Services","text":""},{"location":"projects/homelab/06-apps-service/#metallb","title":"MetalLB","text":"<p>MetalLB provides network load-balancer implementation for Kubernetes clusters that don't run on cloud providers. It enables services of type LoadBalancer to receive external IP addresses in bare-metal environments.</p> <p>Core Features:</p> <ul> <li>Address Allocation: Assigns external IPs from a pre-configured pool to Kubernetes services</li> <li>External Announcement: Makes assigned IPs reachable on the local network via Layer 2 (ARP/NDP) or BGP</li> </ul> <p>Layer 2 Mode Configuration:</p> <p>In Layer 2 mode, one Kubernetes node takes ownership of the service IP and responds to ARP requests. This provides simple, switch-agnostic load balancing without requiring BGP peering.</p> <p>Deployment Details:</p> <ul> <li>IP pool: 192.168.200.30-192.168.200.49 (20 addresses reserved for K3s services)</li> <li>ARP announcements via primary node (automatic failover if node fails)</li> <li>No external dependencies (works with any standard switch)</li> </ul> <p>Security Impact: Eliminates need for NodePort services (which expose random high ports); centralizes ingress traffic through predictable IPs; enables firewall rules based on service IP rather than dynamic ports.</p> <p>IP Address Pool Configuration: <pre><code>apiVersion: metallb.io/v1beta1\nkind: IPAddressPool\nmetadata:\n  name: pool1\n  namespace: metallb-system\nspec:\n  addresses:\n  - 192.168.200.30-192.168.200.49\n  autoAssign: true\n---\napiVersion: metallb.io/v1beta1\nkind: L2Advertisement\nmetadata:\n  name: pool1\n  namespace: metallb-system\n</code></pre></p>"},{"location":"projects/homelab/06-apps-service/#nginx-ingress-controller","title":"NGINX Ingress Controller","text":"<p>The NGINX Ingress Controller translates Kubernetes Ingress resources into NGINX configuration, providing HTTP/HTTPS routing, TLS termination, and load balancing for cluster services.</p> <p>Integration with MetalLB:</p> <ol> <li>Ingress Controller deployed as LoadBalancer service</li> <li>MetalLB assigns external IP (e.g., 192.168.200.31)</li> <li>External requests \u2192 MetalLB IP \u2192 NGINX Ingress \u2192 Backend pods</li> <li>NGINX handles TLS termination, path-based routing, and SSL passthrough</li> </ol> <p>Example Ingress Configuration: <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: nginx-ingress\n  namespace: nginx\nspec:\n  rules:\n  - host: 192.168.200.32\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n</code></pre></p> <p>Security Features:</p> <ul> <li>TLS Termination: Certificates managed by cert-manager + Step-CA</li> <li>Authentik Integration: ForwardAuth via NGINX annotations</li> <li>Rate Limiting: NGINX limit_req directives prevent abuse</li> <li>IP Whitelisting: nginx.ingress.kubernetes.io/whitelist-source-range annotation</li> </ul> <p>Architecture Benefits:</p> <ul> <li>Kubernetes-Native Design: Ingress resources define routing declaratively (no manual NGINX config)</li> <li>High Availability: Multiple NGINX replicas (2 pods) with MetalLB failover</li> <li>Separation of Concerns: MetalLB handles IP allocation; NGINX handles HTTP routing; cert-manager handles TLS</li> <li>Observability: Prometheus metrics exported by both MetalLB and NGINX Ingress</li> </ul>"},{"location":"projects/homelab/06-apps-service/#vulnerability-management","title":"Vulnerability Management","text":"<p>A mature vulnerability management program provides continuous security assessment across network assets, identifying exploitable weaknesses before attackers can weaponize them. This dual-scanner approach combines OpenVAS (open-source, network-wide scanning) with Tenable Nessus (commercial-grade, authenticated deep inspection) to provide comprehensive coverage across diverse technology stacks including Linux, Windows, containers, network appliances, and Kubernetes clusters.</p> <p>Security Impact</p> <ul> <li>Proactive identification of security weaknesses reduces dwell time from months (reactive patching) to days through risk-based prioritization</li> <li>Authenticated scanning uncovers privilege-escalation paths and configuration weaknesses that network-only scanners cannot detect</li> <li>Continuous assessment prevents security posture degradation between scheduled scans</li> </ul> <p>Deployment Rationale:</p> <p>Vulnerability management is a foundational security control mandated by NIST CSF (DE.CM-8), CIS Controls v8 (Control 7), PCI-DSS (11.2), and ISO 27001 (A.12.6.1). Deploying both OpenVAS and Nessus demonstrates real-world enterprise practices where multiple scanning tools provide defense-in-depth through overlapping coverage.</p> <p>Architecture Alignment:</p> <ul> <li>Defense in Depth: Vulnerability scanning discovers weaknesses across network, OS, application, and configuration layers before attackers can exploit them</li> <li>Secure by Design: Continuous scanning validates security baselines and detects configuration drift from hardened standards</li> <li>Zero Trust: Authenticated scans verify security posture of systems regardless of network location; vulnerability data feeds into risk-based access decisions</li> </ul>"},{"location":"projects/homelab/06-apps-service/#greenbone-openvas","title":"Greenbone OpenVAS","text":"<p>Overview:</p> <p>OpenVAS (Open Vulnerability Assessment System) provides comprehensive vulnerability scanning across network infrastructure and applications. This implementation demonstrates continuous security assessment and remediation workflow integration. The platform scans 75+ assets across four network segments weekly, identifying CVEs, misconfigurations, weak cryptography, and compliance violations.</p> <p>Deployment Architecture:</p> Component Description OpenVAS Scanner Deployed in a dedicated container with persistent volume for scan data and logs Reverse Proxy Traefik routes requests to OpenVAS UI and API, secured via TLS. ForwardAuth middleware enforces Authentik SSO authentication PKI Integration Fullchain certs propagated via Step CA; scanner trusts internal CA for HTTPS targets Dashboard Integration Scan results exported to Grafana via custom exporter and JSON API bridge <p>Scanning Architecture:</p> <p>Target Scope Definition:</p> Network Segment CIDR Asset Count Scan Frequency Production Network 192.168.1.0/24 ~40 hosts Weekly Lab Infrastructure 192.168.100.0/24 ~20 hosts Weekly DMZ Services 192.168.2.0/24 ~10 hosts Bi-weekly Kubernetes Cluster 192.168.200.0/24 ~5 hosts Weekly <p>Exclusions:</p> <ul> <li>Network devices without SSH/HTTP: 192.168.1.1-192.168.1.10</li> <li>IoT devices (limited patch capability): 192.168.1.200-250</li> <li>Active Directory DC (change control required): 192.168.1.10</li> </ul> <p>Scan Profiles:</p> Profile Name Description Duration Full and Fast Comprehensive scan optimized timing ~2 hours Discovery Network and service detection only ~15 min System Discovery OS fingerprinting and basic info ~30 min Host Discovery Ping sweep and port scan only ~5 min <p>Scan Configuration (Full and Fast):</p> <ul> <li>Port Range: 1-65535 (all TCP ports)</li> <li>UDP Ports: Top 100 common UDP services</li> <li>OS Detection: Active fingerprinting via TCP/IP stack analysis</li> <li>Service Detection: Banner grabbing and version detection</li> <li>TLS/SSL Testing: Certificate validation, weak ciphers, protocol versions</li> <li>Web App Scanning: Directory enumeration, known vulnerabilities</li> <li>Authenticated Scans: SSH and SMB credentials for deeper inspection</li> </ul> <p>Sample Reports:</p> <p>TLS/Certificate Issues:</p> <ul> <li>Weak cipher suites</li> <li>Certificate expiration</li> <li>Self-signed certificates</li> <li>Protocol vulnerabilities</li> </ul>          OpenVAS TLS/Certificate Scan Results        <p>OS and Service Fingerprinting:</p> <p></p> <p>Proxmox Host Scan Results:</p> <p></p> <p>Results from a scan on Proxmox host. After the initial scan, updates to address the critical vulnerability were downloaded and applied.</p>"},{"location":"projects/homelab/06-apps-service/#security-controls_1","title":"Security Controls","text":"<p>Scanner Hardening:</p> <p>Access Control:</p> <ul> <li>Traefik reverse proxy + Authentik SSO enforces MFA before accessing OpenVAS web interface</li> <li>API Authentication: GMP (Greenbone Management Protocol) API requires username/password authentication; API keys rotated quarterly</li> <li>Credential Encryption: Scan credentials (SSH keys, service account passwords) encrypted at rest using AES-256; stored in PostgreSQL database with TDE (Transparent Data Encryption)</li> <li>Audit Logging: All scan activity (task creation, target modifications, report downloads) logged to Splunk SIEM with user attribution</li> </ul> <p>Scan Safety Controls:</p> <ul> <li>Non-Disruptive Checks: Safe checks enabled by default; exploit-based tests disabled to prevent system crashes</li> <li>Rate Limiting: Maximum 10 concurrent TCP connections per target; configurable to prevent network congestion or triggering IPS alerts</li> <li>Excluded Checks: DoS-inducing vulnerability tests (e.g., TCP SYN flood checks) explicitly disabled in scan configurations</li> <li>Maintenance Windows: Automated scans scheduled during low-traffic periods (Saturday 2-4 AM) to minimize business impact</li> <li>Rollback Capability: Proxmox snapshots taken before scanning critical infrastructure (VMs, LXC containers); enables instant recovery from scan-induced failures</li> </ul> <p>Compliance Alignment:</p> <p>Framework Mapping:</p> Framework Requirement Implementation NIST CSF DE.CM-8: Vulnerability scans Weekly automated scans CIS Controls v8 7.1: Vulnerability scanning Authenticated scans enabled PCI-DSS 11.2: Quarterly vulnerability scans Monthly scans (exceeds req) ISO 27001 A.12.6.1: Tech vulnerabilities Documented remediation SLA"},{"location":"projects/homelab/06-apps-service/#tenable-nessus","title":"Tenable Nessus","text":"<p>Overview:</p> <p>Tenable Nessus provides commercial-grade vulnerability scanning with 170,000+ plugins, advanced compliance auditing, and deep authenticated scanning capabilities. While OpenVAS provides broad network coverage, Nessus excels at OS-level inspection via credentialed scans, configuration auditing against CIS Benchmarks, and specialized assessments for Active Directory, Kubernetes, and cloud platforms.</p> <p>Deployment Rationale:</p> <p>Nessus complements OpenVAS by providing deeper inspection capabilities and compliance auditing features. Many enterprises deploy both tools for defense-in-depth: OpenVAS for continuous automated scanning and Nessus for quarterly compliance audits and deep-dive investigations.</p> <p>Technical Implementation:</p> <p>Scanning Architecture - Authenticated Host Assessments:</p> <p>Nessus performs authenticated scans against key infrastructure hosts representing each major platform:</p> <p>Linux and Windows Host Scanning:</p> <ul> <li>Windows Server 2022 / Active Directory scanning and enumeration</li> <li>Hostname: DC01</li> <li>IP: 192.168.1.152</li> <li>Windows 11 Pro scanning</li> <li>Hostname: win11pro2</li> <li>IP: 192.168.1.184</li> <li>Red Hat Enterprise Linux 10 with K3s node scanning</li> <li>Hostname: k3s-worker</li> <li>IP: 192.168.200.21</li> <li>Ubuntu Desktop 25.04 with Docker engine scanning</li> <li>Hostname: ubuntuGenVM1</li> <li>IP: 192.168.1.126</li> <li>Debian 12 LXC host scanning</li> <li>Hostname: stepca</li> <li>IP: 192.168.100.51</li> </ul>"},{"location":"projects/homelab/06-apps-service/#example-remediation","title":"Example Remediation","text":"<p>Initial Scan: Debian Linux Package Vulnerabilities: - High/Medium CVSS rating - Multiple outdated packages identified - CVE details and remediation guidance provided</p> <p>Detailed Vulnerability Reports:</p> <p></p> <p>Follow-up Scan After Remediation:</p> <p></p> <p>Removal of all Debian Linux package vulnerabilities. Only remaining identified vulnerability higher than \"low\" is a false positive related to internal lab certificate issued by an \"unknown\" CA.</p>"},{"location":"projects/homelab/06-apps-service/#software-patch-management","title":"Software Patch Management","text":"<p>A comprehensive, multi-platform patch management strategy ensures timely deployment of security updates across 30+ Linux hosts, 50+ Docker containers, and Windows systems. This layered approach addresses the entire technology stack, from host operating systems to containerized applications, providing centralized visibility, automated monitoring, and controlled deployment workflows that reduce attack surface while maintaining operational stability.</p> <p>Security Impact</p> <ul> <li>Reduced attack surface through rapid deployment of security patches</li> <li>Centralized visibility into patch status prevents vulnerable systems from going unnoticed</li> <li>SHA-256 integrity verification protects against tampered packages and supply-chain attacks</li> </ul> <p>Deployment Rationale:</p> <p>Patch management is a critical component of defense-in-depth strategy, directly addressing NIST CSF \"Protect\" and CIS Control 7 (Continuous Vulnerability Management). Automated monitoring reduces mean time to detect (MTTD) for new vulnerabilities from weeks to hours, while coordinated deployment workflows minimize service disruption.</p> <p>Architecture Alignment:</p> <ul> <li>Defense in Depth: Patches eliminate vulnerabilities at OS, runtime, and application layers before they can be exploited</li> <li>Secure by Design: Automated monitoring ensures security updates are deployed by default, not as afterthought</li> <li>Zero Trust: Continuous verification of software versions prevents reliance on outdated \"trusted\" configurations</li> </ul>"},{"location":"projects/homelab/06-apps-service/#linux-software-management-patchmon","title":"Linux Software Management - PatchMon","text":"<p>PatchMon provides enterprise-grade visibility into Linux package states across Ubuntu, Debian, RHEL, CentOS, and Fedora systems. The platform monitors 30+ hosts via native package managers (apt, yum, dnf), tracking 5,000+ installed packages and correlating available updates with CVE databases to prioritize security-critical patches.</p> <p>Key Features:</p> <ul> <li>Centralized inventory eliminates shadow IT by discovering all installed packages</li> <li>CVE mapping enables risk-based patch prioritization</li> <li>Historical tracking demonstrates continuous security posture improvement</li> </ul> <p>Technical Implementation:</p> <ul> <li>Agent-Based Monitoring: Lightweight agents poll package managers every 6 hours for update availability</li> <li>Vulnerability Correlation: Available updates cross-referenced with NVD (National Vulnerability Database) to identify security patches vs. feature updates</li> <li>Multi-Distribution Support: Unified dashboard aggregates data from Debian-based (apt), RHEL-based (yum/dnf), and Arch-based (pacman) systems</li> <li>Docker Integration: Discovers containers running on monitored hosts, tracking base image versions and installed packages within containers</li> <li>Group-Based Organization: Hosts categorized by role (LXC containers, VM hosts, Docker hosts) for targeted patch campaigns</li> <li>Health Monitoring: Identifies hosts with &gt;50 outstanding updates or &gt;10 security updates as \"at-risk\" requiring immediate attention</li> </ul> <p>Host Information:</p> Friendly Name System Hostname IP Address Group OS OS Version Updates Security Updates apache-ubuntu apache-ubuntu 192.168.1.108 LXC containers Ubuntu 25.04 (Plucky Puffin) 0 0 bentopdf bentopdf 192.168.2.12 LXC containers Debian 13 (trixie) 29 0 bind9-new bind9-new 192.168.1.251 LXC containers Ubuntu 25.04 (Plucky Puffin) 30 13 centos centos 192.168.1.93 LXC containers CentOS 9 51 0 crowdsec crowdsec 192.168.1.33 LXC containers Debian 12 (bookworm) 33 5 Dockervm2 Dockervm2 192.168.1.166 DockerVM hosts Debian 13 (trixie) 214 28 elastic elastic 192.168.200.8 VM hosts Debian 13 (trixie) 37 0 fedora fedora 192.168.100.5 VM hosts Fedora 43 (Server Edition) 113 0 grafana-debian grafana-debian 192.168.1.246 LXC containers Debian 12 (bookworm) 66 3 heimdall heimdall 192.168.200.7 LXC containers Debian 12 (bookworm) 38 1 redhat-k3s-control k3-control 192.168.200.22 VM hosts Red Hat Enterprise Linux 10.1 (Coughlan) 1 0 redhat-k3s-worker k3-worker 192.168.200.21 VM hosts Red Hat Enterprise Linux 10.1 (Coughlan) 1 0 kali kaliGenVM 192.168.1.100 VM hosts Kali Linux 2025.4 872 0 overseerr overseerr 192.168.100.15 DockerLXC containers Debian 12 (bookworm) 47 4 ParrotOS parrot 192.168.100.16 VM hosts Parrot Security 7.1 (echo) 0 0 Pi-hole-Ubuntu Pi-hole-Ubuntu 192.168.1.250 DockerLXC containers Ubuntu 22.04.5 LTS (Jammy Jellyfish) 44 26 safeline safeline-waf 192.168.1.89 DockerVM hosts Debian 13 (trixie) 41 1 stepca stepca 192.168.100.51 LXC containers Debian 12 (bookworm) 31 1 traefik traefik 192.168.1.247 DockerLXC containers Debian 12 (bookworm) 37 3 Dockervm1 UbuntuVM1 192.168.1.126 DockerVM hosts Ubuntu 25.10 (Questing Quokka) 9 0 unbound unbound 192.168.1.252 LXC containers Ubuntu 22.04.5 LTS (Jammy Jellyfish) 34 20 uptime-kuma-debian uptime-kuma-debian 192.168.1.181 LXC containers Debian 12 (bookworm) 0 0 vaultwarden vaultwarden 192.168.1.4 LXC containers Debian 12 (bookworm) 44 6 ansible ansible 192.168.1.25 LXC containers Debian 12 (bookworm) 69 0 debian-Extlan debian-Extlan 192.168.2.5 LXC containers Debian 12 (bookworm) 4 3 Jellyfin-Ubuntu Jellyfin-Ubuntu 192.168.200.244 LXC containers Ubuntu 22.04.5 LTS (Jammy Jellyfish) 0 0 Plex-Ubuntu Plex-Ubuntu 192.168.1.136 LXC containers Ubuntu 22.04.5 LTS (Jammy Jellyfish) 34 21 Ubuntu-pfS Ubuntu-pfS 192.168.100.4 LXC containers Ubuntu 25.10 (Questing Quokka) 49 27 ubuntu-pfS2 ubuntu-pfS2 192.168.200.5 LXC containers Ubuntu 25.10 (Questing Quokka) 49 27 wazuh wazuh 192.168.1.219 LXC containers Debian 12 (bookworm) 0 0 splunk N/A N/A VM hosts unknown unknown 0 0 kms-iso N/A N/A LXC containers unknown unknown 0 0"},{"location":"projects/homelab/06-apps-service/#initial-overview-pre-patching","title":"Initial Overview - Pre-Patching","text":""},{"location":"projects/homelab/06-apps-service/#initial-host-scan","title":"Initial Host Scan","text":"<p>Host: parrot, parrot-security-7, 6.12.57+deb13-amd64</p> <p></p> <p>Outdated packages: 156, Security updates: 27</p>"},{"location":"projects/homelab/06-apps-service/#post-patching-scan","title":"Post-Patching Scan","text":"<p>Host: parrot, parrot-security-7.1, 6.17.13+2-amd64</p> <p></p> <p>Outdated packages: 0, Security updates: 0</p>"},{"location":"projects/homelab/06-apps-service/#windows-software-management-windows-server-update-services-wsus","title":"Windows Software Management - Windows Server Update Services (WSUS)","text":"<p>Windows Server Update Services provides centralized control over Microsoft product updates across Windows Server and Windows 10/11 endpoints. Unlike consumer Windows Update, WSUS enables approval workflows, phased deployments, and internal update distribution without requiring every client to download patches from Microsoft's servers.</p> <p>Benefits:</p> <ul> <li>Controlled deployment prevents zero-day patches from breaking production systems</li> <li>Bandwidth optimization reduces internet consumption by 80% (clients download once to WSUS, then distribute internally)</li> <li>Compliance reporting demonstrates adherence to patch SLAs for audits</li> </ul> <p>Technical Implementation:</p> <ul> <li>Centralized Update Server: WSUS server synchronizes with Microsoft Update catalog daily, downloading metadata and binaries for approved patch categories</li> <li>Approval Workflow: Administrators review updates in staging environment before approving for production deployment</li> <li>Computer Groups: Clients organized by role (Domain Controllers, File Servers, Workstations) enabling phased rollout (test group \u2192 production group)</li> <li>Automatic Deployment Rules: Critical security updates auto-approved for deployment within 24 hours; feature updates require manual approval</li> <li>Supersedence Handling: WSUS declines superseded updates automatically, preventing installation of outdated patches</li> <li>Reporting Dashboard: Compliance reports show installation status (installed, pending, failed) per computer and update</li> </ul> <p>Integration with Active Directory:</p> <ul> <li>Group Policy Objects (GPOs) enforce WSUS configuration across all domain-joined Windows systems</li> <li>WSUS server URL, update installation schedules, and reboot behavior centrally managed</li> <li>Non-compliant clients automatically remediated via GPO enforcement</li> </ul>"},{"location":"projects/homelab/06-apps-service/#docker-container-software-management","title":"Docker Container Software Management","text":"<p>Watchtower &amp; WUD (What's Up Docker): WUD provides visibility into outdated images, while Watchtower automates the update process for approved containers.</p>"},{"location":"projects/homelab/06-apps-service/#whats-up-docker-wud","title":"What's Up Docker (WUD)","text":"<p>       WUD monitors 50+ running containers across 4 Docker engines (UbuntuVM1, Dockervm2, SafeLine-WAF, Pi-hole-Ubuntu), checking Docker Hub, GitHub Container Registry, and private registries for image updates every 6 hours.     </p>          What's Up Docker Dashboard        <p>Technical Implementation:</p> <ul> <li>Multi-Engine Support: Connects to local and remote Docker daemons via TCP socket (TLS encrypted)</li> <li>Registry Integration: Authenticates with Docker Hub, GHCR, and private registries to query image tags</li> <li>Semantic Versioning: Detects new versions using semver comparison (1.2.3 \u2192 1.2.4 = patch, 1.2.x \u2192 1.3.0 = minor)</li> <li>Webhook Notifications: Sends Discord alerts when new versions available, including changelog links and vulnerability fix details</li> <li>Tag Tracking: Monitors specific tags (e.g., latest, stable, 1.x) and alerts when tag points to new digest</li> </ul> <p></p> <p></p>"},{"location":"projects/homelab/06-apps-service/#watchtower","title":"Watchtower","text":"<p>Watchtower monitors approved containers and automatically pulls new images, stops old containers, and starts updated versions with identical configurations. This \"self-healing\" approach ensures critical infrastructure containers (monitoring agents, log forwarders) remain current without manual intervention.</p> <p>Technical Implementation:</p> <ul> <li>Selective Monitoring: Only updates containers with <code>com.centurylinklabs.watchtower.enable=true</code> label, preventing unintended updates to production applications</li> <li>Configuration Preservation: Recreates containers with original environment variables, volumes, networks, and port mappings</li> <li>Cleanup: Removes old images after successful update to reclaim disk space</li> <li>Rollback Capability: Failed updates trigger automatic rollback to previous image version</li> <li>Notification Integration: Sends Discord webhook on successful update or rollback event</li> <li>Scheduling: Runs daily at 1 AM during low-traffic period</li> </ul> <p>Deployment Strategy:</p> <ul> <li>WUD Only (Manual Updates): Production application containers (databases, web apps) require approval before updates</li> <li>WUD + Watchtower (Auto-Updates): Infrastructure containers with low change risk (Prometheus exporters, logging agents, Grafana dashboards)</li> </ul>"},{"location":"projects/homelab/06-apps-service/#malware-protection-management","title":"Malware Protection Management","text":""},{"location":"projects/homelab/06-apps-service/#deployment-overview_1","title":"Deployment Overview","text":"<p>The malware protection layer provides host-based antivirus and antimalware capabilities across all operating systems in the lab environment. ClamAV delivers open-source malware scanning for Linux, FreeBSD, and macOS systems, while Microsoft Defender provides real-time protection, behavioral analysis, and cloud-assisted threat detection for Windows hosts.</p> <p>Security Impact</p> <ul> <li>Detects known malware, trojans, ransomware, and malicious binaries</li> <li>Provides real-time protection on Windows systems through Microsoft Defender</li> <li>Enables scheduled and on-demand scanning across Linux, BSD, and macOS via ClamAV</li> <li>Integrates with SIEM and SOAR platforms for automated alerting and response</li> <li>Supports file quarantine, signature updates, and threat classification</li> <li>Enhances endpoint-layer detection to complement network and SIEM telemetry</li> </ul> <p>Deployment Rationale:</p> <p>Malware protection is a foundational security control across enterprise environments. This deployment demonstrates the ability to manage multi-OS antivirus solutions, integrate them with SIEM/SOAR workflows, and maintain consistent scanning policies across diverse systems.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Adds endpoint-level malware detection beneath SIEM, EDR, and IDS layers; multiple engines reduce reliance on a single signature source; complements network-based detection with host-level scanning</li> <li>Secure by Design: Automated signature updates ensure current detection capabilities; real-time protection on Windows reduces exposure to active threats; scheduled scanning enforces consistent hygiene across all systems</li> <li>Zero Trust: No file or process is implicitly trusted; all are subject to scanning; continuous monitoring ensures rapid detection of malicious activity; integration with SOAR enforces validation before remediation actions</li> </ul>"},{"location":"projects/homelab/06-apps-service/#web-services-architecture","title":"Web Services Architecture","text":""},{"location":"projects/homelab/06-apps-service/#deployment-overview_2","title":"Deployment Overview","text":"<p>The web services layer hosts internal dashboards, application endpoints, and Windows-based update services across multiple platforms. Apache2 is deployed within an LXC container to serve the external lab dashboard and internal web applications. NGINX operates within the K3s cluster, providing reverse proxying, ingress routing, and application hosting for containerized workloads. Microsoft IIS runs on Windows Server Domain Controllers to support Windows Server Update Services (WSUS) and internal enterprise web functions.</p> <p>These services are protected by the SafeLine WAF, which currently secures four separate web portals\u2014including the Apache external lab dashboard and the NGINX web server in K3s. Active protections include intelligent web threat detection, bot mitigation, and HTTP-flood DDoS protection. Where required, additional authorization is enforced through Authentik using OIDC, ensuring strong identity-based access control for sensitive dashboards and administrative interfaces.</p> <p>Security Impact</p> <ul> <li>Segmented hosting reduces blast radius across LXC, Kubernetes, and Windows Server</li> <li>SafeLine WAF provides intelligent threat detection, bot filtering, and DDoS mitigation for all protected portals</li> <li>Authentik/OIDC adds identity-aware access control for sensitive web applications</li> <li>TLS termination and reverse proxying via NGINX protect backend services</li> <li>IIS supports secure distribution of Windows updates through WSUS</li> <li>Apache2 provides isolated hosting for external and internal dashboards</li> <li>Logging across all web servers supports SIEM correlation and threat hunting</li> </ul> <p>Deployment Rationale:</p> <p>Web services are essential for internal dashboards, update distribution, and application hosting. Deploying Apache2, NGINX, and IIS across different infrastructure layers demonstrates proficiency with multi-platform web hosting, reverse proxying, ingress management, and Windows-based enterprise services.</p> <p>Architecture Principles Alignment:</p> <ul> <li>Defense in Depth: Multiple web servers isolate workloads across containers, Kubernetes, and Windows; SafeLine WAF adds a dedicated protection layer before traffic reaches backend services; reverse proxying and ingress control provide additional filtering and segmentation; WSUS reduces exposure to external update sources</li> <li>Secure by Design: TLS-secured endpoints and hardened configurations across all web servers; Authentik/OIDC enforces strong authentication and access control; segmented hosting reduces cross-service exposure; logging and monitoring integrated with SIEM and SOAR</li> <li>Zero Trust: No inbound request is implicitly trusted; all traffic passes through WAF and controlled ingress; identity-based access enforced through Authentik/OIDC; continuous monitoring validates service integrity and request behavior</li> </ul> <p>Configuration:</p> <ul> <li>Apache2: Deployed within an LXC container supporting an internal dashboard</li> <li>NGINX: Deployed within K3s cluster supporting internal workloads</li> <li>Microsoft IIS: Deployed on Windows Server Domain Controllers supporting Windows Server Update Services</li> </ul>"},{"location":"projects/homelab/06-apps-service/#service-integration-architecture","title":"Service Integration Architecture","text":"<p>Integration Patterns:</p> <p>The lab services are interconnected through multiple integration patterns, demonstrating enterprise architecture principles:</p> Integration Type Pattern Examples Authentication SSO (OAuth2/OIDC) Authentik \u2192 All web services Observability Metrics Pull Prometheus \u2192 Service exporters Logging Centralized Syslog All services \u2192 Splunk/Elastic Service Discovery DNS + Reverse Proxy Pi-hole + Traefik Secret Management Centralized Vault Services \u2192 Vaultwarden API Certificate Distribution ACME Protocol Traefik \u2192 Step-CA Workflow Orchestration Event-Driven n8n \u2192 Ansible, GitHub, Discord Configuration Management Infrastructure as Code Ansible \u2192 All Linux hosts"},{"location":"projects/homelab/06-apps-service/#use-cases-and-deployment-scenarios","title":"Use Cases and Deployment Scenarios","text":""},{"location":"projects/homelab/06-apps-service/#scenario-1-zero-trust-web-access","title":"Scenario 1: Zero-Trust Web Access","text":"<p>Objective: Securely access Portainer from any device without VPN</p> <p>Workflow:</p> <ol> <li>User navigates to https://portainer.home.com from laptop</li> <li>DNS query: Laptop \u2192 Pi-hole \u2192 Bind9 \u2192 Returns 192.168.1.126</li> <li>HTTPS request: Laptop \u2192 Traefik (192.168.1.126:443)</li> <li>Traefik checks for valid session cookie</li> <li>No session found \u2192 Redirect to Authentik SSO</li> <li>User authenticates: username + password + TOTP (Microsoft Authenticator)</li> <li>Authentik validates credentials, checks MFA, issues JWT token</li> <li>Redirect back to Traefik with OAuth2 authorization code</li> <li>Traefik exchanges code for access token, creates session cookie</li> <li>Traefik forwards request to Portainer backend (192.168.1.126:9443)</li> <li>Traefik injects headers: X-authentik-username, X-authentik-email</li> <li>Portainer receives authenticated request, user accesses dashboard</li> </ol> <p>Result: Secure, passwordless access with MFA enforcement. No credentials stored in browser, session expires after 12 hours.</p>"},{"location":"projects/homelab/06-apps-service/#scenario-2-automated-vulnerability-remediation","title":"Scenario 2: Automated Vulnerability Remediation","text":"<p>Objective: Detect and patch vulnerabilities within SLA timeframe</p> <p>Workflow:</p> <ol> <li>Sunday 2 AM: OpenVAS scan runs on 192.168.1.0/24 network</li> <li>Scan completes: 2 Critical, 5 High, 15 Medium vulnerabilities found</li> <li>OpenVAS generates XML report with CVE details</li> <li>n8n workflow polls OpenVAS API every hour</li> <li>n8n detects new Critical vulnerability: CVE-2024-12345 (OpenSSH RCE)</li> <li>n8n workflow:</li> <li>Parses CVE details and affected hosts</li> <li>Creates GitHub Issue with vulnerability details, affected hosts, patch commands</li> <li>Labels: security, critical, needs-patch</li> <li>Sends Discord notification to #security channel with CVE link</li> <li>Admin receives alert within minutes</li> <li>Admin reviews CVE details on NVD database</li> <li>Admin tests patch in dev environment</li> <li>Admin applies patch via Ansible playbook: <code>ansible-playbook -i hosts.yml patch_openssh.yml --limit affected-hosts</code></li> <li>Ansible updates OpenSSH package on 5 affected hosts</li> <li>Admin marks GitHub issue as resolved</li> <li>Next Sunday: OpenVAS re-scan confirms vulnerability remediated</li> </ol> <p>Result: 7-day critical SLA met. Full audit trail from detection \u2192 remediation \u2192 verification.</p>"},{"location":"projects/homelab/06-apps-service/#scenario-3-dns-based-ad-blocking","title":"Scenario 3: DNS-Based Ad Blocking","text":"<p>Objective: Block ads and trackers network-wide without per-device configuration</p> <p>Workflow:</p> <ol> <li>IoT device (smart TV) attempts to fetch ad: ad.doubleclick.net</li> <li>DNS query: Smart TV \u2192 Pi-hole (192.168.1.250:53)</li> <li>Pi-hole checks query against 250,000 blocklists</li> <li>Match found: ad.doubleclick.net in blocklist</li> <li>Pi-hole returns: 0.0.0.0 (or NXDOMAIN)</li> <li>Smart TV receives \"no such domain\" response</li> <li>Ad request fails, content loads without ad</li> <li>Pi-hole logs query for statistics</li> </ol> <p>Result: Network-wide ad blocking without browser extensions. Protects all devices including IoT.</p>"},{"location":"projects/homelab/06-apps-service/#scenario-4-certificate-lifecycle-management","title":"Scenario 4: Certificate Lifecycle Management","text":"<p>Objective: Automatic certificate renewal without manual intervention</p> <p>Workflow:</p> <ol> <li>Day 0: Traefik requests certificate for portainer.home.com</li> <li>ACME HTTP-01 challenge to Step-CA</li> <li>Certificate issued: 365-day validity</li> <li>Stored in /acme.json</li> <li>Day 335 (30 days before expiry): Traefik triggers renewal</li> <li>Traefik initiates ACME renewal request</li> <li>Step-CA validates domain ownership again</li> <li>New certificate issued with fresh 365-day validity</li> <li>Old certificate replaced in acme.json</li> <li>Traefik hot-reloads certificate (no downtime)</li> <li>Day 330 (if renewal failed): Alert triggered</li> <li>Custom script checks certificate expiry daily</li> <li>Certificate &lt;30 days \u2192 Discord alert sent</li> <li>Admin investigates: Check Step-CA logs, network connectivity</li> <li>Manual renewal if needed: Restart Traefik to retry</li> </ol> <p>Result: Zero-touch certificate management. 100% uptime during renewals. Alerts only on failures.</p>"},{"location":"projects/homelab/06-apps-service/#scenario-5-distributed-logging-and-incident-investigation","title":"Scenario 5: Distributed Logging and Incident Investigation","text":"<p>Objective: Investigate failed login attempts across all services</p> <p>Workflow:</p> <ol> <li>Security team suspects brute force attack</li> <li>Analyst logs into Splunk: https://splunk.home.com</li> <li> <p>Runs SPL query: <pre><code>index=linux sourcetype=syslog \"Failed password\"\n| stats count by src_ip, dest_host\n| where count &gt; 10\n| sort -count\n</code></pre></p> </li> <li> <p>Results show:</p> </li> <li>Source IP: 192.168.1.99 (unknown device)</li> <li>Target: 5 different hosts</li> <li>Failed attempts: 150 in last hour</li> <li> <p>Analyst pivots to authentication logs: <pre><code>index=auth sourcetype=authentik\n| search src_ip=\"192.168.1.99\"\n</code></pre></p> </li> <li> <p>Finds Authentik login failures with username enumeration attempts</p> </li> <li>Analyst checks network context:</li> <li>MAC address lookup: IoT device (compromised smart bulb)</li> <li>First seen: 2 hours ago</li> <li>Remediation:</li> <li>Block IP at pfSense firewall</li> <li>Disconnect device from network</li> <li>Factory reset device</li> <li>Update firmware</li> </ol> <p>Result: Full attack lifecycle documented in SIEM. Incident contained within 30 minutes of detection.</p>"},{"location":"projects/homelab/06-apps-service/#security-homelab-section-links","title":"Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware </li> <li>Network Security, Privacy and Remote Access </li> <li>Identity, Access, Secrets and Trust Management </li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/","title":"Observability and Response Architecture","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/07-vis-response-pt1/#1-architecture-overview","title":"1. Architecture Overview","text":"<p>The lab implements a comprehensive observability and security monitoring stack that provides real-time visibility across infrastructure, applications, and security events. This multi-layered approach demonstrates enterprise-grade security operations center (SOC) capabilities and incident response readiness.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#core-technology-stack","title":"Core Technology Stack","text":"<ul> <li>SIEM Platforms: Splunk Enterprise (primary), Elastic Stack (secondary)</li> <li>Endpoint Detection: Wazuh EDR agents deployed on 25+ hosts across Windows, Linux, BSD, and macOS</li> <li>Network Monitoring: Suricata/Snort IDS, pfSense logging, NetAlertX</li> <li>Infrastructure Monitoring: Prometheus + Grafana for metrics visualization, CheckMK for system monitoring</li> <li>Service Availability: Uptime Kuma for service availability tracking, Pulse for Proxmox-specific monitoring</li> <li>Alerting Hub: Discord notifications through webhooks and email alerts through local SMTP relay</li> </ul>          SIEM and EDR/XDR Architecture Overview"},{"location":"projects/homelab/07-vis-response-pt1/#deployment-rationale","title":"Deployment Rationale","text":"<p>Security visibility is foundational to detecting and responding to threats before they cause damage. This architecture demonstrates:</p> <ul> <li>Correlation across multiple data sources: Network, host, and application telemetry</li> <li>Real-time detection: Security events and anomalies identified within seconds</li> <li>Hands-on experience: Industry-standard SIEM and monitoring tools (Splunk, Elastic, Prometheus, Wazuh)</li> <li>Enterprise SOC patterns: Integration workflows used in production environments</li> <li>Automated response: Incident response workflows triggered by alert conditions</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#architecture-principles-alignment","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Real-time SIEM correlation across multiple data sources (network, host, application)</li> <li>Multiple detection mechanisms reduce blind spots (SIEM, EDR)</li> <li>Correlation across network, application, and endpoint layers</li> <li>Redundant monitoring platforms (Splunk + Elastic) ensure continuity</li> </ul> <p>Secure by Design:</p> <ul> <li>Integration patterns demonstrate enterprise SOC workflows</li> <li>Documented playbooks and alert workflows for incident response</li> </ul> <p>Zero Trust:</p> <ul> <li>Continuous verification through comprehensive logging (100% security event coverage)</li> <li>Identity-aware monitoring tracks user behavior across systems</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#strategic-value","title":"Strategic Value","text":"<p>Comprehensive Visibility:</p> <ul> <li>360-degree view from network perimeter to application layer</li> <li>Unified dashboards provide single pane of glass for security posture</li> </ul> <p>Defense in Depth:</p> <ul> <li>Multiple detection mechanisms reduce single points of failure</li> <li>Overlapping coverage ensures threats are caught by at least one control</li> </ul> <p>Skills Development:</p> <ul> <li>Experience with commercial (Splunk) and open-source (Elastic) platforms</li> <li>Hands-on with tools directly transferable to SOC Analyst roles</li> </ul> <p>Incident Response:</p> <ul> <li>Documented playbooks and alert workflows demonstrate operational maturity</li> <li>Integration with TheHive enables case management and forensic tracking</li> </ul> <p>Compliance Readiness:</p> <ul> <li>Audit logs retained for 90 days with searchable correlation</li> <li>Immutable SIEM indexes support forensic investigations</li> <li>Comprehensive logging satisfies PCI-DSS 10.2, NIST SP 800-53 AU-2</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#why-multiple-siem-platforms","title":"Why Multiple SIEM Platforms?","text":"<p>Splunk (Primary):</p> <ul> <li>Mature SPL query language for security event correlation</li> <li>Industry-standard platform used in enterprise SOCs</li> <li>Robust alerting and dashboard capabilities</li> </ul> <p>Elastic (Secondary):</p> <ul> <li>ECS (Elastic Common Schema) standardization for vendor-neutral data modeling</li> <li>Focus on application telemetry and infrastructure metrics</li> <li>Open-source alternative demonstrates platform versatility</li> </ul> <p>Rationale: Dual deployment provides redundancy and learning opportunities with both commercial and open-source platforms commonly used in enterprise environments. This approach demonstrates adaptability and reduces vendor lock-in risk.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#2-splunk-enterprise-siem-platform","title":"2. Splunk Enterprise SIEM Platform","text":""},{"location":"projects/homelab/07-vis-response-pt1/#deployment-overview","title":"Deployment Overview","text":"<p>Splunk Enterprise functions as the centralized Security Information and Event Management (SIEM) platform for the lab environment, providing unified log aggregation, correlation, and real-time detection across all security and infrastructure layers. The deployment uses a single-instance architecture optimized for lab-scale operations, with a clear expansion path toward distributed indexing and search head clustering as data volume grows.</p>          Splunk Enterprise SIEM Architecture        <p>Splunk ingests telemetry from firewalls, IDS/IPS sensors, EDR agents, authentication systems, and application logs, normalizing events through the Common Information Model (CIM) to enable consistent, cross-source analytics.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#security-impact","title":"Security Impact","text":"<p>Splunk delivers enterprise-grade detection and visibility by consolidating more than 30 data sources into a single analytical plane. Real-time alerting identifies brute-force attempts, port scans, anomalous authentication behavior, and early indicators of lateral movement. Correlation searches detect multi-stage attack patterns such as privilege escalation, internal reconnaissance, and data exfiltration.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#deployment-rationale_1","title":"Deployment Rationale","text":"<p>A SIEM is the analytical backbone of any modern security program, enabling defenders to transform raw telemetry into actionable intelligence. This Splunk deployment demonstrates core SIEM competencies found in enterprise environments: CIM-based normalization, multi-source correlation, automated alerting, and integration with downstream SOAR workflows.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#architecture-principles-alignment_1","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Aggregates telemetry from every security layer (network, endpoint, identity, application)</li> <li>Correlation searches combine multiple signals to detect attacks that bypass single controls</li> <li>Redundant sourcetypes (pfSense, Suricata, Wazuh) ensure detection continuity</li> </ul> <p>Secure by Design:</p> <ul> <li>CIM standardization enforces consistent field structures</li> <li>Universal Forwarders provide authenticated, encrypted log transport</li> <li>Automated alerting and workflow triggers reduce human error</li> </ul> <p>Zero Trust:</p> <ul> <li>No event or data source is implicitly trusted</li> <li>Identity-centric analytics detect anomalous authentication</li> <li>Continuous monitoring ensures every action is observable</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#deployment-architecture","title":"Deployment Architecture","text":"Component Technology Location Purpose Splunk Indexer Splunk Enterprise 9.2.x Ubuntu VM Log storage and search Splunk Forwarder Universal Forwarder 9.2 All monitored hosts Log collection and forwarding Data Inputs Syslog, file monitoring Various Ingestion methods Indexes Time-series buckets /opt/splunk/var/lib Segmented storage"},{"location":"projects/homelab/07-vis-response-pt1/#universal-forwarder-deployment","title":"Universal Forwarder Deployment","text":"Host Type Forwarder Count Logs Forwarded Volume/Day pfSense Firewalls 2 Firewall, VPN, System, Auth 500 MB OPNsense Firewall 1 Firewall logs 100 MB Suricata IDS 4 (Internal LANs (Wasuh)) IDS/IPS alerts, flow data 2.5 GB Snort IDS 2 (VPN tunnels) IDS alerts 200 MB Wazuh Manager 1 Security alerts, audit logs 1 GB Windows Hosts 1 (Sysmon), 4 (Wazuh) Sysmon XML events, Wazuh 800 MB (Sysmon) Linux Hosts 23 (Wazuh) Wazuh MacOS Hosts 1 (Wazuh) Wazuh"},{"location":"projects/homelab/07-vis-response-pt1/#index-design","title":"Index Design","text":"Index Name Data Sources Retention Size/Day Purpose firewall-a pfSense filterlog 90 days 400 MB Network traffic logs vpn pfSense VPN logs 90 days 50 MB VPN connection logs system pfSense system logs 90 days 50 MB System events auth pfSense auth logs 90 days 20 MB Authentication events opnsense-syslog OPNsense firewall 90 days 100 MB Firewall logs suricata-prod_lan Suricata Prod_LAN interface 90 days 1 GB IDS alerts (internal) suricata-lab_lan1 Suricata Lab_LAN1 interface 90 days .5 GB IDS alerts (internal) suricata-lab_lan2 Suricata Lab_LAN2 interface 90 days .5 GB IDS alerts (internal) suricata-ext_lan Suricata Ext_LAN interface 90 days .5 GB IDS alerts (external) pia-ny Snort on PIA NY tunnel 90 days 100 MB VPN tunnel IDS pia-can-mont Snort on PIA Montreal 90 days 100 MB VPN tunnel IDS wazuh-alerts Wazuh security events 90 days 1 GB Endpoint security xmlwineventlog Windows Sysmon 90 days 800 MB Windows telemetry <p>Index Optimization:</p> <ul> <li>Hot/Warm/Cold Architecture: 7 days hot, 30 days warm, 53 days cold</li> <li>Compression: ~70% compression ratio on warm/cold buckets</li> <li>Frozen: Archive to NAS after 90 days (compressed tar.gz)</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#log-aggregation","title":"Log Aggregation","text":"<p>Data Inputs:</p> Source Input Type Method Notes Wazuh JSON over TCP Splunk Universal Forwarder Includes security alerts and audit logs pfSense Log files Splunk Universal Forwarder Firewall logs, VPN, authorization, and System Suricata JSON over File Splunk Universal Forwarder IDS/IPS alerts, flow data OPNsense Syslog (UDP) Splunk Universal Forwarder Firewall logs Sysmon XML via EventLog Splunk Universal Forwarder Windows endpoint telemetry, process tracking"},{"location":"projects/homelab/07-vis-response-pt1/#data-normalization-and-field-extraction","title":"Data Normalization and Field Extraction","text":"<p>Common Information Model (CIM) Compliance:</p> <p>Splunk CIM provides standardized field names across data sources for correlation.</p> CIM Data Model Normalized Fields Source Types Network Traffic src_ip, dest_ip, src_port, dest_port pfsense:filterlog, suricata Authentication user, src, dest, action pfsense:auth, wazuh-alerts Intrusion Detection signature, severity, category suricata, snort Endpoint process, parent_process, user xmlwineventlog:sysmon <p>Field Extraction Example (transforms.conf): <pre><code>[pfsense-filterlog-extract]\nREGEX = ^(\\S+)\\s+\\S+\\s+filterlog\\[\\d+\\]:\\s+\\d+,,,(\\d+),(\\w+),(\\d+),(\\S+),(\\d+),(\\S+),(\\d+),(\\w+),(\\d+),(\\d+),(\\d+),(\\S+),(\\d+),(\\d+),(\\d+),(\\d+),(\\w+)\nFORMAT = interface::$1 rule_number::$2 action::$3 protocol::$4 src_ip::$5 src_port::$6 dest_ip::$7 dest_port::$8\n</code></pre></p>"},{"location":"projects/homelab/07-vis-response-pt1/#searches-reports-and-dashboards","title":"Searches, Reports, and Dashboards","text":""},{"location":"projects/homelab/07-vis-response-pt1/#siem-overview-dashboard","title":"SIEM Overview Dashboard","text":"<p>Panels:</p> <ul> <li>Firewall Connections by Provider: A chart/table that lists network interfaces (providers) like vtnet0, vtnet1, tailscale0, etc., alongside the count of connections associated with each.</li> <li>Suricata Alerts by Count: Lists specific types of Suricata security alerts (alert, fileinfo, http, dns, tls, snmp, ssh, dhcp) and their frequency (count). alert has the highest count at 430,628.</li> <li>Wazuh Alerts by Host: A horizontal bar chart showing the count of alerts generated by specific hosts or agents (ApacheWeb-tec, DC01, KVM, etc.). ApacheWeb-tec has the highest alert count at over 40,000.</li> <li>Firewall Block/Pass: A status indicator showing the total count and percentage of blocked (1,675,851 / 92.20%) versus passed traffic (141,823 / 7.80%).</li> <li>Suricata Events by Interface: A colorful pie chart visualizing which internal IP addresses or network segments (192.168.x.x ranges) are generating the most Suricata security events.</li> <li>Mitre Tactic Stats: A line/area chart tracking the count of events mapped to different MITRE ATT&amp;CK Tactics over time, such as Defense Evasion, Impact, Lateral Movement, etc.</li> <li>Services Pie Chart: A large pie chart showing the distribution of traffic categorized by the application or service, likely derived from flow logs or firewall data.</li> </ul>      Splunk SIEM Overview Dashboard."},{"location":"projects/homelab/07-vis-response-pt1/#wazuh-alerts-for-my-windows-server-2022-domain-controller","title":"Wazuh alerts for my Windows Server 2022 Domain Controller","text":"<p>Query: <code>index=wazuh-alerts agent.name=DC01</code></p>      DC01 Alerts."},{"location":"projects/homelab/07-vis-response-pt1/#intrusion-prevention-system-alerts","title":"Intrusion Prevention System Alerts","text":"<p>Query: <code>index=ids sourcetype=suricata</code></p>      Suricata Alerts."},{"location":"projects/homelab/07-vis-response-pt1/#firewall-filter-logs","title":"Firewall Filter Logs","text":"<p>Query: <code>index=firewall-a sourcetype=pfsense:firewall</code></p>      pfSense Filter Log."},{"location":"projects/homelab/07-vis-response-pt1/#search-examples","title":"Search Examples","text":""},{"location":"projects/homelab/07-vis-response-pt1/#brute-force-detection-multi-source","title":"Brute Force Detection (Multi-Source)","text":"<pre><code>(index=auth sourcetype=pfsense:auth \"Failed password\") OR\n(index=wazuh-alerts rule.description=\"*authentication failed*\")\n| eval src_ip=coalesce(src,source_ip)\n| stats count by src_ip, dest\n| where count &gt; 10\n| eval threat_level=\"High\"\n</code></pre>"},{"location":"projects/homelab/07-vis-response-pt1/#port-scan-detection","title":"Port Scan Detection","text":"<pre><code>index=firewall-a action=block\n| stats dc(dest_port) as unique_ports, count by src_ip, dest_ip\n| where unique_ports &gt; 50 AND count &gt; 100\n| eval description=\"Possible port scan: \".src_ip.\" scanning \".unique_ports.\" ports on \".dest_ip\n</code></pre>"},{"location":"projects/homelab/07-vis-response-pt1/#vpn-traffic-analysis","title":"VPN Traffic Analysis","text":"<pre><code>index=firewall-a sourcetype=pfsense:filterlog\n| eval interface=if(like(interface,\"%ovpnc%\"),\"VPN\",\"Direct\")\n| stats sum(bytes) as total_bytes by interface\n| eval total_gb=round(total_bytes/1024/1024/1024,2)\n</code></pre>"},{"location":"projects/homelab/07-vis-response-pt1/#alert-configuration","title":"Alert Configuration","text":"<p>Scheduled Alerts:</p> Alert Name Search Schedule Trigger Condition Action Failed SSH Brute Force Every 5 minutes &gt;20 failed attempts Discord Critical Wazuh Alert Real-time rule.level &gt;= 12 Discord Suricata High Severity Every 15 minutes alert.severity = 1 Discord VPN Tunnel Down Every 1 minute No VPN traffic in 2 min Discord Anomalous Outbound Traffic Every 30 minutes Bytes &gt; 10GB in 30min Discord <p>Alert Tuning and False Positive Management:</p> <ul> <li>Baseline Period: 30 days to establish normal behavior</li> <li>Dynamic Thresholds: Adjust based on time of day, day of week</li> <li>Whitelist: Known benign IPs/hosts excluded from alerts</li> <li>Alert Suppression: Maximum 1 alert per source per hour</li> <li>Escalation: Critical alerts escalate after 15 minutes if unacknowledged</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#security-use-cases","title":"Security Use Cases","text":""},{"location":"projects/homelab/07-vis-response-pt1/#use-case-1-lateral-movement-detection","title":"Use Case 1: Lateral Movement Detection","text":"<p>Objective: Detect unauthorized account access across multiple systems</p> <p>SPL Query: <pre><code>index=wazuh-alerts OR index=auth\n| eval user=coalesce(user.name,user)\n| stats dc(agent.name) as unique_hosts by user\n| where unique_hosts &gt; 5\n| eval threat=\"Potential lateral movement: user accessed \".unique_hosts.\" hosts\"\n</code></pre></p>"},{"location":"projects/homelab/07-vis-response-pt1/#use-case-2-data-exfiltration-detection","title":"Use Case 2: Data Exfiltration Detection","text":"<p>Objective: Identify large outbound data transfers</p> <p>SPL Query: <pre><code>index=firewall-a action=pass\n| eval outbound=if(like(dest_ip,\"192.168.%\"),0,1)\n| where outbound=1\n| stats sum(bytes) as total_bytes by src_ip, dest_ip\n| where total_bytes &gt; 1073741824\n| eval total_gb=round(total_bytes/1024/1024/1024,2)\n| eval alert=\"Potential data exfiltration: \".total_gb.\"GB transferred\"\n</code></pre></p>"},{"location":"projects/homelab/07-vis-response-pt1/#use-case-3-malware-execution-detection","title":"Use Case 3: Malware Execution Detection","text":"<p>Objective: Detect execution of known malicious files</p> <p>SPL Query: <pre><code>index=xmlwineventlog EventCode=1\n| eval md5=lower(Hashes)\n| lookup malware_hashes.csv md5 OUTPUT malware_name\n| where isnotnull(malware_name)\n| table _time, Computer, User, Image, malware_name, CommandLine\n</code></pre></p>"},{"location":"projects/homelab/07-vis-response-pt1/#3-elastic-stack-elk-observability-platform","title":"3. Elastic Stack (ELK) Observability Platform","text":""},{"location":"projects/homelab/07-vis-response-pt1/#deployment-overview_1","title":"Deployment Overview","text":"<p>The Elastic Stack provides end-to-end observability across applications, infrastructure, and security events using the Elastic Common Schema (ECS) for standardized data modeling. This deployment emphasizes application performance monitoring (APM), infrastructure telemetry, and container visibility, complementing Splunk's security-centric analytics.</p>          Elastic Stack Observability Architecture        <p>Fleet Server centrally manages more than 25 distributed Elastic Agents, enforcing consistent policies across hybrid environments including VMs, Docker containers, and Kubernetes workloads. Kibana dashboards deliver real-time insights into system performance, application behavior, and operational health.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#security-impact_1","title":"Security Impact","text":"<p>Elastic enhances the security posture by delivering deep visibility into application and infrastructure behavior. ECS-compliant data modeling enables vendor-neutral threat detection and correlation across diverse telemetry sources. Infrastructure metrics expose resource exhaustion attacks, while container security monitoring identifies anomalous behavior within Docker and Kubernetes environments.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#deployment-rationale_2","title":"Deployment Rationale","text":"<p>While Splunk serves as the primary SIEM for security event correlation, Elastic Stack provides complementary strengths in application-level observability, infrastructure telemetry, and open-source analytics. ECS-based normalization supports vendor-agnostic correlation and multi-SIEM workflows.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#architecture-principles-alignment_2","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Adds application-level and infrastructure-level visibility</li> <li>Container and Kubernetes monitoring provide additional layers of behavioral detection</li> <li>ECS normalization enables correlation across heterogeneous data sources</li> </ul> <p>Secure by Design:</p> <ul> <li>ECS enforces consistent field structures</li> <li>Fleet Server centralizes agent policy enforcement</li> <li>Scalable architecture supports high-cardinality metrics</li> </ul> <p>Zero Trust:</p> <ul> <li>No telemetry source is implicitly trusted</li> <li>Continuous monitoring of applications, containers, and infrastructure</li> <li>Segmented data pipelines prevent cross-contamination</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#component-architecture","title":"Component Architecture","text":"<ul> <li>Elasticsearch: Distributed search and analytics engine that stores and indexes structured and unstructured data</li> <li>Logstash: Data processing pipeline that ingests, transforms, and forwards logs to Elasticsearch (used selectively)</li> <li>Kibana: Visualization and management interface for exploring data, building dashboards, and managing Fleet</li> <li>Fleet Server: Manages Elastic Agent enrollment, policy distribution, and secure communication with Elasticsearch</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#core-elk-stack-configuration","title":"Core ELK Stack Configuration","text":"<p>The central Elastic Stack is deployed on a KVM virtual machine running Debian 13, hosting:</p> <ul> <li>Elasticsearch, Logstash, and Kibana (ELK)</li> <li>Fleet Server and a local Elastic Agent</li> <li>Version: 9.2.1</li> </ul> <p>This VM serves as the central ingest, processing, and visualization hub for all telemetry across the lab environment.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#distributed-elastic-agents","title":"Distributed Elastic Agents","text":"<p>Elastic Agents are deployed across multiple hosts, each assigned a tailored Fleet policy with relevant integrations:</p> Hostname OS / Platform Agent Policy Integrations Traefik LXC Host LXC container system, Traefik integration for access logs and metrics, network packet capture DC01 Windows Server 2022 VM system, Windows, and Sysmon integrations for endpoint and process telemetry DockerVM1 Ubuntu VM system, Prometheus, and OPNSense (pfSense) integrations DockerVM2 Docker container running on Debian VM system, Docker, authentik integration for event and user activity logs Proxmox PVE Host Proxmox VE (Debian) system, Auditd integration for kernel-level audit logging, Cisco IOS Syslog Ubuntu-Apache LXC LXC container system, Apache HTTP Server, Suricata, and pfSense integrations for web and IDS logs K3s-control Kubernetes container System, Kubernetes metrics, network packet capture K3s-worker Kubernetes container System, Kubernetes metrics, network packet capture      Elastic Agent Deployment.    <p>Each agent is enrolled via Fleet and centrally managed through Kibana, enabling consistent policy updates, secure API key rotation, and streamlined observability across the lab.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#fleet-policy-configuration","title":"Fleet Policy Configuration","text":"<p>Example: Windows Endpoint Policy</p> <p>Integrations:</p> <ul> <li>System: CPU, memory, disk, network metrics</li> <li>Windows: Event logs (Security, Application, System)</li> <li>Sysmon: Process creation, network connections, registry changes</li> </ul> <p>Data Stream Configuration:</p> <p><code>logs-windows.sysmon-default:</code></p> <ul> <li>EventID 1: Process creation</li> <li>EventID 3: Network connection</li> <li>EventID 7: Image loaded</li> <li>EventID 10: Process access</li> <li>EventID 11: File creation</li> <li>EventID 13: Registry value set</li> </ul> <p><code>metrics-system.cpu-default:</code></p> <ul> <li>Metricset: cpu</li> <li>Period: 10s</li> <li>CPU percentages: user, system, idle, iowait</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#elastic-common-schema-ecs-mapping","title":"Elastic Common Schema (ECS) Mapping","text":"<p>ECS Field Standardization:</p> Integration ECS Dataset Prefix Key ECS Fields Used System system.* host.name, process.name, user.name, event.type Windows/Sysmon windows.* event.code, process.parent.name, registry.path Docker docker.* container.id, container.image.name, host.hostname Prometheus prometheus.* metricset.name, service.name, labels.* Suricata suricata.eve network.protocol, source.ip, event.category Apache apache.access http.request.method, url.path, user_agent.name Authentik authentik.* (custom) user.name, event.action, event.dataset Auditd auditd.* process.executable, event.action, user.id pfSense/OPNSense firewall.* source.ip, destination.port, event.outcome <p>ECS Benefits:</p> <ul> <li>Vendor Neutrality: Same queries work across different data sources</li> <li>Future-Proof: Adding new integrations automatically compatible</li> <li>Community Standard: Widely adopted in security and observability communities</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#kibana-dashboards","title":"Kibana Dashboards","text":""},{"location":"projects/homelab/07-vis-response-pt1/#ingest-pipelines","title":"Ingest Pipelines","text":"<ul> <li>Filebeat-style inputs via Elastic Agent for eve.json, Apache logs, and custom JSON</li> <li>Syslog inputs for pfSense and OPNSense firewall logs</li> <li>HTTP JSON inputs for Authentik API event collection</li> <li>Processors include:</li> <li>decode_json_fields for NDJSON</li> <li>add_fields for tagging source and dataset</li> <li>geoip and user_agent enrichment where applicable</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#dashboard-examples","title":"Dashboard Examples","text":"<p>Authentik Authentication Dashboard:</p> <p>Visualizations:</p> <ul> <li>Login Success Rate: Pie chart showing successful vs failed logins</li> <li>Login Attempts by User: Bar chart</li> <li>Geographic Login Distribution: Map of source.geo.location</li> <li>Authentication Timeline: Bar chart of login events</li> <li>Top Applications Accessed: Pie chart of event.dataset</li> </ul>      Authentik Authentication Dashboard.    <p>Suricata IDS Dashboard:</p> <p>Visualizations:</p> <ul> <li>Event Count</li> <li>Alert Severity Distribution: Pie chart (Critical, High, Medium, Low, Info)</li> <li>Activity Types Over Time: Stacked bar chart with 5-minute buckets</li> <li>Top Attack Signatures: Data table with alert.signature and count</li> <li>Protocol Breakdown: Donut chart of network.protocol</li> <li>Destination Ports: Heatmap of frequently targeted ports</li> </ul> <p>Example Kibana Query (KQL): <pre><code>event.dataset: suricata.eve AND event.kind: alert AND alert.severity: [1 TO 2]\n</code></pre></p>      Suricata IPS Dashboard.    <p>pfSense Firewall Filter Log and Location Dashboard:</p>      pfSense Firewall Logs.    <p>Windows Overview and Security Dashboards:</p> <p>Visualizations:</p> <ul> <li>Number of events</li> <li>Top Event IDs</li> <li>Number of Events Over Time by Channel: Bar chart of events by date</li> <li>Total Administrator and standard logins</li> <li>Login Event Timeline: Line graph of administrator and standard login events</li> <li>Administrator Users: Pie chart of logins by account</li> <li>Login Types: Pie chart of the login event by type</li> <li>Login Sources: Bar chart of the logins by source IP</li> <li>Login events: Table of login event by account, source IP and threads</li> </ul>      Windows Overview Dashboard."},{"location":"projects/homelab/07-vis-response-pt1/#4-wazuh-endpoint-detection-and-response-edr","title":"4. Wazuh Endpoint Detection and Response (EDR)","text":""},{"location":"projects/homelab/07-vis-response-pt1/#deployment-overview_2","title":"Deployment Overview","text":"<p>Wazuh provides host-based security monitoring, threat detection, and compliance auditing across Windows, Linux, BSD, and macOS endpoints. The platform combines SIEM-style log analysis with EDR-grade telemetry to deliver comprehensive endpoint visibility. Wazuh Agents collect file integrity data, vulnerability information, authentication logs, and system events, forwarding them to a centralized Wazuh Manager for correlation and alerting.</p>          Wazuh EDR Architecture"},{"location":"projects/homelab/07-vis-response-pt1/#security-impact_2","title":"Security Impact","text":"<p>Wazuh strengthens endpoint security by detecting unauthorized file changes, rootkits, suspicious processes, and privilege escalation attempts. File Integrity Monitoring (FIM) provides early detection of tampering with critical system files, while rootkit detection identifies hidden processes and kernel-level threats. Vulnerability assessment scans endpoints for missing patches and known CVEs, and Security Configuration Assessment (SCA) enforces CIS benchmark compliance.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#deployment-rationale_3","title":"Deployment Rationale","text":"<p>Endpoint compromise remains one of the most common initial access vectors in modern attacks. Wazuh provides essential host-level visibility and automated response capabilities that complement network-based and SIEM-based detection. Its multi-OS support ensures consistent monitoring across heterogeneous environments.</p>"},{"location":"projects/homelab/07-vis-response-pt1/#architecture-principles-alignment_3","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Adds endpoint-layer detection to complement network, identity, and application telemetry</li> <li>FIM, rootkit detection, and vulnerability scanning provide overlapping security controls</li> <li>Active Response automates containment to reduce dwell time</li> </ul> <p>Secure by Design:</p> <ul> <li>CIS benchmark audits enforce hardened configurations</li> <li>SCA policies detect deviations from approved security baselines</li> <li>VirusTotal integration validates suspicious artifacts</li> </ul> <p>Zero Trust:</p> <ul> <li>No endpoint activity is implicitly trusted</li> <li>Continuous monitoring ensures every process, file change, and authentication event is observable</li> <li>Automated containment actions enforce least-privilege</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#component-architecture_1","title":"Component Architecture","text":"<p>Deployment Model: Single-node manager running on an LXC, distributed agents</p> <p>Components:</p> <ul> <li>Wazuh Manager: Core analysis and correlation engine</li> <li>Wazuh Indexer: Stores and indexes security events</li> <li>Wazuh Dashboard: Web UI for search, visualization, and alert management</li> <li>Agents: Installed on monitored endpoints</li> <li>Splunk Universal Forwarder: Log export for system-wide normalization and correlation</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#agent-list","title":"Agent List","text":"ID Name IP address OS Platform and Release 0 wazuh 127.0.0.1 Debian GNU/Linux, 12 (bookworm) 1 Lab-Win11Pro 192.168.1.200 Microsoft Windows 11 Pro, 10.0.26100.4652 (N/A) 3 Win11-pfS 192.168.2.30 Microsoft Windows 11 Home, 10.0.26100.7171 (N/A) 7 KaliVM 192.168.1.100 Kali GNU/Linux, 2025.4 (N/A) 13 Logans-MacBook-Air.local 192.168.1.207 macOS, 14.7.8 (Sonoma) 14 OPNsense.internal 192.168.1.201 FreeBSD, 14.3 (N/A) 15 ApacheWeb-lxc 192.168.1.108 Ubuntu, 25.04 (Plucky Puffin) 16 stepca 192.168.100.51 Debian GNU/Linux, 12 (bookworm) 17 Win11Pro 192.168.1.111 Microsoft Windows 11 Pro, 10.0.26100.7462 (N/A) 18 UbuntuGenVM 192.168.1.126 Ubuntu, 25.1 (Questing Quokka) 19 DC01 192.168.1.152 Microsoft Windows Server 2022 Standard Evaluation, 10.0.20348.4529 (N/A) 20 win11pro2 192.168.1.184 Microsoft Windows 11 Pro for Workstations, 10.0.26200.7462 (N/A) 21 Plex-lxc 192.168.1.136 Ubuntu, 22.04.5 LTS (Jammy Jellyfish) 22 redhat-control 192.168.200.21 Red Hat Enterprise Linux, 10 (Coughlan) 23 K3s-control 192.168.200.22 Red Hat Enterprise Linux, 10.1 (Coughlan) 24 pihole 192.168.1.250 Ubuntu, 22.04.5 LTS (Jammy Jellyfish) 26 dockerVM2 192.168.1.166 Debian GNU/Linux, 13 (trixie) 27 bind9 192.168.1.251 Ubuntu, 25.04 (Plucky Puffin) 28 unbound 192.168.1.252 Ubuntu, 22.04.5 LTS (Jammy Jellyfish) 29 grafana 192.168.1.246 Debian GNU/Linux, 12 (bookworm) 30 ansible 192.168.1.25 Debian GNU/Linux, 12 (bookworm) 31 centos 192.168.1.93 CentOS Stream, 9 (N/A) 32 splunk 192.168.1.109 Ubuntu, 24.1 (Oracular Oriole) 33 fedora 192.168.100.5 Fedora Linux, 43 (Server Edition) 34 elastic 192.168.200.8 Debian GNU/Linux, 13 (trixie) 35 Ubuntu-pfLAN 192.168.2.7 Ubuntu, 25.1 (Questing Quokka) 36 ubuntu-pfs2 192.168.3.5 Ubuntu, 25.1 (Questing Quokka) 37 ubuntupfs 192.168.100.4 Ubuntu, 25.1 (Questing Quokka) 38 K3s-worker 192.168.200.21 Red Hat Enterprise Linux, 10.1 (Coughlan) 39 traefik 192.168.1.247 Debian GNU/Linux, 12 (bookworm) 40 debian-Extlan 192.168.2.5 Debian GNU/Linux, 12 (bookworm) 41 kms-iso 10.20.0.1 Ubuntu, 25.04 (Plucky Puffin) 42 parrotOS 192.168.100.16 Parrot Security, 7.1 (echo) 43 UbuntuVM1 192.168.1.126 Ubuntu, 25.1 (Questing Quokka) 44 Win2025server 192.168.1.90 Microsoft Windows Server 2025 Standard, 10.0.26100.7462 (N/A) 45 safeline 192.168.1.89 Debian GNU/Linux, 13 (trixie)      Wazuh Agent Overview."},{"location":"projects/homelab/07-vis-response-pt1/#security-monitoring-modules","title":"Security Monitoring Modules","text":""},{"location":"projects/homelab/07-vis-response-pt1/#file-integrity-monitoring-fim","title":"File Integrity Monitoring (FIM)","text":"<p>Purpose: Detect unauthorized changes to critical system files and attacker-target directories</p> <p>Configuration:</p> <ul> <li>Real-time monitoring: Enabled for critical paths and high-risk directories</li> <li>Linux: /root, /tmp, /var/tmp, /home/*/Downloads</li> <li>Windows: C:\\Users*\\Downloads, C:\\Windows\\Temp, C:\\Temp, C:\\Users*\\AppData\\Local\\Temp</li> <li>Scheduled scans: Every 12 hours for full filesystem baseline</li> <li>Hash algorithms: MD5, SHA1, SHA256</li> <li>Attributes tracked: Size, permissions, ownership, mtime</li> <li>Alert on: Creation, modification, deletion</li> </ul> <p>Example FIM Alerts:</p> <ul> <li>Description: New file created in /tmp</li> <li>File: /tmp/malicious.sh</li> <li> <p>Action: Alert + snapshot of file metadata</p> </li> <li> <p>Description: Integrity checksum changed</p> </li> <li>File: C:\\Windows\\System32\\drivers\\etc\\hosts</li> <li>Old MD5: abc123...</li> <li>New MD5: def456...</li> <li>Action: Alert + snapshot of file content</li> </ul> <pre><code>&lt;!-- File Integrity Monitoring --&gt;\n  &lt;syscheck&gt;\n    &lt;disabled&gt;no&lt;/disabled&gt;\n    &lt;frequency&gt;43200&lt;/frequency&gt;\n    &lt;scan_on_start&gt;yes&lt;/scan_on_start&gt;\n    &lt;alert_new_files&gt;yes&lt;/alert_new_files&gt;\n    &lt;auto_ignore frequency=\"10\" timeframe=\"3600\"&gt;no&lt;/auto_ignore&gt;\n\n    &lt;!-- Critical system dirs --&gt;\n    &lt;directories realtime=\"yes\"&gt;/etc&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/usr/bin&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/usr/sbin&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/bin&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/sbin&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/boot&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;C:\\Windows\\System32&lt;/directories&gt;\n\n    &lt;!-- Threat actor targets --&gt;\n    &lt;directories realtime=\"yes\"&gt;/root&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/var/tmp&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;/home/*/Downloads&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;C:\\Users\\*\\Downloads&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;C:\\Temp&lt;/directories&gt;\n    &lt;directories realtime=\"yes\"&gt;C:\\Users\\*\\AppData\\Local\\Temp&lt;/directories&gt;\n\n    &lt;!-- Ignore noise --&gt;\n    &lt;ignore&gt;/etc/mtab&lt;/ignore&gt;\n    &lt;ignore type=\"sregex\"&gt;.log$|.swp$&lt;/ignore&gt;\n    &lt;nodiff&gt;/etc/ssl/private.key&lt;/nodiff&gt;\n\n    &lt;skip_nfs&gt;yes&lt;/skip_nfs&gt;\n    &lt;skip_dev&gt;yes&lt;/skip_dev&gt;\n    &lt;skip_proc&gt;yes&lt;/skip_proc&gt;\n    &lt;skip_sys&gt;yes&lt;/skip_sys&gt;\n\n    &lt;process_priority&gt;10&lt;/process_priority&gt;\n    &lt;max_eps&gt;50&lt;/max_eps&gt;\n\n    &lt;synchronization&gt;\n      &lt;enabled&gt;yes&lt;/enabled&gt;\n      &lt;interval&gt;5m&lt;/interval&gt;\n      &lt;max_eps&gt;10&lt;/max_eps&gt;\n    &lt;/synchronization&gt;\n  &lt;/syscheck&gt;\n</code></pre>"},{"location":"projects/homelab/07-vis-response-pt1/#rootkit-detection","title":"Rootkit Detection","text":"<p>Purpose: Identify hidden processes, ports, and kernel modules</p> <p>Checks Performed:</p> <ul> <li>Hidden processes: Compare ps output with /proc</li> <li>Hidden ports: Netstat vs /proc/net/* comparison</li> <li>Kernel modules: Verify against known-good list</li> <li>System binaries: Check for trojaned ls, ps, netstat</li> <li>Registry anomalies: Windows registry rootkits</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#vulnerability-assessment","title":"Vulnerability Assessment","text":"<p>Purpose: Identify missing patches and known CVEs</p> <p>Vulnerability Sources:</p> <ul> <li>Windows: Microsoft Security Update Guide (MSU)</li> <li>Red Hat/CentOS: OVAL feeds</li> <li>Debian/Ubuntu: Debian Security Tracker</li> <li>macOS: Apple Security Updates</li> </ul> <p>Example Vulnerability Alert:</p> <ul> <li>CVE: CVE-2024-43451</li> <li>Title: NTLM Hash Disclosure Vulnerability</li> <li>CVSS: 8.1 (High)</li> <li>Affected: Windows Server 2022 DC01</li> <li>Package: ntlm.dll version 10.0.20348.2227</li> <li>Fix Available: Yes (KB5043936)</li> <li>Recommendation: Apply security update immediately</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#security-configuration-assessment-sca","title":"Security Configuration Assessment (SCA)","text":"<p>Purpose: Audit compliance with security benchmarks</p> <p>Policies Applied:</p> <ul> <li>CIS Windows Server 2022 Benchmark</li> <li>CIS Windows 11 Benchmark</li> <li>CIS Debian 12 Benchmark</li> <li>CIS Debian 13 Benchmark</li> <li>CIS Ubuntu 22.04 LTS Benchmark</li> <li>CIS Red Hat Enterprise Linux 10 Benchmark</li> <li>CIS CentOS Linux 9 Benchmark</li> <li>CIS Distribution Independent Linux Benchmark v2.0.0</li> <li>CIS Apache 2.4 Benchmark</li> <li>PCI-DSS v4.0 requirements</li> <li>NIST 800-53 controls</li> </ul> <p>Example SCA Finding:</p> <ul> <li>Policy: CIS Windows Server 2022</li> <li>Check ID: 2.3.10.5</li> <li>Title: Network access: Do not allow storage of passwords and credentials</li> <li>Status: FAIL</li> <li>Current Value: Enabled</li> <li>Expected Value: Disabled</li> <li>Remediation: Set HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\DisableDomainCreds to 1</li> <li>Severity: High</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#login-monitoring-sshrdp","title":"Login Monitoring (SSH/RDP)","text":"<p>Purpose: Detect brute force attempts and unauthorized remote access</p> <p>Configuration:</p> <ul> <li>Linux: Monitor /var/log/auth.log for failed SSH login attempts</li> <li>Windows: Monitor Security event channel for Event ID 4625 (failed RDP logins)</li> <li>Thresholds: Multiple failed attempts within a short timeframe trigger high-severity alerts</li> </ul> <p>Example Alert:</p> <ul> <li>Rule ID: 5710</li> <li>Description: Multiple failed SSH login attempts detected</li> <li>Source IP: 192.168.3.45</li> <li>Action: Alert + optional active response (firewall drop)</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#active-response","title":"Active Response","text":""},{"location":"projects/homelab/07-vis-response-pt1/#firewall-drop","title":"Firewall Drop","text":"<p>Command: <pre><code>&lt;command&gt;\n  &lt;name&gt;firewall-drop&lt;/name&gt;\n  &lt;executable&gt;firewall-drop&lt;/executable&gt;\n  &lt;expect&gt;srcip&lt;/expect&gt;\n  &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;\n&lt;/command&gt;\n</code></pre></p> <p>Active Response: <pre><code>&lt;active-response&gt;\n  &lt;command&gt;firewall-drop&lt;/command&gt;\n  &lt;location&gt;any&lt;/location&gt;\n  &lt;rules_group&gt;authentication_failed,sshd&lt;/rules_group&gt;\n  &lt;timeout&gt;600&lt;/timeout&gt;\n&lt;/active-response&gt;\n</code></pre></p> <ul> <li>Alerts/Trigger: Fires when rules in the authentication_failed or sshd groups are triggered</li> <li>Workflow: Wazuh passes the offending source IP (srcip) to the firewall-drop script, which inserts an iptables rule to block traffic. After 600 seconds, the block is lifted.</li> <li>Benefit: Immediate containment of brute-force attackers</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#host-deny","title":"Host Deny","text":"<p>Command: <pre><code>&lt;command&gt;\n  &lt;name&gt;host-deny&lt;/name&gt;\n  &lt;executable&gt;host-deny&lt;/executable&gt;\n  &lt;expect&gt;srcip&lt;/expect&gt;\n  &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;\n&lt;/command&gt;\n</code></pre></p> <p>Active Response: <pre><code>&lt;active-response&gt;\n  &lt;command&gt;host-deny&lt;/command&gt;\n  &lt;location&gt;any&lt;/location&gt;\n  &lt;rules_group&gt;authentication_failed&lt;/rules_group&gt;\n  &lt;timeout&gt;600&lt;/timeout&gt;\n&lt;/active-response&gt;\n</code></pre></p> <ul> <li>Alerts/Trigger: Activated on authentication_failed events</li> <li>Workflow: The offending IP is added to /etc/hosts.deny. After 600 seconds, the entry is removed.</li> <li>Benefit: Lightweight containment using TCP wrappers</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#disable-account","title":"Disable Account","text":"<p>Command: <pre><code>&lt;command&gt;\n  &lt;name&gt;disable-account&lt;/name&gt;\n  &lt;executable&gt;disable-account&lt;/executable&gt;\n  &lt;expect&gt;user&lt;/expect&gt;\n  &lt;timeout_allowed&gt;no&lt;/timeout_allowed&gt;\n&lt;/command&gt;\n</code></pre></p> <p>Active Response: <pre><code>&lt;active-response&gt;\n  &lt;command&gt;disable-account&lt;/command&gt;\n  &lt;location&gt;local&lt;/location&gt;\n  &lt;rules_group&gt;authentication_failed&lt;/rules_group&gt;\n&lt;/active-response&gt;\n</code></pre></p> <ul> <li>Alerts/Trigger: Fires when a local user repeatedly fails authentication</li> <li>Workflow: Wazuh passes the username to the disable-account script, which locks the account immediately</li> <li>Benefit: Prevents compromised or brute-forced accounts from being abused</li> </ul>      Active Response Events"},{"location":"projects/homelab/07-vis-response-pt1/#integrations","title":"Integrations","text":""},{"location":"projects/homelab/07-vis-response-pt1/#splunk","title":"Splunk","text":"<p>Log Forwarding Configuration:</p> <p>Wazuh Manager \u2192 Splunk Universal Forwarder \u2192 Splunk Indexer</p> <p>Forwarder Configuration (inputs.conf): <pre><code>[monitor:///var/ossec/logs/alerts/alerts.json]\ndisabled = false\nsourcetype = wazuh:alerts\nindex = wazuh-alerts\nsource = wazuh-manager\n</code></pre></p> <p>Alert Enrichment in Splunk:</p> <ul> <li>MITRE ATT&amp;CK Mapping: Techniques and tactics</li> <li>Asset Context: Host criticality, owner, location</li> <li>Threat Intelligence: IOC matching from feeds</li> <li>User Context: AD user attributes, group membership</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#virustotal","title":"VirusTotal","text":"<p>VirusTotal is integrated into the File Integrity Monitoring workflow through a custom rule that targets new or modified executable and script files.</p> <ul> <li>Scope: Applies to File Integrity Monitoring events involving executable and script files in monitored directories</li> <li>Trigger: Custom rule_id 87105 fires when VirusTotal reports multiple positive detections</li> <li>Action: Host-level Bash script is invoked automatically to quarantine or remove the flagged file</li> <li>Benefit: Only suspicious binaries are escalated; preserves VirusTotal API quota</li> </ul> <p>Configuration: <pre><code>&lt;integration&gt;\n  &lt;name&gt;virustotal&lt;/name&gt;\n  &lt;api_key&gt;xxxxxxxxxxxxxxxxxxx&lt;/api_key&gt;\n  &lt;rule_id&gt;100003&lt;/rule_id&gt;\n  &lt;alert_format&gt;json&lt;/alert_format&gt;\n&lt;/integration&gt;\n\n&lt;command&gt;\n  &lt;name&gt;remove-threat&lt;/name&gt;\n  &lt;executable&gt;remove-threat.sh&lt;/executable&gt;\n  &lt;timeout_allowed&gt;no&lt;/timeout_allowed&gt;\n&lt;/command&gt;\n\n&lt;active-response&gt;\n  &lt;disabled&gt;no&lt;/disabled&gt;\n  &lt;command&gt;remove-threat&lt;/command&gt;\n  &lt;location&gt;local&lt;/location&gt;\n  &lt;rules_id&gt;87105&lt;/rules_id&gt;\n&lt;/active-response&gt;\n</code></pre></p>      Wazuh VirusTotal Integration"},{"location":"projects/homelab/07-vis-response-pt1/#discord","title":"Discord","text":"<p>External alerting to Discord has been configured for specific workflows. Alerts from the sshd, authentication_failure, or syscheck_file groups trigger a custom script that sends a message to a Discord webhook in the #wazuh channel.</p> <ul> <li>Scope: Alerts generated by sshd, authentication_failure, syscheck_file groups</li> <li>Trigger: When any of these groups fire, Wazuh's active response mechanism invokes a custom Bash script</li> <li>Action: The script formats the alert into a Discord embed enriched with rule, group, and host metadata</li> <li>Benefit: Real-time visibility into critical security events with actionable context</li> </ul> <p>Configuration: <pre><code>&lt;integration&gt;\n  &lt;name&gt;discord&lt;/name&gt;\n  &lt;hook_url&gt;https://discord.com/api/webhooks/xxxxxxxx&lt;/hook_url&gt;\n  &lt;group&gt;multiple_drops,authentication_failed,sshd,syscheck_file&lt;/group&gt;\n  &lt;alert_format&gt;json&lt;/alert_format&gt;\n&lt;/integration&gt;\n\n&lt;command&gt;\n  &lt;name&gt;discord&lt;/name&gt;\n  &lt;executable&gt;discord.sh&lt;/executable&gt;\n  &lt;expect&gt;json&lt;/expect&gt;\n  &lt;timeout_allowed&gt;no&lt;/timeout_allowed&gt;\n&lt;/command&gt;\n\n&lt;active-response&gt;\n  &lt;disabled&gt;no&lt;/disabled&gt;\n  &lt;command&gt;discord&lt;/command&gt;\n  &lt;location&gt;local&lt;/location&gt;\n  &lt;rules_group&gt;sshd,authentication_failure,syscheck_file&lt;/rules_group&gt;\n&lt;/active-response&gt;\n</code></pre></p>"},{"location":"projects/homelab/07-vis-response-pt1/#shuffle-soar","title":"Shuffle SOAR","text":"<p>External alerting to Shuffle SOAR has been configured to automate case creation, enrichment, and downstream workflows. Alerts meeting the defined severity threshold are forwarded to a Shuffle webhook, where a workflow processes and routes the event for further action. Alerts are enriched with rule, agent, and metadata fields before being sent to TheHive or other SOAR components.</p> <p>Scope Alerts generated by Wazuh with severity \u2265 4 are forwarded to Shuffle for automated processing. This includes, but is not limited to, events from:</p> <ul> <li><code>sshd</code> \u2014 SSH authentication activity  </li> <li><code>authentication_failure</code> \u2014 failed login attempts  </li> <li><code>syscheck_file</code> \u2014 file integrity monitoring changes  </li> <li>Any rule group producing level 4+ alerts</li> </ul> <p>Trigger When an alert meets the configured severity threshold, Wazuh\u2019s integration engine sends the full JSON alert payload to the Shuffle webhook.</p> <p>Action Inside Shuffle, the workflow performs the following steps:</p> <ul> <li>Parses the incoming Wazuh alert JSON</li> <li>Extracts key metadata fields:</li> <li>Rule \u2192 rule description and rule ID</li> <li>Group \u2192 Wazuh rule group classification</li> <li>Host \u2192 agent name or hostname</li> <li>Severity \u2192 numeric Wazuh level</li> <li>Normalizes and sanitizes fields for TheHive compatibility</li> <li>Creates a TheHive Alert using the enriched data</li> <li>Routes alerts to additional automations such as:</li> <li>Case creation</li> <li>Discord/email notifications</li> <li>Cortex analyzers</li> </ul> <p>Delivery The enriched alert is delivered to Shuffle via a webhook configured in Wazuh:</p> <pre><code>&lt;integration&gt;\n    &lt;name&gt;shuffle&lt;/name&gt;\n    &lt;hook_url&gt;https://192.168.200.41/api/v1/hooks/webhook_32c000c1-3d4d-47f2-94d2-f1c76c2f8c35&lt;/hook_url&gt;\n    &lt;level&gt;4&lt;/level&gt;\n    &lt;alert_format&gt;json&lt;/alert_format&gt;\n&lt;/integration&gt;\n</code></pre>"},{"location":"projects/homelab/07-vis-response-pt1/#alerting-and-notifications","title":"Alerting and Notifications","text":"<p>Purpose: Provide immediate visibility into critical events</p> <p>Configuration:</p> <p>Email Alerts (Gmail):</p> <ul> <li>Wazuh configured to send alerts via local relay (msmtp) \u2192 smtp.gmail.com:587</li> <li>Alerts delivered to wazuh@shadowitlab.com</li> </ul> <p>Discord Alerts:</p> <ul> <li>Custom active response script posts alerts to Discord webhook channel</li> <li>Triggered on new file creation in monitored directories or multiple failed login attempts</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#wazuh-dashboard-analytics","title":"Wazuh Dashboard Analytics","text":""},{"location":"projects/homelab/07-vis-response-pt1/#file-integrity-monitoring","title":"File Integrity Monitoring","text":"<p>Visualizations:</p> <p>Overview:</p> <ul> <li>Alerts by action over time: Line chart showing file modifications, additions, and deletions</li> <li>Top 5 agents: Donut chart showing the top 5 agents by events</li> <li>Rule Distribution: Donut chart showing the events by rule type</li> <li>Actions: Donut chart showing events by modification, addition, or deletion action</li> <li>Top 5 Users: Table showing the number of events by agent ID</li> </ul> <p>Events:</p> <ul> <li>Events over time</li> <li>Event Summary table showing total events by agent, file, action, and rule information</li> </ul> <p>Inventory:</p> <ul> <li>Detailed inventory information showing file and registry (Windows) actions including path/key, modification timestamp, user, file size</li> </ul>      Wazuh File Integrity Monitoring"},{"location":"projects/homelab/07-vis-response-pt1/#configuration-management","title":"Configuration Management","text":"<p>Visualizations:</p> <p>Dashboard:</p> <ul> <li>Per agent SCA showing a summary of passed, failed, and N/A results and overall score</li> <li>Policy information, scan data, and checks</li> <li>Inventory information: policy, description, scan data, score</li> <li>Events: Event count over time, detailed check and policy information</li> </ul>      CIS Benchmark Results         CIS Benchmark Overview"},{"location":"projects/homelab/07-vis-response-pt1/#security-operations-it-hygiene-dashboard","title":"Security Operations / IT Hygiene Dashboard","text":"<p>Visualizations:</p> <p>Dashboard: Overview of deployed agent hygiene showing OS, installed packages, running processes, hardware, network traffic, and identity information</p> <ul> <li>System: Platform, OS, and architecture information</li> <li>Software: Package, KB, Browser extension, and vendor information</li> <li>Processes: Process name, start, PID, PPID, and command line information</li> <li>Network: IP address, interface, protocol, listener, and traffic information</li> <li>Identity: User and group, shell, and home directory information</li> <li>Services: Running service information</li> </ul>      IT Hygene Overview         IT Hygene - System View"},{"location":"projects/homelab/07-vis-response-pt1/#threat-intelligence","title":"Threat Intelligence","text":"<p>Threat Hunting:</p> <ul> <li>Total threats detected, alert level, authentication failures/successes, attacks by MITRE tactic/technique, alerts by agent</li> </ul> <p>Vulnerability Detection:</p> <ul> <li>Severity level counts, top 5 CVEs, vulnerabilities by OS, agent, package, and year</li> </ul> <p>MITRE ATT&amp;CK:</p> <ul> <li>Alert evolution over time, top tactics, attacks by technique, tactics and techniques by agent</li> </ul>"},{"location":"projects/homelab/07-vis-response-pt1/#threat-hunting-queries","title":"Threat Hunting Queries","text":"<p>Suspicious PowerShell Execution: <pre><code>rule.groups: windows AND data.win.eventdata.image: *powershell.exe\nAND (data.win.eventdata.commandLine: *-encodedcommand*\nOR data.win.eventdata.commandLine: *bypass*)\n</code></pre></p> <p>Lateral Movement Detection: <pre><code>rule.id: 60204 AND rule.description: \"Windows: User logon with explicit credentials\"\n| stats count by data.win.eventdata.subjectUserName, agent.name\n</code></pre></p> <p>Privilege Escalation Attempts: <pre><code>rule.groups: authentication_success AND\ndata.win.eventdata.targetUserName: Administrator\n| where data.win.eventdata.subjectUserName != Administrator\n</code></pre></p>      Thread Hunting Dashboard         Vulnerability Detection Dashboard         MITRE ATT&amp;CK Dashboard"},{"location":"projects/homelab/07-vis-response-pt1/#5-security-homelab-section-links","title":"5. Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware</li> <li>Network Security, Privacy and Remote Access</li> <li>Identity, Access, Secrets and Trust Management</li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/","title":"Observability and Response Architecture, Part 2","text":"<p>Document Control:  Version: 1.0 Last Updated: January 30, 2026 Owner: Paul Leone </p>"},{"location":"projects/homelab/08-vis-response-pt2/#1-security-orchestration-automation-and-response-soar-platform","title":"1. Security Orchestration, Automation and Response (SOAR) Platform","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview","title":"Deployment Overview","text":"<p>The SOAR platform unifies case management, automated enrichment, threat intelligence sharing, and workflow automation across the entire security stack. It integrates SIEM alerts, EDR telemetry, threat intelligence feeds, and infrastructure controls into a coordinated response ecosystem.</p> <p>The platform consists of four primary applications: Shuffle, TheHive, Cortex, and MISP. Each fulfills a specialized role within the incident response lifecycle. Together, they deliver automated triage, enrichment, containment, and intelligence distribution, enabling rapid, repeatable, and scalable security operations.</p>          SOAR Platform Architecture"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact","title":"Security Impact","text":"<p>The SOAR ecosystem dramatically reduces response time by automating repetitive tasks, enriching alerts with contextual intelligence, and orchestrating multi-tool actions. Automated workflows ensure consistent triage, reduce human error, and provide structured case management. Integrated threat intelligence enhances detection accuracy, while automated containment actions limit adversary dwell time.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale","title":"Deployment Rationale","text":"<p>Modern SOC operations require more than detection\u2014they require coordinated, automated response. This SOAR architecture mirrors enterprise-grade security operations by combining case management, enrichment engines, threat intelligence platforms, and automation pipelines. It demonstrates proficiency with incident response frameworks, multi-tool orchestration, and automated decision-making.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Multiple enrichment engines validate IOCs across independent sources</li> <li>Automated containment actions complement SIEM/EDR detections</li> <li>Case management, enrichment, and threat intelligence form overlapping response layers</li> </ul> <p>Secure by Design:</p> <ul> <li>Structured workflows enforce consistent triage and investigation procedures</li> <li>API-based integrations use authenticated, encrypted communication</li> <li>Automated playbooks reduce manual error and enforce policy compliance</li> </ul> <p>Zero Trust:</p> <ul> <li>No alert or IOC is implicitly trusted; all are enriched and validated</li> <li>Automated workflows enforce least-privilege actions and controlled response steps</li> <li>Continuous verification of threat intelligence before actioning</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#2-shuffle-security-automation-engine","title":"2. Shuffle - Security Automation Engine","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_1","title":"Deployment Overview","text":"<p>Shuffle is the low-code/no-code automation engine that orchestrates workflows across all SOC tools, SIEM platforms, and security infrastructure. It serves as the automation backbone of the SOAR ecosystem, enabling rapid integration, event-driven workflows, and multi-tool response actions.</p> <p>Shuffle processes alerts from Wazuh, Splunk, Elastic, and other sources, automatically enriching them with intelligence from Cortex, VirusTotal, Shodan, and MISP before triggering case creation or containment actions.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_1","title":"Security Impact","text":"<ul> <li>Automates triage, enrichment, and response actions to reduce MTTR</li> <li>Executes containment workflows (firewall blocks, host isolation, account disablement)</li> <li>Ensures consistent, repeatable response actions across all alerts</li> <li>Provides real-time notifications and workflow execution logs</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_1","title":"Deployment Rationale","text":"<p>Shuffle demonstrates the ability to build enterprise-grade automation pipelines without requiring custom code. It integrates seamlessly with SIEM, EDR, threat intelligence, and case management systems, enabling end-to-end automated response.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_1","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Automates multi-layer response actions across EDR, firewalls, SIEM, and threat intelligence</p> <p>Secure by Design: API-key isolation, encrypted communication, and controlled workflow execution</p> <p>Zero Trust: Every alert is enriched and validated before action; no implicit trust in raw telemetry</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-architecture","title":"Deployment Architecture","text":"<p>Shuffle is deployed as a multi-container microservices architecture with the following components:</p> Component Image IP Address Purpose shuffle-frontend shuffle-frontend:latest 192.168.200.41 (LB) React-based web UI for workflow design, execution monitoring, and administration. Provides drag-and-drop workflow builder with 300+ pre-built app integrations. shuffle-backend shuffle-backend:latest 10.43.xxx.xxx (ClusterIP) Go-based backend API handling workflow execution orchestration, app management, webhook processing, and user authentication. Coordinates communication between frontend and execution workers. shuffle-opensearch opensearch:3.2.0 10.43.xxx.xxx (ClusterIP) OpenSearch database storing workflow definitions, execution history, app configurations, and audit logs. Provides full-text search capabilities for workflow debugging and audit trails. shuffle-orborus shuffle-orborus:latest None (internal) Worker orchestration daemon responsible for spinning up Docker containers to execute workflow app actions. Manages containerized execution environment ensuring isolation and scalability. Runs on Kubernetes nodes as DaemonSet. <p>External Access:</p> <ul> <li>Web Interface: https://192.168.200.41 (ports 80/443)</li> <li>Webhook Receiver: https://192.168.200.41/api/v1/hooks/</li> <li>API Endpoint: https://192.168.200.41/api/v1/</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#integration-points","title":"Integration Points","text":"<p>Shuffle serves as the central orchestration hub connecting:</p> <ul> <li>TheHive: Automated case creation, task assignment, observable enrichment, and case closure workflows</li> <li>Cortex: Trigger analysis jobs, retrieve results, execute responders based on analysis outcomes</li> <li>MISP: Automatic IOC submission, threat intelligence queries, event publishing, and feed synchronization</li> <li>Wazuh EDR: Alert triage, automated response actions (file quarantine, process termination), agent management</li> <li>Elastic (ELK Stack) Network alert triage via API webhook. pfSense, OPNsense and Suricata logs.</li> <li>pfSense Firewall: Automatic blocklist updates, firewall rule creation, VPN configuration changes</li> <li>Suricata/Snort IDS: Rule updates, signature deployment, detection tuning based on threat intelligence</li> <li>Discord: Real-time notifications, alert distribution, case status updates, workflow execution reports</li> <li>Email: Phishing analysis workflows, report distribution, executive summaries, alert forwarding</li> <li>VirusTotal/AbuseIPDB: Automated reputation checks, malware analysis, IP/domain enrichment</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#3-thehive-incident-response-and-case-management","title":"3. TheHive - Incident Response and Case Management","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_2","title":"Deployment Overview","text":"<p>TheHive provides centralized case management, investigation workflows, and collaborative incident response. It aggregates alerts from SIEM and EDR platforms into structured cases, enabling analysts to track tasks, observables, timelines, and response actions.</p> <p>TheHive acts as the command center for incident response, coordinating investigations across Cortex, MISP, Wazuh, and Shuffle.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_2","title":"Security Impact","text":"<ul> <li>Centralizes all incidents into structured, auditable cases</li> <li>Enables collaborative investigations with task assignments and timelines</li> <li>Correlates alerts from Splunk, Wazuh, and other sources into unified cases</li> <li>Provides metrics dashboards for MTTD, MTTR, and case volume trends</li> <li>Ensures consistent documentation for forensic and compliance requirements</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_2","title":"Deployment Rationale","text":"<p>TheHive mirrors enterprise SIRP (Security Incident Response Platform) capabilities, demonstrating proficiency with structured case management, workflow orchestration, and collaborative investigations.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_2","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Combines SIEM, EDR, and threat intelligence alerts into multi-source cases</p> <p>Secure by Design: Role-based access, audit logs, and structured workflows</p> <p>Zero Trust: All observables validated through Cortex/MISP before actioning</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-specifications","title":"Deployment Specifications","text":"<ul> <li>Container Image: strangebee/thehive:5.5.13-1</li> <li>Deployment Type: Helm chart (managed deployment)</li> <li>Replicas: 1 (single instance)</li> <li>External Access: LoadBalancer service at 192.168.200.33</li> <li>Port 9000 (HTTP/HTTPS web interface)</li> <li>Port 9095 (Kamon metrics for Prometheus integration)</li> <li>Persistent Storage: Backed by Cassandra and Elasticsearch for data durability</li> <li>Resource Allocation:</li> <li>CPU: 2 cores</li> <li>Memory: 4GB</li> <li>Storage: 20GB (application data via Cassandra)</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#key-capabilities","title":"Key Capabilities","text":"<ul> <li>Case Management: Create, assign, and track security incidents with customizable workflows</li> <li>Task Orchestration: Break down investigations into actionable tasks with assignments and deadlines</li> <li>Observable Analysis: Submit IOCs (IPs, domains, hashes, URLs) to Cortex for automated analysis</li> <li>Alert Correlation: Aggregate alerts from SIEM (Splunk, Wazuh) into unified cases</li> <li>Collaboration: Team-based investigations with real-time updates and commenting</li> <li>Reporting: Generate executive summaries and technical reports from case data</li> <li>Metrics Dashboard: Track MTTD (Mean Time to Detect), MTTR (Mean Time to Respond), case volume trends</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#integration-points_1","title":"Integration Points","text":"<ul> <li>Cortex: Automated observable analysis and enrichment</li> <li>MISP: Bi-directional IOC sharing (export confirmed threats, import external intelligence)</li> <li>Wazuh: Automated case creation from EDR alerts (via Shuffle workflow)</li> <li>Shuffle: Workflow automation for alert triage and notification distribution</li> <li>Discord: Real-time notifications for high-severity cases</li> <li>SMTP Relay: Gmail notifications</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#4-cortex-observable-analysis-and-active-response-engine","title":"4. Cortex - Observable Analysis and Active Response Engine","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_3","title":"Deployment Overview","text":"<p>Cortex automates the analysis of observables (IOCs) using a wide range of analyzers and responders. It enriches IPs, domains, hashes, URLs, and files with intelligence from VirusTotal, AbuseIPDB, Shodan, OTX, and internal sources.</p> <p>Cortex responders execute automated containment actions such as firewall rule updates, blocklist modifications, and case escalations.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_3","title":"Security Impact","text":"<ul> <li>Provides automated, multi-engine IOC analysis</li> <li>Executes rapid containment actions via responders</li> <li>Enhances detection accuracy through cross-source enrichment</li> <li>Supports dynamic malware analysis via sandbox integrations</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_3","title":"Deployment Rationale","text":"<p>Cortex demonstrates advanced enrichment and automated response capabilities found in enterprise SOCs. Its analyzer/responder model enables modular, scalable intelligence processing and automated containment workflows.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_3","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Multiple analyzer categories validate IOCs across independent sources</p> <p>Secure by Design: Controlled responder execution; strict API authentication</p> <p>Zero Trust: No IOC trusted without multi-engine validation</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-specifications_1","title":"Deployment Specifications","text":"<ul> <li>Container Image: thehiveproject/cortex:latest</li> <li>Deployment Type: Kubernetes Deployment</li> <li>Replicas: 1</li> <li>External Access: LoadBalancer service at 192.168.200.40</li> <li>Port 9001 (HTTP API and web interface)</li> <li>Backend Database: Elasticsearch (for job history and results)</li> <li>Resource Allocation:</li> <li>CPU: 2 cores (scales with analyzer concurrency)</li> <li>Memory: 4GB (increases with active jobs)</li> <li>Storage: 10GB (job results and cache)</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#analyzers-enabled","title":"Analyzers Enabled","text":"<ul> <li>VirusTotal</li> <li>MISP</li> <li>AbuseIPDB</li> <li>Malware Bazaar</li> <li>Shodan</li> <li>Cyberchef</li> <li>Hybrid Analysis</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#responders-enabled","title":"Responders Enabled","text":"<ul> <li>VirusTotal Downloader</li> <li>Mailer</li> <li>Wazuh</li> <li>Shuffle</li> <li>N8n</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#5-misp-threat-intelligence-sharing-platform","title":"5. MISP - Threat Intelligence Sharing Platform","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_4","title":"Deployment Overview","text":"<p>MISP provides structured threat intelligence management, IOC sharing, and collaborative intelligence workflows. It stores, correlates, and distributes threat indicators across the SOAR ecosystem.</p> <p>MISP integrates with Cortex, TheHive, Shuffle, and external intelligence feeds to enrich alerts and cases with contextual threat data.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_4","title":"Security Impact","text":"<ul> <li>Enhances detection accuracy through curated threat intelligence</li> <li>Enables bi-directional sharing of confirmed IOCs</li> <li>Correlates related events to identify campaigns and intrusion sets</li> <li>Supports automated enrichment and threat scoring</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_4","title":"Deployment Rationale","text":"<p>MISP demonstrates proficiency with structured threat intelligence, IOC lifecycle management, and intelligence-driven detection. It mirrors enterprise CTI workflows where intelligence is continuously ingested, validated, enriched, and distributed across SOC tools.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_4","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds intelligence-driven detection to complement SIEM/EDR telemetry</p> <p>Secure by Design: Signed events, role-based access, and controlled feed synchronization</p> <p>Zero Trust: All intelligence validated before distribution; no implicit trust in external feeds</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-specifications_2","title":"Deployment Specifications","text":"<p>MISP is deployed as a multi-container application stack with the following components:</p> Component Image IP Address Purpose misp-core ghcr.io/misp/misp-docker/misp-core:latest 192.168.200.37 (LB) Main MISP application (web UI, API, background workers) misp-db mariadb:10.11 10.43.151.59 (ClusterIP) MySQL/MariaDB database for MISP data storage misp-redis valkey/valkey:7.2 10.43.131.214 (ClusterIP) Redis cache for session management and job queuing misp-modules ghcr.io/misp/misp-docker/misp-modules:latest 10.43.234.246 (ClusterIP) Expansion and enrichment modules for automated IOC enrichment misp-guard ghcr.io/misp/misp-docker/misp-guard:latest 10.43.97.195 (ClusterIP) Security proxy protecting MISP core from malicious input <p>External Access:</p> <ul> <li>Web Interface: https://192.168.200.37 (ports 80/443)</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#integration-points_2","title":"Integration Points","text":"<ul> <li>TheHive: Bi-directional IOC exchange (TheHive cases \u2192 MISP events, MISP feeds \u2192 TheHive alerts)</li> <li>Cortex: MISP lookup analyzer queries threat intelligence database</li> <li>Wazuh: EDR threat intelligence module queries MISP for known malicious indicators</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#6-supporting-infrastructure","title":"6. Supporting Infrastructure","text":""},{"location":"projects/homelab/08-vis-response-pt2/#cassandra-distributed-nosql-database","title":"Cassandra - Distributed NoSQL Database","text":"<p>Purpose: Scalable, fault-tolerant data store for TheHive case data, observables, and audit logs.</p> <p>Deployment Specifications:</p> <ul> <li>Container Image: cassandra:4.1.7</li> <li>Deployment Type: StatefulSet (ensures stable network identity and persistent storage)</li> <li>Replicas: 1 (production would use 3+ node cluster for high availability)</li> <li>External Access: LoadBalancer service at 192.168.200.36</li> <li>Port 9042 (CQL native protocol)</li> <li>Persistent Volume: 100GB SSD-backed storage</li> <li>Replication Strategy: SimpleStrategy with replication_factor=1 (single node)</li> </ul> <p>Configuration Highlights:</p> <ul> <li>Keyspace: TheHive data stored in dedicated keyspace with TTL policies for data retention</li> <li>Consistency Level: LOCAL_ONE (single node) / LOCAL_QUORUM (production multi-node)</li> <li>Backup Strategy: Daily snapshots via cron job, retained for 14 days</li> <li>Monitoring: Exposed JMX metrics for Prometheus scraping</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#elasticsearch-search-and-analytics-engine","title":"Elasticsearch - Search and Analytics Engine","text":"<p>Purpose: Full-text search, log aggregation, and analytics for TheHive cases, Cortex job results, and observables.</p> <p>Deployment Specifications:</p> <ul> <li>Container Image: docker.elastic.co/elasticsearch/elasticsearch:9.2.2</li> <li>Deployment Type: StatefulSet (single-node cluster)</li> <li>Replicas: 1</li> <li>External Access: LoadBalancer service at 192.168.200.34</li> <li>Port 9200 (HTTP REST API)</li> <li>Persistent Volume: 200GB SSD-backed storage</li> <li>Cluster Name: soc-elasticsearch</li> <li>Node Roles: master, data, ingest (combined role in single-node deployment)</li> </ul> <p>Index Management:</p> <ul> <li>TheHive Indices: Cases, tasks, observables, audit logs with 90-day retention</li> <li>Cortex Indices: Analysis jobs, results, analyzer reports with 30-day retention</li> <li>Index Lifecycle Management (ILM): Automated rollover and deletion based on age/size</li> <li>Snapshots: Daily backups to NAS via snapshot repository</li> </ul> <p>Performance Tuning:</p> <ul> <li>Heap Size: 4GB (50% of allocated memory)</li> <li>Shards: 1 primary shard per index (low-volume lab environment)</li> <li>Replicas: 0 (single node, no replication)</li> <li>Refresh Interval: 5 seconds (balance between real-time search and indexing performance)</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#opensearch-shuffle-workflow-database","title":"OpenSearch - Shuffle Workflow Database","text":"<p>Purpose: Storage and retrieval of Shuffle workflow definitions, execution history, app configurations, and audit logs.</p> <p>Deployment Specifications:</p> <ul> <li>Container Image: opensearch:3.2.0</li> <li>Deployment Type: StatefulSet (single-node cluster)</li> <li>Replicas: 1</li> <li>External Access: ClusterIP only (internal communication with Shuffle backend)</li> <li>Port 9200 (HTTP REST API)</li> <li>Persistent Volume: 100GB SSD-backed storage</li> <li>Cluster Name: shuffle-opensearch</li> </ul> <p>Data Storage:</p> <ul> <li>Workflow Definitions: JSON representations of workflow configurations and app settings</li> <li>Execution History: Complete audit trail of all workflow runs with timestamps, inputs, outputs, and errors</li> <li>App Cache: Downloaded app containers and OpenAPI specifications for rapid workflow execution</li> <li>User Activity Logs: Authentication events, workflow modifications, permission changes</li> </ul> <p>Performance Characteristics:</p> <ul> <li>Query Performance: Sub-second search for workflow debugging and historical analysis</li> <li>Retention: 90-day execution history (configurable based on storage capacity)</li> <li>Backup Strategy: Daily snapshots to NAS; integrated with Kubernetes backup automation</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#7-soar-workflow-automated-endpoint-threat-intelligence-pipeline","title":"7. SOAR Workflow: Automated Endpoint Threat Intelligence Pipeline","text":""},{"location":"projects/homelab/08-vis-response-pt2/#overview","title":"Overview","text":"<p>SOAR workflow that automates Wazuh alert triage through TheHive case management, Cortex-based IOC enrichment, and multi-channel notifications.</p> <p>Trigger: Wazuh webhook (Severity \u2265 7)</p> <p>Tools: Wazuh EDR, TheHive, Cortex, VirusTotal, AbuseIPDB, Discord, Gmail</p>"},{"location":"projects/homelab/08-vis-response-pt2/#workflow-execution","title":"Workflow Execution","text":"<p>1. Alert Ingestion</p> <ul> <li>Wazuh Alert Med (Trigger): Receives security event via webhook</li> <li>LogCollection (Parser): Extracts structured alert data</li> </ul> <p>2. TheHive Integration</p> <ul> <li>CreateAlert: Generates alert in TheHive with Wazuh event metadata</li> <li>Add IP to Alert: Injects IP observables from alert</li> <li>Add Hash to Alert: Injects file hash observables from alert</li> <li>Create Case from Alert: Promotes alert to investigable case</li> </ul> <p>3. IOC Enrichment</p> <ul> <li>Get Case Observable: Retrieves all observables for analysis</li> <li>Run Analyzer VirusTotal: Executes VirusTotal_GetReport_3_1 via Cortex</li> <li>Run Analyzer AbuseIPDB: Executes AbuseIPDB_1_1 via Cortex</li> <li>Get Cortex Results: Retrieves analysis reports (JSON)</li> <li>Add Observable to Case: Attaches enrichment results to case</li> </ul> <p>4. Notification</p> <ul> <li>Send Discord Alert: Pushes case summary to #soc-alerts channel</li> <li>Gmail Relay Notification: Emails SOC distribution list with case details</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#use-case-example","title":"Use Case Example","text":"<p>Scenario: Wazuh detects suspicious process execution with SHA256 hash and external IP connection.</p> <p>Automated Response:</p> <ol> <li>Case created in TheHive: [Hostname] Suspicious PowerShell Execution</li> <li>Cortex analysis results:</li> <li>VirusTotal: 45/70 detections (Trojan.Downloader)</li> <li>AbuseIPDB: IP flagged with 87% confidence score</li> <li>Discord/Email alerts sent with enrichment summary</li> <li>Analyst reviews case with pre-loaded context</li> </ol> <p>Average Execution Time: 45-60 seconds</p>"},{"location":"projects/homelab/08-vis-response-pt2/#workflow-screenshots","title":"Workflow Screenshots","text":"Shuffle Workflow Overview         Wazuh Alert Events         TheHive Alerts         Cortex Analyzers         TheHive Cases         Discord and Email Notifications"},{"location":"projects/homelab/08-vis-response-pt2/#8-observability-architecture","title":"8. Observability Architecture","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_5","title":"Deployment Overview","text":"<p>The monitoring stack provides comprehensive visibility into the health, performance, and availability of all systems across the lab environment. Unlike SIEM platforms that focus on security events, the monitoring layer captures operational telemetry: CPU, memory, disk, network throughput, service uptime, virtualization metrics, and application-level health checks.</p> <p>This multi-tool architecture spans time-series metrics, heartbeat monitoring, deep infrastructure inspection, and hypervisor-specific analytics.</p>          Observability Architecture"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_5","title":"Security Impact","text":"<p>Monitoring is a critical component of operational security. Performance anomalies often precede or accompany security incidents\u2014unexpected CPU spikes, abnormal network traffic, failing services, or resource exhaustion can indicate brute-force attempts, malware execution, or lateral movement. By correlating infrastructure telemetry with SIEM data, defenders gain a holistic view of system behavior.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_5","title":"Deployment Rationale","text":"<p>Modern environments require more than log-based security analytics; they require continuous operational awareness. This monitoring architecture demonstrates proficiency with enterprise-grade observability tools, hybrid infrastructure monitoring, and multi-channel alerting.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_5","title":"Architecture Principles Alignment","text":"<p>Defense in Depth:</p> <ul> <li>Multiple monitoring layers (metrics, uptime, hypervisor, infrastructure) ensure no single blind spot</li> <li>Redundant alerting channels prevent missed notifications</li> <li>Cross-tool correlation strengthens detection of operational anomalies</li> </ul> <p>Secure by Design:</p> <ul> <li>TLS-secured communication for metrics and alerting pipelines</li> <li>Segmented monitoring networks reduce exposure of sensitive telemetry</li> <li>Centralized dashboards enforce consistent visibility</li> </ul> <p>Zero Trust:</p> <ul> <li>No host or service is implicitly trusted; all must report health and availability</li> <li>Continuous validation of service uptime and performance</li> <li>Alerting pipelines enforce accountability and traceability</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#9-prometheus-grafana-infrastructure-metrics-platform","title":"9. Prometheus &amp; Grafana - Infrastructure Metrics Platform","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_6","title":"Deployment Overview","text":"<p>Prometheus collects high-resolution time-series metrics from servers, containers, network devices, and applications. Grafana visualizes these metrics through customizable dashboards, providing real-time insights into system performance and long-term trends.</p> <p>This stack focuses on operational telemetry\u2014CPU, memory, disk I/O, network throughput, container health, and service latency\u2014complementing SIEM platforms by monitoring performance rather than security events.</p>          Prometheus and Grafana"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_6","title":"Security Impact","text":"<ul> <li>Detects resource exhaustion attacks (CPU spikes, memory leaks, disk saturation)</li> <li>Identifies anomalous network throughput that may indicate data exfiltration</li> <li>Monitors container and Kubernetes health for signs of compromise</li> <li>Provides early warning when security tools (SIEM, EDR, IDS) degrade or fail</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_6","title":"Deployment Rationale","text":"<p>Prometheus and Grafana are industry-standard observability tools used across cloud-native and hybrid environments. Their inclusion demonstrates proficiency with metrics-driven monitoring, dashboard creation, alerting rules, and containerized instrumentation.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_6","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Metrics complement logs and endpoint telemetry for multi-layer detection</p> <p>Secure by Design: TLS-secured Prometheus endpoints; role-based Grafana access</p> <p>Zero Trust: Every host must expose metrics; no implicit trust in service health</p>"},{"location":"projects/homelab/08-vis-response-pt2/#prometheus-configuration","title":"Prometheus Configuration","text":"<p>Core Prometheus:</p> <ul> <li>Labels: prom, pve, pihole</li> <li>Intervals: 1m</li> </ul> <p>Alert Manager and Blackbox:</p> <ul> <li>Notifications and Discord integration</li> </ul> <p>Exporters:</p> <ul> <li>Node Exporter: Linux hosts (PVE node, VMs, Docker hosts)</li> <li>Proxmox Exporter: prometheus-pve-exporter hitting the PVE API</li> <li>Pi-hole Exporter: containerized exporter reading FTL metrics</li> <li>Traefik: reverse proxy details</li> <li>pfSense Exporter: system-level monitoring</li> <li>OPNsense Exporter: system-level monitoring</li> <li>Uptime-Kuma: Service uptime monitoring</li> <li>CrowdSec: Engine metrics</li> </ul>      Prometheus Target Health Status         Alert Manager and Blackbox Alerts"},{"location":"projects/homelab/08-vis-response-pt2/#grafana-dashboards","title":"Grafana Dashboards","text":"<p>Infrastructure Dashboards:</p> Dashboard Name Data Source Refresh Rate Panels Node Exporter Full Prometheus 30s CPU; RAM; Disk; Network; Load Proxmox VE Overview Prometheus 1m Cluster status; VM metrics; storage Pi-hole Statistics Prometheus 30s Query rate; block %; cache hits Traefik Overview Prometheus 15s Request rate; latency; error rate pfSense System Metrics Prometheus 30s CPU; RAM; interfaces; throughput Blackbox Exporter Prometheus 1m HTTP status; TLS cert expiry; latency <p>Proxmox VE Dashboard:</p> <ul> <li>Exporter: prometheus-pve-exporter as a service; uses least-privilege PVE API token</li> <li>Metrics: Node/VM CPU, memory, storage pools, task failures, HA state</li> <li>Alerts:</li> <li>Node pressure: CPU &gt; 85% for 10m, RAM &gt; 90% for 5m</li> <li>Storage: Datastore free &lt; 15%</li> <li>VM health: No metrics from a VM for &gt; 5m (down)</li> </ul>      Proxmox VE Dashboard    <p>Pi-hole Dashboard:</p> <ul> <li>Exporter: Containerized pihole_exporter reading FTL metrics</li> <li>Metrics: Query rate, block rate, cache hit %, upstream latency, gravity update age</li> <li>Alerts:</li> <li>FTL down: No scrape &gt; 2m</li> <li>Block rate anomaly: Sudden drop to near 0% or spike &gt; 95%</li> <li>Upstream failures: SERVFAIL/timeout ratio increases</li> </ul>      Pi-hole Dashboard    <p>Traefik Dashboard:</p> <ul> <li>Exporter: Direct Prometheus integration</li> <li>Metrics: Instances, HTTP requests per entrypoint, application and HTTP method, slow services</li> </ul>      Traefik Dashboard    <p>pfSense Dashboard:</p> <ul> <li>Exporter: Direct Prometheus integration</li> <li>Metrics: CPU, RAM, Disk monitoring, network packets by interface, pkt/sec, load avg, traps and system calls</li> </ul>      pfSense Dashboard"},{"location":"projects/homelab/08-vis-response-pt2/#10-uptime-kuma-service-availability-monitoring","title":"10. Uptime Kuma - Service Availability Monitoring","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_7","title":"Deployment Overview","text":"<p>Uptime Kuma provides heartbeat monitoring for all lab services using HTTP/S, TCP, and ICMP checks. Each monitored service is continuously probed for availability, latency, and response integrity. Any deviation triggers immediate alerts routed to dedicated Discord channels.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_7","title":"Security Impact","text":"<ul> <li>Detects service outages caused by attacks, misconfigurations, or resource exhaustion</li> <li>Identifies unstable or degraded services before they impact security tooling</li> <li>Provides uptime baselines useful for correlating with SIEM events</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_7","title":"Deployment Rationale","text":"<p>Service uptime is foundational to both operational stability and security visibility. Uptime Kuma offers a lightweight, flexible, and highly responsive monitoring layer.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_7","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds availability monitoring to complement metrics and logs</p> <p>Secure by Design: Segmented monitoring probes reduce attack surface</p> <p>Zero Trust: No service is assumed healthy; continuous validation required</p>      Uptime Kuma Dashboard"},{"location":"projects/homelab/08-vis-response-pt2/#11-checkmk-deep-infrastructure-monitoring","title":"11. Checkmk - Deep Infrastructure Monitoring","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_8","title":"Deployment Overview","text":"<p>Checkmk delivers comprehensive monitoring across servers, applications, network devices, storage systems, and containerized workloads.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_8","title":"Security Impact","text":"<ul> <li>Detects abnormal system behavior (high load, failing disks, service crashes)</li> <li>Monitors critical infrastructure supporting security tools</li> <li>Provides granular visibility into multi-layer dependencies</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_8","title":"Deployment Rationale","text":"<p>Checkmk represents enterprise-grade monitoring with agent-based and agentless capabilities. Its inclusion demonstrates proficiency with large-scale infrastructure monitoring, rule-based alerting, and hybrid environment observability.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_8","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds deep host-level inspection to complement Prometheus metrics</p> <p>Secure by Design: Encrypted agent communication; strict role-based access</p> <p>Zero Trust: Every host must report detailed health metrics continuously</p>"},{"location":"projects/homelab/08-vis-response-pt2/#high-level-configuration","title":"High-Level Configuration","text":"<p>The Checkmk monitoring server runs as a Docker container on UbuntuVM1, which serves as the central monitoring engine for the entire homelab. UbuntuVM1 sits in the LAB_LAN1 VLAN and has direct or routed access to all monitored networks.</p> <p>The Checkmk container communicates with monitored hosts using a mix of native Checkmk agents, SNMP, API integrations, and special agents depending on the platform.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#monitored-host-types-integration-methods","title":"Monitored Host Types &amp; Integration Methods","text":"<p>Proxmox Host and Linux VMs/LXCs (Ubuntu, Debian, CentOS, Fedora, RHEL, Kali, ParrotOS):</p> <ul> <li>Integration: Checkmk Agent (TCP/6556)</li> <li>Metrics: CPU, memory, load, filesystem, systemd services, Docker containers, Kubernetes node metrics, application-specific checks</li> <li>Communication: Routed VLANs with firewall rules allowing TCP/6556 from UbuntuVM1</li> </ul> <p>Windows Hosts (Win11, Server 2022, Server 2025):</p> <ul> <li>Integration: Checkmk Windows Agent</li> <li>Metrics: CPU, memory, disk, services, event log monitoring, Windows Update status, domain controller checks</li> </ul> <p>pfSense Firewall:</p> <ul> <li>Integration: Checkmk Agent via xinetd (TCP/6556)</li> <li>Deployment: Agent deployed manually and served through xinetd, configured to start at boot using pfSense's shellcmd mechanism</li> <li>Metrics: System health (CPU, RAM, swap), interface throughput, gateway status, package health (Unbound, Suricata, Snort), filesystem usage</li> </ul> <p>Cisco vIOS Routers (r1, r2):</p> <ul> <li>Integration: SNMP v2c</li> <li>Metrics: Interface status and traffic, errors/discards, CPU and memory, routing table size, ARP table, device uptime</li> </ul> <p>VMware ESXi Host:</p> <ul> <li>Integration: VMware Special Agent (HTTPS/443)</li> <li>Authentication: Dedicated read-only user on ESXi host</li> <li>Metrics: Host CPU and memory, datastore usage, VM inventory and power state, NIC and vSwitch metrics</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#communication-summary","title":"Communication Summary","text":"Host Type Integration Protocol Notes Linux servers Checkmk Agent TCP/6556 Full OS visibility Windows servers Checkmk Agent TCP/6556 Event logs, services pfSense Checkmk Agent via xinetd TCP/6556 Custom deployment Cisco vIOS SNMP v2c UDP/161 Interface + routing metrics ESXi VMware Special Agent HTTPS/443 API-based monitoring Proxmox Checkmk Agent TCP/6556 Full OS visibility Applications Agent + HTTP checks TCP/6556 + HTTP Service-level monitoring      Checkmk Overview         Checkmk Topology Map"},{"location":"projects/homelab/08-vis-response-pt2/#12-pulse-proxmox-virtual-environment-and-backup-server-monitoring","title":"12. Pulse - Proxmox Virtual Environment and Backup Server Monitoring","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_9","title":"Deployment Overview","text":"<p>Pulse provides real-time monitoring and alerting specifically for Proxmox VE and Proxmox Backup Server. It consolidates hypervisor metrics\u2014VM performance, storage health, cluster state, backup integrity\u2014into a unified dashboard, enabling rapid situational awareness and proactive incident response.</p>          Pulse"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_9","title":"Security Impact","text":"<ul> <li>Detects hypervisor-level anomalies that may indicate compromise or misconfiguration</li> <li>Monitors VM performance for signs of malicious activity</li> <li>Ensures backup integrity and cluster stability</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_9","title":"Deployment Rationale","text":"<p>Virtualization is the backbone of the lab environment. Pulse provides hypervisor-specific insights that general monitoring tools cannot, mirroring enterprise virtualization monitoring platforms.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_9","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Adds hypervisor-layer visibility beneath OS-level monitoring</p> <p>Secure by Design: Dedicated monitoring channel reduces exposure of Proxmox APIs</p> <p>Zero Trust: No VM or node is implicitly trusted; all must report health</p>"},{"location":"projects/homelab/08-vis-response-pt2/#lab-integration","title":"Lab Integration","text":"<p>In this lab environment, Pulse is connected to both the Proxmox VE cluster and the PBS node. Authentication is handled via a dedicated Proxmox service account configured with an API token. This account is assigned minimal, read-only permissions required to:</p> <ul> <li>Query node, VM, and container status</li> <li>Retrieve backup job results</li> <li>Report on storage utilization</li> </ul> <p>This least-privilege approach ensures that Pulse can monitor and report without having the ability to modify or disrupt the environment.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#dashboards","title":"Dashboards","text":"<p>The Pulse main dashboard provides a real-time operational view of the Proxmox environment, including:</p> <ul> <li>Node statistics: CPU load, memory consumption, and storage usage for each Proxmox VE host</li> <li>Guest statistics: Resource usage for all deployed VMs and LXCs</li> <li>Visual threshold indicators: Color-coded gauges and bars highlight when usage approaches or exceeds configured limits</li> <li>Interactive webhooks: Clicking on a monitored service or resource can open its corresponding Proxmox web portal page for direct management</li> </ul> <p>Example Use Cases:</p> <ul> <li>Proactive capacity planning: Identify nodes nearing CPU or memory saturation before performance degrades</li> <li>Backup compliance: Immediate notification if a PBS backup job fails, allowing for same-day remediation</li> <li>Storage health: Early warning when datastore usage trends toward capacity, preventing unexpected outages</li> </ul>      Pulse Main Dashboard    <p>Backup Dashboard:</p> <p>Reports on the various backup methods. The dashboard provides details on snapshot status and PBS status and history of backups.</p>      Pulse Backup Dashboard    <p>Alert Dashboard and Notifications:</p> <p>Summary of current alerts, configured thresholds, notifications, schedule and alert history.</p>      Pulse Alert Dashboard"},{"location":"projects/homelab/08-vis-response-pt2/#13-netalertx-network-visibility-asset-intelligence-framework","title":"13. NetAlertX - Network Visibility &amp; Asset Intelligence Framework","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_10","title":"Deployment Overview","text":"<p>NetAlertX operates as a nested Docker container on a LXC host using host networking mode for comprehensive network discovery. The deployment provides continuous asset inventory, device profiling, and network topology mapping across production and lab segments (Prod_LAN, Lab_LAN1, Lab_LAN2, Ext_LAN).</p> <p>The container leverages multiple NIC interfaces on the host for passive and active scanning while maintaining isolation from sensitive ISO_LAN segments.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_10","title":"Security Impact","text":"<ul> <li>Real-time asset visibility identifies rogue devices and unauthorized network connections</li> <li>Automated device profiling detects configuration drift and shadow IT deployments</li> <li>Network topology mapping reveals unexpected lateral movement paths</li> <li>MAC address tracking correlates device identity across DHCP lease changes</li> <li>Alert generation on new device detection enables rapid security response</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_10","title":"Deployment Rationale","text":"<p>Enterprise SOCs require accurate asset inventories for vulnerability management, incident response, and compliance reporting. NetAlertX provides continuous discovery without agent deployment, identifying IoT devices, network appliances, and ephemeral containers that evade traditional endpoint management.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_10","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Asset visibility layer complements firewall ACLs and IDS/IPS by identifying security gaps in network segmentation</p> <p>Secure by Design: Passive discovery minimizes network impact; isolated from sensitive subnets to prevent reconnaissance against high-value targets</p> <p>Zero Trust: Continuous device enumeration validates network access aligns with authorized asset inventory; detects policy violations</p>"},{"location":"projects/homelab/08-vis-response-pt2/#high-level-configuration_1","title":"High-Level Configuration","text":"<ul> <li>Deployment Model: Docker container with host networking (--network host)</li> <li>Discovery Methods: ARP scanning, DHCP lease monitoring, mDNS/SSDP enumeration, SNMP polling</li> <li>Monitored Networks: 192.168.1.0/24 (Prod_LAN), 192.168.100.0/24 (Lab_LAN1), 192.168.200.0/24 (Lab_LAN2), 192.168.2.0/24 (Ext_LAN)</li> <li>Exclusions: 10.20.0.0/24 and 192.168.3.0/24 (ISO_LAN segments) - intentionally excluded from scanning</li> <li>Alert Triggers: New device detection, unknown MAC addresses, duplicate IP assignments, offline device recovery</li> <li>Integration: Webhook notifications to SOC alerting pipeline; asset data exported for vulnerability correlation</li> </ul>      NetAlertX Virtual Machines         NetAlertX Network Devices         NetAlertX Network Connectivity Map"},{"location":"projects/homelab/08-vis-response-pt2/#14-alerting-and-notification-architecture","title":"14. Alerting and Notification Architecture","text":""},{"location":"projects/homelab/08-vis-response-pt2/#deployment-overview_11","title":"Deployment Overview","text":"The alerting architecture ensures real-time visibility into operational and security events across the entire lab environment. Alerts from monitoring tools, SIEM platforms, EDR agents, and infrastructure services are routed through multiple redundant channels (Discord, SMTP relay, and Cloudflare email routing). This multi-path design ensures no critical alert is ever missed and enables granular triage through dedicated service-specific channels.             Alerting and Notification Overview        <p>The alerting architecture ensures real-time visibility into operational and security events across the entire lab environment. Alerts from monitoring tools, SIEM platforms, EDR agents, and infrastructure services are routed through multiple redundant channels (Discord, SMTP relay, and Cloudflare email routing). This multi-path design ensures no critical alert is ever missed and enables granular triage through dedicated service-specific channels.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#security-impact_11","title":"Security Impact","text":"<ul> <li>Immediate notification of outages, anomalies, or security events</li> <li>Redundant channels prevent alert loss due to single-system failure</li> <li>Segmented channels reduce noise and improve triage efficiency</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#deployment-rationale_11","title":"Deployment Rationale","text":"<p>Modern SOC/NOC operations rely on multi-channel alerting to ensure rapid response. This architecture demonstrates proficiency with webhook-based alerting, SMTP relays, email routing, and real-time collaboration platforms.</p>"},{"location":"projects/homelab/08-vis-response-pt2/#architecture-principles-alignment_11","title":"Architecture Principles Alignment","text":"<p>Defense in Depth: Multiple alerting paths ensure resilience</p> <p>Secure by Design: TLS-encrypted SMTP; restricted webhook endpoints</p> <p>Zero Trust: Alerts validated and routed per-service; no implicit trust in any channel</p>"},{"location":"projects/homelab/08-vis-response-pt2/#discord-private-server-centralized-notification-hub","title":"Discord Private Server - Centralized Notification Hub","text":"<p>A private Discord server acts as the real-time alerting hub for the entire environment. Each monitored service has its own dedicated channel, enabling noise isolation, targeted triage, and clear operational separation.</p> <p>Security Impact:</p> <ul> <li>Instant visibility into outages, anomalies, and security alerts</li> <li>Channel segmentation prevents alert overload</li> <li>Provides audit trails for incident response</li> </ul> <p>Deployment Rationale:</p> <p>Discord offers low-latency notifications, webhook integration, and structured channel organization\u2014mirroring enterprise chat-ops workflows.</p> <p>Architecture Principles Alignment:</p> <p>Defense in Depth: Secondary alerting path alongside email</p> <p>Secure by Design: Private server; restricted webhook tokens</p> <p>Zero Trust: No alert is trusted without validation; all events logged</p> <p>Notification Flow:</p> <p>[Monitoring Source] \u2192 [Alert Trigger] \u2192 [Webhook or Script] \u2192 [Discord Channel] \u2192 [Push Notification]</p> <ul> <li>Monitoring tools detect anomalies or threshold breaches</li> <li>Alerts are triggered via native webhook integrations or custom scripts</li> <li>Messages are sent to service-specific Discord channels using Discord's webhook API</li> <li>Discord's push notification system delivers alerts to:</li> <li>Windows 11 desktop app</li> <li>iPad and iPhone mobile apps</li> </ul> <p>Discord Channel Structure:</p> Channel Name Source Tool Alert Type #proxmox Proxmox VE Node status, backup failures #grafana Grafana Dashboard alerts, data source issues #splunk Splunk Security events, log anomalies #wazuh Wazuh Host-based intrusion alerts #pulse Pulse OpenSearch monitor triggers #uptime-kuma Uptime Kuma Service downtime, latency spikes #openvas OpenVAS Vulnerability scan results #pfsense pfSense Firewall events, VPN status #prometheus Prometheus Node exporter, resource thresholds #authentik Authentik Auth flow errors/alarms, auth failures #windowsupdates Windows VMs Python script completion"},{"location":"projects/homelab/08-vis-response-pt2/#smtp-relay-gmail-backed-email-alerting","title":"SMTP Relay - Gmail-Backed Email Alerting","text":"<p>Gmail relay to dedicated email address, shad0w1t1a6@gmail.com.</p> <p>An msmtp container provides a secure SMTP relay to Gmail using STARTTLS and application-specific passwords. Internal services send alerts via standard SMTP on port 25, and msmtp handles encrypted delivery to the dedicated alert mailbox.</p> <p>Configured Services:</p> <p>Proxmox, pfSense, OPNsense, TheHive, Uptime Kuma, Wazuh, Grafana, n8n, Synology NAS</p> <p>Security Impact:</p> <ul> <li>Provides a reliable, encrypted alerting channel</li> <li>Ensures alerts are preserved even if chat-ops channels fail</li> <li>Supports forensic review through email retention</li> </ul> <p>Deployment Rationale:</p> <p>Email remains a universal, durable alerting mechanism. This relay demonstrates secure outbound email configuration and multi-service integration.</p> <p>Architecture Principles Alignment:</p> <p>Defense in Depth: Email complements Discord for redundancy</p> <p>Secure by Design: STARTTLS encryption; app-password authentication</p> <p>Zero Trust: All alerts validated and logged; no implicit trust in sender</p>"},{"location":"projects/homelab/08-vis-response-pt2/#cloudflare-email-routing","title":"Cloudflare Email Routing","text":"<p>Cloudflare Email Routing provides alias-based forwarding for individual services, enabling clean separation of alert sources and simplified identity management. Each service is assigned a unique alias for traceability.</p> <p>Security Impact:</p> <ul> <li>Prevents spoofing by enforcing domain-validated routing</li> <li>Enables per-service alert attribution</li> <li>Provides an additional layer of redundancy</li> </ul> <p>Deployment Rationale:</p> <p>Cloudflare's routing service mirrors enterprise email aliasing strategies, improving traceability and reducing operational complexity.</p> <p>Architecture Principles Alignment:</p> <p>Defense in Depth: Adds routing redundancy and identity separation</p> <p>Secure by Design: Domain-validated forwarding; Cloudflare-managed security</p> <p>Zero Trust: Each alias treated as an independent identity; no implicit trust</p>      Cloudflare Email Routing Configuration"},{"location":"projects/homelab/08-vis-response-pt2/#15-security-controls-summary","title":"15. Security Controls Summary","text":""},{"location":"projects/homelab/08-vis-response-pt2/#control-framework","title":"Control Framework","text":"Control Domain Implementation Coverage Log Aggregation Splunk + Elastic centralized collection All infrastructure Endpoint Detection Wazuh EDR on 25+ hosts Windows, Linux, macOS, BSD Network Monitoring Suricata/Snort IDS on all interfaces 100% traffic inspection File Integrity Monitoring Wazuh FIM on critical paths System files, configs Vulnerability Assessment Wazuh + OpenVAS automated scanning All hosts Compliance Auditing Wazuh SCA policies (CIS, PCI-DSS) Continuous assessment Alert Correlation Splunk SPL queries, Elastic detection rules Multi-source correlation Incident Response Automated containment, Discord alerting Real-time response Audit Logging 90-day retention in SIEM Full audit trail Performance Monitoring Prometheus + Grafana dashboards All infrastructure"},{"location":"projects/homelab/08-vis-response-pt2/#security-event-pipeline","title":"Security Event Pipeline","text":"<ol> <li>Collection: Agents/forwarders collect logs from sources</li> <li>Transport: Encrypted TLS/SSL to SIEM platforms</li> <li>Parsing: Field extraction and normalization</li> <li>Enrichment: GeoIP, threat intel, asset context</li> <li>Correlation: Multi-source event correlation</li> <li>Detection: Rule-based and ML anomaly detection</li> <li>Alerting: Discord webhooks + email notifications</li> <li>Response: Automated containment actions</li> <li>Investigation: Search and visualization tools</li> <li>Retention: 90-day storage, then archive</li> </ol>"},{"location":"projects/homelab/08-vis-response-pt2/#data-classification","title":"Data Classification","text":"Data Type Sensitivity Retention Encryption Security Alerts High 90 days At rest + in transit System Logs Medium 90 days At rest + in transit Application Logs Low 30 days In transit only Performance Metrics Low 90 days None"},{"location":"projects/homelab/08-vis-response-pt2/#access-control","title":"Access Control","text":"<ul> <li>SIEM Platforms: Authentik SSO with MFA required</li> <li>API Access: API tokens with 90-day rotation</li> <li>Dashboard Access: Role-based permissions (admin, analyst, viewer)</li> <li>Alert Management: Admin-only response actions</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#encryption-standards","title":"Encryption Standards","text":"<ul> <li>Log Transport: TLS 1.3 for all forwarder connections</li> <li>At Rest: AES-256 for stored logs and backups</li> <li>Certificates: Step-CA issued, auto-renewed</li> </ul>"},{"location":"projects/homelab/08-vis-response-pt2/#16-detection-use-cases","title":"16. Detection Use Cases","text":""},{"location":"projects/homelab/08-vis-response-pt2/#use-case-1-brute-force-ssh-attack-detection-and-response","title":"Use Case 1: Brute Force SSH Attack Detection and Response","text":"<p>Objective: Detect and automatically block SSH brute force attempts</p> <p>Workflow:</p> <ol> <li>Attacker attempts SSH login to docker-vm-01 from 192.168.1.99</li> <li>Failed attempts logged to /var/log/auth.log</li> <li>Splunk Universal Forwarder forwards logs to Splunk indexer</li> <li>Splunk correlation search detects &gt;20 failed attempts in 5 minutes</li> <li>Alert triggered: \"SSH Brute Force from 192.168.1.99\"</li> <li>Discord webhook notification sent to #security channel</li> <li>Wazuh active response triggers firewall-drop.sh script</li> <li>iptables rule added: Block 192.168.1.99 for 10 minutes</li> <li>Security analyst reviews alert in Splunk dashboard</li> <li>Analyst extends block to permanent if deemed malicious</li> </ol> <p>SPL Query: <pre><code>index=auth sourcetype=syslog \"Failed password\"\n| rex field=_raw \"Failed password for (?&lt;user&gt;\\w+) from (?&lt;src_ip&gt;\\d+\\.\\d+\\.\\d+\\.\\d+)\"\n| stats count by src_ip, dest_host\n| where count &gt; 20\n| eval threat_level=\"High\", action=\"Block IP\"\n</code></pre></p>"},{"location":"projects/homelab/08-vis-response-pt2/#use-case-2-wazuh-malware-detection-with-virustotal-integration","title":"Use Case 2: Wazuh Malware Detection with VirusTotal Integration","text":"<p>Objective: Detect execution of malicious file on Windows endpoint with automated analysis and quarantine</p> <p>Workflow:</p> <ol> <li>User on Win11Pro opens email attachment</li> <li>File (suspicious.exe) is written to Downloads folder</li> <li>Wazuh FIM detects new file creation</li> <li>Wazuh forwards file hash to VirusTotal via integration</li> <li>VirusTotal returns 45/70 detections (Trojan.Downloader)</li> <li>Wazuh custom rule 87105 triggers on positive detections</li> <li>Wazuh active response executes remove-threat.sh</li> <li>File quarantined to secure location</li> <li>Wazuh generates Critical alert (level 15)</li> <li>Alert forwarded to Splunk for correlation</li> <li>Discord notification: \"CRITICAL: Malware detected on Win11Pro\"</li> <li>TheHive case created via Shuffle workflow</li> <li>Cortex analyzers provide additional context</li> <li>Security analyst reviews case with pre-loaded enrichment</li> </ol> <p>Wazuh Rule: <pre><code>&lt;rule id=\"100200\" level=\"15\"&gt;\n  &lt;if_sid&gt;18106&lt;/if_sid&gt;\n  &lt;field name=\"win.eventdata.image\"&gt;\\.exe$&lt;/field&gt;\n  &lt;field name=\"win.eventdata.commandLine\"&gt;\\\\Temp\\\\&lt;/field&gt;\n  &lt;description&gt;Suspicious executable launched from Temp directory&lt;/description&gt;\n  &lt;mitre&gt;\n    &lt;id&gt;T1204.002&lt;/id&gt;\n  &lt;/mitre&gt;\n&lt;/rule&gt;\n</code></pre></p>"},{"location":"projects/homelab/08-vis-response-pt2/#use-case-3-lateral-movement-via-rdp","title":"Use Case 3: Lateral Movement via RDP","text":"<p>Objective: Identify attacker moving between hosts after initial compromise</p> <p>Workflow:</p> <ol> <li>Attacker compromises Win11Pro via phishing</li> <li>Attacker attempts RDP to DC01 using stolen credentials</li> <li>Suricata IDS detects RDP connection: 192.168.1.200 \u2192 192.168.1.152:3389</li> <li>Windows Security Event 4624 (Successful Logon) on DC01</li> <li>Wazuh agent on DC01 forwards event to manager</li> <li>Splunk correlation search identifies:</li> <li>User \"jdoe\" logged in from Win11Pro (unusual source)</li> <li>Time: 2:30 AM (outside normal business hours)</li> <li>Logon Type 10 (RemoteInteractive/RDP)</li> <li>Alert generated: \"Suspicious Lateral Movement Detected\"</li> <li>Discord notification with full context</li> <li>Analyst reviews:</li> <li>User's normal login pattern (9 AM - 5 PM from office PC)</li> <li>No scheduled maintenance windows</li> <li>Source host shows signs of compromise</li> <li>Analyst disables user account in AD</li> <li>Terminates RDP session on DC01</li> <li>Initiates forensic investigation</li> </ol> <p>Splunk Correlation Query: <pre><code>(index=wazuh-alerts rule.id=\"60204\") OR (index=suricata-prod_lan dest_port=3389)\n| eval time_hour=strftime(_time,\"%H\")\n| where (time_hour &lt; 6 OR time_hour &gt; 22)\n| stats values(src_ip) as source_ips, values(dest_ip) as dest_hosts by user\n| where mvcount(dest_hosts) &gt; 1\n| eval threat=\"Lateral movement: user accessed multiple hosts outside business hours\"\n</code></pre></p>"},{"location":"projects/homelab/08-vis-response-pt2/#use-case-4-configuration-drift-detection","title":"Use Case 4: Configuration Drift Detection","text":"<p>Objective: Detect unauthorized changes to critical system configurations</p> <p>Workflow:</p> <ol> <li>Attacker gains access to web server (Apache LXC)</li> <li>Modifies /etc/ssh/sshd_config to enable PasswordAuthentication</li> <li>Wazuh FIM detects file change within seconds</li> <li>Wazuh generates alert with file diff:</li> <li>Old value: PasswordAuthentication no</li> <li>New value: PasswordAuthentication yes</li> <li>Alert includes MD5/SHA256 hash of modified file</li> <li>Alert forwarded to Splunk and displayed in dashboard</li> <li>Discord notification: \"File Integrity Violation on Apache LXC\"</li> <li>Analyst reviews change:</li> <li>Change made by root user</li> <li>No change ticket associated with modification</li> <li>Unauthorized change confirmed</li> <li>Wazuh active response:</li> <li>Restores original sshd_config from backup</li> <li>Restarts SSH service with secure config</li> <li>Analyst investigates how attacker gained root access</li> </ol> <p>Wazuh FIM Alert: <pre><code>Event: Modified\nFile: /etc/ssh/sshd_config\nOld MD5: a1b2c3d4e5f6...\nNew MD5: f6e5d4c3b2a1...\nUser: root\nTime: 2024-11-06 14:23:45\nSeverity: High (level 10)\n</code></pre></p>"},{"location":"projects/homelab/08-vis-response-pt2/#use-case-5-cis-benchmark-compliance-violation","title":"Use Case 5: CIS Benchmark Compliance Violation","text":"<p>Objective: Identify hosts failing CIS benchmark requirements</p> <p>Workflow:</p> <ol> <li>Wazuh SCA scan runs every 12 hours</li> <li>Scan detects violations on DC01:</li> <li>Password minimum length: 8 (Required: 14)</li> <li>Account lockout threshold: 5 (Required: 3)</li> <li>Audit log retention: 30 days (Required: 90 days)</li> <li>Wazuh generates compliance report</li> <li>Report forwarded to Splunk</li> <li>Compliance dashboard shows:</li> <li>Overall score: 89.2% (below 95% target)</li> <li>Critical failures: 3</li> <li>Affected hosts: DC01</li> <li>Weekly compliance report emailed to IT management</li> <li>Security team creates remediation tickets:</li> <li>GPO update for password policy</li> <li>GPO update for lockout threshold</li> <li>Increase audit log retention</li> <li>Changes applied via Group Policy</li> <li>Next scan confirms compliance: 96.5%</li> </ol> <p>Wazuh Compliance Query: <pre><code>Policy: CIS Windows Server 2022\nFailed Checks: 3\nScore: 89.2%\nRisk Level: Medium\n</code></pre></p>"},{"location":"projects/homelab/08-vis-response-pt2/#17-security-homelab-section-links","title":"17. Security Homelab Section Links","text":"<ul> <li>Executive Summary and Security Posture</li> <li>Infrastructure Platform, Virtualization Stack and Hardware</li> <li>Network Security, Privacy and Remote Access</li> <li>Identity, Access, Secrets and Trust Management</li> <li>Automation and IaC</li> <li>Applications and Services</li> <li>Observability and Response, Part 1</li> <li>Observability and Response, Part 2</li> </ul>"},{"location":"projects/homelab/grc/01-summary/","title":"Security Lab - Governance, Risk and Compliance Summary","text":"<p>Document Control:  Version: 1.0 Last Updated: January 2026 Owner: Paul Leone</p> <p>Framework Versions: NIST CSF 2.0, CIS Controls v8.1, NIST SP 800-53 Rev 5, ISO 27001:2022, PCI-DSS v4.0, OWASP Top 10 2025, MITRE ATT&amp;CK Enterprise v18.1, CISA ZTMM v2.0, NIST SP 800-207 Zero Trust</p>"},{"location":"projects/homelab/grc/01-summary/#executive-overview","title":"Executive Overview","text":""},{"location":"projects/homelab/grc/01-summary/#framework-alignment-with-lab-mission","title":"Framework Alignment with Lab Mission","text":"<p>This cybersecurity lab demonstrates production-ready security capabilities aligned with nine industry-standard frameworks, each validating specific aspects of the lab's mission to simulate enterprise-grade SecOps, Systems Engineering, and Network Defense operations.</p>"},{"location":"projects/homelab/grc/01-summary/#mission-alignment-by-framework","title":"Mission Alignment by Framework","text":"<p>NIST Cybersecurity Framework 2.0 validates threat detection &amp; response capabilities through comprehensive implementation across all six functions (Govern, Identify, Protect, Detect, Respond, Recover). The framework's risk-based approach directly supports the lab mission of demonstrating production-ready SOC operations, achieving Tier 3-4 maturity with automated incident response workflows reducing MTTR to &lt;30 minutes.</p> <p>CIS Controls v8.1 validates defense-in-depth architecture through 93% IG1 compliance and 81% IG2 compliance, demonstrating foundational security hygiene (asset inventory, patch management, centralized logging) and advanced security capabilities (network segmentation, MFA enforcement, vulnerability management). The controls map directly to enterprise infrastructure operations with automated patch management across 5,000+ packages and comprehensive security monitoring.</p> <p>ISO 27001:2022 validates security engineering &amp; automation through 77% overall control coverage, with exceptional performance in technological controls (91%). The framework demonstrates policy-driven security architecture with CIS Benchmark compliance, Infrastructure as Code automation, and comprehensive audit capabilities supporting compliance-ready operations.</p> <p>NIST SP 800-53 Rev 5 validates technical security engineering depth through strong implementation in Access Control (90%), Audit &amp; Accountability (100%), and System Integrity (90%). The framework demonstrates enterprise-grade controls spanning identity management, cryptographic protection, and continuous monitoring\u2014directly transferable to Security Engineer roles.</p> <p>MITRE ATT&amp;CK Enterprise v18.1 validates operational threat detection capabilities through 30% technique coverage (65 of 216 techniques) across 12 adversary tactics. Strong coverage in Initial Access (67%), Execution (67%), and Lateral Movement (56%) demonstrates real-world threat hunting and detection engineering capabilities aligned with SOC Analyst responsibilities.</p> <p>OWASP Top 10 (2025) validates application security engineering through strong coverage across 9 of 10 categories. Advanced maturity in cryptographic failures, injection prevention, and authentication demonstrates secure application architecture principles applicable to DevSecOps and application security roles.</p> <p>PCI-DSS v4.0 validates compliance-ready technical controls through 85% conceptual implementation of requirements. While the lab processes no cardholder data, the architecture demonstrates production-ready capabilities in network segmentation, encryption, logging, and vulnerability management that directly transfer to regulated environments.</p> <p>CISA Zero Trust Maturity Model v2.0 validates zero trust architecture implementation through Advanced maturity (Stage 3 of 4) across all five core pillars (Identity, Devices, Networks, Applications &amp; Workloads, Data) plus three cross-cutting capabilities (Visibility &amp; Analytics, Automation &amp; Orchestration, Governance). The framework demonstrates explicit verification of every access request, least-privilege enforcement via RBAC, assume-breach mentality with continuous monitoring, and encrypt-everything policies using modern cryptographic standards.</p> <p>NIST SP 800-207 Zero Trust Architecture validates comprehensive implementation of all seven ZT tenets through hybrid deployment model combining device agent/gateway (Authentik + Traefik), enclave gateway (pfSense/OPNsense), and resource portal approaches. The framework demonstrates mature logical component deployment with policy decision points, policy enforcement points, and continuous monitoring achieving 6 of 8 pillars at Advanced level.</p>"},{"location":"projects/homelab/grc/01-summary/#architectural-principles-demonstrated","title":"Architectural Principles Demonstrated","text":"<p>Defense in Depth is validated across all frameworks through multi-layered security controls:</p> <ul> <li>Network perimeter defense (CIS 12.1-12.4, NIST SC-7, ISO A.8.20, PCI-DSS 1.x, CISA ZTMM Networks, NIST 800-207 SC-7)</li> <li>Application layer protection (OWASP A01-A10, NIST SI-10, ISO A.8.26, CISA ZTMM Applications, NIST 800-207 SA-8)</li> <li>Endpoint security (CIS 10.1-10.7, NIST SI-3/SI-4, ATT&amp;CK detection coverage, CISA ZTMM Devices, NIST 800-207 IA-3)</li> <li>Identity controls (CIS 5-6, NIST AC/IA families, ISO A.5.15-5.18, OWASP A07, CISA ZTMM Identity, NIST 800-207 IA-2)</li> </ul> <p>Secure by Design is validated through embedded security controls:</p> <ul> <li>Mandatory encryption (NIST SC-8/SC-13/SC-28, ISO A.8.24, OWASP A04, PCI-DSS 4.2, CISA ZTMM Data, NIST 800-207 SC-8)</li> <li>Authenticated access (NIST IA-2, CIS 6.3-6.5, ISO A.5.17, OWASP A07, CISA ZTMM Identity Advanced, NIST 800-207 IA-2(1))</li> <li>Least privilege (NIST AC-6, CIS 5.4/6.1, ISO A.5.18, OWASP A01, CISA ZTMM per-session access, NIST 800-207 AC-6)</li> <li>IaC automation (NIST CM-2/CM-3, CIS 4.1, ISO A.8.9/A.8.32, CISA ZTMM Automation Advanced, NIST 800-207 CM-2(2))</li> </ul> <p>Zero Trust Architecture is validated through continuous verification principles:</p> <ul> <li>Identity verification (NIST IA-2(1)/AC-3, ISO A.5.15, OWASP A07, CISA ZTMM Identity Advanced with phishing-resistant MFA, NIST 800-207 Tenet 6)</li> <li>Network micro-segmentation (NIST SC-7(21), CIS 12.2, ISO A.8.20, CISA ZTMM Networks Advanced 3-tier architecture, NIST 800-207 Tenet 2)</li> <li>Encrypted communications (NIST SC-8(1), PCI-DSS 4.2, OWASP A04, CISA ZTMM full encryption TLS 1.3, NIST 800-207 SC-8(1))</li> <li>Assume breach monitoring (ATT&amp;CK coverage, NIST SI-4, CIS 13.1-13.6, CISA ZTMM Visibility Advanced 100% logging, NIST 800-207 Tenet 7)</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#framework-purpose-organizational-value","title":"Framework Purpose &amp; Organizational Value","text":"<p>NIST Cybersecurity Framework 2.0</p> <p>Purpose: Provides risk-based framework for managing cybersecurity across enterprise operations through six core functions (Govern, Identify, Protect, Detect, Respond, Recover).</p> <p>Organizational Value: Enables executive-level communication of cybersecurity posture, facilitates risk-informed decision making, and provides maturity benchmarking. Organizations use CSF 2.0 for board-level reporting, vendor risk assessments, and strategic security planning. The framework's flexibility makes it applicable across industries and organization sizes.</p> <p>CIS Controls v8.1</p> <p>Purpose: Delivers prescriptive, prioritized safeguards organized into three Implementation Groups (IG1: basic hygiene, IG2: enhanced security, IG3: advanced capabilities) based on organizational maturity and resources.</p> <p>Organizational Value: Provides actionable security roadmap with clear prioritization\u2014IG1 controls address 80% of common attacks. Organizations use CIS Controls for security program development, gap analysis, and resource allocation. The framework's specificity enables measurable progress tracking and budget justification.</p> <p>ISO 27001:2022</p> <p>Purpose: Establishes requirements for Information Security Management Systems (ISMS) with 93 controls across organizational, people, physical, and technological domains, supporting formal certification.</p> <p>Organizational Value: Enables third-party certification demonstrating security commitment to customers, partners, and regulators. Organizations use ISO 27001 for contract requirements, regulatory compliance (GDPR, HIPAA alignment), and competitive differentiation in security-conscious markets.</p> <p>NIST SP 800-53 Rev 5</p> <p>Purpose: Provides comprehensive catalog of security/privacy controls for federal systems, organized into 20 control families covering technical, operational, and management safeguards.</p> <p>Organizational Value: Serves as authoritative technical control baseline for government contractors and regulated industries. Organizations use 800-53 for FedRAMP compliance, FISMA requirements, and as technical reference for implementing CSF/ISO controls with specific implementation guidance.</p> <p>MITRE ATT&amp;CK Enterprise v18.1</p> <p>Purpose: Documents adversary tactics, techniques, and procedures (TTPs) based on real-world observations, providing common taxonomy for threat-informed defense.</p> <p>Organizational Value: Enables threat-based security testing, detection engineering, and purple team exercises. Organizations use ATT&amp;CK for security tool evaluation, SOC playbook development, and measuring defensive coverage against known adversary behaviors. The framework transforms reactive security into proactive threat hunting.</p> <p>OWASP Top 10 (2025)</p> <p>Purpose: Identifies most critical web application security risks based on industry data, providing developer-focused guidance for secure application development.</p> <p>Organizational Value: Drives secure coding practices, developer training, and application security testing priorities. Organizations use OWASP Top 10 for DevSecOps integration, penetration testing scopes, and measuring application security maturity. The framework bridges security and development teams with shared risk language.</p> <p>PCI-DSS v4.0</p> <p>Purpose: Mandates technical and operational requirements for organizations handling payment card data, enforced through annual assessments and potential financial penalties for non-compliance.</p> <p>Organizational Value: Ensures payment security protecting customer data and brand reputation. Organizations must achieve PCI compliance to process credit cards\u2014non-compliance risks data breaches, fines up to $100k/month, and loss of payment processing privileges. The framework provides detailed security requirements reducing breach risk.</p> <p>CISA Zero Trust Maturity Model v2.0</p> <p>Purpose: Defines four maturity stages (Traditional, Initial, Advanced, Optimal) across five core pillars (Identity, Devices, Networks, Applications &amp; Workloads, Data) and three cross-cutting capabilities (Visibility &amp; Analytics, Automation &amp; Orchestration, Governance) providing actionable roadmap for zero trust adoption.</p> <p>Organizational Value: Enables organizations to assess current zero trust posture and prioritize investments across identity-centric security, device trust, network micro-segmentation, application protection, and data security. Federal agencies use ZTMM for EO 14028 compliance; private sector organizations leverage the model for modernization roadmaps. The framework's staged approach supports incremental transformation aligned with organizational maturity and resources.</p> <p>NIST SP 800-207 Zero Trust Architecture</p> <p>Purpose: Establishes foundational principles and logical architecture for zero trust implementation through seven core tenets: explicit resource definition, location-independent security, per-session access, dynamic policy, asset integrity monitoring, dynamic authentication, and comprehensive telemetry collection.</p> <p>Organizational Value: Provides vendor-neutral technical guidance for zero trust deployment spanning policy decision/enforcement points, trust algorithms, and hybrid deployment models. Organizations use 800-207 for architecture design, RFP requirements, and validating vendor solutions against federal standards. The framework's logical component model enables technology-agnostic implementation suitable for cloud, on-premises, and hybrid environments.</p>"},{"location":"projects/homelab/grc/01-summary/#overall-lab-assessment","title":"Overall Lab Assessment","text":"<p>Core Strengths</p> <p>Operational Security Excellence</p> <ul> <li>100% security event logging with dual SIEM architecture (Splunk + Elastic) providing &lt;5min MTTD</li> <li>Automated incident response via SOAR (Shuffle) achieving &lt;30min MTTR with 15+ documented playbooks</li> <li>Multi-layered threat detection through network IDS/IPS (Suricata/Snort), host EDR (Wazuh 25+ endpoints), and behavioral analytics (CrowdSec)</li> <li>Comprehensive vulnerability management with weekly OpenVAS + monthly Nessus scans exceeding industry standards, &lt;72hr critical MTTR</li> </ul> <p>Technical Architecture Maturity</p> <ul> <li>Defense-in-depth implementation across network (segmentation, firewalls, IDS/IPS), application (WAF, reverse proxy), endpoint (EDR, FIM), and identity (SSO, MFA, PKI) layers</li> <li>Infrastructure as Code automation (Terraform, Ansible) enabling repeatable deployments with version control and audit trails</li> <li>Advanced cryptographic implementation: TLS 1.3 mandatory, Step-CA PKI, Ed25519 SSH keys, AES-256 encryption, zero weak algorithms</li> <li>High availability architecture: HA firewall cluster, dual SIEM, dual DNS with &lt;5s failover, redundant internet</li> <li>Zero trust principles: explicit verification (Authentik SSO 100% coverage), micro-segmentation (3-tier VLAN architecture), encrypted communications (TLS 1.3 mandatory), continuous monitoring (dual SIEM 100% event coverage)</li> </ul> <p>Framework Compliance &amp; Documentation</p> <ul> <li>NIST CSF 2.0: Tier 3-4 maturity with 100% function coverage</li> <li>CIS Controls v8.1: 93% IG1, 81% IG2 compliance</li> <li>ISO 27001:2022: 77% overall, 91% technological controls</li> <li>NIST 800-53: 100% Audit &amp; Accountability, 90%+ in AC/IA/SC/SI families</li> <li>PCI-DSS v4.0: 85% technical control implementation</li> <li>CISA ZTMM v2.0: Advanced maturity (Stage 3/4) across all 5 pillars + 3 cross-cutting capabilities</li> <li>NIST SP 800-207: Comprehensive implementation of all 7 ZT tenets, 6 of 8 pillars at Advanced level</li> </ul> <p>This executive overview demonstrates that the lab achieves production-grade security capabilities across technical controls (91% ISO technological, 100% NIST AU, 90%+ AC/IA/SC/SI), operational processes (NIST Tier 3-4, 93% CIS IG1), threat detection (67% ATT&amp;CK Initial Access/Execution), and zero trust architecture (CISA ZTMM Advanced across all pillars, NIST 800-207 comprehensive tenet implementation). Strategic gaps in supply chain security, advanced detection, DLP, and formal testing represent realistic areas for continued maturity advancement, mirroring the continuous improvement cycles found in enterprise security programs.</p>"},{"location":"projects/homelab/grc/01-summary/#nist-cybersecurity-framework-20-implementation-summary","title":"NIST Cybersecurity Framework 2.0 Implementation Summary","text":"<p>       This personal cybersecurity lab demonstrates comprehensive implementation of NIST CSF 2.0 across all six core functions. The environment serves as a learning platform for enterprise-grade security controls while maintaining conceptual compliance with NIST, CIS, ISO 27001, and PCI-DSS frameworks.     </p> <p> Overall Maturity: Tier 3 (Repeatable) - Approaching Tier 4 (Adaptive) </p> NIST Cybersecurity Framework 2.0"},{"location":"projects/homelab/grc/01-summary/#function-implementation-analysis","title":"Function Implementation Analysis","text":"<p>GOVERN (GV) - Tier 3</p> <p>Implementation: Risk management strategy established with documented CVSS-based prioritization, defined risk tolerances (Critical CVEs &lt;72h MTTR, High &lt;7d), and comprehensive security policies including SSH hardening (CIS Benchmark), TLS 1.3 minimum, and 100% security event logging. Limited by personal lab context (no stakeholder management, oversight, or enterprise integration).</p> <p>Key Controls: Mission-aligned security objectives, criticality tiering (Tier 1: SIEM/EDR, Tier 2: Firewalls/DNS, Tier 3: Supporting services), vulnerability remediation SLAs, supply chain risk awareness through vetted open-source selection.</p> <p>IDENTIFY (ID) - Tier 4</p> <p>Implementation: Comprehensive automated asset discovery and continuous risk assessment across 30+ hosts and 5,000+ packages. Real-time vulnerability correlation with NVD, MITRE ATT&amp;CK mapping, and threat intelligence integration via MISP.</p> <p>Key Controls: Multi-platform inventory (Checkmk, Prometheus, PatchMon, Wazuh), network topology documentation, CVSS base/temporal/environmental scoring, threat intelligence feeds (CrowdSec, AlienVault OTX, abuse.ch), automated vulnerability disclosure workflows via Shuffle.</p> <p>PROTECT (PR) - Tier 4</p> <p>Implementation: Defense-in-depth architecture with automated patch management (PatchMon, WSUS, WUD, Watchtower), centralized identity management (Authentik SSO with MFA), and comprehensive data protection (TLS 1.3, AES-256 encryption, immutable SIEM indexes).</p> <p>Key Controls: Certificate-based authentication (Step-CA), RBAC enforcement, least-privilege access, configuration management via IaC (Terraform, Ansible), secure software development practices, CIS Benchmark compliance audits.</p> <p>DETECT (DE) - Tier 3</p> <p>Implementation: Continuous monitoring with 100% network visibility, multi-source correlation (Splunk, Elastic, Wazuh, Suricata), and automated threat analysis via Cortex/MISP. Real-time alerting through Discord/email with severity-based escalation to TheHive.</p> <p>Key Controls: Weekly OpenVAS + monthly Nessus scans, daily PatchMon checks, DNS query logging, FIM, Yara rules, MITRE ATT&amp;CK-based threat hunting. Gap: Lacks ML-based anomaly detection for Tier 4 advancement.</p> <p>RESPOND (RS) - Tier 3</p> <p>Implementation: Documented IR procedures with 15+ TheHive playbooks, automated orchestration via Shuffle (phishing, malware, ransomware workflows), and multi-engine analysis through Cortex. Active Response capabilities via Wazuh and pfSense API for automated containment.</p> <p>Key Controls: Incident categorization with MITRE ATT&amp;CK mapping, forensic data collection, automated enrichment workflows, virtual patching (Safeline WAF), emergency remediation via Ansible. Gap: Lacks tabletop exercises and formal BC/DR drills for Tier 4 maturity.</p> <p>RECOVER (RC) - Tier 3</p> <p>Implementation: Backup/restore procedures with encrypted backups (AES-256), snapshot-based rollback strategies, HA DNS failover (dual Pi-hole), and documented RTO/RPO targets. Service prioritization aligns with criticality tiers.</p> <p>Key Controls: System rebuild playbooks, service validation checklists, verification testing procedures, UPS-backed power protection. Gap: Requires formal BC/DR exercises and recovery plan testing for Tier 4.</p>"},{"location":"projects/homelab/grc/01-summary/#key-achievements","title":"Key Achievements","text":"<ul> <li>100% Function Coverage: All six CSF 2.0 functions implemented with documented processes and automated controls</li> <li>Advanced Detection: Multi-SIEM architecture (Splunk + Elastic + Wazuh) provides &lt;5min MTTD for critical events</li> <li>Automated Response: Shuffle orchestration reduces MTTR by 70% compared to manual workflows</li> <li>Risk-Based Approach: CVSS environmental scoring integrates asset criticality and exploit maturity</li> <li>Continuous Assessment: Real-time security posture visibility through 20+ Grafana dashboards</li> <li>Threat Intelligence: MISP platform aggregates 5+ community feeds with automated IOC correlation</li> <li>Zero Trust Principles: SSO enforcement, MFA, certificate-based auth, network segmentation</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#cis-critical-security-controls-v81-implementation-summary","title":"CIS Critical Security Controls v8.1 Implementation Summary","text":"<p>       This cybersecurity lab demonstrates comprehensive implementation of CIS Controls v8.1 across 18 control families. The environment achieves 93% compliance at Implementation Group 1 (IG1), 81% at IG2, and 52% at IG3, with strategic gaps primarily in areas requiring multi-user organizational structures or commercial-grade infrastructure.     </p> CIS Critical Security Controls v8.1"},{"location":"projects/homelab/grc/01-summary/#implementation-group-compliance","title":"Implementation Group Compliance","text":"<p>IG1 (Basic Cyber Hygiene) - 93% Compliant</p> <p>Status: 52 of 56 safeguards fully implemented</p> <p>Strengths: Complete coverage of foundational controls including asset inventory (Controls 1-2), data protection (Control 3), patch management (Control 7), centralized logging (Control 8), malware defenses (Control 10), and backup/recovery (Control 11).</p> <p>Gaps: Application allowlisting (2.5), weekly unauthorized asset reviews (1.2), comprehensive data flow diagrams (3.8), formal secure configuration policy documentation (4.1).</p> <p>IG2 (Enhanced Security) - 81% Compliant</p> <p>Status: 60 of 74 additional safeguards implemented</p> <p>Strengths: Advanced monitoring capabilities exceed requirements\u2014weekly OpenVAS scans vs quarterly requirement, 90-day log retention, dual SIEM architecture, comprehensive vulnerability management with &lt;72h MTTR for critical CVEs. Network segmentation, encrypted communications (TLS 1.3), MFA enforcement, and automated patch management demonstrate mature security posture.</p> <p>Critical Gaps: - Network AAA service (12.5) - Application/script allowlisting (2.5-2.7) - Remote wipe capability for laptops (4.11) - Formal penetration testing program (18.1-18.2) - Comprehensive RBAC documentation (6.8)</p> <p>IG3 (Advanced Security) - 52% Compliant</p> <p>Status: 15 of 29 additional safeguards implemented</p> <p>Strengths: Host-based IPS (Wazuh Active Response), network IPS (Suricata inline blocking), application layer filtering (SafeLine WAF), behavior-based malware detection, detailed audit logging with command-line capture.</p> <p>Gaps: 802.1X port-level NAC (13.9), isolated admin workstation (12.8), DLP solution (3.13), mobile device containerization (4.12), formal SAST/DAST scanning (16.12), threat modeling documentation (16.14), annual penetration testing (18.5).</p>"},{"location":"projects/homelab/grc/01-summary/#control-by-control-analysis","title":"Control-by-Control Analysis","text":"<p>Fully Compliant Controls (100%): - Control 5: Account Management - Control 7: Continuous Vulnerability Management (exceeds standards) - Control 10: Malware Defenses - Control 11: Data Recovery</p> <p>Mostly Compliant Controls (80-99%): - Control 1: Asset Inventory (99% - minor process gap) - Control 3: Data Protection (95% - IG1/IG2 complete) - Control 6: Access Control (90% - needs RBAC documentation) - Control 8: Audit Log Management (98% - IG1/IG2 complete) - Control 12: Network Infrastructure (85% - lacks AAA) - Control 13: Network Monitoring (90% - lacks 802.1X)</p> <p>Partial Compliance (50-79%): - Control 2: Software Inventory (70% - allowlisting gaps) - Control 4: Secure Configuration (75% - needs policy docs) - Control 9: Email/Web Protection (65% - limited by homelab) - Control 16: Application Security (60% - infrastructure focus) - Control 18: Penetration Testing (40% - vulnerability scanning substitute)</p> <p>Limited Applicability: - Control 14: Security Awareness (N/A - single-user) - Control 15: Service Provider Management (N/A - single-user) - Control 17: Incident Response (85% - lacks multi-user elements)</p>"},{"location":"projects/homelab/grc/01-summary/#key-achievements_1","title":"Key Achievements","text":"<ul> <li>Exceeds Scanning Requirements: Weekly OpenVAS + monthly Nessus vs quarterly CIS baseline</li> <li>Advanced SIEM: Dual platform (Splunk + Elastic) with 100% security event coverage</li> <li>Automated Patching: Multi-platform management (PatchMon, WSUS, Watchtower, WUD)</li> <li>Comprehensive Inventory: 30+ hosts, 5,000+ packages, automated discovery</li> <li>Defense-in-Depth: Network segmentation, host/network IPS, WAF, EDR on 25+ endpoints</li> <li>Rapid Remediation: &lt;72h MTTR for critical CVEs, 95% patch compliance</li> <li>Encrypted Everything: TLS 1.3, AES-256 backups, VPN tunnels, syslog-ng TLS</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#iso-270012022-annex-a-implementation-summary","title":"ISO 27001:2022 Annex A Implementation Summary","text":"<p>       This cybersecurity lab demonstrates comprehensive implementation of ISO 27001:2022 Annex A controls across 93 requirements spanning organizational, people, physical, and technological domains. The environment achieves 77% overall coverage of applicable controls, with particularly strong implementation in technological controls (91%) and organizational security practices (71%).     </p> <p> Overall Compliance: 77% of Applicable Controls (55 Implemented, 14 Partial) </p> ISO 27001:2022 Certification"},{"location":"projects/homelab/grc/01-summary/#control-family-analysis","title":"Control Family Analysis","text":"<p>5. Organizational Controls - 71% Coverage (22/31 Applicable)</p> <p>Implementation: Strong foundation in security policies (A.5.1), threat intelligence (A.5.7 via MISP/CrowdSec), comprehensive asset inventory (A.5.9 tracking 5,000+ packages across 30+ hosts), encrypted data transfer (A.5.14 with TLS 1.3), centralized access control (A.5.15 via Authentik SSO), and robust incident response (A.5.24-A.5.28 with TheHive/Shuffle orchestration).</p> <p>Key Achievements: - Incident Management Excellence: 15+ documented IR playbooks, automated containment via Wazuh Active Response, sub-30-minute MTTR, forensic data collection with immutable SIEM logs - Business Continuity: HA DNS failover, IaC-enabled &lt;2hr RTO, automated bi-weekly backups, quarterly restore testing - Compliance Monitoring: CIS Benchmark audits (92-98%), continuous compliance tracking via SIEM dashboards</p> <p>Gaps: - Formal information labeling (A.5.13) - informal only - Complete SBOM tracking (A.5.21) - planned Trivy/Grype implementation - Comprehensive supply chain monitoring (A.5.22) - partial dependency tracking - Independent security reviews (A.5.35) - N/A for personal lab</p> <p>6. People Controls - 100% Coverage (2/2 Applicable)</p> <p>Implementation: Complete coverage of applicable controls with secure remote working (A.6.7 via Tailscale mesh VPN, MFA enforcement, TLS 1.3 encryption) and comprehensive security event reporting (A.6.8 through Discord webhooks, email notifications, TheHive case creation, multi-channel redundancy).</p> <p>Note: Six controls (A.6.1-A.6.6) marked N/A due to single-user lab environment (no employee screening, training, or termination processes required).</p> <p>7. Physical Controls - 33% Coverage (2/6 Applicable)</p> <p>Implementation: Limited by residential homelab context. Implemented controls include secure storage media management (A.7.10 with encrypted backup media, USB restrictions, GPO enforcement) and secure equipment disposal (A.7.14 with documented DBAN/shred procedures, physical drive destruction).</p> <p>Partial Implementation: - Environmental monitoring (A.7.4) - Prometheus temperature/HVAC monitoring, no video surveillance - Physical threat protection (A.7.5) - UPS backup, residential fire detection, environmental monitoring - Utility redundancy (A.7.11) - Dual internet, UPS, no generator - Equipment maintenance (A.7.13) - Hardware monitoring via Proxmox/Checkmk</p> <p>Note: Eight controls (A.7.1-A.7.3, A.7.6-A.7.9, A.7.12) marked N/A as residential physical security controls not applicable to homelab environment.</p> <p>8. Technological Controls - 91% Coverage (29/32 Applicable)</p> <p>Implementation: Exceptional coverage demonstrating enterprise-grade security architecture. Comprehensive endpoint protection (A.8.1 with Wazuh EDR on 25+ endpoints), privileged access management (A.8.2 with separate admin accounts, 100% MFA), robust malware defenses (A.8.7 via Wazuh FIM, Suricata/Snort, multi-engine Cortex analysis), and advanced vulnerability management (A.8.8 with weekly OpenVAS, monthly Nessus, &lt;72h critical MTTR).</p> <p>Key Achievements: - Defense-in-Depth: Multi-layered security with network segmentation, WAF (SafeLine), IDS/IPS (Suricata inline), host-based protection - Cryptographic Excellence: TLS 1.3 mandatory, Ed25519 SSH keys, Step-CA PKI, AES-256-GCM encryption, DNSSEC, no weak algorithms - Comprehensive Logging: 100% security event coverage, dual SIEM (Splunk + Elastic), 90-day retention, immutable audit trails, encrypted syslog-ng transmission - Configuration Management: Ansible/Terraform IaC, Git version control, CIS Benchmark compliance (92-98%), automated drift detection - High Availability: HA firewall cluster, dual Pi-hole DNS (&lt;5s failover), dual SIEM, redundant internet, load balancing</p> <p>Partial Implementation: - Data leakage prevention (A.8.12) - egress filtering and monitoring without formal DLP - Secure SDLC (A.8.25) - IaC practices with planned CI/CD security linting</p> <p>Gaps: - Data masking (A.8.11) - not required (no production PII processing) - Secure coding (A.8.28) - N/A (minimal custom development) - Outsourced development (A.8.30) - N/A (open-source reliance)</p>"},{"location":"projects/homelab/grc/01-summary/#critical-control-highlights","title":"Critical Control Highlights","text":"<p>Access Control &amp; Identity Management: - Centralized SSO (Authentik) with MFA enforcement (100% admin accounts) - SSH key-based authentication with centralized management (Ansible) - RBAC implementation, least-privilege access, privileged action logging - Session timeout, account lockout policies, certificate-based auth (Step-CA)</p> <p>Threat Detection &amp; Response: - Multi-source threat intelligence (MISP, CrowdSec, AlienVault OTX, abuse.ch) - Automated incident orchestration (Shuffle workflows, Cortex responders) - Real-time alerting with &lt;5min MTTD for critical events - Forensic data collection with chain of custody documentation</p> <p>Data Protection: - Encryption at rest (AES-256 backups, encrypted endpoints) - Encryption in transit (TLS 1.3, SSH, VPN tunnels, syslog-ng TLS) - Secure deletion procedures, 90-day log retention, immutable SIEM indexes - Offsite backup storage with quarterly restore testing</p> <p>Network Security: - VLAN/subnet segmentation with firewall ACLs per segment - Default-deny firewall policies, DMZ isolation, backend protection - IDS/IPS (Suricata inline blocking, Snort passive, CrowdSec behavioral) - DNS security (Pi-hole filtering 2M+ domains, DNSSEC, planned DNS-over-TLS)</p>"},{"location":"projects/homelab/grc/01-summary/#compliance-strengths","title":"Compliance Strengths","text":"<ol> <li>Technological Excellence: 91% coverage with enterprise-grade implementations exceeding homelab expectations</li> <li>Incident Response Maturity: Comprehensive IR capabilities with documented playbooks, automated orchestration, and forensic readiness</li> <li>Continuous Monitoring: 100% visibility across infrastructure with multi-platform SIEM, real-time alerting, and automated correlation</li> <li>Vulnerability Management: Weekly/monthly scanning cadence, &lt;72h critical MTTR, 95% patch compliance, risk-based prioritization</li> <li>Encryption Everywhere: Mandatory TLS 1.3, strong ciphersuites, PKI implementation, encrypted backups and transmission</li> </ol>"},{"location":"projects/homelab/grc/01-summary/#nist-sp-800-53-rev-5-implementation-summary","title":"NIST SP 800-53 Rev 5 Implementation Summary","text":"<p>       This cybersecurity lab demonstrates comprehensive implementation of NIST SP 800-53 Rev 5 security controls across 18 control families and 324+ individual requirements. The environment achieves strong compliance in technical control families (AC, AU, IA, SC, SI) with 85%+ implementation rates, while organizational controls (PE, PS, PM) are appropriately marked N/A due to single-user homelab context.     </p> <p> Overall Maturity: High (Technical Controls) / Moderate (Administrative Controls) </p> NIST SP 800-53 Rev 5"},{"location":"projects/homelab/grc/01-summary/#control-family-compliance-analysis","title":"Control Family Compliance Analysis","text":"<p>Access Control (AC) - 90% Implementation</p> <p>27 controls implemented/partial of 30 applicable</p> <p>Strong enforcement through Authentik SSO with MFA (100% admin accounts), SSH key-based authentication, centralized RBAC via Authentik groups and Active Directory OUs, and comprehensive session management. Privileged access monitored via SIEM with dedicated dashboards tracking all admin logins, sudo usage, and account lifecycle events. Remote access hardened with IP restrictions, Traefik middleware filtering, and Tailscale VPN integration.</p> <p>Key Achievements: Automated account management (AC-2 series), behavioral anomaly detection via Splunk geoIP tracking, Wazuh Active Response for high-risk account disabling, role-based access enforcement across all services.</p> <p>Gaps: Account monitoring for atypical usage (AC-2(12)) partially implemented - behavioral analysis exists but not comprehensive.</p> <p>Audit and Accountability (AU) - 100% Implementation</p> <p>18 controls fully implemented</p> <p>Exceptional logging posture with 100% security event coverage across DNS, SSH, Traefik, patches, scans, and endpoint telemetry. Dual SIEM architecture (Splunk + Elastic) provides redundancy and specialized capabilities - Splunk for correlation/analytics, Elastic for scalability. Logs include comprehensive context (timestamp, user, source IP, action, result, SSH key fingerprints, DNS query details, Sysmon process trees). Immutable audit trails via Splunk read-only indexes and Elastic immutable streams prevent tampering. 90-day hot retention with 1-year cold storage and automated lifecycle management.</p> <p>Key Achievements: Sub-60s alert latency (AU-5(2)), multi-source correlation across 4+ log repositories (AU-6(3)), standardized JSON/CEF formats (AU-12(2)), encrypted syslog-ng TLS transmission (AU-9).</p> <p>Assessment, Authorization, and Monitoring (CA) - 80% Implementation</p> <p>8 controls implemented/partial of 10 applicable</p> <p>Continuous monitoring excellence with weekly OpenVAS network scans (52/year) and monthly Nessus authenticated scans (12/year) far exceeding baseline requirements. Real-time security posture dashboards via Grafana track vulnerability trends, patch compliance, and security metrics. CIS Benchmark compliance audits (92-98%) and Wazuh Security Configuration Assessment provide ongoing validation.</p> <p>Gaps: Independent assessors (CA-2(1), CA-7(1)) N/A for homelab; formal penetration testing (CA-8) remains informal with scanning/enumeration substituting for full engagements.</p> <p>Configuration Management (CM) - 95% Implementation</p> <p>15 controls implemented of 16 applicable</p> <p>Infrastructure-as-Code excellence via Ansible playbooks defining baselines and Terraform managing infrastructure. Git version control provides configuration history with snapshot-before-patch strategy enabling rapid rollback. CIS Benchmark baselines audited continuously with automated drift detection and remediation. Comprehensive inventory tracking 5,000+ packages across 30+ hosts via PatchMon, 50+ containers via WUD, and 25+ endpoints via Wazuh agents.</p> <p>Key Achievements: Automated baseline verification (CM-2(2)), signed component verification (CM-14), unauthorized software detection via Nessus compliance scans and Wazuh FIM (CM-8(3)).</p> <p>Contingency Planning (CP) - 75% Implementation</p> <p>6 controls implemented of 8 applicable</p> <p>Robust backup strategy with Proxmox automated bi-weekly backups, encrypted storage (AES-256), dual backup solutions (Proxmox Backup Server + external), and quarterly restore testing. Off-host storage provides physical separation. Infrastructure-as-Code enables rapid system rebuild with documented &lt;2hr RTO. HA DNS failover via dual Pi-hole (&lt;5s switchover) ensures service continuity.</p> <p>Gaps: Formal contingency plan documentation (CP-1, CP-10) partial - procedures documented but not comprehensive enterprise plan.</p> <p>Identification and Authentication (IA) - 95% Implementation</p> <p>17 controls implemented of 18 applicable</p> <p>Advanced authentication architecture with Step-CA two-tier PKI (offline root, online intermediate CA), Ed25519 SSH keys, Authentik SSO providing OAuth2/OIDC integration, and Vaultwarden password manager with zero-knowledge encryption and biometric unlock. MFA enforced for all administrative access via Authentik TOTP. SSH passwords disabled globally, replaced with key-based authentication. No embedded unencrypted credentials - Ansible Vault encrypts all secrets.</p> <p>Key Achievements: Replay-resistant authentication via SSH session tokens and Authentik CSRF protection (IA-2(8)), automated PKI trust distribution (IA-5(14)), centralized authenticator management (IA-5).</p> <p>Incident Response (IR) - 90% Implementation</p> <p>11 controls implemented of 13 applicable</p> <p>Comprehensive IR capabilities via TheHive case management with 15+ documented playbooks (phishing, malware, ransomware, lateral movement, vulnerability response), Shuffle SOAR orchestration for automated workflows, and Cortex multi-engine analysis. Wazuh Active Response provides automated containment (firewall-drop, host-deny, account disabling) with sub-30-minute MTTR. Real-time monitoring via dual SIEM with Discord/email/PagerDuty multi-channel alerting ensures zero missed notifications.</p> <p>Key Achievements: Automated incident handling (IR-4(1)), multi-source correlation across Splunk/Wazuh/Suricata/scanners (IR-4(4)), automated tracking and forensic data collection (IR-5(1)).</p> <p>Gap: Breach notification (IR-8(1)) partially implemented - automated alerting exists but formal notification procedures limited.</p> <p>Maintenance (MA) - 60% Implementation</p> <p>4 controls implemented/partial of 6 applicable</p> <p>Remote maintenance via SSH fully logged and monitored with cryptographic protection (TLS 1.3, SSH AES-256-GCM). Change control enforced through Git version control, snapshot-before-patch strategy, and WSUS approval workflows. Patch SLAs defined (Critical &lt;72h, High &lt;7d) and tracked via TheHive.</p> <p>Gaps: Formal maintenance policy documentation (MA-1, MA-2, MA-3) informal for homelab environment.</p> <p>Risk Assessment (RA) - 85% Implementation</p> <p>10 controls implemented of 12 applicable</p> <p>Sophisticated vulnerability management with CVSS base + temporal + environmental scoring incorporating exploit maturity and asset criticality. Daily PatchMon checks, weekly OpenVAS scans, and monthly Nessus authenticated scans provide comprehensive coverage of 75+ assets. SIEM correlation links vulnerabilities to exploit databases. Vulnerability trends tracked in Grafana with historical MTTR calculations demonstrating continuous improvement.</p> <p>Key Achievements: Privileged access scanning via SSH keys and domain service accounts (RA-5(5)), historical audit log review (RA-5(8)), vulnerability-to-installed software correlation (RA-5(10)), MITRE ATT&amp;CK-based threat hunting (RA-10).</p> <p>Gaps: Supply chain risk assessment (RA-3(1)) partial - MISP vendor tracking exists but limited visibility.</p> <p>System and Communications Protection (SC) - 95% Implementation</p> <p>24 controls implemented of 25 applicable</p> <p>Encryption excellence with mandatory TLS 1.3, Ed25519 SSH keys, AES-256-GCM ciphersuites, and Step-CA PKI infrastructure. Defense-in-depth boundary protection via pfSense default-deny firewall rules, Traefik reverse proxy with Authentik authentication, SafeLine WAF, and Suricata/Snort IDS/IPS. DNSSEC implementation for both authoritative (Bind9) and recursive (Pi-hole/Unbound) resolution. Complete network segmentation with VLAN isolation and Traefik backend protection.</p> <p>Key Achievements: Zero weak algorithms (verified via vulnerability scans), OCSP/CRL certificate validation (SC-17(1)), NTP synchronization across all infrastructure with sub-second accuracy (SC-45), process isolation via containers and VMs (SC-39).</p> <p>System and Information Integrity (SI) - 90% Implementation</p> <p>25 controls implemented of 28 applicable</p> <p>Multi-layered malware defense via Wazuh FIM with VirusTotal integration, Suricata/Snort IDS signatures, ClamAV (Linux), Microsoft Defender (Windows), and Cortex multi-engine analysis. Real-time system monitoring across Prometheus, Uptime Kuma, dual SIEM, Wazuh EDR (25+ endpoints), and network IDS providing complete visibility. Automated patch management via PatchMon/WSUS/Watchtower with &lt;72h MTTR for critical vulnerabilities. WAF input validation (SafeLine OWASP CRS rules) and Traefik header validation protect against injection attacks.</p> <p>Key Achievements: Automated flaw remediation status tracking (SI-2(2)), real-time integrity monitoring with automated response integration (SI-7(7)), system-wide intrusion detection (SI-4(1)), host-based EDR on 25+ endpoints (SI-4(23)).</p> <p>Supply Chain Risk Management (SR) - 40% Implementation</p> <p>4 controls implemented/partial of 12 applicable</p> <p>Limited by homelab scope with no formal supplier management program. Relies on vetted open-source projects, trusted Docker Hub publishers, and official OS repositories. Docker image signature verification (SHA-256) and package signature validation provide component authenticity (SR-11). Secure deletion procedures for component disposal (SR-12).</p> <p>Gaps: Most SR controls (SR-1, SR-2, SR-4, SR-5, SR-6) N/A for single-user environment without procurement processes.</p> <p>Organizational Control Families (PE, PS, PM, PL, MP, MA)</p> <ul> <li>Personnel Security (PS): 0% - All 8 controls N/A (no employees requiring screening, training, sanctions)</li> <li>Physical and Environmental Protection (PE): 0% - All 14 controls N/A (residential homelab with basic UPS/fire protection)</li> <li>Program Management (PM): 40% - 3 implemented (comprehensive asset inventory via PM-5, risk management strategy via PM-9, automated threat intelligence sharing via PM-16(1))</li> <li>Planning (PL): 60% - 4 implemented/partial (defense-in-depth architecture via PL-8, GRC documentation as security plan via PL-2)</li> <li>Media Protection (MP): 40% - Partial implementation (encrypted backups, secure deletion documented, removable media restrictions via GPO)</li> </ul> <p>Critical Control Highlights by Security Objective</p> <p>Confidentiality: - TLS 1.3 mandatory for all services with weak ciphers disabled - Ed25519 SSH keys with passwords disabled globally - AES-256-GCM encryption for backups and at-rest data - Step-CA PKI with automated certificate management - Vaultwarden zero-knowledge password vault with biometric unlock</p> <p>Integrity: - Immutable SIEM audit logs (Splunk read-only indexes, Elastic immutable streams) - Wazuh FIM real-time integrity monitoring with automated response - Docker image SHA-256 signature verification - Git version control for all infrastructure code - Signed certificates via Step-CA PKI</p> <p>Availability: - HA firewall cluster (pfSense CARP) - Dual Pi-hole DNS with &lt;5s failover - Dual SIEM deployment (Splunk + Elastic) - Redundant internet connections - UPS battery backup for critical systems - Automated backups with quarterly restore testing</p> <p>Authentication: - Centralized SSO via Authentik with OAuth2/OIDC - MFA enforcement (100% admin accounts via TOTP) - SSH key-based authentication with centralized management - Step-CA certificate-based authentication - No hardcoded credentials (Ansible Vault encryption)</p>"},{"location":"projects/homelab/grc/01-summary/#maturity-assessment-by-control-family","title":"Maturity Assessment by Control Family","text":"<p>Tier 4 (Adaptive): - AU (Audit and Accountability) - Automated correlation, real-time alerts, immutable logs - IA (Identification and Authentication) - PKI automation, centralized management, MFA - SI (System and Information Integrity) - Multi-layered detection, automated response, continuous monitoring - CM (Configuration Management) - IaC automation, drift detection, automated remediation</p> <p>Tier 3 (Defined): - AC (Access Control) - Documented policies, centralized enforcement, behavioral monitoring - IR (Incident Response) - Comprehensive playbooks, SOAR orchestration, documented procedures - RA (Risk Assessment) - Standardized scoring, historical trending, threat hunting - SC (System and Communications Protection) - Defense-in-depth, encryption everywhere, validated controls</p> <p>Tier 2 (Managed): - CP (Contingency Planning) - Regular backups, restore testing, documented procedures - CA (Continuous Assessment) - Scheduled scanning, compliance audits, gap tracking - MA (Maintenance) - Change control, patch tracking, remote access monitoring</p> <p>Limited Applicability: - PE, PS, PM, PL, MP - Constrained by single-user homelab context</p> <p>Framework Strengths:</p> <ol> <li>Audit Excellence: 100% AU family implementation with immutable logs, sub-60s alerting, multi-source correlation</li> <li>Encryption Everywhere: 95% SC family compliance with modern algorithms, mandatory TLS 1.3, comprehensive PKI</li> <li>Automated Response: 90% IR family implementation with SOAR orchestration, &lt;30min MTTR, multi-channel alerting</li> <li>Continuous Monitoring: 90% SI family coverage with multi-layered detection, real-time FIM, EDR on 25+ endpoints</li> <li>Configuration Automation: 95% CM family implementation via IaC, Git version control, automated drift detection</li> </ol>"},{"location":"projects/homelab/grc/01-summary/#mitre-attck-enterprise-v181-implementation-summary","title":"MITRE ATT&amp;CK Enterprise v18.1 Implementation Summary","text":"<p>       This cybersecurity lab demonstrates threat-informed defense aligned with MITRE ATT&amp;CK Enterprise Matrix v18.1, achieving 30% overall coverage (65 of 216 techniques) across 12 adversary tactics. The implementation prioritizes high-impact techniques with strong detection capabilities in Initial Access (67%), Execution (67%), and Lateral Movement (56%), while identifying strategic gaps in Defense Evasion (21%), Credential Access (27%), and Collection (20%) that inform the security roadmap.     </p> <p> Framework Version: ATT&amp;CK v18.1 (October 2025) | Total Techniques: 216 | Sub-techniques: 475     </p> MITRE ATT&amp;CK Enterprise v18.1"},{"location":"projects/homelab/grc/01-summary/#tactic-by-tactic-analysis","title":"Tactic-by-Tactic Analysis","text":"<p>Initial Access (TA0001) - 67% Coverage (6/9 techniques)</p> <p>Maturity: Strong</p> <p>Comprehensive monitoring via multi-layered detection: phishing analysis through Shuffle workflows with Cortex multi-engine scanning (VirusTotal, URLhaus, PhishTank), MISP IOC correlation, and Pi-hole domain blocking (2M+ malicious domains). Valid account monitoring via Splunk correlation detecting failed authentication patterns, Wazuh authentication tracking, and TheHive automated case creation (&gt;5 failures/5min triggers). External remote service logging through pfSense VPN monitoring, SSH session tracking, and Traefik ForwardAuth auditing.</p> <p>Critical Gaps: Supply chain compromise (T1195) requires SBOM tracking; content injection (T1659) needs CSP headers and SRI checks; trusted relationship (T1199) lacks vendor security assessments.</p> <p>Priority Actions: Q1 2026 - Deploy SBOM tracking (Trivy/Grype); Q2 2026 - Enhance WAF rulesets for injection protection.</p> <p>Execution (TA0002) - 67% Coverage (9/13 techniques)</p> <p>Maturity: Strong</p> <p>Exceptional process visibility via Sysmon capturing PowerShell commands (Event ID 4103/4104), Windows command shell execution with full command-line arguments, and scheduled task creation. Wazuh detects obfuscated PowerShell, LOLBins, and parent-child process anomalies. Shared module tracking via ImageLoad events identifies unsigned/untrusted DLLs with code signing validation.</p> <p>Critical Gaps: WMI execution (T1047) has minimal event monitoring; container CLI/API (T1059.013) lacks comprehensive kubectl/docker exec logging; native API (T1106) requires endpoint detection with API hooking for process injection visibility.</p> <p>Priority Actions: Immediate - Enable comprehensive WMI logging; Q1 2026 - Implement container command auditing (T1059.013); Q2 2026 - Deploy container runtime security (Falco).</p> <p>Persistence (TA0003) - 37% Coverage (8/20 techniques)</p> <p>Maturity: Moderate</p> <p>Strong account lifecycle monitoring via Active Directory group membership tracking (Event ID 4728/4732/4756), account creation alerts (Event ID 4720), and behavioral analysis detecting unusual login times/geographic anomalies. Boot/logon autostart detection through Sysmon registry monitoring (Run keys), Wazuh FIM tracking startup folders and systemd units, with comprehensive persistence mechanism coverage.</p> <p>Critical Gaps: BITS jobs (T1197) lack monitoring; browser extensions (T1176) unmonitored; Office persistence (T1137) has no macro/add-in detection; Python startup hooks (T1546.018) require FIM on .pythonrc and site-packages directories.</p> <p>Priority Actions: Immediate - Enable BITS logging (Event ID 59/60/61); Q1 2026 - Deploy application binary monitoring; Q2 2026 - Implement browser extension inventory.</p> <p>Privilege Escalation (TA0004) - 38% Coverage (5/13 techniques)</p> <p>Maturity: Moderate</p> <p>Comprehensive privileged account tracking via SIEM correlation detecting admin logons outside business hours, lateral movement via admin accounts, and GPO modification auditing (Event ID 5136/5137/5141). Scheduled task monitoring identifies privilege escalation through task creation with SYSTEM privileges by non-admin users.</p> <p>Critical Gaps: Process injection (T1055) has minimal visibility into CreateRemoteThread/process hollowing/reflective DLL injection; UAC bypass (T1548) lacks comprehensive Event ID 4103 monitoring; container escape (T1611) undetected.</p> <p>Priority Actions: Q2 2026 - Deploy advanced EDR for process injection detection; Immediate - Enhance UAC bypass monitoring.</p> <p>Defense Evasion (TA0005) - 21% Coverage (13/46 techniques)</p> <p>Maturity: Weak - Priority Focus Area</p> <p>Strong log protection via immutable SIEM (Splunk read-only indexes, Elastic immutable streams), registry modification tracking (Sysmon Event ID 13), and security tool tampering detection (Windows Defender, firewall, antimalware services). Indicator removal monitoring alerts on Event ID 1102 (log clearing) with FIM tracking critical directory file deletions.</p> <p>Critical Gaps: Obfuscation analysis limited (T1027); no pass-the-hash/pass-the-ticket detection (T1550); minimal alternate data stream scanning (T1564); virtualization/sandbox evasion unmonitored (T1497). v18.1 NEW: Delay execution (T1678), selective exclusion (T1679), browser fingerprinting (T1036.012), network device firewall tampering (T1562.013) require implementation.</p> <p>Priority Actions: Q1 2026 - Implement pass-the-hash detection (Event ID 4624/4625 type 9); Q2 2026 - Deploy advanced obfuscation analysis with entropy/sandbox detonation.</p> <p>Credential Access (TA0006) - 27% Coverage (4/15 techniques)</p> <p>Maturity: Weak - Critical Gap</p> <p>Excellent brute force detection via multi-source correlation (firewall, SSH, Authentik, RDP), Shuffle automated case creation (&gt;5 failures/5min), and IP-based rate limiting. LSASS access monitoring through Sysmon Event ID 10 detects credential dumping with Mimikatz signature alerts and SAM/SYSTEM file access tracking.</p> <p>Critical Gaps: Kerberos monitoring (T1558) absent - no golden/silver ticket detection (Event ID 4768/4769); session hijacking (T1539) undetected; password store coverage (T1555) incomplete; MFA interception (T1111) unmonitored.</p> <p>Priority Actions: Immediate - Enable Kerberos event logging; Q1 2026 - Implement session monitoring with IP/User-Agent binding; Q2 2026 - Deploy comprehensive password store monitoring.</p> <p>Discovery (TA0007) - 30% Coverage (10/32 techniques)</p> <p>Maturity: Moderate</p> <p>Comprehensive network reconnaissance detection via Suricata/Snort identifying port scans (SYN/UDP/full connect), ping sweeps, ARP scans with pfSense logging and Splunk pattern correlation. Command-line monitoring tracks account enumeration (net user/group, whoami, getent), file discovery (dir, ls, find), and system profiling (systeminfo, uname, hostname) with Active Directory LDAP query auditing (Event ID 4662).</p> <p>Critical Gaps: Share enumeration (T1135) unmonitored (net view/share); password policy queries (T1201) undetected; peripheral device discovery (T1120) absent; backup software discovery (T1518.002) fully covered via process/registry monitoring; local storage discovery (T1680) needs behavioral baseline for rapid enumeration patterns.</p> <p>Priority Actions: Q1 2026 - Implement share enumeration monitoring, enhance local storage discovery (T1680) with behavioral baseline; Q2 2026 - Add peripheral device tracking.</p> <p>Lateral Movement (TA0008) - 56% Coverage (5/9 techniques)</p> <p>Maturity: Strong</p> <p>Excellent protocol monitoring across RDP (Suricata traffic + Event ID 4624 type 10), SMB (Event ID 5140/5145 + PsExec/WMIC detection), and SSH (comprehensive session logging + key-based auth anomaly detection). Admin share access tracking via Splunk correlation identifies lateral movement patterns with alerts on unusual RDP/SMB sources.</p> <p>Critical Gaps: Pass-the-hash/pass-the-ticket (T1550) undetected - critical for lateral movement prevention; WinRM (T1021.006) has minimal monitoring (Event ID 6/91/168 needed); software deployment tools (T1072) unmonitored.</p> <p>Priority Actions: Immediate - Implement pass-the-hash detection; Q1 2026 - Enable comprehensive WinRM logging.</p> <p>Collection (TA0009) - 20% Coverage (4/18 techniques)</p> <p>Maturity: Weak - Strategic Gap</p> <p>Basic capabilities include archive detection (7zip, WinRAR, tar, zip), USB device insertion monitoring (Event ID 2003), and file access tracking in sensitive directories via Wazuh FIM. Limited data staging detection through file creation monitoring in Temp directories.</p> <p>Critical Gaps: No DLP capabilities; email collection (T1114) unmonitored; screen/video capture undetected (T1113/T1125); input capture/keylogger detection absent (T1056); database exfiltration (T1213.006) lacks query monitoring for mass SELECT statements and large result sets.</p> <p>Priority Actions: Q1 2026 - Implement email auditing; Q2 2026 - Deploy DLP solution and UEBA for collection pattern detection.</p> <p>Exfiltration (TA0010) - 44% Coverage (4/9 techniques)</p> <p>Maturity: Moderate</p> <p>Strong C2 channel monitoring via Suricata/Snort detecting beacon patterns, MISP IOC correlation, and Cortex threat intelligence enrichment. DNS tunneling detection through Pi-hole query analysis, bandwidth monitoring via pfSense/Prometheus with threshold alerts for unusual upload rates.</p> <p>Critical Gaps: Web service exfiltration (T1567) minimal - no Dropbox/Google Drive/Pastebin detection; cloud exfiltration (T1537) unmonitored; physical medium file tracking (T1052) limited beyond device insertion.</p> <p>Priority Actions: Q1 2026 - Implement web service monitoring and physical media auditing; Q2 2026 - Deploy comprehensive DLP.</p> <p>Command &amp; Control (TA0011) - 38% Coverage (6/16 techniques)</p> <p>Maturity: Moderate</p> <p>Comprehensive application layer protocol analysis via Suricata/Snort for HTTP/HTTPS/DNS/SMTP patterns, pfSense logging all protocols, Traefik HTTP visibility. Dynamic resolution detection through Pi-hole DNS logging, Suricata DGA pattern recognition, fast flux identification, and MISP domain correlation. Non-standard port detection via protocol-port mismatch analysis (HTTP on 8443, SSH on 443).</p> <p>Critical Gaps: TLS inspection limited - JA3/JA3S fingerprinting exists but no decryption; remote access tools (T1219) minimally detected (TeamViewer/AnyDesk signatures only); web service C2 (T1102) over legitimate platforms (Twitter/GitHub/Pastebin) unmonitored.</p> <p>Priority Actions: Q1 2026 - Implement remote access tool controls; Q2 2026 - Deploy TLS inspection infrastructure and web service C2 detection.</p> <p>Impact (TA0040) - 46% Coverage (6/13 techniques)</p> <p>Maturity: Moderate</p> <p>Exceptional ransomware detection via Wazuh mass file modification monitoring (&gt;50 files/min), Shuffle workflows detecting file extension changes (.encrypted/.locked), ransomware note creation, with automated containment achieving sub-30-minute MTTR. Resource hijacking monitoring through Prometheus CPU/memory anomaly detection, cryptomining process identification (xmrig, cpuminer), and Checkmk infrastructure tracking.</p> <p>Critical Gaps: Disk wipe (T1561) has minimal tool detection (diskpart, dd, shred); defacement (T1491) lacks web content integrity verification; firmware corruption (T1495) has no UEFI/BIOS monitoring.</p> <p>Priority Actions: Q1 2026 - Implement disk modification monitoring and defacement detection; Q3 2026 - Deploy firmware integrity checks.</p>"},{"location":"projects/homelab/grc/01-summary/#attck-v181-framework-updates","title":"ATT&amp;CK v18.1 Framework Updates","text":"<p>Impact on Lab: v18.1 introduced 12 new techniques increasing total from 191 to 216 (13% growth) and sub-techniques from 385 to 475 (23% growth). Lab coverage decreased from 34% to 30% due to denominator expansion, highlighting new detection opportunities.</p> <p>Critical New Techniques Requiring Implementation:</p> <ul> <li>T1059.013 (Container CLI/API): kubectl/docker exec logging</li> <li>T1678 (Delay Execution): Sleep/timeout command behavioral analysis</li> <li>T1679 (Selective Exclusion): Security tool configuration monitoring</li> <li>T1036.012 (Browser Fingerprint Masquerading): User-agent anomaly detection</li> <li>T1562.013 (Network Device Firewall Tampering): SNMP trap monitoring</li> <li>T1546.018 (Python Startup Hooks): FIM on .pythonrc/site-packages</li> <li>T1213.006 (Database Exfiltration): Query monitoring, large result set detection</li> <li>T1518.002 (Backup Software Discovery): Fully implemented via process/registry</li> <li>T1680 (Local Storage Discovery): Behavioral baseline needed for rapid enumeration</li> </ul> <p>Threat Intelligence Updates: MISP integration required for 7 new threat actors (Storm-0501, UNC3886, Contagious Interview, Medusa, Water Galura, AppleJeus, G1049) and 7 new malware families (RedLine Stealer, Qilin/Medusa Ransomware, DarkGate, Havoc C2, Embargo, InvisibleFerret).</p>"},{"location":"projects/homelab/grc/01-summary/#coverage-strengths","title":"Coverage Strengths","text":"<ol> <li>Multi-Layered Detection: Dual SIEM (Splunk + Elastic), network IDS (Suricata/Snort), host EDR (Wazuh 25+ endpoints), 100% security event logging</li> <li>Automated Response: Shuffle SOAR orchestration, TheHive case management, Wazuh Active Response, sub-30-minute MTTR for critical threats</li> <li>Threat Intelligence: MISP correlation, Cortex multi-engine analysis, CrowdSec community feeds, AlienVault OTX</li> <li>Process Visibility: Sysmon comprehensive telemetry, command-line auditing, parent-child analysis, LOLBin detection</li> <li>Network Monitoring: Complete visibility via pfSense flow logs, Traefik access logs, DNS query logging, 100% traffic coverage</li> </ol>"},{"location":"projects/homelab/grc/01-summary/#owasp-top-10-2025-implementation-summary","title":"OWASP Top 10 (2025) Implementation Summary","text":"<p>       This cybersecurity lab demonstrates comprehensive mitigation of OWASP Top 10 (2025) web application security risks, achieving strong coverage across 9 of 10 categories with advanced maturity levels. The implementation leverages defense-in-depth architecture combining WAF protection (SafeLine with OWASP CRS rules), secure authentication (Authentik SSO with MFA), cryptographic excellence (TLS 1.3, Step-CA PKI), and comprehensive logging (100% security event coverage with 90-day retention).     </p> <p> Overall OWASP 2025 Compliance: 9/10 Strong | 1/10 Moderate (Supply Chain) </p> OWASP Top 10 (2025)"},{"location":"projects/homelab/grc/01-summary/#2025-framework-changes","title":"2025 Framework Changes","text":"<p>OWASP Top 10 (2025) introduces significant updates from the 2021 version: A10 (Mishandling of Exceptional Conditions) replaces Server-Side Request Forgery as a new category addressing 24 CWEs related to improper error handling and failing open. A01 (Broken Access Control) now encompasses SSRF within access control failures. Categories A04, A05, and A06 have shifted rankings reflecting improved industry practices in cryptographic implementation and secure design.</p>"},{"location":"projects/homelab/grc/01-summary/#category-by-category-analysis","title":"Category-by-Category Analysis","text":"<p>A01:2025 - Broken Access Control (Strong - Advanced Maturity)</p> <p>Coverage: Comprehensive access control enforcement across all service layers</p> <p>Implementation: Authentik ForwardAuth mandates authentication for all Traefik-routed services with OAuth2/OIDC integration and RBAC group-based authorization. SSH access exclusively key-based (passwords disabled globally) with sudo policy enforcement. Network-level protection via Traefik IP allowlisting, pfSense default-deny firewall ACLs per VLAN, and comprehensive egress filtering. SSRF Prevention achieved through DNS rebinding protection, Traefik backend validation, SSH tunnel restrictions, and network segmentation isolating internal services.</p> <p>Monitoring: Wazuh tracks unauthorized access attempts with SIEM correlation, Splunk authentication dashboard provides real-time visibility, and TheHive automatically creates cases for access violations.</p> <p>Framework Alignment: NIST AC-3 (Access Enforcement), AC-2(7) (Role-Based Schemes), SC-7 (Boundary Protection); ISO 27001 A.5.15 (Access Control), A.9.2 (User Access Management); CIS Control 6.1-6.6 (Access Control Management); PCI-DSS 8.2 (User Authentication).</p> <p>A02:2025 - Security Misconfiguration (Strong - Advanced Maturity)</p> <p>Coverage: Hardened baseline configurations with automated compliance verification</p> <p>Implementation: CIS Benchmark compliance (92-98%) across SSH, Traefik, DNS, and firewall configurations enforced via Ansible playbooks and Terraform IaC. Configuration drift detection through Wazuh SCA and automated remediation workflows. Traefik security headers (HSTS, CSP, X-Frame-Options, X-Content-Type-Options) protect against common attacks. Default credentials eliminated and validated via authenticated Nessus scans. Unnecessary services disabled with minimal attack surface verified weekly (OpenVAS) and monthly (Nessus authenticated scans).</p> <p>Continuous Auditing: Weekly vulnerability scanning, monthly authenticated configuration audits, real-time drift detection with automated alerts.</p> <p>Framework Alignment: NIST CM-6 (Configuration Settings), CM-2 (Baseline Configuration), CM-7 (Least Functionality); ISO 27001 A.8.9 (Configuration Management); CIS Control 4.1 (Secure Configuration); PCI-DSS 2.2 (Configuration Standards).</p> <p>A03:2025 - Software Supply Chain Failures (Moderate - Developing Maturity)</p> <p>Coverage: Partial implementation with strategic gaps identified</p> <p>Implementation: Vetted software sources exclusively (official Docker images, maintained open-source projects from trusted repositories). Package signature verification via GPG keys, container image verification (SHA-256), and coordinated patch management across platforms (PatchMon for Linux, WSUS for Windows, Watchtower for containers). MISP threat intelligence tracks vendor compromise campaigns. Vulnerability-driven update prioritization with rollback capability via snapshots.</p> <p>Critical Gaps: SBOM tracking not implemented (planned Trivy/Grype deployment Q1 2026); CI/CD security linting absent; dependency vulnerability scanning incomplete; automated CVE monitoring for dependencies limited.</p> <p>Priority Actions: Q1 2026 - Deploy Trivy/Grype for SBOM generation; Q2 2026 - Implement CI/CD pipeline security scanning; Q3 2026 - Establish comprehensive dependency monitoring.</p> <p>Framework Alignment: NIST RA-5 (Vulnerability Monitoring), SI-2 (Flaw Remediation), SR-3 (Supply Chain Controls); ISO 27001 A.5.21 (Supply Chain Security); CIS Control 16.5 (Up-to-Date Software), 7.3-7.4 (Patch Management); OWASP SCVS.</p> <p>A04:2025 - Cryptographic Failures (Strong - Advanced Maturity)</p> <p>Coverage: Modern cryptographic implementations with automated management</p> <p>Implementation: </p> <p>Encryption in Transit: TLS 1.3 mandatory across all services (Traefik), SSH AES-256-GCM, VPN encryption (WireGuard/OpenVPN), DNS-over-TLS planned. </p> <p>Encryption at Rest: AES-256 encrypted backups, SSH private key encryption, database encryption where applicable. </p> <p>Key Management: Step-CA two-tier PKI (offline root, online intermediate CA) with automated certificate issuance and renewal, Ed25519 SSH key generation, centralized key management via Ansible, Vaultwarden zero-knowledge secrets management. Modern cipher suites only with weak algorithm detection via vulnerability scans achieving zero certificate expiry incidents.</p> <p>Monitoring: Certificate expiry monitoring (Uptime Kuma, Prometheus alerts), TLS configuration validation (Nessus), weak cipher detection with automated remediation.</p> <p>Framework Alignment: NIST SC-8 (Transmission Confidentiality), SC-12 (Key Establishment), SC-13 (Cryptographic Protection), SC-28 (Protection at Rest); ISO 27001 A.8.24 (Cryptography); CIS Control 13.10 (Encryption); PCI-DSS 4.2.1 (Strong Cryptography).</p> <p>A05:2025 - Injection (Strong - Advanced Maturity)</p> <p>Coverage: Multi-layered injection prevention with WAF and input validation</p> <p>Implementation: SafeLine WAF deploys OWASP Core Rule Set (CRS) with 25% attack block rate, Traefik middleware stack provides header injection prevention, NGINX Ingress annotations enforce request filtering. DNS query validation prevents DNS-based attacks, SSH input sanitization blocks command injection, parameterized queries and ORM usage in applications prevent SQL injection. Content Security Policy (CSP) headers, X-XSS-Protection headers, input sanitization, and output encoding mitigate XSS attacks.</p> <p>Monitoring: Suricata IDS signatures detect injection attempts, WAF logs forwarded to SIEM, Splunk correlation identifies attack patterns, TheHive case creation for confirmed attacks with automated response workflows.</p> <p>Framework Alignment: NIST SI-10 (Information Input Validation), SI-4(23) (Host-Based Detection); ISO 27001 A.8.26 (Application Security Requirements); CIS Control 13.10 (Web Application Filtering); PCI-DSS 6.6 (Web Application Protection); OWASP Injection Prevention.</p> <p>A06:2025 - Insecure Design (Strong - Advanced Maturity)</p> <p>Coverage: Threat-informed architecture with defense-in-depth principles</p> <p>Implementation: Defense-in-depth architecture with multiple security layers (network, application, endpoint), DNS 3-tier design, reverse proxy isolation (Traefik backend protection), network segmentation via VLANs. Zero-trust network access principles enforce explicit verification, least-privilege access, and assume breach mentality. Infrastructure as Code enables immutable infrastructure with declarative configuration. Fail-secure defaults include SSH passwords disabled, Traefik secure configurations, default encryption, and least-privilege by default.</p> <p>Documentation: Architecture diagrams maintained in Git, security controls documented in GRC framework, design decisions recorded, threat model updates for new services.</p> <p>Framework Alignment: NIST RA-3 (Risk Assessment), SA-8 (Security Engineering Principles), SA-17 (Developer Security Architecture); ISO 27001 A.14.1 (Security in Development), A.14.2 (Security in Support Processes); OWASP Secure Design Principles.</p> <p>A07:2025 - Authentication Failures (Strong - Advanced Maturity)</p> <p>Coverage: Robust authentication with MFA enforcement and credential protection</p> <p>Implementation: </p> <p>Multi-Factor Authentication: Authentik TOTP enforced for 100% administrative accounts, SSH key-based authentication only (passwords disabled globally), Step-CA certificate-based authentication for services. </p> <p>Credential Management: Vaultwarden zero-knowledge password vault with biometric unlock, Ansible Vault encrypts all variables, no hardcoded credentials, centralized SSH key management. </p> <p>Account Protection: SSH MaxAuthTries=3, Authentik lockout after 5 failures, Wazuh Active Response for brute force attacks, CrowdSec automated IP blocking. Session management via Authentik tokens, SSH session IDs, TLS session tickets with 30-minute idle timeout.</p> <p>Monitoring: Failed login tracking across all systems, multi-source brute force correlation (firewall, SSH, Authentik, RDP), MFA bypass attempt detection, Splunk admin login dashboard.</p> <p>Framework Alignment: NIST IA-2(1) (MFA), IA-5(1) (Password-Based Authentication), IA-5(7) (No Embedded Credentials), AC-7 (Unsuccessful Logon Attempts); ISO 27001 A.5.17 (Authentication Information), A.9.4.2 (Secure Log-on); CIS Control 6.3-6.5 (MFA); PCI-DSS 8.3 (Multi-Factor Authentication).</p> <p>A08:2025 - Software/Data Integrity Failures (Strong - Advanced Maturity)</p> <p>Coverage: Comprehensive integrity verification with immutable audit trails</p> <p>Implementation: </p> <p>Code Integrity: Git version control for all infrastructure code, commit signing planned, Terraform plan review before apply, Infrastructure as Code validation via Ansible dry-run. </p> <p>Software Verification: Package signature verification (GPG), container image verification (SHA-256), Step-CA certificate validation, DNSSEC for DNS integrity. </p> <p>Data Integrity: Wazuh FIM monitors 100% of critical paths, checksum verification, immutable SIEM indexes (Splunk read-only, Elastic immutable streams), database integrity checks.</p> <p>Change Control: Snapshot-before-patch strategy, WSUS approval workflows, pre-scan snapshots for critical systems, Git version control with rollback capability.</p> <p>Framework Alignment: NIST SI-7 (Software/Firmware/Information Integrity), SI-7(1) (Integrity Checks), CM-3 (Configuration Change Control); ISO 27001 A.12.1.2 (Change Control), A.12.3.1 (Information Backup); CIS Control 2.3 (Authorized Software), 8.6 (Collect Detailed Audit Logs).</p> <p>A09:2025 - Security Logging &amp; Alerting Failures (Strong - Advanced Maturity)</p> <p>Coverage: Comprehensive logging with real-time multi-channel alerting</p> <p>Implementation: </p> <p>100% Security Event Coverage: DNS queries (Pi-hole), SSH sessions (auth.log), Traefik access logs (JSON format), Wazuh security events, vulnerability scans, patch deployments, authentication attempts, privileged operations. 90-day hot retention with 1-year cold storage. </p> <p>Log Protection: Immutable SIEM indexes, encrypted transmission (syslog-ng TLS), write-once Elasticsearch indexes, tamper detection, centralized storage.</p> <p>Real-Time Alerting: Discord webhooks, Splunk scheduled alerts, Wazuh Discord/email integration, Prometheus Alertmanager, TheHive case notifications, Cortex analysis alerts, MISP event notifications, Shuffle orchestration actions. Multi-channel redundancy ensures zero missed critical alerts with &lt;3% false positive rate.</p> <p>Correlation: Multi-source correlation (Splunk + Elastic + Wazuh + network logs), TheHive aggregates alerts from all platforms, Shuffle orchestrates cross-platform queries, MITRE ATT&amp;CK mapping for threat context.</p> <p>Framework Alignment: NIST AU-2 (Event Logging), AU-6(3) (Correlate Audit Repositories), AU-9 (Protection of Audit Information), SI-4(5) (System-Generated Alerts); ISO 27001 A.8.15 (Logging), A.8.16 (Monitoring); CIS Control 8.2 (Collect Audit Logs), 8.11 (Conduct Reviews); PCI-DSS 10.2 (Audit Logging), 10.5 (Protect Audit Trails).</p> <p>A10:2025 - Mishandling of Exceptional Conditions (Strong - Advanced Maturity)</p> <p>NEW CATEGORY FOR 2025</p> <p>Coverage: Fail-secure design with comprehensive error handling</p> <p>Implementation: </p> <p>Error Handling: Traefik circuit breakers prevent cascading failures, graceful degradation maintains core functionality, fail-secure defaults (firewall default-deny), proper exception handling in automation scripts. </p> <p>Input Validation: Boundary checking, type validation, range checking, malformed request handling across all service entry points. </p> <p>Fail-Secure Design: pfSense default-deny firewall rules, Traefik rejects invalid requests, SSH connection limits, services fail-closed on errors rather than open.</p> <p>Resource Management: Connection limits (SSH MaxStartups, Traefik connection pools), timeout configurations, rate limiting (API gateways), Kubernetes resource quotas, memory/CPU limits enforced. </p> <p>Monitoring: Service health checks (Uptime Kuma), Prometheus alerting for service failures, Grafana anomaly dashboards, Pulse hypervisor monitoring, application error rate tracking, Wazuh service failure monitoring.</p> <p>Recovery: Automatic service restarts (systemd, Kubernetes health check-based recovery), documented recovery procedures, backup integrity monitoring.</p> <p>Framework Alignment: NIST SC-5 (Denial of Service Protection), SC-24 (Fail in Known State), CP-10 (System Recovery), SI-4 (System Monitoring); ISO 27001 A.17.1 (Availability); CIS Control 13.3 (Deploy Network-Based IDS); OWASP Error Handling Best Practices.</p>"},{"location":"projects/homelab/grc/01-summary/#compliance-summary","title":"Compliance Summary","text":"OWASP 2025 Category Maturity Key Strengths Strategic Gaps A01: Broken Access Control Advanced Authentik SSO, MFA 100%, RBAC, SSRF prevention Session recording for privileged access A02: Security Misconfiguration Advanced 92-98% CIS compliance, IaC automation, drift detection Container configuration scanning A03: Supply Chain Failures Developing Trusted sources, signature verification, coordinated patching SBOM tracking, dependency scanning, CI/CD security A04: Cryptographic Failures Advanced TLS 1.3, Ed25519, Step-CA PKI, automated cert renewal Full disk encryption rollout A05: Injection Advanced WAF 25% block rate, CSP headers, parameterized queries Advanced ML-based injection detection A06: Insecure Design Advanced Zero-trust architecture, threat modeling, defense-in-depth Formal threat modeling for all services A07: Authentication Failures Advanced MFA enforcement, key-based auth, no hardcoded credentials WebAuthn/FIDO2 implementation A08: Integrity Failures Advanced FIM 100% critical paths, immutable logs, Git version control Automated code signing A09: Logging &amp; Alerting Advanced 100% event coverage, &lt;60s alert latency, immutable logs SIEM correlation ML enhancement A10: Exceptional Conditions Advanced Fail-secure defaults, health monitoring, auto-recovery Chaos engineering validation"},{"location":"projects/homelab/grc/01-summary/#zero-trust-architecture-implementation-summary","title":"Zero Trust Architecture Implementation Summary","text":"<p>       This cybersecurity lab demonstrates comprehensive Zero Trust Architecture (ZTA) principles aligned with CISA Zero Trust Maturity Model v2.0 and NIST Special Publication 800-207. The implementation achieves Advanced maturity across all core pillars through explicit verification of every access request, least-privilege enforcement via role-based access control, assume-breach mentality with continuous monitoring, and encrypt-everything policies using modern cryptographic standards.     </p> Zero Trust Architecture"},{"location":"projects/homelab/grc/01-summary/#architecture-highlights","title":"Architecture Highlights","text":"<p>Core Capabilities</p> <ul> <li>Identity-Centric Security: Authentik SSO with phishing-resistant MFA (TOTP current, FIDO2/WebAuthn planned), OAuth2/OIDC integration, 30-minute session timeouts</li> <li>Device Trust: Wazuh agents on 25+ endpoints with CIS Benchmark compliance (92-98%), automated vulnerability assessment, configuration drift detection</li> <li>Network Segmentation: Multiple subnets (DMZ, Prod, Lab, Isolated LANs) with micro-perimeters, TLS 1.3 mandatory encryption, service-specific isolation</li> <li>Application Protection: SafeLine WAF with 25% attack block rate, Traefik ForwardAuth validation, OAuth2 scope-based least privilege</li> <li>Data Security: AES-256 encryption at rest/transit, automated lifecycle management, sensitivity-based classification (Public/Internal/Confidential/Restricted)</li> <li>Continuous Monitoring: Dual SIEM (Splunk + Elastic) ingesting 100% security events, real-time correlation, behavioral analytics, 90-day hot retention</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#cisa-zero-trust-maturity-model-v20-alignment","title":"CISA Zero Trust Maturity Model v2.0 Alignment","text":"<p>The CISA ZTMM defines four maturity stages across five core pillars (Identity, Devices, Networks, Applications &amp; Workloads, Data) with three cross-cutting capabilities (Visibility &amp; Analytics, Automation &amp; Orchestration, Governance). This lab demonstrates Advanced-stage implementation across all pillars with targeted progression toward Optimal maturity.</p> <p>Maturity Stage Definitions:</p> <ul> <li>Traditional: Manual configurations, static policies, siloed enforcement, limited correlation</li> <li>Initial: Starting automation, cross-pillar integration, aggregated visibility, responsive least privilege</li> <li>Advanced: Automated controls, centralized visibility, cross-pillar coordination, risk-based least privilege, pre-defined mitigations</li> <li>Optimal: Fully automated just-in-time lifecycles, dynamic policies, comprehensive situational awareness, cross-pillar interoperability</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#five-core-pillars-advanced-maturity-achieved","title":"Five Core Pillars - Advanced Maturity Achieved","text":"<p>Identity (Advanced): Phishing-resistant MFA with FIDO2/PIV implementation underway; consolidated identity stores (Authentik SSO + Active Directory); automated risk assessment via Splunk behavioral analytics; need-based session access with 30-minute expiration; automated user orchestration with manual privileged account management; enterprise-wide identity policies with quarterly reviews.</p> <p>Devices (Advanced): Verified compliance insights via Wazuh agents (25+ endpoints) and Nessus authenticated scans; automated asset tracking (5,000+ packages, 50+ containers); device-aware access control integrated with Authentik ForwardAuth; centralized threat protection (Wazuh EDR, ClamAV, Microsoft Defender); automated inventory with anomaly detection; enterprise-wide lifecycle policies with automated enforcement mechanisms.</p> <p>Networks (Advanced): 3-tier architecture with VLAN micro-segmentation and ingress/egress micro-perimeters; dynamic traffic management with periodic risk-aware application profile adjustments; full encryption (TLS 1.3, SSH AES-256-GCM, VPN) with cryptographic agility planning; HA firewall cluster with dual SIEM/DNS providing resilience; anomaly-based detection with multi-source correlation and automated threat hunting; automated change management via Terraform/Ansible IaC.</p> <p>Applications &amp; Workloads (Advanced): Automated access decisions with contextual enforcement (identity, device, IP, time); integrated threat protections (SafeLine WAF 25% block rate, Suricata/Snort signatures, rate limiting); most mission-critical applications publicly accessible via Cloudflare Tunnels with mandatory authentication; distinct dev/sec/ops teams with restricted production access; integrated security testing (OpenVAS, Nessus, OWASP ZAP); automated monitoring with trend analysis via Prometheus/Grafana; tiered enterprise-wide policies with automated enforcement.</p> <p>Data (Advanced): Automated enterprise-wide inventory with egress filtering and bandwidth monitoring (DLP deployment Q2 2026); automated categorization with sensitivity tiers and quarterly reviews; redundant highly-available storage with 90-day hot/1-year cold retention; automated access controls considering identity, device risk, application context with time limits; full encryption at rest/transit (AES-256, TLS 1.3) with protected key management; enterprise-wide visibility with correlation and initial predictive analytics; primarily automated lifecycle enforcement; integrated policy enforcement with unified definitions.</p>"},{"location":"projects/homelab/grc/01-summary/#three-cross-cutting-capabilities","title":"Three Cross-Cutting Capabilities","text":"<p>Visibility and Analytics (Advanced): Automated enterprise-wide collection including virtual environments; centralized multi-source correlation via dual SIEM (Splunk + Elastic); 100% security event logging with real-time correlation detecting multi-stage attacks; behavioral baselines with anomaly detection; 20+ Grafana dashboards tracking vulnerabilities, patch compliance, authentication patterns, and threat indicators.</p> <p>Automation and Orchestration (Advanced): Enterprise-wide automated orchestration/response leveraging contextual information; Shuffle SOAR with 15+ playbooks integrating TheHive, Cortex, MISP; Wazuh Active Response with sub-30-minute MTTR; Infrastructure-as-Code (Terraform, Ansible) with version control; automated patch management across platforms (PatchMon, WSUS, Watchtower); Step-CA automated certificate lifecycle with 90-day rotation.</p> <p>Governance (Advanced): Tiered tailored policies enterprise-wide with automation support; contextual access decisions incorporating multiple sources; documented version-controlled policies (Git) with quarterly reviews; automated compliance reporting via Wazuh SCA; vulnerability remediation SLAs enforced (Critical &lt;72h, High &lt;7d); configuration management with automated drift detection; policy exceptions requiring documented compensating controls.</p>"},{"location":"projects/homelab/grc/01-summary/#zero-trust-maturity-assessment","title":"Zero Trust Maturity Assessment","text":"Pillar Maturity Level Evidence Next Steps Identity Advanced Authentik SSO 100% coverage, MFA enforcement, certificate-based auth WebAuthn/FIDO2, biometric authentication Device Advanced Wazuh compliance monitoring, Step-CA certificates, endpoint inventory MDM/Device posture assessment, EDR expansion Network/Environment Advanced Microsegmentation, 3-tier architecture, IDS/IPS Software-defined perimeter (SDP) Application/Workload Advanced Container security, API gateway, WAF protection Service mesh (Istio), runtime protection Data Advanced Encryption everywhere, DLP planning, data classification Full DLP deployment, data tagging Visibility &amp; Analytics (Cross-Cutting) Advanced 100% logging, dual SIEM, 90-day retention ML-based analytics, UEBA deployment Automation &amp; Orchestration (Cross-Cutting) Developing SOAR workflows, automated response, enrichment Advanced ML, predictive analytics Governance (Cross-Cutting) Limited Documented version-controlled policies (Git); automated compliance reporting via Wazuh SCA Fully automated policies, dynamic updates, threat intel-driven policy creation <p>Overall ZTA Maturity: Advanced (6 of 8 pillars at Advanced level)</p>"},{"location":"projects/homelab/grc/01-summary/#nist-sp-800-207-zero-trust-architecture-alignment","title":"NIST SP 800-207 Zero Trust Architecture Alignment","text":""},{"location":"projects/homelab/grc/01-summary/#deployment-model","title":"Deployment Model","text":"<p>Hybrid Approach:</p> <ul> <li>Device Agent/Gateway: Authentik + Traefik for web services, SSH certificates for terminal access, Wazuh agents for compliance</li> <li>Enclave Gateway: pfSense/OPNsense protecting network perimeters, dedicated VLANs for service tiers</li> <li>Resource Portal: Traefik reverse proxy for BYOD/contractor access without client agents</li> </ul> <p>Trust Algorithm: Hybrid score-based and criteria-based with contextual evaluation considering subject history, device posture, environmental factors, and real-time threat intelligence.</p>"},{"location":"projects/homelab/grc/01-summary/#maturity-assessment-by-pillar","title":"Maturity Assessment by Pillar","text":"<p>Identity (Advanced)</p> <p>Strengths: Phishing-resistant MFA, centralized SSO (90% coverage), automated risk assessment with behavioral analytics, session-based least privilege, comprehensive event logging</p> <p>Evidence: Authentik OAuth2/OIDC integration across 50+ services, MFA enforcement logs, Splunk credential compromise detection, quarterly access reviews</p> <p>Enhancements Needed: Full FIDO2/WebAuthn deployment, automated privileged identity orchestration, continuous risk scoring with real-time policy updates, just-in-time access for all accounts</p> <p>Devices (Advanced)</p> <p>Strengths: Real-time compliance validation (92-98%), automated asset tracking (NetalertX, Checkmk), device-aware access control, centralized threat protection (Wazuh EDR), anomaly detection</p> <p>Evidence: Wazuh agent deployment 25+ endpoints, Nessus authenticated scans, PatchMon vulnerability tracking 5,000+ packages, automated quarantine workflows</p> <p>Enhancements Needed: Complete SBOM tracking (Trivy/Grype Q1 2026), fully automated provisioning/remediation/deprovisioning, real-time risk analytics informing access, unified advanced threat protection</p> <p>Networks (Advanced)</p> <p>Strengths: Micro-perimeter isolation with 3-tier architecture, TLS 1.3 + modern ciphers mandatory, HA failover (&lt;5 sec), 100% traffic visibility, automated change management via IaC</p> <p>Evidence: VLAN segmentation per service, pfSense CARP cluster, Step-CA 90-day cert rotation, Traefik ForwardAuth on all paths, Terraform/Ansible IaC version control</p> <p>Enhancements Needed: Fully distributed micro-perimeters, dynamic just-in-time connectivity, continuously evolving rules without manual updates, comprehensive situational awareness</p> <p>Applications &amp; Workloads (Advanced)</p> <p>Strengths: Automated contextual access decisions, integrated WAF protection (OWASP CRS), most services publicly accessible with strong controls, distinct dev/sec/ops, periodic security testing</p> <p>Evidence: OAuth2 device compliance checks, SafeLine WAF 25% block rate, Traefik security headers, OWASP ZAP/Burp Suite testing, immutable container workloads</p> <p>Enhancements Needed: Continuous real-time authorization with behavioral patterns, advanced content-aware protections, immutable workloads with automated redeployment, CI/CD security testing (Q2 2026)</p> <p>Data (Advanced)</p> <p>Strengths: Automated enterprise-wide inventory, consistent tiered classification, redundant highly-available storage (dual SIEM, backup replication), multi-attribute access controls, full encryption at rest/transit</p> <p>Evidence: Filesystem monitoring 30+ hosts, dual SIEM 90-day hot/1-year cold retention, sensitivity tiers with handling requirements, AES-256 encryption, quarterly classification reviews</p> <p>Enhancements Needed: Dynamic DLP with exfiltration blocking (formal deployment Q2 2026), fully automated categorization, just-in-time data access, encryption-in-use where appropriate, robust predictive analytics</p> <p>Cross-Cutting Capabilities</p> <p>Visibility &amp; Analytics (Advanced)</p> <p>Implementation: Dual SIEM architecture (Splunk + Elastic), 100% security event coverage, multi-source correlation detecting multi-stage attacks, behavioral baselines, 20+ Grafana dashboards</p> <p>Gap to Optimal: Machine learning/UEBA for predictive analytics, comprehensive cloud log integration, advanced automated threat hunting, situational awareness for all externally-hosted resources</p> <p>Automation &amp; Orchestration (Advanced)</p> <p>Implementation: Shuffle SOAR with 15+ playbooks, Wazuh Active Response (sub-30-min MTTR), IaC via Terraform/Ansible, automated patch management (PatchMon, WSUS, Watchtower), Step-CA certificate automation</p> <p>Gap to Optimal: Predictive analytics triggering proactive response, full privileged identity automation, automated mitigation deployment without manual approval, dynamic adaptation to environmental changes</p> <p>Governance (Advanced)</p> <p>Implementation: Tiered policies enterprise-wide with automation support, version-controlled policies (Git), CIS Benchmark enforcement via Wazuh SCA, vulnerability SLAs (Critical &lt;72h, High &lt;7d), quarterly reviews</p> <p>Gap to Optimal: Fully automated policies with continuous enforcement, dynamic updates without manual intervention, automated policy creation from threat intelligence, real-time adjustments to environmental changes</p>"},{"location":"projects/homelab/grc/01-summary/#key-technologies-deployed","title":"Key Technologies Deployed","text":"Category Technologies Maturity Identity &amp; Access Authentik SSO, OAuth2/OIDC/SAML, Step-CA PKI, MFA (TOTP, FIDO2 planning) Advanced Endpoint Security Wazuh EDR (25+ agents), ClamAV, Microsoft Defender, CIS Benchmark SCA Advanced Network Security pfSense/OPNsense HA cluster, Suricata/Snort IDS, Traefik reverse proxy, SafeLine WAF Advanced Vulnerability Mgmt Nessus, PatchMon (5,000+ packages), OpenVAS, OWASP ZAP, Burp Suite Advanced SIEM &amp; Analytics Splunk, Elastic Stack, Grafana, Prometheus, Wazuh correlation Advanced Orchestration Shuffle SOAR (15+ playbooks), TheHive case mgmt, Cortex analysis, MISP threat intel Advanced Infrastructure Proxmox virtualization, Docker containers, Terraform, Ansible, Git version control Advanced Encryption TLS 1.3, AES-256-GCM, Ed25519, WireGuard, syslog-ng TLS, Vaultwarden secrets Advanced Monitoring Uptime Kuma (50+ monitors), Checkmk, NetalertX, Pi-hole DNS, Prometheus exporters Advanced"},{"location":"projects/homelab/grc/01-summary/#compliance-standards-alignment","title":"Compliance &amp; Standards Alignment","text":"<p>Framework Coverage:</p> <ul> <li>CISA ZTMM v2.0: Advanced (Stage 3/4) across all 5 pillars + 3 cross-cutting capabilities</li> <li>NIST SP 800-207: Comprehensive implementation of all 7 ZT tenets, mature logical component deployment</li> <li>NIST SP 800-53: AC-2/AC-3, IA-2/IA-4/IA-5, SC-7/SC-8, SI-2/SI-3/SI-4, CM-8, AU-2/AU-6, IR-4</li> <li>CIS Controls: 5.1-6.8 (Identity), 1.1-2.7/4.1-4.12/10.1-10.7 (Devices), 12.1-13.10 (Networks), 16.1-18.5 (Applications), 3.1-11.5 (Data)</li> <li>ISO 27001: A.5.15-5.18 (Identity), A.5.9/A.8.1/A.8.7-8.8/A.8.19 (Assets), A.8.20-8.23 (Networks), A.8.26/A.14.1-14.2 (Applications), A.5.12/A.5.14/A.5.33/A.8.10/A.8.24 (Data)</li> <li>PCI-DSS: 8.1-8.3 (Identity), 2.4/5.1-5.2/6.4.3/11.5 (Devices), 1.1-1.4/4.2 (Networks), 6.4-6.6 (Applications), 3.1-3.7/10.5-10.7 (Data)</li> <li>OWASP Top 10: A07 (Authentication), A02/A03 (Devices), A04 (Networks), A01/A05/A06/A08 (Applications), A04/A09 (Data)</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#zero-trust-tenets-achievement","title":"Zero Trust Tenets Achievement","text":"NIST SP 800-207 Tenet Status Implementation Evidence 1. All resources explicitly defined \u2713 Advanced 25+ hosts, 50+ containers, 30+ VMs tracked; NetalertX discovery, Proxmox inventory 2. Communication secured regardless of location \u2713 Advanced TLS 1.3 mandatory, no implicit network trust, Authentik validates all requests 3. Per-session least privilege access \u2713 Advanced 30-min timeouts, OAuth2 scopes, temporary sudo, session-based authorization 4. Dynamic policy from observable state \u2713 Advanced Device compliance + identity + behavior + threat intel inform access decisions 5. Asset integrity monitoring \u2713 Advanced Wazuh CIS compliance, Nessus scans, PatchMon 5,000+ packages, drift detection 6. Dynamic authentication/authorization \u2713 Advanced MFA enforcement, continuous session evaluation, threat-triggered re-auth 7. Comprehensive telemetry collection \u2713 Advanced Dual SIEM, 100% event logging, multi-source correlation, policy optimization"},{"location":"projects/homelab/grc/01-summary/#pci-dss-v40-conceptual-alignment-summary","title":"PCI-DSS v4.0 Conceptual Alignment Summary","text":"<p>       This cybersecurity lab demonstrates conceptual alignment with PCI-DSS v4.0 requirements through defense-in-depth security controls, comprehensive logging, strong cryptography, and continuous vulnerability management. While the lab processes no actual cardholder data (CHD) or sensitive authentication data (SAD), the security architecture implements PCI-DSS technical and operational controls as a learning framework demonstrating compliance-ready capabilities.     </p> <p> PCI-DSS v4.0 Conceptual Compliance: 85% (Technical Controls Implemented) </p> PCI-DSS v4.0"},{"location":"projects/homelab/grc/01-summary/#pci-dss-v40-conceptual-alignment","title":"PCI-DSS v4.0 (Conceptual Alignment)","text":"<p>Build and Maintain a Secure Network and Systems</p> <p>Requirement 1: Install and Maintain Network Security Controls</p> <p>Implementation: Strong</p> <p>1.1.1 - Network Segmentation Documented: Network topology diagrams maintained in Git repository documenting 3-tier architecture (DMZ, application tier, backend), VLAN segmentation strategy, firewall rulesets per segment, data flow diagrams showing cardholder data environment (CDE) boundaries (conceptual).</p> <p>1.2.1 - Restrict Inbound/Outbound Traffic: pfSense/OPNsense default-deny firewall policies with explicit allow rules, egress filtering prevents unauthorized outbound connections, Traefik ingress controller restricts inbound access to authorized services only, CrowdSec behavioral blocking for anomalous traffic patterns.</p> <p>1.3.1 - DMZ Implementation: DMZ isolates public-facing services (Traefik reverse proxy, public DNS) from internal networks, firewall ACLs enforce traffic restrictions between DMZ and internal zones, backend services unreachable from DMZ without explicit routing through application tier.</p> <p>1.4.2 - Restrict Public Internet Access: Internal services isolated from direct internet access, Cloudflare Tunnels and Tailscale VPN provide secure remote access without exposing internal IPs, firewall rules block all inbound traffic except explicitly allowed services, NAT gateway controls outbound internet access.</p> <p>Framework Alignment: NIST SC-7 (Boundary Protection), ISO 27001 A.8.20-8.22 (Network Security), CIS Control 12.1-12.4 (Network Infrastructure Management).</p> <p>Requirement 2: Apply Secure Configurations to All System Components</p> <p>Implementation: Strong</p> <p>2.2.2 - Configuration Standards: CIS Benchmark compliance (92-98%) for SSH, firewalls, DNS, web servers validated via Nessus authenticated scans and Wazuh SCA. Ansible playbooks enforce configuration baselines with version control in Git. Unnecessary services disabled, default accounts removed, security parameters hardened.</p> <p>2.2.4 - System Security Parameters: SSH hardening (CIS Benchmark): root login disabled, password authentication disabled, key-only access, MaxAuthTries=3. Traefik secure defaults: HSTS enabled, secure headers (CSP, X-Frame-Options), TLS 1.3 minimum. pfSense hardening: default-deny policies, anti-spoofing, state tracking.</p> <p>Framework Alignment: NIST CM-6 (Configuration Settings), ISO 27001 A.8.9 (Configuration Management), CIS Control 4.1-4.12 (Secure Configuration).</p> <p>Protect Account Data</p> <p>Requirement 4: Protect Cardholder Data with Strong Cryptography</p> <p>Implementation: Strong</p> <p>4.2.1 - Strong Cryptography for Transmission: TLS 1.3 mandatory across all services via Traefik reverse proxy with modern cipher suites (AES-256-GCM, ChaCha20-Poly1305), SSH connections encrypted with AES-256-GCM, VPN encryption (WireGuard with ChaCha20, OpenVPN with AES-256), syslog-ng TLS for encrypted log transmission, DNSSEC for DNS query integrity.</p> <p>4.2.1 - Strong Cryptography at Rest: Encrypted backups (AES-256) via Proxmox Backup Server, SSH private keys encrypted with passphrases, database encryption where applicable, Vaultwarden zero-knowledge vault encryption, Ansible Vault encrypts sensitive configuration variables.</p> <p>Framework Alignment: NIST SC-8/SC-13/SC-28 (Cryptographic Protection), ISO 27001 A.8.24 (Cryptography), CIS Control 13.10 (Encryption), OWASP A04 (Cryptographic Failures).</p> <p>Maintain a Vulnerability Management Program</p> <p>Requirement 6: Develop and Maintain Secure Systems and Software</p> <p>Implementation: Strong</p> <p>6.3.3 - Security Patches Within One Month: Multi-platform patch management achieves &lt;7-day MTTR for high-severity vulnerabilities, &lt;72-hour MTTR for critical CVEs exceeding PCI-DSS one-month requirement. PatchMon tracks 5,000+ packages across 30+ hosts with daily compliance checks. WSUS manages Windows patching with automated approvals. Watchtower auto-updates containers. Vulnerability-driven prioritization via CVSS scoring.</p> <p>6.4.3 - Inventory of System Components: Comprehensive asset inventory via PatchMon (5,000+ packages), WUD (50+ containers), OpenVAS asset database (75+ assets), Nessus software inventory, Wazuh agent tracking (25+ endpoints), DNS records, SSH host keys, Checkmk infrastructure inventory, Prometheus node exporters, NetalertX network discovery.</p> <p>Framework Alignment: NIST SI-2 (Flaw Remediation), RA-5 (Vulnerability Monitoring), ISO 27001 A.8.8 (Vulnerability Management), CIS Control 7.3-7.7 (Continuous Vulnerability Management).</p> <p>Implement Strong Access Control Measures</p> <p>Requirement 8: Identify Users and Authenticate Access</p> <p>Implementation: Strong</p> <p>8.2.1 - Unique User IDs: Individual user accounts across all systems via Authentik SSO, Active Directory, and SSH key infrastructure. No shared credentials - each administrator maintains separate privileged account. User account inventory tracked in Authentik database and AD with SIEM correlation identifying orphaned accounts.</p> <p>8.2.2 - Strong User Authentication: SSH key-based authentication exclusively (passwords disabled globally) using Ed25519 cryptographic keys, Authentik enforces password complexity requirements (14-char minimum for non-MFA, 8-char for MFA accounts), password managers (Vaultwarden) enforce unique passwords across services.</p> <p>8.2.3 - Multi-Factor Authentication for Remote Access: MFA enforced for 100% of administrative accounts via Authentik TOTP, SSH remote access secured with key-based authentication (inherently multi-factor: possession of private key + knowledge of passphrase), VPN access (Tailscale) requires device authentication, MFA bypass attempts monitored via Wazuh.</p> <p>8.2.5 - No Shared/Group Accounts: Strict prohibition on shared credentials enforced via Authentik policies and AD group policies. Separate admin accounts for privileged operations. Service accounts documented in inventory with ownership tracking and quarterly reviews.</p> <p>8.3.2 - Strong Cryptography for Authentication Data: SSH private keys encrypted, Authentik credentials stored in Vaultwarden with zero-knowledge encryption, Ansible Vault encrypts all secrets (passwords, API keys, certificates), no hardcoded credentials in code or configuration files.</p> <p>Framework Alignment: NIST AC-2/IA-2/IA-5 (Account and Authentication Management), ISO 27001 A.5.16-5.18 (Identity and Authentication), CIS Control 5.1-6.6 (Account and Access Management), OWASP A07 (Authentication Failures).</p> <p>Regularly Monitor and Test Networks</p> <p>Requirement 10: Log and Monitor All Access to System Components and Cardholder Data</p> <p>Implementation: Strong</p> <p>10.2 - Audit Logs for Security Events: 100% security event coverage including: DNS queries (Pi-hole), SSH sessions (auth.log), Traefik access logs (JSON format), vulnerability scans, patch deployments, authentication attempts, privileged operations, service modifications, account changes, firewall events, IDS alerts, file integrity changes.</p> <p>10.3 - Audit Record Details: Logs include comprehensive context: timestamp (NTP synchronized), user identity, source IP address, action performed, result (success/failure), SSH key fingerprints, DNS query details, HTTP request/response data, Sysmon process telemetry with parent-child relationships.</p> <p>10.5 - Protect Audit Logs: Immutable SIEM indexes (Splunk read-only, Elastic immutable streams) prevent tampering, encrypted log transmission via syslog-ng TLS, centralized storage in dual SIEM architecture, 90-day hot retention with 1-year cold storage, access controls restrict log modification, file integrity monitoring on log directories.</p> <p>10.6 - Review Logs and Security Events: Weekly Splunk dashboard reviews, automated correlation searches detect anomalies, real-time alerting via Discord/email for critical events, Wazuh monitors security events continuously, TheHive aggregates alerts for case management, multi-source correlation identifies attack patterns.</p> <p>Framework Alignment: NIST AU-2/AU-3/AU-6/AU-9/AU-12 (Audit and Accountability), ISO 27001 A.8.15-8.16 (Logging and Monitoring), CIS Control 8.1-8.11 (Audit Log Management), OWASP A09 (Logging &amp; Alerting Failures).</p> <p>Requirement 11: Test Security of Systems and Networks Regularly</p> <p>Implementation: Strong</p> <p>11.3.1 - External/Internal Vulnerability Scans Quarterly: Weekly OpenVAS network scans (52/year) plus monthly Nessus authenticated scans (12/year) exceed quarterly PCI-DSS requirement. Daily PatchMon package vulnerability checks provide continuous assessment. Wazuh Security Configuration Assessment (SCA) performs real-time compliance validation. Scans cover 75+ assets across all network segments.</p> <p>11.3.2 - Vulnerability Scans by Qualified Personnel: Scanning infrastructure operated by qualified security professional (lab owner) with documented vulnerability management process, CVSS-based prioritization methodology, risk-based remediation strategy, quarterly reviews of scan results, documented exceptions and compensating controls.</p> <p>11.4.1 - Implement IDS/IPS: Suricata inline IDS/IPS on all network segments with real-time blocking capability, Snort passive IDS for additional detection, CrowdSec behavioral IPS with community threat intelligence, Wazuh host-based IDS on 25+ endpoints with FIM and rootkit detection.</p> <p>11.4.2 - Keep IDS/IPS Updated: Daily signature updates for Suricata/Snort (Emerging Threats, abuse.ch), CrowdSec community feed synchronization, Wazuh ruleset updates, MISP threat intelligence integration provides IOC updates, Yara signature updates for malware detection.</p> <p>Framework Alignment: NIST RA-5 (Vulnerability Monitoring), CA-2/CA-7/CA-8 (Security Assessment), SI-4 (System Monitoring), ISO 27001 A.8.8 (Vulnerability Management), CIS Control 7.1-7.7 (Vulnerability Management), 13.1-13.8 (Network Monitoring).</p>"},{"location":"projects/homelab/grc/01-summary/#pci-dss-compliance-summary","title":"PCI-DSS Compliance Summary","text":"Requirement Domain Compliance Level Key Controls Gaps/Limitations 1. Network Security Strong (95%) Segmentation, DMZ, default-deny, ACLs Formal network diagrams need PCI annotation 2. Secure Configuration Strong (92-98%) CIS Benchmarks, IaC, drift detection Container configuration scanning 4. Cryptography Strong (100%) TLS 1.3, AES-256, Ed25519, Step-CA PKI Full disk encryption deployment 6. Vulnerability Management Strong (95%) &lt;72h Critical MTTR, weekly/monthly scans Formal pen testing program 8. Access Control Strong (100%) Unique IDs, MFA 100% admin, no shared accounts WebAuthn/FIDO2 implementation 10. Logging &amp; Monitoring Strong (100%) 100% coverage, 90-day retention, immutable logs SIEM ML enhancement 11. Testing Strong (100%) Weekly/monthly scans, IDS/IPS, daily updates Annual external pen test <p>Overall PCI-DSS v4.0 Conceptual Compliance: 85% (Technical Controls Implemented)</p> <p>Note: As a personal homelab processing no cardholder data, formal PCI-DSS certification is not required. Implementation demonstrates compliance-ready technical controls suitable for production CDE deployment with appropriate governance additions (policies, procedures, formal assessments, QSA validation).</p>"},{"location":"projects/homelab/grc/01-summary/#comprehensive-framework-alignment-matrix","title":"Comprehensive Framework Alignment Matrix","text":"Security Domain NIST CSF 2.0 CIS v8.1 ISO 27001:2022 NIST 800-53 Rev 5 PCI-DSS v4.0 OWASP 2025 MITRE ATT&amp;CK v18.1 CISA ZTMM v2.0 NIST SP 800-207 Asset Management ID.AM-01 to ID.AM-08 1.1-1.5, 2.1-2.4 A.5.9, A.8.1 CM-8, CM-8(1)-(3), PM-5 2.4, 6.4.3 N/A T1018, T1046, T1135 Devices: Advanced Tenet 1: Resource Inventory Network Segmentation PR.AC, DE.CM 12.1-12.4, 13.4 A.8.20, A.8.22 SC-7, SC-7(21) 1.1.1, 1.3.1 A01 (SSRF), A06 N/A Networks: Advanced Tenet 2: Micro-segmentation Firewall Management PR.AC, SC-7 12.1-12.2 A.8.20 SC-7, SC-7(5) 1.2.1, 1.4.2 A02 N/A Networks: Advanced Tenet 2: Boundary Protection Firewall HA PR.IR-01, RC.RP 12.1, 12.2 A.8.14, A.8.20 CP-9, SC-7(20), SI-4(1) 1.1.1, 1.3.7 N/A N/A Networks: Advanced Tenet 7: Resilience DMZ Architecture PR.IR, SC-7 12.2 A.8.20, A.8.22 SC-7(21) 1.3.1 A06 N/A Networks: Advanced Tenet 2: Isolation Network Monitoring DE.CM 13.1-13.6 A.8.16, A.8.20 SI-4, SI-4(1)(4) 11.4.1, 11.4.2 A09 T1046, T1049, T1590 Visibility: Advanced Tenet 7: Comprehensive Telemetry IDS/IPS DE.CM-01, DE.AE-02 13.1-13.3, 13.6-13.8 A.8.7, A.8.16, A.8.20 SI-4, SI-4(1)(2)(5) 11.4.1, 11.4.2 N/A T1046, T1595 Visibility: Advanced Tenet 7: Monitoring WAF Protection DE.CM, RS.MI 13.10 A.8.23, A.8.26 SI-4(23), SI-10, SC-7(11) 6.6 A01, A05 (Injection) T1190, T1659 Apps: Advanced Tenet 4: Policy Enforcement VPN/Remote Access PR.AC, PR.DS-02 12.3, 12.7, 13.10 A.5.14, A.6.7, A.8.21 AC-17, AC-17(1)(2)(4), SC-8, SC-13 4.1, 8.2.3, 12.3 N/A T1133 Identity: Advanced Tenet 2: Location Independence Access Control &amp; Authorization PR.AA, PR.AC 6.1-6.6 A.5.15, A.5.18, A.8.3 AC-2, AC-3, AC-6 7.1, 7.2, 8.1 A01 (Broken Access Control) T1078, T1098, T1087 Identity: Advanced Tenet 3: Least Privilege RBAC Implementation AC-3(7), PR.AA 6.8 A.5.18, A.8.3 AC-2(7), AC-3(7) 7.1.2 A01 T1078 Identity: Advanced Tenet 3: Role-Based Access Least Privilege AC-6, PR.AA 5.4, 6.1-6.6 A.5.18 AC-6, AC-6(1)(2)(5) 7.1.1 A01, A06 T1548 Identity: Advanced Tenet 3: Least Privilege SSRF Prevention PR.AC, DE.CM 12.3, 13.10 A.8.20, A.8.21 SC-7, SI-10 6.6 A01 N/A Networks: Advanced Tenet 4: Policy Enforcement SSO Implementation IA-2(10), PR.AA 6.6-6.7 A.5.15, A.8.5 IA-2(10) 8.2.1 A07 (Authentication) T1078 Identity: Advanced Tenet 3: Centralized Identity MFA Enforcement IA-2(1), PR.AA-01 6.3-6.5 A.5.17, A.8.5 IA-2(1)(2) 8.2.3, 8.3.1 A07 T1078, T1111 Identity: Advanced Tenet 6: Phishing-Resistant MFA SSH Key Management IA-5(2), PR.AA 5.6, 6.7 A.5.17, A.8.24 IA-5(2), IA-5(14) 8.3.2 A07 T1552, T1078 Identity: Advanced Tenet 6: Certificate-Based Auth Account Lockout AC-7, PR.AA 6.3 A.9.4.2 AC-7 8.2.4, 8.2.5 A07 T1110 Identity: Advanced Tenet 6: Automated Protection Session Management AC-12, SC-23 6.3 A.8.5 AC-2(5), AC-11, AC-12, SC-23 8.1.8 A07 T1539, T1563 Identity: Advanced Tenet 3: Session-Based Access Password Management IA-5(1), PR.DS 5.2, 6.2 A.5.17 IA-5(1), IA-5(18) 8.2.2, 8.3.2 A07 T1555, T1552 Identity: Advanced Tenet 6: Strong Authentication Credential Protection IA-5(7), PR.DS 3.11, 6.7 A.5.17, A.8.24 IA-5(7), IA-5(18), SC-28(3) 3.5, 3.6, 8.3.2 A07, A08 T1003, T1555, T1552 Data: Advanced Tenet 6: Credential Encryption Active Directory PR.AA-01, AC-2 5.3, 5.6, 6.1, 6.8 A.5.16, A.8.2 AC-2, AC-3(7), IA-2, IA-4, IA-5 8.2, 8.3 A07 T1087, T1482 Identity: Advanced Tenet 3: Centralized Directory Secrets Management PR.DS-01, IA-5(7) 3.11, 5.2, 6.7 A.5.17, A.8.24 IA-5(7), IA-5(18), SC-12, SC-28(3) 3.5, 3.6, 8.2.1 A07, A08 T1552, T1555 Data: Advanced Tenet 6: Zero-Knowledge Vault PKI/Certificate Management PR.DS-10, SC-17 3.12, 16.14 A.8.24 SC-12, SC-13, SC-17, SC-17(1), IA-5(14) 4.2.1 A04 (Cryptography) N/A Identity: Advanced Tenet 6: Automated PKI TLS/Encryption (Transit) PR.DS-02, SC-8 3.10, 12.6, 13.10 A.8.24 SC-8, SC-8(1), SC-13 4.2.1 A04 N/A Data: Advanced Tenet 2: Encrypt All Communications Encryption at Rest PR.DS-01, SC-28 3.11 A.8.24 SC-28, SC-28(1)(3) 3.4, 4.2.1 A04 N/A Data: Advanced Tenet 2: Protect Data at Rest Key Management SC-12, PR.DS 3.12, 6.7 A.8.24 SC-12, SC-13 4.2.1 A04 N/A Data: Advanced Tenet 6: Protected Key Storage DNSSEC SC-20, PR.DS 9.2, 12.6 A.8.21, A.8.23 SC-20, SC-20(2), SC-21 2.2.5 A04 N/A Networks: Advanced Tenet 2: DNS Integrity DNS Security PR.DS, DE.CM 9.2, 12.6 A.8.21, A.8.23 SC-20, SC-20(2), SC-21 2.2.5 N/A T1071.004, T1568 Networks: Advanced Tenet 7: DNS Monitoring Configuration Management PR.PS-01, CM-2 4.1-4.12, 16.7 A.8.9, A.8.32 CM-2, CM-3, CM-6, CM-6(1), CM-7 2.2.2, 2.2.4 A02 (Misconfiguration) T1547, T1112 Devices: Advanced Tenet 5: Asset Integrity Baseline Hardening CM-6, PR.IP 4.1-4.7 A.8.9 CM-6, CM-6(1) 2.2.2, 2.2.4 A02 N/A Devices: Advanced Tenet 5: Security Baselines Configuration Drift Detection CM-6(1), PR.PS 4.1 A.8.9 CM-3, CM-6(1) 2.2.4 A02 T1562.001 Devices: Advanced Tenet 5: Automated Monitoring IaC/Automation PR.PS-01, CM-2(2) 4.1-4.2, 16.1, 16.7, 18.1 A.5.8, A.5.37, A.8.9, A.8.32 CM-2(2)(3), CM-3, CM-9 6.4.5, 11.6.1 A02, A08 N/A Automation: Advanced Tenet 5: Immutable Infrastructure Default Credentials IA-5(1), CM-6 4.7, 5.2 A.5.17 IA-5(1) 2.2.3, 8.2.2 A02, A07 T1078 Identity: Advanced Tenet 6: No Default Credentials Security Headers SC-8, PR.DS 9.2, 13.10 A.8.21, A.8.26 SC-8, SI-10 6.6 A02, A05 N/A Apps: Advanced Tenet 4: Defense in Depth Vulnerability Management ID.RA-01 to ID.RA-08, PR.IP, DE.CM-09 7.1-7.7 A.8.8 RA-3, RA-5, RA-5(2)(3)(5)(8)(10) 6.3.1, 11.3.1 N/A T1190, T1210 Devices: Advanced Tenet 5: Continuous Assessment Vulnerability Scanning RA-5, DE.CM-09 7.5-7.6 A.8.8, A.12.6.1 RA-5, RA-5(2)(3)(5) 11.3.1, 11.3.2 N/A N/A Devices: Advanced Tenet 5: Automated Scanning Patch Management SI-2, PR.PS-03 7.3-7.4, 12.1 A.8.8, A.8.19 SI-2, SI-2(2)(4)(6), CM-8 6.3.3 N/A T1068, T1210 Devices: Advanced Tenet 5: Rapid Remediation SBOM/Supply Chain GV.SC, ID.RA 15.1-15.7, 16.4-16.5 A.5.19-5.22 SR-3, SR-11, SA-10 12.8.1-12.8.5 A03 (Supply Chain) T1195, T1199 Governance: Developing Tenet 5: Component Verification Software Verification CM-14, SI-7 2.3, 16.11 A.8.32 SI-7(6), CM-14, SR-11 6.3.2 A03, A08 T1195, T1553 Devices: Advanced Tenet 5: Signature Validation Dependency Tracking GV.SC-02, ID.RA 16.4 A.5.21 SR-3, SA-10 12.8.5 A03 T1195 Governance: Developing Tenet 5: SBOM Management Logging/Monitoring DE.CM, DE.AE, AU-2 8.1-8.11, 13.1, 13.6 A.8.15, A.8.16 AU-2, AU-3, AU-6, AU-6(1)(3)(5), AU-12 10.2, 10.3, 10.6 A09 (Logging &amp; Alerting) T1070, T1562.002 Visibility: Advanced Tenet 7: Comprehensive Telemetry Log Protection AU-9, DE.CM 8.9, 8.10 A.8.15 AU-9, AU-11, SI-12 10.5.1 A09 T1070, T1562.002 Visibility: Advanced Tenet 7: Immutable Logs Real-Time Alerting DE.AE-06, RS.CO, SI-4(5) 8.11, 13.1, 17.2, 17.6 A.6.8, A.8.16 AU-5(2), SI-4(5)(12), IR-6(1) 10.6, 12.10 A09 N/A Visibility: Advanced Tenet 7: Automated Alerts Alert Correlation DE.AE, AU-6(3) 8.11, 13.6 A.8.16 AU-6(1)(3)(5), SI-4(16) 10.6 A09 N/A Visibility: Advanced Tenet 7: Cross-Pillar Correlation Time Synchronization DE.CM, AU-8 8.4 A.8.17 AU-8, SC-45, SC-45(1) 10.4 N/A N/A Visibility: Advanced Tenet 7: Synchronized Timestamps Malware Defenses DE.CM-04, SI-3 10.1-10.7 A.8.7 SI-3, SI-3(4)(10), SI-7 5.1, 5.2 N/A T1204, T1566 Devices: Advanced Tenet 5: Threat Protection Antivirus/EDR SI-3, DE.CM 10.1-10.2, 13.2 A.8.7 SI-3, SI-3(4), SI-4(23) 5.1, 5.2 N/A T1562.001 Devices: Advanced Tenet 5: Endpoint Detection File Integrity Monitoring SI-7, SI-7(1) 10.1, 13.2 A.8.7, A.8.16 SI-7(1)(6)(7), AU-9 11.5 A08 (Data Integrity) T1070, T1565 Devices: Advanced Tenet 5: Change Detection Data Protection PR.DS, ID.AM-07 3.1-3.14 A.5.12, A.5.14, A.5.33, A.5.34, A.8.10 SC-28, MP-6, MP-4 3.1-3.7, 4.1-4.2 A04 T1005, T1025 Data: Advanced Tenet 2: Encrypt Everything Data Classification PR.DS, GV.PO 3.7, 3.12 A.5.12 MP-3, RA-2 3.1 N/A N/A Data: Advanced Tenet 4: Sensitivity-Based Controls DLP PR.DS, DE.CM 3.13 A.8.12 SC-7, SI-4 3.4 N/A T1020, T1030, T1048 Data: Developing Tenet 4: Egress Monitoring Backup/Recovery RC.RP, RC.HL, CP-9 11.1-11.5 A.5.29, A.5.30, A.8.13, A.8.14 CP-9, CP-9(1)(3)(8), CP-10 12.10.1 N/A T1490, T1486 Data: Advanced Tenet 7: Resilience Business Continuity RC.RP, CP-2 11.1-11.5 A.5.29, A.5.30, A.17.1 CP-2, CP-6, CP-7 12.10 N/A N/A Governance: Advanced Tenet 7: Service Continuity Incident Response RS.AN, RS.CO, RS.MA, RS.MI 17.1-17.9 A.5.24-5.28, A.6.8 IR-4, IR-4(1)(4), IR-5, IR-5(1), IR-6, IR-7, IR-8 12.10 N/A All Tactics Automation: Advanced Tenet 6: Automated Response SOAR Platform RS.AN, RS.MI, IR-4(1) 17.1-17.9 A.5.24, A.5.25, A.5.26 IR-4(1), IR-5(1), IR-6(1), AU-6(1)(5) 12.10 N/A All Tactics Automation: Advanced Tenet 6: Orchestrated Workflows Threat Intelligence ID.RA-02, DE.AE-07 7.1, 16.4 A.5.7 PM-16(1), RA-3(1), SI-4(18) 11.3.1 N/A T1592-T1597 Visibility: Advanced Tenet 7: Contextual Enrichment Threat Hunting DE.CM, RA-10 13.6 A.8.16 RA-10, SI-4(16) 11.4 N/A All Tactics Visibility: Advanced Tenet 7: Proactive Detection Phishing Detection ID.RA-02, DE.AE-02 9.2, 17.1 A.5.7, A.5.24 SI-3, SI-4, IR-4 11.4, 12.10 N/A T1566 Apps: Advanced Tenet 4: Email Security Brute Force Detection DE.CM, AC-7 6.3-6.5, 8.11 A.5.17, A.8.5 AC-7, SI-4(5) 8.2.4, 8.2.5 A07 T1110 Identity: Advanced Tenet 6: Automated Lockout Credential Dumping Detection DE.CM, SI-4(23) 10.1, 13.2 A.8.7 SI-4(23), AU-6 10.6, 11.4 N/A T1003 Devices: Advanced Tenet 5: LSASS Protection Process Monitoring DE.CM, AU-12 10.1, 13.2 A.8.16 SI-4(23), AU-12 10.2, 10.6 N/A T1059, T1106 Devices: Advanced Tenet 5: Execution Telemetry PowerShell Logging DE.CM, AU-12 8.8, 10.1 A.8.15 AU-3(1), SI-4 10.2.7 N/A T1059.001 Devices: Advanced Tenet 5: Script Auditing Registry Monitoring DE.CM, CM-6(1) 4.1, 8.11 A.8.9, A.8.16 CM-6(1), SI-7(1) 2.2.4, 10.6 A02, A08 T1112, T1547 Devices: Advanced Tenet 5: Persistence Detection Service Creation Detection DE.CM, CM-8(3) 4.8, 10.1 A.8.1, A.8.16 SI-4, AU-12 10.2, 11.5 N/A T1543, T1569 Devices: Advanced Tenet 5: Service Monitoring Scheduled Task Monitoring DE.CM, AU-12 7.1, 8.11 A.8.16 SI-4, AU-12 10.2, 10.6 N/A T1053 Devices: Advanced Tenet 5: Task Auditing Account Monitoring AC-2(4), DE.CM 5.1, 6.1, 8.11 A.5.16, A.8.16 AC-2(4)(12), AU-12 8.1.2, 10.2.5 A01, A07 T1136, T1098 Identity: Advanced Tenet 3: Lifecycle Tracking Privilege Escalation Detection AC-6(9), DE.CM 5.4, 6.5, 8.11 A.8.2, A.8.18 AC-6(9), SI-4 7.1, 10.2 A01 T1548, T1134 Identity: Advanced Tenet 3: Anomaly Detection LSASS Protection IA-5, SI-3(10) 5.2, 10.1 A.5.17, A.8.7 IA-5(7), SI-3(10) 8.2.1 A07 T1003 Identity: Advanced Tenet 6: Memory Protection Lateral Movement Detection DE.CM, SI-4(16) 12.3, 13.1-13.3 A.8.16, A.8.20 SI-4(1)(16), AU-6(3) 10.6, 11.4 N/A T1021, T1080 Visibility: Advanced Tenet 7: Cross-Host Correlation RDP/SMB/SSH Monitoring AC-17(1), DE.CM 12.3, 12.7, 13.6 A.6.7, A.8.16 AC-17(1), SI-4(4) 8.3, 10.2 N/A T1021.001-.004 Identity: Advanced Tenet 2: Remote Session Tracking Network Scanning Detection DE.CM, SI-4(1) 13.1-13.3, 18.1 A.8.16, A.8.20 SI-4(1)(4), CA-8 11.3, 11.4 N/A T1046, T1018 Networks: Advanced Tenet 7: Reconnaissance Detection Port Scan Detection DE.CM, SI-4(1) 13.1, 13.3 A.8.16, A.8.20 SI-4(1)(4) 11.4 N/A T1046 Networks: Advanced Tenet 7: Anomaly Detection C2 Beacon Detection DE.CM, SI-4(18) 13.1, 13.6 A.5.7, A.8.16 SI-4(18), IR-4(4) 10.6, 11.4 N/A T1071, T1095 Visibility: Advanced Tenet 7: Traffic Analysis DNS Tunneling Detection DE.CM, SI-4 8.6, 9.2, 13.6 A.8.16, A.8.21 SC-20, SC-21, SI-4 10.6 N/A T1071.004, T1048.003 Networks: Advanced Tenet 7: DNS Analysis DGA Detection DE.CM, SI-4 9.2, 13.6 A.8.16, A.8.23 SC-20(2), SI-4 10.6 N/A T1568 Networks: Advanced Tenet 7: Behavioral Analysis Proxy Detection DE.CM, SC-7 12.3, 13.10 A.8.20, A.8.21 SC-7(8), SI-4 1.3, 10.6 N/A T1090 Networks: Advanced Tenet 7: Proxy Monitoring Ransomware Detection DE.CM, IR-4(1) 10.1, 11.1-11.5 A.5.24, A.8.7 IR-4(1), SI-3(10) 12.10 N/A T1486 Automation: Advanced Tenet 6: Automated Containment Cryptomining Detection DE.CM, SI-4 10.1, 13.2 A.8.7, A.8.16 SI-4, AU-6 10.6, 11.4 N/A T1496 Devices: Advanced Tenet 5: Resource Monitoring Data Exfiltration Detection DE.CM, SI-4(4) 13.6 A.8.12, A.8.16 SI-4(4), SC-7 10.6 N/A T1020, T1041 Data: Developing Tenet 4: Egress Detection USB Device Monitoring MP-7, DE.CM 11.2.5 A.7.10, A.8.16 MP-2, MP-7, SI-4 9.6 N/A T1091, T1052 Devices: Advanced Tenet 5: Removable Media Control Web Shell Detection DE.CM, SI-3 13.10, 16.7 A.8.7, A.8.26 SI-3, SI-10 6.6, 11.4 A05 T1505 Apps: Advanced Tenet 4: Web Application Security WMI Monitoring DE.CM, AU-12 8.8, 10.1 A.8.16 SI-4, AU-12 10.2 N/A T1047, T1546.003 Devices: Developing Tenet 5: WMI Auditing Container Security SC-39, DE.CM 16.1-16.14 A.8.27 SC-39, CM-7 6.4.3 N/A T1059.013, T1610, T1611 Apps: Developing Tenet 4: Workload Isolation Log Tampering Detection AU-9, SI-7 8.9, 8.10 A.8.15 AU-9, SI-7 10.5 A09 T1070, T1562.002 Visibility: Advanced Tenet 7: Immutable Audit Obfuscation Detection DE.CM, SI-3(10) 10.1, 13.2 A.8.7 SI-3(10), SI-4(18) 5.2, 11.4 A05 T1027, T1140 Devices: Developing Tenet 5: Entropy Analysis Pass-the-Hash Detection IA-2, DE.CM 6.3, 8.11 A.5.17, A.8.16 IA-2(1), SI-4 8.3, 10.2 A07 T1550.002 Identity: Developing Tenet 6: Credential Replay Detection Kerberos Monitoring IA-2, DE.CM 6.1, 8.11 A.5.17, A.8.16 IA-2, SI-4 8.2, 10.2 A07 T1558 Identity: Developing Tenet 6: Ticket Analysis DLL Injection Detection SI-3, DE.CM 10.1, 13.2 A.8.7 SI-3, SI-7 5.2, 11.5 N/A T1055 Devices: Developing Tenet 5: Injection Detection Browser Extension Monitoring DE.CM, CM-8 9.4, 16.1 A.8.1 CM-8, SI-4 6.5.4 N/A T1176 Apps: Developing Tenet 4: Extension Inventory Input Validation SI-10, PR.DS 13.10, 16.7 A.8.26 SI-10 6.5 A05 (Injection Prevention) T1659 Apps: Advanced Tenet 4: Boundary Checking SQL Injection Prevention SI-10, PR.PS 16.7 A.8.26, A.14.2 SI-10, SA-11 6.5.1 A05 N/A Apps: Advanced Tenet 4: Parameterized Queries XSS Prevention SI-10, PR.DS 9.2, 13.10 A.8.23, A.8.26 SI-10 6.5.7 A05 N/A Apps: Advanced Tenet 4: Output Encoding Command Injection Prevention SI-10, PR.PS 16.7 A.8.26 SI-10 6.5 A05 T1059 Apps: Advanced Tenet 4: Input Sanitization Secure Architecture PL-8, RA-3 12.2, 16.1 A.8.27, A.14.1 SA-8, SA-17, PL-8 6.4 A06 (Insecure Design) N/A Governance: Advanced Tenet 4: Security by Design Threat Modeling RA-3, PL-8 16.14, 18.1 A.14.1, A.14.2 SA-8, RA-3 6.3.1 A06 N/A Governance: Developing Tenet 4: Risk-Based Design Defense in Depth PR.IR, PL-8(1) 12.2, 13.4 A.8.27, A.13.1 SC-7, PL-8(1) 1.2 A06 N/A All Pillars: Advanced Tenet 1-7: Layered Security Change Control CM-3, PR.IP 4.1, 16.7, 18.1 A.8.32 CM-3, CM-3(2), CM-4, CM-5 6.4.5 A08 T1554 Automation: Advanced Tenet 5: Controlled Changes Code Signing SI-7, CM-14 2.3, 16.11 A.8.32 SI-7(6), CM-14 6.3.2 A08 T1553 Devices: Developing Tenet 5: Software Integrity Boundary Protection SC-7, PR.AC 12.1-12.4, 13.3 A.8.20, A.8.22 SC-7, SC-7(3)(4)(5)(8)(21) 1.2, 1.3 A01 N/A Networks: Advanced Tenet 2: Explicit Boundaries Process Isolation SC-39, PR.PS 4.8, 16.7 A.8.27 SC-39 6.4.3 N/A T1055 Apps: Advanced Tenet 4: Workload Isolation Capacity Management PR.IR-04, AU-4 12.4 (via 4.1) A.8.6 AU-4, AU-5(1), CP-2 12.1.3 N/A N/A Visibility: Advanced Tenet 7: Resource Monitoring Physical Security PR.AA-06, PE-2 11.1.1-11.2.9 A.7.1-A.7.14 PE-2, PE-3, PE-6, PE-9 9.1-9.6 N/A N/A N/A N/A Removable Media MP-7, PR.DS 11.2.5 A.7.10 MP-2, MP-4, MP-5, MP-7 9.6 N/A T1091, T1052 Devices: Advanced Tenet 5: Media Controls Remote Maintenance MA-4, AC-17 12.3 A.6.7 MA-4, MA-4(6), AC-17 8.3 N/A T1021 Identity: Advanced Tenet 2: Authenticated Maintenance Cloud Security PR.DS, DE.CM 15.1 A.5.23 SC-7, SC-8, SC-13, AC-17 12.8.1-12.8.5 N/A T1537 All Pillars: Advanced Tenet 2: Cloud-Agnostic Security Evidence Collection RS.AN-03, AU-9 17.1 A.5.28 AU-9, IR-4(4), AU-11 10.5, 12.10.4 N/A N/A Visibility: Advanced Tenet 7: Forensic Readiness Environment Separation PR.IP, CM-2(6) 16.8 A.8.31 CM-2(6), SC-7, CM-7 6.4.1 N/A N/A Networks: Advanced Tenet 2: Logical Isolation Error Handling SI-11, SC-24 16.7 A.8.26 SI-11, SC-24 6.5 A10 (Exception Handling) N/A Apps: Advanced Tenet 4: Fail Secure Fail-Secure Design SC-24, CP-10 12.1, 13.3 A.8.27 SC-24, CP-2 6.4 A10 (Fail Closed) N/A All Pillars: Advanced Tenet 4: Default Deny Resource Limits SC-5, SC-6 13.3 A.8.6 SC-5, SC-6 12.1.3 A10 (DoS Prevention) T1498, T1499 Apps: Advanced Tenet 4: Rate Limiting Service Health Monitoring SI-4, CP-10 8.6, 12.4 A.8.6, A.8.16 SI-4, AU-6, CP-10 10.6 A10 (Availability) T1489 Visibility: Advanced Tenet 7: Health Checks Penetration Testing CA-8, ID.RA-09 18.1-18.5 A.8.29 CA-8, RA-5(6) 11.3, 11.4 N/A All Tactics Governance: Developing Tenet 7: Validation Testing Secure Development PR.PS-02, SA-8 16.1-16.14 A.5.8, A.8.25-8.29 SA-3, SA-8, SA-11, CM-3(2) 6.5 A06, A08 N/A Governance: Advanced Tenet 4: SDLC Security Source Code Security CM-3, SA-10 16.11 A.8.4 CM-3, CM-5, SA-10 6.3.2 A08 N/A Governance: Developing Tenet 5: Code Integrity Supplier Management GV.SC-02 to GV.SC-05 15.1-15.7 A.5.19-5.22 SR-3, SR-6, SR-10, SR-11, SA-9 12.8 A03 T1195, T1199 Governance: Developing Tenet 5: Third-Party Risk Zero Trust - Identity PR.AA, IA-2 6.1-6.6 A.5.15-5.18 AC-2, AC-3, IA-2, IA-4 8.1, 8.2 A01, A07 T1078 Identity: Advanced Tenet 3: Identity as Perimeter Zero Trust - Device PR.AA, IA-3 1.1-1.5 A.8.1 IA-3, CM-8 2.4 N/A N/A Devices: Advanced Tenet 5: Device Trust Zero Trust - Network SC-7, PR.AC 12.1-12.4, 13.4 A.8.20, A.8.22 SC-7, SC-7(4)(5)(21) 1.1-1.4 A01, A06 N/A Networks: Advanced Tenet 2: Never Trust Location Zero Trust - Application PR.PS, SA-8 16.1-16.14 A.8.25-8.27 SA-8, SA-17, SC-39 6.4, 6.5 A06 N/A Apps: Advanced Tenet 4: Context-Aware Access Zero Trust - Data PR.DS, SC-28 3.1-3.14 A.5.12, A.5.14, A.8.24 SC-28, MP-3, MP-4 3.1-3.7 A04 N/A Data: Advanced Tenet 2: Data-Centric Security Zero Trust - Visibility DE.CM, AU-6 8.1-8.11, 13.6 A.8.15, A.8.16 AU-2, AU-6, SI-4 10.2-10.6 A09 All Tactics Visibility: Advanced Tenet 7: Full Observability Zero Trust - Automation RS.MA, IR-4(1) 17.1-17.9 A.5.24-5.27 IR-4(1), IR-5(1) 12.10 N/A All Tactics Automation: Advanced Tenet 6: Dynamic Policies Privileged Access Management AC-6, PR.AA 5.4, 6.5 A.8.2, A.8.18 AC-2(7), AC-6, AC-6(1)(5)(9) 7.1, 7.2 A01 T1078, T1134 Identity: Advanced Tenet 3: JIT/PIM API Security IA-5, SC-8 16.7 A.8.26, A.14.1 SC-8, SI-10, IA-5 6.5, 6.6 A01, A05 N/A Apps: Advanced Tenet 4: API Gateway Database Security SC-28, AC-3 3.11, 6.1 A.8.24, A.9.2 SC-28, AC-3 3.4, 8.2 A05 T1213.006 Data: Advanced Tenet 4: Query Monitoring Wireless Security SC-40, AC-18 12.6 A.8.21 AC-18, SC-40 4.1.1 N/A N/A Networks: Advanced Tenet 2: Wireless Segmentation Email Security SC-7, SI-8 9.1-9.7 A.8.23 SC-7, SI-8 12.3 N/A T1566 Apps: Advanced Tenet 4: Email Gateway Mobile Device Security AC-19, SC-7 4.10-4.12 A.6.7, A.8.1 AC-19, SC-43 8.2.3, 9.6 N/A N/A Devices: Developing Tenet 5: MDM/MAM Endpoint Protection SI-3, DE.CM 10.1-10.7, 13.2 A.8.7 SI-3, SI-4(23) 5.1, 5.2 N/A T1204, T1566 Devices: Advanced Tenet 5: EDR Coverage Account Lifecycle AC-2, PR.AA 5.1-5.6 A.5.16, A.9.2 AC-2, AC-2(1)(3)(4) 8.1.2-8.1.4 A07 T1136, T1098 Identity: Advanced Tenet 3: Automated Provisioning Privileged Session Recording AU-12, AC-6(9) 8.11, 6.5 A.8.18 AU-12, AC-6(9) 10.2.2 N/A T1078 Identity: Advanced Tenet 3: Session Audit Security Awareness Training AT-2, PR.AT 14.1-14.9 A.6.3 AT-2, AT-3 12.6 N/A T1204, T1566 N/A N/A Incident Classification IR-4, RS.AN 17.4 A.5.25 IR-4, IR-5 12.10.1 N/A All Tactics Automation: Advanced Tenet 6: Automated Triage Forensic Analysis IR-4(4), RS.AN 17.1 A.5.28 IR-4(4), AU-9 12.10.4 N/A All Tactics Visibility: Advanced Tenet 7: Evidence Preservation Communication Security SC-8, PR.DS 3.10, 13.10 A.8.24 SC-8, SC-13 4.2 A04 N/A Data: Advanced Tenet 2: Encrypted Channels Third-Party Risk GV.SC, SR-3 15.1-15.7 A.5.19-5.22 SR-3, SR-5, SR-6 12.8 A03 T1195, T1199 Governance: Developing Tenet 5: Vendor Assessment Compliance Monitoring CA-7, GV.PO 18.1-18.5 A.5.36 CA-7, PM-9 12.11 N/A N/A Governance: Advanced Tenet 7: Continuous Compliance Risk Assessment RA-3, ID.RA 7.1, 18.1 A.5.7, A.8.8 RA-3, RA-5 12.2 N/A N/A Governance: Advanced Tenet 4: Risk-Based Decisions Security Metrics GV.OV, PM-9 17.9, 18.1 A.5.27 PM-9, CA-7(3) 12.11 N/A N/A Governance: Advanced Tenet 7: Performance Tracking Policy Management GV.PO, PL-1 4.1, 18.1 A.5.1, A.5.36 PL-1, PM-1 12.1 N/A N/A Governance: Advanced Tenet 4: Policy Automation Disaster Recovery RC.RP, CP-10 11.1-11.5 A.5.29, A.5.30, A.17.1 CP-10, CP-2 12.10.1 N/A N/A Data: Advanced Tenet 7: DR Testing Service Continuity RC.HL, CP-2 11.1-11.5 A.5.29, A.17.1 CP-2, CP-6, CP-7 12.10 N/A T1498, T1499 Apps: Advanced Tenet 7: HA Architecture Data Retention PR.DS, MP-6 3.4, 8.10 A.5.33 MP-6, SI-12 3.1, 10.7 N/A N/A Data: Advanced Tenet 4: Lifecycle Management Secure Disposal MP-6, PR.IR 3.5, 11.2.7 A.5.14, A.7.14 MP-6, SR-12 9.8 N/A N/A Data: Advanced Tenet 4: Data Sanitization Audit Trail Integrity AU-9, SI-7 8.9, 10.1 A.8.15 AU-9, SI-7 10.5 A09 T1070 Visibility: Advanced Tenet 7: Tamper-Proof Logs Non-Repudiation AU-10, SI-7 8.5 A.8.15 AU-10, SC-17 10.3.4 A08 N/A Visibility: Advanced Tenet 7: Digital Signatures Trusted Computing SI-7, SC-34 N/A A.8.24 SI-7, SC-34 N/A N/A N/A Devices: Developing Tenet 5: Hardware Root of Trust Virtualization Security SC-44, CM-7 N/A A.8.27 SC-44, SC-39 6.4.3 N/A T1611 Apps: Advanced Tenet 4: Hypervisor Isolation Container Orchestration CM-7, SC-39 16.1-16.14 A.8.27 SC-39, CM-7 6.4.3 N/A T1610, T1611 Apps: Developing Tenet 4: K8s Security Microservices Security SC-7, SA-8 16.1 A.8.27 SC-7(21), SA-8 6.4 A06 N/A Apps: Advanced Tenet 4: Service Mesh DevSecOps SA-10, PR.PS 16.1-16.14, 18.1 A.5.8, A.8.25 SA-10, SA-11 6.5 A08 N/A Governance: Developing Tenet 4: Pipeline Security Secrets Rotation IA-5, SC-12 6.7 A.8.24 IA-5, SC-12 8.3.2 A07 T1552 Identity: Advanced Tenet 6: Automated Rotation Certificate Lifecycle SC-17, IA-5(14) 3.12 A.8.24 SC-17, IA-5(14) 4.2.1 A04 N/A Identity: Advanced Tenet 6: ACME Automation Vulnerability Disclosure RA-5, PM-16 7.1, 16.2 A.5.7 RA-5, PM-16 11.3.1 A03 N/A Governance: Advanced Tenet 7: Coordinated Disclosure Security Orchestration IR-4(1), RS.MA 17.1-17.9 A.5.24-5.27 IR-4(1), IR-8 12.10 N/A All Tactics Automation: Advanced Tenet 6: SOAR Platform Behavioral Analytics AU-6, SI-4(18) 8.11, 13.6 A.8.16 AU-6(5), SI-4(18) 10.6 A09 All Tactics Visibility: Developing Tenet 7: UEBA/ML Anomaly Detection SI-4, DE.AE 13.6 A.8.16 SI-4(2), SI-4(18) 10.6, 11.4 A09 All Tactics Visibility: Advanced Tenet 7: Baseline Deviation Deception Technology SI-4, DE.CM 13.1 A.8.16 SI-4 11.4 N/A All Tactics Visibility: Developing Tenet 7: Honeypots/Honeynets Security Data Lake AU-6, DE.CM 8.9, 13.6 A.8.15 AU-6, AU-12 10.2 A09 N/A Visibility: Advanced Tenet 7: Centralized Repository SIEM/SOAR Integration AU-6(1), IR-4(1) 8.11, 17.1 A.8.16, A.5.24 AU-6(1)(3), IR-4(1) 10.6, 12.10 A09 All Tactics Automation: Advanced Tenet 6+7: Orchestrated Response Threat Modeling Automation RA-3, SA-8 16.14 A.14.1 RA-3, SA-8 6.3.1 A06 N/A Governance: Developing Tenet 4: Continuous Modeling Security Posture Management CA-7, GV.OV 4.1, 18.1 A.5.36, A.8.9 CA-7, PM-9 12.11 A02 N/A Governance: Advanced Tenet 7: CSPM/CWPP Attack Surface Management RA-3, ID.AM 1.1-1.5, 18.1 A.5.9, A.8.8 RA-3, RA-5 11.3.1 N/A T1595, T1596 Devices: Advanced Tenet 1: External Exposure <p>Legend:</p> <ul> <li>N/A = Not Applicable or No Direct Mapping</li> <li>All Tactics = Relevant to Multiple MITRE ATT&amp;CK Tactics (TA0001-TA0040)</li> <li>Developing = Maturity stage below Advanced with identified implementation gaps</li> <li>Advanced = Full implementation with automation and integration</li> </ul>"},{"location":"projects/homelab/grc/01-summary/#framework-coverage-summary","title":"Framework Coverage Summary","text":"<ul> <li>NIST CSF 2.0: 100% of security domains mapped to Functions (Govern, Identify, Protect, Detect, Respond, Recover)</li> <li>CIS Controls v8.1: 98% of applicable controls mapped (159 safeguards across 18 controls)</li> <li>ISO 27001:2022: 97% of applicable Annex A controls mapped (93 controls across 4 families)</li> <li>NIST 800-53 Rev 5: 95% of implemented controls mapped (18 control families)</li> <li>PCI-DSS v4.0: 85% conceptual alignment (technical controls fully implemented)</li> <li>OWASP Top 10 (2025): 90% of categories directly addressed (9 of 10 strong coverage)</li> <li>MITRE ATT&amp;CK v18.1: 30% technique coverage (65 of 216 techniques across 12 tactics)</li> <li>CISA ZTMM v2.0: Advanced maturity across 6 of 8 pillars (Identity, Devices, Networks, Applications, Data, Visibility/Analytics)</li> <li>NIST SP 800-207: Comprehensive implementation of all 7 Zero Trust tenets at Advanced level</li> </ul> <p>This comprehensive alignment matrix demonstrates defense-in-depth implementation across nine major cybersecurity frameworks, providing a unified view of security control coverage across traditional security controls and modern Zero Trust Architecture principles. The matrix facilitates gap analysis, compliance reporting, strategic security planning, and demonstrates progression toward Optimal Zero Trust maturity.</p>"},{"location":"projects/homelab/grc/grc-cis-controls/","title":"CIS Critical Security Controls v8.1","text":"<p>Document Control:  Version: 1.0 Last Updated: January 2026 Owner: Paul Leone </p> <p>Framework Version: CIS Controls v8.1</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-1-inventory-and-control-of-enterprise-assets","title":"CIS Control 1: Inventory and Control of Enterprise Assets","text":"Safeguard Requirement Implementation Notes 1.1 Establish and maintain detailed enterprise asset inventory External Excel Inventory, Checkmk inventory, Wazuh agent inventory (25+ endpoints), Prometheus node exporters, PatchMon tracking (30+ hosts), DNS records, SSH host keys in Ansible Compliant - Multiple sources provide comprehensive coverage 1.2 Address unauthorized assets weekly Partial - NetalertX network discovery identifies unknown devices; no documented weekly review process Gap: Need documented weekly unauthorized asset review procedure 1.3 Utilize an active discovery tool (IG2) NetalertX network discovery, nmap scans, custom Python scanner Compliant - Active scanning implemented 1.4 Use DHCP logging to update inventory (IG2) Asus Router DHCP logs (192.168.1.0/24) + pfSense DHCP logs (192.168.100.0/24) forwarded to Splunk/Elastic Compliant - DHCP logging centralized 1.5 Use passive asset discovery tool (IG3) Passive network monitoring via Suricata/pfSense flow logs Compliant - Passive discovery via traffic analysis <p>Control 1 Overall Status: Compliant (minor process documentation gap in 1.2)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-2-inventory-and-control-of-software-assets","title":"CIS Control 2: Inventory and Control of Software Assets","text":"Safeguard Requirement Implementation Notes 2.1 Establish and maintain software inventory External Excel Inventory, PatchMon Software Inventory (5,000+ packages), Checkmk inventory, Nessus software scanning, Wazuh agent software tracking Compliant - Multi-source software inventory 2.2 Ensure authorized software is currently supported PatchMon tracks EOL software; vulnerability scanners flag unsupported versions; documented exceptions for necessary legacy software Compliant - Supported software validation process 2.3 Address unauthorized software monthly N/A - Single-user lab environment N/A 2.4 Utilize automated software inventory tools (IG2) PatchMon agent-based inventory, Checkmk, Wazuh software tracking, Nessus authenticated scans Compliant - Automated discovery 2.5 Allowlist authorized software (IG2) Not Implemented - No application allowlisting solution deployed Gap: Implement AppLocker, Windows Defender Application Control, or CrowdSec allowlisting 2.6 Allowlist authorized libraries (IG2) Not Implemented - No DLL/library allowlisting Gap: IG2 requirement not addressed 2.7 Allowlist authorized scripts (IG3) Not Implemented - No script execution control (PowerShell Constrained Language Mode, etc.) Gap: IG3 requirement not addressed <p>Control 2 Overall Status: Partially Compliant (IG1 fully compliant; IG2/IG3 gaps in allowlisting)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-3-data-protection","title":"CIS Control 3: Data Protection","text":"Safeguard Requirement Implementation Notes 3.1 Establish and maintain a data management process Documented in GRC document; data classification, retention, disposal procedures defined Compliant 3.2 Establish and maintain data inventory Sensitive data tracked in inventory; backup data cataloged; scan credentials documented Compliant 3.3 Configure data access control lists File system ACLs; SSH key-based access; database access controls; Authentik RBAC Compliant 3.4 Enforce data retention 90-day log retention; backup retention policies; automated cleanup Compliant 3.5 Securely dispose of data Secure deletion procedures; encrypted backup disposal; NIST SP 800-88 alignment Compliant 3.6 Encrypt data on end-user devices Windows BitLocker, Linux LUKS, encrypted laptop drives Compliant 3.7 Establish data classification scheme (IG2) Sensitive/Confidential/Public labels used in documentation Compliant 3.8 Document data flows (IG2) Partial - Network architecture documented; full data flow diagrams not comprehensive Gap: Create detailed data flow diagrams 3.9 Encrypt data on removable media (IG2) USB drives encrypted; backup tapes encrypted Compliant 3.10 Encrypt sensitive data in transit (IG2) TLS 1.3 (Traefik), SSH encryption, syslog-ng TLS, VPN encryption Compliant 3.11 Encrypt sensitive data at rest (IG2) Encrypted backups, database encryption, scan credential encryption Compliant 3.12 Segment data processing based on sensitivity (IG2) VLAN segmentation; backend isolation (Traefik); network segmentation Compliant 3.13 Deploy Data Loss Prevention solution (IG3) Not Implemented - No DLP solution deployed Gap: IG3 requirement (acceptable for homelab) 3.14 Log sensitive data access (IG3) Partial - File access logged via Wazuh FIM; database query logging not comprehensive Gap: Enhanced database audit logging <p>Control 3 Overall Status: IG1/IG2 Compliant; IG3 Partial (DLP not applicable to homelab)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-4-secure-configuration-of-enterprise-assets-and-software","title":"CIS Control 4: Secure Configuration of Enterprise Assets and Software","text":"Safeguard Requirement Implementation Notes 4.1 Establish and maintain secure configuration process CIS Benchmark audits via Wazuh; configuration drift detection; automated remediation via Ansible; Ansible baselines; IaC version control. Not Implemented - documented secure configuration process (policy document) Action Required: Create formal secure configuration policy document 4.2 Establish secure configuration process for network infrastructure Network device hardening standards documented; SSH hardening policy; firewall rule standards Compliant 4.3 Configure automatic session locking 15-min timeout (general OS); 2-min timeout (mobile devices); enforced via GPO/Ansible Compliant 4.4 Implement firewall on servers UFW (Linux), Windows Firewall, iptables rules managed via Ansible Compliant 4.5 Implement firewall on end-user devices Host-based firewalls enabled on all endpoints; default-deny ruleset Compliant 4.6 Securely manage enterprise assets SSH key-based admin access; IaC version control (Git); HTTPS-only management interfaces Compliant 4.7 Manage default accounts Root login disabled (SSH); default vendor accounts removed; validated via Nessus scans Compliant 4.8 Uninstall unnecessary services (IG2) Minimal service footprint; unnecessary services disabled; verified via authenticated scans Compliant 4.9 Configure trusted DNS servers (IG2) Enterprise-controlled DNS (Pi-hole, Unbound); DNSSEC validation Compliant 4.10 Enforce automatic lockout on portable devices (IG2) Failed auth lockout (laptops: 20 attempts; mobile: 10 attempts) via GPO/MDM Compliant 4.11 Enforce remote wipe capability (IG2) Not Implemented - Mobile device wipe capability via planned MDM; laptops rely on full-disk encryption Gap: Implement remote wipe for laptops (BitLocker recovery key escrowing) 4.12 Separate enterprise workspaces on mobile devices (IG3) Not Implemented - No Android Work Profile/iOS Managed App separation Gap: IG3 mobile device management <p>Control 4 Overall Status: Needs Process Documentation (4.1 critical)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-5-account-management","title":"CIS Control 5: Account Management","text":"Safeguard Requirement Implementation Notes 5.1 Establish and maintain account inventory Authentik user database, Active Directory accounts, SSH key inventory (Ansible), Wazuh user tracking Compliant 5.2 Use unique passwords Vaultwarden password manager; 8-char minimum (MFA accounts); 14-char minimum (non-MFA) Compliant - Exceeds CIS recommendations 5.3 Disable dormant accounts after 45 days Automated via Active Directory account expiration policies; Authentik account lifecycle management Compliant 5.4 Restrict admin privileges to dedicated accounts Separate admin accounts (no dual-use); SSH sudo enforcement; Authentik RBAC Compliant 5.5 Establish service account inventory (IG2) Service accounts documented in inventory; ownership tracked; quarterly reviews Compliant 5.6 Centralize account management (IG2) Authentik SSO + Active Directory; centralized SSH key management (Ansible) Compliant <p>Control 5 Overall Status: Fully Compliant</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-6-access-control-management","title":"CIS Control 6: Access Control Management","text":"Safeguard Requirement Implementation Notes 6.1 Establish access granting process Documented onboarding procedures; Authentik provisioning; SSH key distribution workflow Compliant 6.2 Establish access revocation process Offboarding checklist; Authentik account deactivation; SSH key revocation (Ansible); Wazuh Active Response Compliant 6.3 Require MFA for externally-exposed applications Authentik enforces MFA via TOTP; all external services require MFA Compliant 6.4 Require MFA for remote network access VPN (Tailscale) requires device authentication; SSH keys + optional passphrase Compliant 6.5 Require MFA for administrative access 100% admin accounts require Authentik MFA; SSH key-based auth for privileged access Compliant 6.6 Establish authentication/authorization system inventory (IG2) Authentik, Active Directory, SSH key infrastructure documented; annual review Compliant 6.7 Centralize access control (IG2) Authentik SSO for Traefik-routed services; Active Directory domain authentication Compliant 6.8 Define and maintain role-based access control (IG3) Not Implemented - Requires enterprise-wide RBAC documentation (access rights per role for all systems) Action Required: Document RBAC policies for all enterprise systems (AD groups, Authentik roles, SSH sudo policies) <p>Control 6 Overall Status: Mostly Compliant; 6.8 needs broader RBAC documentation</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-7-continuous-vulnerability-management","title":"CIS Control 7: Continuous Vulnerability Management","text":"Safeguard Requirement Implementation Notes 7.1 Establish vulnerability management process Documented dual-scanner approach (OpenVAS + Nessus); remediation SLAs; CVSS prioritization Compliant 7.2 Establish remediation process Risk-based remediation strategy; documented SLAs; monthly reviews; TheHive tracking Compliant 7.3 Perform automated OS patch management PatchMon (Linux), WSUS (Windows), monthly cadence; automated approvals Compliant - Exceeds monthly requirement 7.4 Perform automated application patch management Watchtower (containers), WUD monitoring, monthly cadence Compliant 7.5 Perform automated vulnerability scans - internal (IG2) Weekly OpenVAS (52/year); monthly Nessus authenticated scans (12/year) Compliant - Exceeds quarterly requirement 7.6 Perform automated vulnerability scans - external (IG2) Monthly Nessus scans of externally-exposed assets; OpenVAS external scans Compliant 7.7 Remediate detected vulnerabilities (IG2) MTTR &lt;72h (Critical); &lt;7 days (High); 95% patched within SLA; verification scans Compliant <p>Control 7 Overall Status: Fully Compliant - Exceeds industry standards</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-8-audit-log-management","title":"CIS Control 8: Audit Log Management","text":"Safeguard Requirement Implementation Notes 8.1 Establish audit log management process Documented logging policy; 90-day retention; centralized SIEM; review procedures Compliant 8.2 Collect audit logs 100% security event coverage (DNS, SSH, Traefik, vulnerability scans, patches, Wazuh, Sysmon) Compliant 8.3 Ensure adequate log storage SIEM storage capacity planning; immutable indexes; compressed archival Compliant 8.4 Standardize time synchronization (IG2) NTP sync across all assets; centralized time sources Compliant 8.5 Collect detailed audit logs (IG2) Logs include timestamp, user, source IP, action, result, SSH key fingerprints, DNS query details Compliant 8.6 Collect DNS query logs (IG2) Pi-hole query logs; Unbound logs; Bind9 query logging; forwarded to SIEM Compliant 8.7 Collect URL request logs (IG2) Traefik access logs (JSON format); proxy logs; forwarded to SIEM Compliant 8.8 Collect command-line logs (IG2) Sysmon Event ID 1 (process creation); PowerShell logging; Bash history; Wazuh command monitoring Compliant 8.9 Centralize audit logs (IG2) Dual SIEM (Splunk + Elastic); syslog-ng encrypted forwarding; centralized storage Compliant 8.10 Retain audit logs 90 days minimum (IG2) 90-day retention policy; immutable SIEM indexes Compliant 8.11 Conduct audit log reviews weekly (IG2) Splunk dashboards; Wazuh alerts; weekly correlation searches; automated reviews Compliant 8.12 Collect service provider logs (IG3) Partial - Cloud service logs collected where available; not comprehensive across all SaaS platforms Gap: Document which SaaS platforms provide logs <p>Control 8 Overall Status: Fully Compliant (IG1/IG2); IG3 Partial (limited by SaaS provider capabilities)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-9-email-and-web-browser-protections","title":"CIS Control 9: Email and Web Browser Protections","text":"Safeguard Requirement Implementation Notes 9.1 Ensure only fully supported browsers/email clients Latest browser versions enforced; unsupported clients blocked; automated update verification Compliant 9.2 Use DNS filtering services Pi-hole DNS filtering (2M+ blocked domains); malware/phishing domain blocking Compliant 9.3 Maintain network-based URL filters (IG2) Traefik URL filtering; SafeLine WAF; category-based blocking; reputation filtering Compliant 9.4 Restrict browser/email extensions (IG2) Partial - GPO restricts extensions on managed Windows devices; Linux/personal devices rely on user compliance Gap: Enforce extension restrictions across all platforms 9.5 Implement DMARC (IG2) DMARC policy published; SPF + DKIM implemented for outbound mail Compliant 9.6 Block unnecessary file types (IG2) Partial - Email gateway blocks .exe/.scr/.bat attachments; not comprehensive Gap: Expand blocked file type list 9.7 Deploy email server anti-malware (IG3) Not Implemented - No dedicated email gateway anti-malware (homelab uses external email providers) Gap: IG3 requirement (not applicable - no on-prem email server) <p>Control 9 Overall Status: IG1 Compliant; IG2 Partial; IG3 N/A (no on-prem email)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-10-malware-defenses","title":"CIS Control 10: Malware Defenses","text":"Safeguard Requirement Implementation Notes 10.1 Deploy and maintain anti-malware software Wazuh FIM + VirusTotal integration; ClamAV; Microsoft Defender; rootkit detection Compliant 10.2 Configure automatic anti-malware signature updates Automated signature updates (daily); ClamAV freshclam; Defender definition updates Compliant 10.3 Disable autorun/autoplay for removable media GPO disables autorun; Linux udev rules block autoplay; verified compliance Compliant 10.4 Configure automatic scanning of removable media (IG2) Wazuh FIM monitors USB insertions; ClamAV on-access scanning Compliant 10.5 Enable anti-exploitation features (IG2) Windows DEP/WDEG enabled; Linux ASLR/PIE; macOS SIP/Gatekeeper Compliant 10.6 Centrally manage anti-malware software (IG2) Wazuh central management; Group Policy for Windows Defender; centralized config Compliant 10.7 Use behavior-based anti-malware (IG2) Wazuh behavioral analysis; Windows Defender behavior monitoring; Suricata IDS behavioral detection Compliant <p>Control 10 Overall Status: Fully Compliant</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-11-data-recovery","title":"CIS Control 11: Data Recovery","text":"Safeguard Requirement Implementation Notes 11.1 Establish and maintain data recovery process Documented backup procedures; restore workflows; recovery prioritization; annual reviews Compliant 11.2 Perform automated backups Proxmox automated backups (bi-weekly); Docker volume backups; database backups; weekly cadence Compliant 11.3 Protect recovery data Encrypted backups (AES-256); offsite storage; access controls; encrypted transmission Compliant 11.4 Establish isolated instance of recovery data Offsite backups (cloud + offline USB); air-gapped backup copies; versioned backups Compliant 11.5 Test data recovery (IG2) Quarterly restore testing; documented test results; validation procedures Compliant <p>Control 11 Overall Status: Fully Compliant</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-12-network-infrastructure-management","title":"CIS Control 12: Network Infrastructure Management","text":"Safeguard Requirement Implementation Notes 12.1 Ensure network infrastructure is up-to-date Network device patch management; monthly version checks; automated update notifications Compliant 12.2 Establish secure network architecture (IG2) Documented network architecture; segmentation design; least-privilege network design Compliant 12.3 Securely manage network infrastructure (IG2) SSH key-based management; HTTPS-only interfaces; IaC version control (Git) Compliant 12.4 Establish architecture diagrams (IG2) Network topology diagrams; Subnet/VLAN documentation; NetAlertX Networking mapping Compliant 12.5 Centralize network AAA (IG2) Not Implemented -- Lab does not have a dedicated AAA service deployed Gap: implement AAA service 12.6 Use secure network protocols (IG2) 802.1X port security (planned); WPA3 wireless; TLS 1.3; SSH v2 only Compliant 12.7 Ensure remote devices use VPN + AAA (IG2) Tailscale mesh VPN requires device authentication; Cloudflare Tunnels; no direct internet exposure Compliant 12.8 Establish dedicated admin workstations (IG3) Partial - Dedicated admin VM; not fully air-gapped from internet Gap: Implement fully isolated admin workstation <p>Control 12 Overall Status: IG1/IG2 Compliant; IG3 Partial</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-13-network-monitoring-and-defense","title":"CIS Control 13: Network Monitoring and Defense","text":"Safeguard Requirement Implementation Notes 13.1 Centralize security event alerting (IG2) Dual SIEM (Splunk + Elastic); TheHive case management; Discord/email alerting Compliant 13.2 Deploy host-based IDS (IG2) Wazuh EDR on 25+ endpoints; FIM monitoring; rootkit detection; process monitoring Compliant 13.3 Deploy network IDS (IG2) Suricata (IPS inline); Snort (IDS passive); CrowdSec (behavioral) Compliant 13.4 Perform traffic filtering between segments (IG2) pfSense/OPNsense inter-VLAN ACLs; firewall rules per segment; default-deny policies Compliant 13.5 Manage access control for remote assets (IG2) NAC principles applied; Tailscale device posture checks; Wazuh agent compliance verification Compliant 13.6 Collect network traffic flow logs (IG2) pfSense/OPNsense flow logs; Suricata EVE JSON; packet captures (tcpdump); SIEM ingestion Compliant 13.7 Deploy host-based IPS (IG3) Wazuh Active Response (firewall-drop, host-deny); EDR blocking capabilities Compliant 13.8 Deploy network IPS (IG3) Suricata inline blocking mode; CrowdSec automated firewall rules; pfSense IPS integration Compliant 13.9 Deploy port-level access control (IG3) Not Implemented -- Network switching replacement required; currently using MAC filtering + admin VLAN segmentation Gap: Implement 802.1X NAC 13.10 Perform application layer filtering (IG3) SafeLine WAF (OWASP CRS rules); Traefik middleware filtering; NGINX Ingress rules Compliant 13.11 Tune security event alerting thresholds (IG3) Monthly tuning of Splunk/Wazuh/Suricata thresholds; false positive reduction tracking Compliant <p>Control 13 Overall Status: IG2 Fully Compliant; IG3 Mostly Compliant (802.1X gap)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-14-security-awareness-and-skills-training","title":"CIS Control 14: Security Awareness and Skills Training","text":"Safeguard Requirement Implementation Notes 14.1 Establish security awareness program N/A - Single-user lab environment N/A 14.2 Train workforce on social engineering N/A - Single-user lab environment N/A 14.3 Train workforce on authentication best practices N/A - Single-user lab environment N/A 14.4 Train workforce on data handling N/A - Single-user lab environment N/A 14.5 Train workforce on unintentional data exposure N/A - Single-user lab environment N/A 14.6 Train workforce on incident recognition/reporting N/A - Single-user lab environment N/A 14.7 Train workforce on identifying missing security updates N/A - Single-user lab environment N/A 14.8 Train workforce on insecure network dangers N/A - Single-user lab environment N/A 14.9 Conduct role-specific security training (IG2) N/A - Single-user lab environment hands-on lab work; no formal certification program N/A <p>Control 14 Overall Status: Limited Applicability (single-user homelab)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-15-service-provider-management","title":"CIS Control 15: Service Provider Management","text":"Safeguard Requirement Implementation Notes 15.1 Establish service provider inventory Cloud providers documented (Cloudflare, Tailscale, etc.) Compliant 15.2 Establish service provider management policy (IG2) N/A - Single-user lab environment N/A 15.3 Classify service providers (IG2) N/A - Single-user lab environment N/A 15.4 Ensure contracts include security requirements (IG2) N/A - Single-user lab environment N/A 15.5 Assess service providers (IG3) N/A - Single-user lab environment N/A 15.6 Monitor service providers (IG3) N/A - Single-user lab environment N/A 15.7 Securely decommission service providers (IG3) N/A - Single-user lab environment N/A <p>Control 15 Overall Status: Limited Applicability (single-user homelab)</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-16-application-software-security","title":"CIS Control 16: Application Software Security","text":"Safeguard Requirement Implementation Notes 16.1 Establish secure application development process (IG2) Informal - IaC follows security best practices; no formal SDLC documentation Gap: Document secure development lifecycle 16.2 Establish vulnerability disclosure process (IG2) N/A - Single-user lab environment N/A 16.3 Perform root cause analysis on vulnerabilities (IG2) Informal - Post-incident reviews conducted; no formal RCA process Gap: Document RCA procedures 16.4 Establish third-party software component inventory (IG2) Partial - Docker images tracked; no comprehensive SBOM tracking Gap: Implement SBOM tracking (Trivy/Grype) 16.5 Use up-to-date third-party components (IG2) Watchtower auto-updates; WUD monitoring; trusted sources (official Docker images; maintained OSS projects) Compliant 16.6 Establish vulnerability severity rating system (IG2) CVSS scoring; risk-based prioritization; documented remediation SLAs Compliant 16.7 Use standard hardening templates (IG2) CIS Benchmarks for application infrastructure; IaC templates (Ansible/Terraform); documented configurations Compliant 16.8 Separate production/non-production systems (IG2) N/A - Single-user lab environment N/A 16.9 Train developers in secure coding (IG2) N/A - Single-user lab environment N/A 16.10 Apply secure design principles (IG2) Least privilege; input validation; defense-in-depth architecture; secure defaults Compliant 16.11 Leverage vetted security modules (IG2) Authentik (IAM); Step-CA (PKI); Traefik (reverse proxy); trusted open-source security libraries Compliant 16.12 Implement code-level security checks (IG3) Limited - Infrastructure code linting (Ansible-lint/Terraform validate); no comprehensive SAST/DAST Gap: Implement SAST/DAST scanning 16.13 Conduct application penetration testing (IG3) Informal - Vulnerability scanning covers web apps; Kali/Parrot OS Pen testing Gap: Formal pen testing (IG3) 16.14 Conduct threat modeling (IG3) Informal - Security architecture design considers threats; no formal STRIDE/DREAD modeling Gap: Document threat models (IG3) <p>Control 16 Overall Status: IG2 Mostly Compliant (infrastructure focus, not software development); IG3 Partial</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-17-incident-response-management","title":"CIS Control 17: Incident Response Management","text":"Safeguard Requirement Implementation Notes 17.1 Designate incident handling personnel N/A - Single-user lab environment N/A 17.2 Establish contact information for reporting Discord channels; SMTP relay; Cloudflare email routing Compliant 17.3 Establish enterprise incident reporting process TheHive case creation process; reporting timeframes defined; multi-channel reporting (Discord, email, API) Compliant 17.4 Establish incident response process (IG2) Documented IR plan; TheHive playbooks Compliant 17.5 Assign key roles and responsibilities (IG2) N/A - Single-user lab environment N/A 17.6 Define communication mechanisms (IG2) Primary: Discord; Secondary: SMTP/Cloudflare email routing; multi-path redundancy Compliant 17.7 Conduct routine IR exercises (IG2) N/A - Single-user lab environment N/A 17.8 Conduct post-incident reviews (IG2) N/A - Single-user lab environment N/A 17.9 Establish incident thresholds (IG3) Severity matrix documented; CVSS thresholds; Splunk alert severities; MISP threat levels; Prometheus thresholds Compliant <p>Control 17 Overall Status: Mostly Compliant; Minor Gap in formal exercise scheduling</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#cis-control-18-penetration-testing","title":"CIS Control 18: Penetration Testing","text":"Safeguard Requirement Implementation Notes 18.1 Establish penetration testing program (IG2) Informal - Vulnerability scanning exceeds pen testing frequency; no formal pen testing engagement Gap: Document formal pen testing program 18.2 Perform external penetration tests annually (IG2) Informal - Weekly OpenVAS/monthly Nessus scans provide partial coverage; no dedicated external pen test Gap: Conduct formal external pen test 18.3 Remediate penetration test findings (IG2) Vulnerability remediation process covers pen test findings; documented remediation workflows Compliant - Process exists 18.4 Validate security measures post-test (IG3) Informal - Re-scanning validates remediation; no formal security control validation Gap: Post-remediation validation testing 18.5 Perform internal penetration tests annually (IG3) Informal -- No formal internal pen testing. Local scanning, enumeration and vulnerability testing. Gap: IG3 requirement <p>Control 18 Overall Status: IG2 Partial (vulnerability scanning substitutes for pen testing); IG3 Not Implemented</p>"},{"location":"projects/homelab/grc/grc-cis-controls/#summary-of-compliance-status","title":"Summary of Compliance Status","text":""},{"location":"projects/homelab/grc/grc-cis-controls/#overall-cis-controls-v812-compliance","title":"Overall CIS Controls v8.1.2 Compliance","text":"Implementation Group Controls Fully Compliant Controls Partially Compliant Controls Not Implemented Overall Score IG1 (56 safeguards) 52 (93%) 4 (7%) 0 (0%) 93% Compliant IG2 (74 additional safeguards) 60 (81%) 12 (16%) 2 (3%) 81% Compliant IG3 (29 additional safeguards) 15 (52%) 8 (28%) 6 (20%) 52% Compliant"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/","title":"CISA Zero Trust Maturity Model v2.0","text":"<p>Document Control: Version: 1.0 Last Updated: January 2026 Owner: Paul Leone  </p> <p>Framework Version: 2.0</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#zero-trust-architecture-implementation-overview","title":"Zero Trust Architecture Implementation Overview","text":"<p>This cybersecurity lab demonstrates comprehensive Zero Trust Architecture (ZTA) principles aligned with NIST SP 800-207 and CISA Zero Trust Maturity Model v2.0. The implementation achieves Advanced maturity (Stage 3 of 4) across core Zero Trust pillars through explicit verification of every access request, least-privilege enforcement via RBAC, assume-breach mentality with continuous monitoring, and encrypt-everything policies using modern cryptographic standards.</p> <p>CISA Zero Trust Maturity Level: Advanced (Stage 3 of 4)</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#cisa-zero-trust-maturity-model-v20-alignment","title":"CISA Zero Trust Maturity Model v2.0 Alignment","text":"<p>The CISA ZTMM defines four maturity stages across five core pillars (Identity, Devices, Networks, Applications and Workloads, Data) with three cross-cutting capabilities (Visibility and Analytics, Automation and Orchestration, Governance). This lab demonstrates Advanced-stage implementation across all pillars with targeted progression toward Optimal maturity.</p> <p>Maturity Stage Definitions:</p> <ul> <li>Traditional: Manual configurations, static policies, siloed enforcement, limited correlation</li> <li>Initial: Starting automation, cross-pillar integration, aggregated visibility, responsive least privilege</li> <li>Advanced: Automated controls, centralized visibility, cross-pillar coordination, risk-based least privilege, pre-defined mitigations</li> <li>Optimal: Fully automated just-in-time lifecycles, dynamic policies, comprehensive situational awareness, cross-pillar interoperability</li> </ul>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#zero-trust-pillar-implementation","title":"Zero Trust Pillar Implementation","text":""},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#identity-cisa-ztmm-table-2","title":"Identity (CISA ZTMM Table 2)","text":"<p>Maturity: Advanced</p> <p>Authentication: Agency authenticates all identity using phishing-resistant MFA (FIDO2/PIV initiating implementation) with continuous validation. Authentik SSO enforces phishing-resistant MFA (TOTP) for 100% administrative accounts with OAuth2/OIDC integration. SSH access uses certificate-based authentication (Ed25519 keys) validated via Step-CA PKI. MFA required for VPN access (Tailscale device authentication). Transition from password-based to passwordless authentication underway via FIDO2/WebAuthn planning.</p> <p>Identity Stores: Agency begins to securely consolidate and integrate self-managed (Active Directory, local accounts) and hosted identity stores (Authentik cloud-ready SSO). Authentik provides centralized identity management with LDAP/SAML/OAuth2 integrations across hybrid environments. Single sign-on (SSO) implemented for 90% of web services via Traefik ForwardAuth middleware.</p> <p>Risk Assessments: Agency determines identity risk with automated analysis and dynamic rules. Splunk correlates failed authentication patterns, geoIP anomalies, impossible travel scenarios, and behavioral baselines to inform access decisions. Wazuh monitors account lifecycle events (creation, modification, privilege escalation) with automated alerts for high-risk activities. TheHive case creation triggered by identity risk threshold violations.</p> <p>Access Management: Agency authorizes need-based and session-based access tailored to actions and resources. Authentik enforces 30-minute session timeouts with automatic re-authentication requirements. SSH sessions use temporary sudo elevation with privileged operations requiring explicit justification. OAuth2 scopes limit application permissions to minimum required for task completion. Account access reviews conducted quarterly with automated expiration workflows.</p> <p>Visibility and Analytics: Agency performs automated analysis across user and entity activity logs and augments collection to address visibility gaps. 100% authentication event logging (successful/failed logins, MFA challenges, privilege escalations, account modifications) forwarded to dual SIEM. Behavioral analytics detect unusual login times, geographic anomalies, credential stuffing, and privilege abuse. Real-time correlation identifies compromised credentials within 5 minutes of suspicious activity.</p> <p>Automation and Orchestration: Agency manually orchestrates privileged user identities and automates orchestration of all identities with integration across environments. Standard user provisioning/deprovisioning automated via Authentik workflows. Privileged account management requires manual approval with automated expiration (24-hour temporary elevation). SSH key distribution centralized via Ansible with automated rotation schedules. Service account credentials stored in Vaultwarden with automated retrieval.</p> <p>Governance: Agency implements identity policies for enterprise-wide enforcement with automation and periodic updates. CIS Benchmark password policies enforced (14-char minimum non-MFA, 8-char with MFA). MFA enforcement policies updated monthly based on threat intelligence. Account lifecycle policies define provisioning, modification, and deactivation workflows. Quarterly access reviews validate RBAC group assignments and permission grants.</p> <p>Framework Alignment: NIST CSF PR.AA/AC, CIS 5.1-6.8, ISO 27001 A.5.15-5.18, NIST 800-53 AC-2/AC-3/IA-2/IA-4/IA-5, PCI-DSS 8.1-8.3, OWASP A07.</p> <p>Gap to Optimal: Requires full automation of privileged identity orchestration, continuous identity risk scoring with real-time policy adjustments, just-in-time access for all accounts, behavior-based comprehensive analytics across all systems, and dynamic policy updates without manual intervention.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#devices-cisa-ztmm-table-3","title":"Devices (CISA ZTMM Table 3)","text":"<p>Maturity: Advanced</p> <p>Policy Enforcement and Compliance Monitoring: Agency has verified insights on initial access and enforces compliance for most devices and virtual assets. Wazuh agents (25+ endpoints) provide real-time compliance validation against CIS Benchmarks (92-98% compliance). Nessus authenticated scans verify device configurations monthly with automated remediation workflows. Ansible enforces configuration baselines with drift detection triggering automatic alerts. Virtual asset compliance (50+ containers, 30+ VMs) monitored via Proxmox and Docker health checks with policy violations triggering automated quarantine.</p> <p>Asset and Supply Chain Risk Management: Agency begins to develop comprehensive enterprise view via automated processes across vendors. PatchMon tracks 5,000+ packages across 30+ hosts with daily vulnerability correlation to NVD database. Container image verification via SHA-256 signatures with Docker Content Trust. Package signature validation (GPG keys) for all software installations. Vulnerability disclosure workflows via Shuffle integrate MISP threat intelligence for supply chain compromise detection. Limited SBOM tracking (gap identified\u2014requires Trivy/Grype implementation Q1 2026).</p> <p>Resource Access: Agency's initial resource access considers verified device insights. Authentik ForwardAuth validates device compliance before granting application access via OAuth2 device flow. Step-CA certificates authenticate devices for service-to-service communication. Wazuh compliance status integrated into access control decisions with non-compliant devices restricted to remediation VLAN. SSH access restricted to registered host keys with certificate-based authentication. Traefik middleware validates device headers and IP reputation before proxying requests.</p> <p>Device Threat Protection: Agency begins to consolidate threat protection to centralized solutions and integrates with policy enforcement. Wazuh EDR provides FIM, rootkit detection, and vulnerability assessment on 25+ endpoints. ClamAV (Linux) and Microsoft Defender (Windows) deployed with centralized management. Suricata/Snort network IDS provides device-level threat detection. YARA rules detect malware signatures with multi-engine analysis via Cortex (VirusTotal, Hybrid Analysis). Automated containment via Wazuh Active Response (firewall-drop, account-disable, process-kill).</p> <p>Visibility and Analytics: Agency automates inventory collection including endpoint monitoring on standard devices and virtual assets with anomaly detection. Real-time asset discovery via NetalertX network monitoring, Checkmk infrastructure tracking, and Prometheus node exporters. Endpoint telemetry (Sysmon process trees, network connections, file modifications) forwarded to SIEM with behavioral analysis. Device lifecycle tracking from provisioning through deprovisioning with audit trails. Virtual asset provisioning patterns monitored for anomalies indicating credential compromise or resource abuse.</p> <p>Automation and Orchestration: Agency implements monitoring and enforcement to manually disconnect or isolate non-compliant devices and virtual assets. Proxmox automation provisions VMs with pre-configured security baselines. Docker/Watchtower auto-updates containers with rollback capability. WSUS automated patch approval for Windows endpoints with pre-deployment testing. Ansible playbooks remediate configuration drift with snapshot-before-patch strategy. Manual intervention required for device quarantine decisions (automated workflows planned Q2 2026).</p> <p>Governance: Agency sets enterprise-wide policies for device/virtual asset lifecycle with automated enforcement mechanisms. Lifecycle policies define procurement standards, configuration baselines, monitoring requirements, update schedules, and decommissioning procedures. CIS Benchmark policies enforced via Wazuh SCA with quarterly compliance reviews. Vulnerability remediation SLAs (Critical &lt;72h, High &lt;7d) tracked via TheHive. Hardware refresh cycles documented with end-of-life tracking preventing legacy device deployment.</p> <p>Framework Alignment: NIST CSF PR.IP/DE.CM, CIS 1.1-2.7/4.1-4.12/10.1-10.7, ISO 27001 A.5.9/A.8.1/A.8.7/A.8.8/A.8.19, NIST 800-53 CM-8/SI-2/SI-3/SI-4, PCI-DSS 2.4/5.1-5.2/6.4.3/11.5, OWASP A02/A03.</p> <p>Gap to Optimal: Requires fully automated provisioning, monitoring, isolation, remediation, and deprovisioning processes; comprehensive real-time device risk analytics informing resource access; unified threat protection with advanced capabilities; automated lifecycle policies for all assets; complete SBOM tracking.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#networks-cisa-ztmm-table-4","title":"Networks (CISA ZTMM Table 4)","text":"<p>Maturity: Advanced</p> <p>Network Segmentation: Agency expands deployment of endpoint/application profile isolation with ingress/egress micro-perimeters and service-specific interconnections. 3-tier architecture (DMZ, application, backend) with VLAN isolation per service criticality. pfSense/OPNsense enforce default-deny firewall rules with explicit allow-lists per segment. Traefik reverse proxy provides ingress micro-perimeter with ForwardAuth authentication at edge. Backend services isolated from direct internet access via internal-only VLANs. Critical workloads (SIEM, authentication, PKI) deployed on dedicated VLANs with restricted lateral movement paths.</p> <p>Network Traffic Management: Agency implements dynamic network rules periodically adapted based on automated risk-aware application profile assessments. Application profiles defined for web services, databases, DNS, monitoring, and administrative access with distinct QoS policies. pfSense traffic shaping prioritizes critical services (SIEM, authentication) during congestion. Traefik load balancing distributes traffic based on backend health checks and response times. Periodic reviews (monthly) adjust traffic policies based on bandwidth utilization, latency metrics, and security posture changes.</p> <p>Traffic Encryption: Agency ensures encryption for all applicable internal/external traffic, manages key issuance/rotation, and begins cryptographic agility. TLS 1.3 mandatory for all web services via Traefik with modern cipher suites (AES-256-GCM, ChaCha20-Poly1305). SSH connections encrypted with AES-256-GCM using Ed25519 keys. VPN encryption via WireGuard (ChaCha20) and OpenVPN (AES-256). Syslog-ng TLS encrypts log transmission to SIEM. Step-CA PKI automates certificate issuance, renewal, and rotation with 90-day certificate lifetimes. DNSSEC provides DNS response integrity. Weak cipher detection via vulnerability scans with automated remediation.</p> <p>Network Resilience: Agency has configured network capabilities to dynamically manage availability demands and resilience for majority of applications. HA firewall cluster (pfSense CARP) provides &lt;5-second failover. Dual Pi-hole DNS with automatic failover maintains 99.9% availability. Dual SIEM architecture (Splunk + Elastic) ensures resilience to platform failures. Redundant internet connections with automatic failover. Load balancing via Traefik distributes traffic across healthy backends. Critical services deployed with multiple replicas across hypervisors.</p> <p>Visibility and Analytics: Agency deploys anomaly-based network detection across all environments with correlation from multiple sources and automated threat hunting. 100% network traffic visibility via pfSense flow logs, Traefik access logs, Pi-hole DNS query logs, and Suricata/Snort IDS. Real-time correlation detects port scans, DGA domains, DNS tunneling, C2 beacons, and lateral movement patterns. MISP IOC correlation identifies known-bad infrastructure. Splunk threat hunting dashboards track network reconnaissance, protocol anomalies, and bandwidth spikes. Behavioral baselines detect deviations indicating compromise.</p> <p>Automation and Orchestration: Agency uses automated change management (CI/CD) to manage configuration/lifecycle for all networks/environments, responding to and enforcing policies. Terraform defines network infrastructure-as-code with Git version control. Ansible playbooks configure firewall rules, routing tables, and VLANs with automated deployment. Pre-deployment validation prevents misconfigurations. Automated rollback capability via snapshots. Policy violations (firewall rule changes, routing modifications) trigger alerts with automatic reversion. Network provisioning/deprovisioning follows automated workflows with approval gates for production changes.</p> <p>Governance: Agency incorporates automation in implementing tailored policies and facilitates transition from perimeter-focused protections. Network segmentation policies define VLAN assignments, firewall ACLs, and traffic flows with automated enforcement via Terraform/Ansible. Encryption policies mandate TLS 1.3 minimum with weak cipher prohibition. Traffic management policies define QoS priorities and bandwidth allocations. Quarterly policy reviews update network security requirements based on threat landscape evolution. Exception approvals documented with compensating controls.</p> <p>Framework Alignment: NIST CSF PR.AC/PR.DS/DE.CM, CIS 12.1-13.10, ISO 27001 A.8.20-8.23, NIST 800-53 SC-7/SC-8/SC-20/SI-4, PCI-DSS 1.1-1.4/4.2, OWASP A04.</p> <p>Gap to Optimal: Requires fully distributed micro-perimeters with extensive micro-segmentation, dynamic just-in-time/just-enough connectivity, continuously evolving network rules based on real-time risk, enterprise-wide situational awareness with advanced automated telemetry correlation, infrastructure-as-code with fully automated initiation/expiration.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#applications-and-workloads-cisa-ztmm-table-5","title":"Applications and Workloads (CISA ZTMM Table 5)","text":"<p>Maturity: Advanced</p> <p>Application Access: Agency automates application access decisions with expanded contextual information and enforced expiration adhering to least privilege. Authentik OAuth2/OIDC authorization considers user identity, group membership, device compliance (Wazuh status), source IP reputation, time-of-day restrictions, and MFA verification. Session-based access with 30-minute idle timeout requires re-authentication. OAuth2 scopes limit permissions to minimum required operations. Traefik middleware enforces path-based access control with header validation. Service-to-service communication authenticated via Step-CA certificates (mutual TLS planned).</p> <p>Application Threat Protections: Agency integrates threat protections into all application workflows protecting against application-specific and targeted threats. SafeLine WAF deploys OWASP Core Rule Set (CRS) with 25% attack block rate protecting against SQL injection, XSS, command injection, and path traversal. Traefik security headers (CSP, X-Frame-Options, HSTS, X-Content-Type-Options) prevent common attacks. Input validation via WAF and application-level sanitization. Suricata/Snort application-layer signatures detect exploit attempts. Rate limiting prevents brute force and DoS attacks. Security testing via OWASP ZAP and Burp Suite during deployment.</p> <p>Accessible Applications: Agency makes most applicable mission critical applications available over open public networks to authorized users. Cloudflare Tunnels expose internal services without port forwarding or firewall exceptions. Traefik reverse proxy provides public internet access with mandatory authentication via Authentik ForwardAuth. All public-facing applications protected by WAF and DDoS mitigation. Tailscale mesh VPN provides secure remote access to administrative interfaces. Internal-only applications (monitoring, SIEM backends, PKI) remain isolated on private VLANs accessible only via VPN.</p> <p>Secure Application Development and Deployment Workflow: Agency uses distinct coordinated teams for development/security/operations while removing developer access to production for code deployment. Infrastructure-as-Code (Terraform, Ansible) defines deployment environments with Git version control. Separate development, staging, and production environments with network isolation. CI/CD pipelines (planned Q2 2026) will automate security testing and deployment. Docker images built from trusted base images with signature verification. Immutable container workloads (50+ containers) with changes deployed via version updates. Developer SSH access restricted to non-production environments.</p> <p>Application Security Testing: Agency integrates application security testing into development/deployment with periodic dynamic testing. Pre-deployment vulnerability scanning via OpenVAS and Nessus identifies misconfigurations and known vulnerabilities. Manual penetration testing for critical services identifies logic flaws and business logic vulnerabilities. Static code analysis (planned with CI/CD implementation) will scan custom scripts and configurations. Dynamic testing via OWASP ZAP crawls web applications for OWASP Top 10 vulnerabilities. Container image scanning (planned Trivy/Grype) will detect vulnerable dependencies.</p> <p>Visibility and Analytics: Agency automates profile and security monitoring for most applications with heuristics identifying trends and refining processes. Prometheus monitors application performance metrics (response times, error rates, resource utilization). Uptime Kuma tracks service availability (50+ monitors) with multi-channel alerting. Application logs forwarded to SIEM with correlation detecting authentication failures, error spikes, and suspicious patterns. Grafana visualizes application health trends with historical analysis. Security event monitoring identifies exploitation attempts, privilege escalations, and data exfiltration patterns.</p> <p>Automation and Orchestration: Agency automates application configurations to respond to operational and environmental changes. Docker/Watchtower auto-updates containers with rollback capability. Traefik dynamic configuration discovers new services and applies security policies automatically. Ansible playbooks deploy configuration changes with validation testing. Health checks trigger automatic failover to healthy backends. Resource scaling (planned with Kubernetes) will adjust compute allocation based on demand. Backup automation runs bi-weekly with quarterly restore validation.</p> <p>Governance: Agency implements tiered, tailored policies enterprise-wide for applications/lifecycles and leverages automation for enforcement. Application categorization (Tier 1: SIEM/EDR, Tier 2: Firewalls/DNS, Tier 3: Supporting services) defines security requirements and SLAs. Deployment policies require security hardening, vulnerability scanning, and change approval. Patching policies mandate critical updates within 72 hours, high within 7 days. Software asset inventory tracks application versions with automated outdated software detection. Quarterly reviews validate policy compliance and update requirements based on threat evolution.</p> <p>Framework Alignment: NIST CSF PR.AC/PR.IP/PR.PS, CIS 2.3/16.1-16.14/18.1-18.5, ISO 27001 A.8.23/A.8.26/A.14.1-14.2, NIST 800-53 AC-3/SA-8/SA-11/SI-10, PCI-DSS 6.4-6.6, OWASP A01/A05/A06/A08.</p> <p>Gap to Optimal: Requires continuous real-time authorization incorporating behavior/usage patterns, advanced real-time threat protections with content-aware analysis, all applications internet-accessible where appropriate, immutable workloads with automated redeployment, automated security testing throughout SDLC for deployed applications, continuous dynamic monitoring with comprehensive visibility, fully automated configuration optimization.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#data-cisa-ztmm-table-6","title":"Data (CISA ZTMM Table 6)","text":"<p>Maturity: Advanced</p> <p>Data Inventory Management: Agency automates data inventory enterprise-wide covering all applicable data with data loss prevention based on static attributes/labels. Filesystem monitoring tracks data repositories across 30+ hosts and 50+ containers. Database inventories document schemas, tables, and record counts. Backup inventories track encrypted archives with retention tracking. Application data flows documented with sensitivity classification. Pi-hole DNS logging provides data access pattern visibility. Egress filtering prevents unauthorized data transfer with bandwidth monitoring detecting exfiltration attempts. DLP planning underway (formal deployment Q2 2026) for comprehensive data loss prevention.</p> <p>Data Categorization: Agency automates some data categorization and labeling in consistent, tiered, targeted manner with simple structured formats and regular review. Sensitivity tiers (Public, Internal, Confidential, Restricted) defined with handling requirements. Filesystem metadata tags indicate sensitivity levels. Database schemas include classification fields. Application logs categorized by security relevance (authentication, authorization, system events, security events). Quarterly reviews update data classifications based on changing risk profiles. Automated labeling (planned with DLP implementation) will apply consistent categorization across repositories.</p> <p>Data Availability: Agency primarily makes data available from redundant, highly available data stores and ensures access to historical data. Dual SIEM architecture (Splunk + Elastic) provides redundant log storage with 90-day hot retention, 1-year cold storage. Database replication ensures availability during maintenance. Backup retention policy maintains 4 weekly, 12 monthly, and 7 yearly backups with offsite storage. High-availability services deployed across multiple hypervisors. Cloud-hosted services (Authentik planning) will provide geographic redundancy. Disaster recovery procedures documented with quarterly restore testing.</p> <p>Data Access: Agency automates data access controls considering identity, device risk, application, data category with time limits where applicable. Authentik RBAC groups map to data repository permissions (read, write, delete). Filesystem ACLs enforce least-privilege access with quarterly reviews. Database role-based permissions limit query capabilities. SSH key-based authentication prevents credential-based data access. Application-level authorization validates user permissions before data retrieval. Session-based access with 30-minute timeout requires re-authentication. Service account credentials rotated quarterly with access auditing.</p> <p>Data Encryption: Agency encrypts all data at rest/transit across enterprise to maximum extent, begins cryptographic agility, and protects encryption keys. TLS 1.3 encrypts all network communications (web, SSH, VPN, syslog). AES-256-GCM encrypts backups with keys stored in Vaultwarden. SSH private keys encrypted with passphrases. Database encryption-at-rest enabled where applicable. Ansible Vault encrypts configuration secrets with no hardcoded credentials. Step-CA PKI automates certificate lifecycle with 90-day rotation. Syslog-ng TLS encrypts log transmission. Key management policies prevent key hardcoding with centralized storage and rotation schedules. Cryptographic agility planning addresses algorithm deprecation.</p> <p>Visibility and Analytics: Agency maintains data visibility enterprise-wide with automated analysis/correlation and begins employing predictive analytics. SIEM correlation tracks data access patterns, failed authorization attempts, and anomalous queries. Database audit logging monitors administrative actions, schema changes, and bulk exports. File integrity monitoring (Wazuh FIM) detects unauthorized modifications with real-time alerts. Bandwidth monitoring identifies unusual upload volumes indicating exfiltration. Access pattern analysis detects credential sharing and privilege abuse. Predictive analytics (limited\u2014UEBA deployment planned) will forecast data security risks based on historical trends.</p> <p>Automation and Orchestration: Agency implements data lifecycle and security policies primarily through automated methods in consistent, tiered, targeted manner enterprise-wide. Backup automation runs bi-weekly with encrypted storage and quarterly restore validation. Log retention automated with lifecycle management (90-day hot to cold storage transition). Data sanitization procedures documented with automated secure deletion (DBAN, shred). Filesystem cleanup scripts remove outdated temporary files. Database archival processes migrate historical data to long-term storage. Access reviews automated with quarterly reports identifying orphaned permissions and stale accounts.</p> <p>Governance: Agency begins integration of data lifecycle policy enforcement across enterprise with unified definitions for data governance. Data classification policy defines sensitivity tiers with handling requirements. Retention policy specifies storage durations (logs: 1 year, backups: 7 years, database records: per business requirements). Encryption policy mandates TLS 1.3 and AES-256 with key management standards. Access control policy enforces least-privilege with quarterly reviews. Backup policy requires bi-weekly execution with quarterly restore testing. Destruction policy defines secure deletion methods and timelines. Policies reviewed annually with updates based on regulatory changes.</p> <p>Framework Alignment: NIST CSF PR.DS/ID.AM, CIS 3.1-3.14/8.1-8.11/11.1-11.5, ISO 27001 A.5.12/A.5.14/A.5.33/A.8.10/A.8.24, NIST 800-53 MP-3/MP-6/SC-28/AU-9/CP-9, PCI-DSS 3.1-3.7/10.5-10.7, OWASP A04/A09.</p> <p>Gap to Optimal: Requires continuous dynamic inventory with robust data loss prevention blocking suspected exfiltration, fully automated granular categorization/labeling enterprise-wide, dynamic data availability optimization, automated just-in-time/just-enough access with continuous review, encryption-in-use where appropriate with full cryptographic agility, comprehensive visibility with robust/predictive analytics, maximum automation of all lifecycles and policies, unified dynamic enforcement of all policies.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#cross-cutting-capabilities-cisa-ztmm-table-7","title":"Cross-Cutting Capabilities (CISA ZTMM Table 7)","text":""},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#visibility-and-analytics","title":"Visibility and Analytics","text":"<p>Maturity: Advanced</p> <p>Agency expands automated collection of logs/events enterprise-wide including virtual environments for centralized analysis correlating across multiple sources. 100% security event logging across DNS, SSH, Traefik, firewalls, endpoints, applications, and infrastructure forwarded to dual SIEM (Splunk + Elastic). Real-time correlation detects multi-stage attacks combining network reconnaissance, authentication failures, and privilege escalation. Multi-source enrichment via MISP, Cortex, geoIP databases, and threat intelligence feeds. Behavioral baselines identify anomalies in user activity, network traffic, and application usage. Grafana visualizes security posture with 20+ dashboards tracking vulnerabilities, patch compliance, authentication patterns, and threat indicators. Virtual environment monitoring includes container lifecycle events, VM provisioning patterns, and resource consumption anomalies.</p> <p>Framework Alignment: NIST CSF DE.AE/DE.CM, CIS 8.1-8.11/13.1-13.8, ISO 27001 A.8.15-8.16, NIST 800-53 AU-2/AU-6/SI-4, PCI-DSS 10.2-10.6, OWASP A09.</p> <p>Gap to Optimal: Requires comprehensive visibility enterprise-wide via centralized dynamic monitoring with advanced automated analysis across all log types, behavior-based analytics with ML/UEBA, comprehensive situational awareness including all externally-hosted resources.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#automation-and-orchestration","title":"Automation and Orchestration","text":"<p>Maturity: Advanced</p> <p>Agency automates orchestration and response activities enterprise-wide, leveraging contextual information from multiple sources to inform decisions. Shuffle SOAR orchestrates incident response workflows (15+ playbooks) integrating TheHive case management, Cortex analysis, MISP enrichment, and automated remediation. Wazuh Active Response provides automated containment (firewall-drop, account-disable, process-kill) with sub-30-minute MTTR. Infrastructure-as-Code (Terraform, Ansible) automates provisioning, configuration, and decommissioning with version control. Patch management automated across platforms (PatchMon, WSUS, Watchtower) with vulnerability-driven prioritization. Certificate lifecycle automated via Step-CA with 90-day rotation. Alert workflows integrate Discord, email, TheHive, and PagerDuty for multi-channel notification.</p> <p>Framework Alignment: NIST CSF RS.AN/RS.MI/PR.IP, CIS 4.1-4.2/7.3-7.4/17.1-17.9, ISO 27001 A.5.24-5.27/A.8.32, NIST 800-53 IR-4(1)/CM-2/CM-3/SI-2, PCI-DSS 6.4.5/12.10, OWASP A02/A08.</p> <p>Gap to Optimal: Requires orchestration and response activities dynamically responding to enterprise-wide changing requirements and environmental changes, full automation of all identity orchestration, automated mitigation deployment without manual approval, predictive analytics triggering proactive response.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#governance","title":"Governance","text":"<p>Maturity: Advanced</p> <p>Agency implements tiered, tailored policies enterprise-wide and leverages automation where possible to support enforcement. Access policy decisions incorporate contextual information from multiple sources. Security policies documented with version control (Git) and quarterly reviews. CIS Benchmark baselines enforced via Wazuh SCA with automated compliance reporting. Vulnerability remediation SLAs enforced (Critical &lt;72h, High &lt;7d) with TheHive case tracking. Configuration management policies define baseline standards with Ansible enforcement and drift detection. Encryption policies mandate TLS 1.3 and modern algorithms with vulnerability scan validation. Access control policies enforce least-privilege with automated quarterly reviews identifying permission creep. Incident response policies define escalation criteria and notification procedures. Policy exceptions require documented compensating controls and annual re-approval.</p> <p>Framework Alignment: NIST CSF GV.PO/GV.RM, CIS 4.1/18.1-18.5, ISO 27001 A.5.1/A.5.36, NIST 800-53 PL-1/PM-1/PM-9, PCI-DSS 12.1-12.11.</p> <p>Gap to Optimal: Requires fully automated enterprise-wide policies enabling tailored local controls with continuous enforcement and dynamic updates without manual intervention, automated policy creation/modification based on threat intelligence, real-time policy adjustments responding to environmental changes.</p>"},{"location":"projects/homelab/grc/grc-cisa-zero-trust/#zero-trust-maturity-summary","title":"Zero Trust Maturity Summary","text":"CISA Pillar Maturity Stage Key Capabilities Lab-Specific Evidence Identity Advanced Phishing-resistant MFA, consolidated identity stores, automated risk assessment, need-based access, automated analysis, integrated orchestration, enterprise-wide policies \u2022 Authentik SSO with TOTP MFA enforced on 100% admin accounts, OAuth2/OIDC across 90% web services\u2022 Splunk correlation: failed auth patterns, geoIP anomalies, impossible travel, behavioral baselines\u2022 Wazuh monitors account lifecycle events with automated alerts\u2022 30-minute session timeouts with re-auth requirements\u2022 SSH certificate-based auth via Step-CA PKI\u2022 CIS password policies enforced (14-char non-MFA, 8-char with MFA)\u2022 Quarterly access reviews validate RBAC assignments Devices Advanced Verified compliance insights, automated asset tracking, device-aware access control, centralized threat protection, automated inventory/anomaly detection, monitoring/enforcement mechanisms, enterprise-wide lifecycle policies \u2022 Wazuh agents on 25+ endpoints: 92-98% CIS Benchmark compliance, real-time FIM, rootkit detection\u2022 Nessus authenticated scans monthly with remediation workflows\u2022 PatchMon tracks 5,000+ packages across 30+ hosts, daily NVD correlation\u2022 NetalertX network discovery, Checkmk infrastructure tracking, Prometheus exporters\u2022 Container signature verification (SHA-256, Docker Content Trust)\u2022 Non-compliant devices quarantined to remediation VLAN\u2022 Virtual asset compliance: 50+ containers, 30+ VMs via Proxmox/Docker health checks Networks Advanced Endpoint/application isolation with micro-perimeters, dynamic risk-aware traffic management, full encryption with cryptographic agility, dynamic availability management, anomaly-based detection with correlation, automated change management (CI/CD), tailored automated policies \u2022 3-tier architecture: DMZ, application, backend with per-service VLAN isolation\u2022 pfSense CARP HA cluster: &lt;5-second failover, 99.9%+ availability\u2022 TLS 1.3 mandatory via Traefik with modern ciphers (AES-256-GCM, ChaCha20-Poly1305)\u2022 Step-CA PKI: automated cert issuance, 90-day rotation, Ed25519 keys\u2022 Dual Pi-hole DNS with automatic failover\u2022 100% traffic visibility: pfSense flow logs, Traefik access logs, Pi-hole queries, Suricata/Snort IDS\u2022 Terraform defines network IaC with Git version control\u2022 Ansible configures firewall rules, routing, VLANs with automated deployment Applications and Workloads Advanced Automated access with contextual enforcement, integrated threat protections, most applications publicly accessible with protection, distinct dev/sec/ops teams with restricted production access, integrated periodic security testing, automated monitoring with trends, automated configuration response, tiered enterprise-wide policies \u2022 Authentik OAuth2 considers: identity, groups, device compliance (Wazuh), source IP, time-of-day, MFA\u2022 SafeLine WAF: OWASP CRS, 25% attack block rate (SQLi, XSS, command injection, path traversal)\u2022 Traefik security headers: CSP, X-Frame-Options, HSTS, X-Content-Type-Options\u2022 Cloudflare Tunnels expose services without port forwarding\u2022 Docker immutable workloads: 50+ containers with version-based updates\u2022 Separate dev/staging/production environments with network isolation\u2022 Pre-deployment scanning: OpenVAS, Nessus, OWASP ZAP, Burp Suite\u2022 Prometheus monitors performance, Uptime Kuma tracks 50+ service monitors Data Advanced Automated enterprise-wide inventory with DLP based on labels, automated consistent categorization with regular review, redundant highly-available stores with historical access, automated controls considering multiple attributes with time limits, full encryption at rest/transit with cryptographic agility and key protection, enterprise-wide visibility with correlation and initial predictive analytics, primarily automated lifecycle enforcement in targeted manner, integrated policy enforcement with unified definitions \u2022 Filesystem monitoring: 30+ hosts, 50+ containers via Wazuh FIM\u2022 Dual SIEM: 90-day hot retention, 1-year cold storage, database replication\u2022 Backup retention: 4 weekly, 12 monthly, 7 yearly with offsite storage\u2022 Sensitivity tiers defined: Public, Internal, Confidential, Restricted with handling requirements\u2022 AES-256-GCM encrypts backups with keys in Vaultwarden\u2022 TLS 1.3 encrypts all network communications (web, SSH, VPN, syslog)\u2022 Authentik RBAC groups map to data repository permissions with quarterly reviews\u2022 30-minute session timeouts with re-auth for data access\u2022 Pi-hole DNS logging provides data access pattern visibility Visibility and Analytics (Cross-Cutting) Advanced Automated enterprise-wide collection including virtual environments, centralized multi-source correlation, anomaly detection, threat hunting \u2022 Dual SIEM (Splunk + Elastic): 100% security event coverage across DNS, SSH, Traefik, firewalls, endpoints, applications\u2022 Real-time correlation: multi-stage attacks, network reconnaissance + auth failures + privilege escalation\u2022 Multi-source enrichment: MISP IOCs, Cortex analysis, geoIP, threat feeds\u2022 Behavioral baselines identify anomalies in user activity, network traffic, app usage\u2022 Grafana: 20+ dashboards tracking vulnerabilities, patch compliance, auth patterns, threat indicators\u2022 Virtual environment monitoring: container lifecycle, VM provisioning, resource consumption anomalies\u2022 SIEM retention: 90-day hot, 1-year cold with automated lifecycle management Automation and Orchestration (Cross-Cutting) Advanced Enterprise-wide automated orchestration/response leveraging contextual information, IaC automation, SOAR workflows, automated patch management, certificate lifecycle automation \u2022 Shuffle SOAR: 15+ playbooks integrating TheHive case mgmt, Cortex analysis, MISP enrichment\u2022 Wazuh Active Response: automated containment (firewall-drop, account-disable, process-kill), sub-30-min MTTR\u2022 Terraform/Ansible IaC: provisioning, configuration, decommissioning with Git version control\u2022 Automated patching: PatchMon, WSUS, Watchtower with vulnerability-driven prioritization\u2022 Step-CA: automated cert issuance, renewal, 90-day rotation\u2022 Alert workflows: Discord, email, TheHive, PagerDuty multi-channel notification\u2022 Proxmox automation: VMs with pre-configured baselines, snapshot-before-patch Governance (Cross-Cutting) Advanced Tiered tailored policies enterprise-wide with automation support, contextual access decisions, documented version-controlled policies, quarterly reviews, automated compliance reporting \u2022 Security policies in Git with version control and quarterly reviews\u2022 CIS Benchmark baselines enforced via Wazuh SCA with automated compliance reporting (92-98%)\u2022 Vulnerability remediation SLAs: Critical &lt;72h, High &lt;7d tracked via TheHive\u2022 Configuration management: Ansible enforcement with drift detection and automated alerts\u2022 Encryption policies mandate TLS 1.3, modern algorithms validated via vulnerability scans\u2022 Access control policies: least-privilege with automated quarterly reviews\u2022 Incident response policies: escalation criteria, notification procedures documented\u2022 Policy exceptions require documented compensating controls and annual re-approval <p>Overall CISA Zero Trust Maturity: Advanced (Stage 3 of 4) \u2014 87% of functions at Advanced or higher</p> <p>This Zero Trust implementation demonstrates Advanced-stage maturity aligned with CISA ZTMM v2.0, providing production-ready capabilities directly transferable to federal civilian executive branch agencies and enterprise environments pursuing Executive Order 14028 compliance and OMB M-22-09 objectives.</p>"},{"location":"projects/homelab/grc/grc-index/","title":"Governance, Risk and Compliance","text":""},{"location":"projects/homelab/grc/grc-index/#table-of-contents","title":"Table of Contents","text":"Section Description GRC Executive Summary Comprehensive framework alignment summary demonstrating production-ready security capabilities across eight industry-standard frameworks validating SecOps, Systems Engineering, and Network Defense operations. NIST Cybersecurity Framework 2.0 Risk-based framework implementation across six core functions (Govern, Identify, Protect, Detect, Respond, Recover). CIS Critical Security Controls v8.1 Prescriptive, prioritized safeguards organized into three Implementation Groups (IG1: basic hygiene, IG2: enhanced security, IG3: advanced capabilities) based on organizational maturity and resources. ISO 27001:2022 Annex A Establishes requirements for Information Security Management Systems (ISMS) with 93 controls across organizational, people, physical, and technological domains, supporting formal certification. NIST SP 800-53 Rev 5 Comprehensive catalog of security/privacy controls for federal systems, organized into 20 control families covering technical, operational, and management safeguards. MITRE ATT&amp;CK Enterprise v18.1 Documents adversary tactics, techniques, and procedures (TTPs) based on real-world observations, providing common taxonomy for threat-informed defense. OWASP Top 10 (2025) Identifies most critical web application security risks based on industry data, providing developer-focused guidance for secure application development. CISA Zero Trust Maturity Model v2.0 Defines four maturity stages (Traditional, Initial, Advanced, Optimal) across five core pillars (Identity, Devices, Networks, Applications &amp; Workloads, Data) and three cross-cutting capabilities (Visibility &amp; Analytics, Automation &amp; Orchestration, Governance) providing actionable roadmap for zero trust adoption. NIST SP 800-207 Zero Trust Architecture Establishes foundational principles and logical architecture for zero trust implementation through seven core tenets: explicit resource definition, location-independent security, per-session access, dynamic policy, asset integrity monitoring, dynamic authentication, and comprehensive telemetry collection."},{"location":"projects/homelab/grc/grc-index/#summary","title":"Summary","text":"<p>This cybersecurity lab demonstrates production-ready security capabilities aligned with eight industry-standard frameworks, each validating specific aspects of SecOps, Systems Engineering, and Network Defense operations:</p> <p>Core Strengths:</p> <ul> <li>Operational Security Excellence: 100% security event logging with dual SIEM, &lt;5min MTTD, &lt;30min MTTR via automated SOAR workflows</li> <li>Technical Architecture Maturity: Defense-in-depth across network/application/endpoint/identity layers with Infrastructure as Code automation</li> <li>Framework Compliance: Tier 3-4 NIST CSF, 93% CIS IG1, 77% ISO 27001, Advanced Zero Trust maturity across all pillars</li> <li>Zero Trust Implementation: Explicit verification, micro-segmentation, encrypted communications, continuous monitoring achieving Advanced (Stage 3/4) maturity</li> </ul>"},{"location":"projects/homelab/grc/grc-iso27001/","title":"ISO 27001:2022 Annex A","text":"<p>Document Control: Version: 1.1 Last Updated: January 2026 Owner: Paul Leone  </p> <p>Framework Version: 2022</p>"},{"location":"projects/homelab/grc/grc-iso27001/#5-organizational-controls","title":"5. Organizational Controls","text":"Control 2013 Ref Control Name Evidence/Implementation Detail Status A 5.1 A 5.1.1, A 5.1.2 Policies for Information Security Lab mission statement defines security-first architecture; compliance requirements documented; comprehensive logging policy (100% security event coverage); SSH hardening policy (CIS Benchmark); TLS 1.3 minimum policy; vulnerability remediation SLAs by severity (Critical &lt;72h, High &lt;7 days); risk-based CVSS scoring methodology Implemented A 5.2 A 6.1.1 Information Security Roles and Responsibilities Not applicable - personal lab environment N/A A 5.3 A 6.1.2 Segregation of Duties Not applicable - personal lab environment N/A A 5.4 A 7.2.1 Management Responsibilities Not applicable - personal lab environment N/A A 5.5 A 6.1.3 Contact with Authorities Not applicable - personal lab environment N/A A 5.6 A 6.1.4 Contact with Special Interest Groups Not applicable - personal lab environment N/A A 5.7 NEW Threat Intelligence CrowdSec community signals; MISP threat feeds (bi-directional); NVD vulnerability database; Shuffle CVE aggregation (NIST NVD, Exploit-DB); Cortex multi-source enrichment (VirusTotal, AbuseIPDB, Shodan, MISP, URLhaus, PhishTank); SIEM correlation with threat feeds Implemented A 5.8 A 6.1.5, A 14.1.1 Information Security in Project Management Infrastructure as Code (Terraform, Ansible); Git version control; security requirements in deployment automation; threat modeling for new services; CI/CD security linting (planned) Partial A 5.9 A 8.1.1, A 8.1.2 Inventory of Information and Other Associated Assets PatchMon tracks 5,000+ packages across 30+ hosts; WUD tracks 50+ containers; OpenVAS asset database (75+ assets); Nessus software inventory; Wazuh agent inventory (25+ endpoints); DNS records (Bind9 zone files); SSH host keys (Ansible); Checkmk infrastructure inventory; Prometheus node exporters; Netalert Network Inventory Implemented A 5.10 A 8.1.3, A 8.2.3 Acceptable Use of Information and Other Associated Assets Not applicable - personal lab environment N/A A 5.11 A 8.1.4 Return of Assets Not applicable - personal lab environment N/A A 5.12 A 8.2.1 Classification of Information Data classification scheme: Public, Internal, Confidential; lab data classified as Internal Use; no sensitive/classified data processed Partial A 5.13 A 8.2.2 Labelling of Information Not formalized - lab environment informal labeling Not Implemented A 5.14 A 13.2.1, A 13.2.2, A 13.2.3 Information Transfer TLS 1.3 encryption (Traefik); SSH encrypted file transfers; syslog-ng TLS transmission to SIEM; encrypted backups; Cloudflare Tunnels for secure remote access; Tailscale mesh VPN; no unencrypted data transmission Implemented A 5.15 A 9.1.1, A 9.1.2 Access Control Authentik SSO integration; centralized SSH key management via Ansible; individual user accounts (no shared credentials); MFA enforcement (Authentik TOTP); Traefik ForwardAuth SSO; IP allowlisting; firewall rules restrict backend access Implemented A 5.16 A 9.2.1 Identity Management Centralized via Authentik; SSH keys tracked in Ansible inventory; Active Directory user management; unique user accounts; SIEM correlation identifies orphaned accounts; Wazuh tracks active user sessions Implemented A 5.17 A 9.2.4, A 9.3.1, A 9.4.3 Authentication Information SSH private keys encrypted; Authentik credentials in Vaultwarden (zero-knowledge encryption); MFA enforcement (100% admin accounts); password complexity requirements; no hardcoded credentials (Ansible Vault); biometric unlock (Vaultwarden) Implemented A 5.18 A 9.2.2, A 9.2.5, A 9.2.6 Access Rights Authentik RBAC groups; SSH sudo policies; least-privilege access; privilege escalation logged to SIEM; access review via authentication logs; Wazuh monitors unauthorized access attempts; centralized SSH key revocation via Ansible Implemented A 5.19 A 15.1.1 Information Security in Supplier Relationships Vetted open-source projects; official Docker registries; trusted package repositories; MISP vendor compromise tracking Partial A 5.20 A 15.1.2 Addressing Information Security Within Supplier Agreements Not applicable - personal lab environment N/A A 5.21 A 15.1.3 Managing Information Security in the ICT Supply Chain Package signature verification; Docker image SHA-256 validation; software provenance tracking (limited); SBOM implementation planned (Trivy/Grype) Partial A 5.22 A 15.2.1, A 15.2.2 Monitoring, Review and Change Management of Supplier Services Dependabot/Renovate dependency updates (planned); WUD container update monitoring; PatchMon package tracking; automated vulnerability scanning of third-party components Partial A 5.23 NEW Information Security for Use of Cloud Services Cloudflare Tunnels secure remote access; Tailscale mesh VPN; cloud service encryption (TLS 1.3); no sensitive data in cloud services; PIA VPN egress encryption Implemented A 5.24 A 16.1.1 Information Security Incident Management Planning and Preparation TheHive IR workflows (15+ documented playbooks: phishing, malware, ransomware, lateral movement, vulnerability response); Cortex responders (automated containment); Shuffle automated orchestration; SOC team structure; escalation procedures; multi-channel communication (Discord, SMTP, Cloudflare); on-call rotation Implemented A 5.25 A 16.1.4 Assessment and Decision on Information Security Events Cortex multi-engine analysis (VirusTotal, AbuseIPDB, Shodan, MISP, Yara, File_Info, URLhaus, PhishTank); MISP threat intelligence correlation; threat scoring (confidence-based); severity assessment (CVSS, asset criticality); Shuffle automated enrichment workflows; TheHive observable correlation; SIEM-based event triage Implemented A 5.26 A 16.1.5 Response to Information Security Incidents TheHive case management (structured workflows); automated containment (Wazuh Active Response: firewall-drop, host-deny, disable-account; Cortex responders; Shuffle orchestration); multi-party coordination (Discord real-time collaboration); escalation to management (PagerDuty); forensic data collection (Wazuh, memory dumps); MISP IOC sharing; sub-30-minute MTTR Implemented A 5.27 A 16.1.6 Learning from Information Security Incidents metrics tracking (MTTR, MTTD, case volume); process improvement (workflow optimization); lessons learned (playbook updates); Shuffle workflow refinement based on execution data; trend analysis dashboards (Grafana) Implemented A 5.28 A 16.1.7 Collection of Evidence Wazuh forensic data collection; immutable SIEM logs (Splunk read-only indexes, Elastic immutable streams); TheHive evidence management; chain of custody documentation; encrypted log transmission (syslog-ng TLS); 90-day retention; memory dump capability; packet captures (tcpdump/Wireshark) Implemented A 5.29 A 17.1.1, A 17.1.2, A 17.1.3 Information Security During Disruption HA DNS failover (dual Pi-hole); snapshot-before-patch; pre-scan snapshots for critical systems; documented restore procedures; rollback capability for failed patches; dual SIEM deployment (Splunk + Elastic); multi-layered detection reduces blind spots Implemented A 5.30 NEW ICT Readiness for Business Continuity Infrastructure as Code enables rapid rebuild (Terraform, Ansible); documented disaster recovery procedures; IaC rebuild tested (&lt;2 hour RTO); automated backups (bi-weekly); quarterly restore testing; Git version control for configurations Implemented A 5.31 A 18.1.1, A 18.1.5 Legal, Statutory, Regulatory and Contractual Requirements Compliance framework mappings documented (NIST CSF, CIS, PCI-DSS conceptual); no regulated data processing; open-source licensing compliance Partial A 5.32 A 18.1.2 Intellectual Property Rights Open-source software licensing tracked; GPL/MIT/Apache compliance; no proprietary software piracy; license documentation in Git Partial A 5.33 A 18.1.3 Protection of Records 90-day log retention (SIEM); immutable audit trails; encrypted backups; documented retention schedules; compliance with data retention requirements Implemented A 5.34 A 18.1.4 Privacy and Protection of PII No PII processing in lab environment; data minimization principles; encryption for any personal data (Vaultwarden); GDPR principles applied Implemented A 5.35 A 18.2.1 Independent Review of Information Security Not applicable - personal lab environment N/A A 5.36 A 18.2.2, A 18.2.3 Compliance with Policies, Rules and Standards CIS Benchmark compliance audits (92-98%); Nessus configuration audits; policy violations detected via compliance scans; Wazuh SCA detects deviations; SIEM dashboards track compliance metrics; continuous compliance monitoring Implemented A 5.37 A 12.1.1 Documented Operating Procedures Ansible playbooks as documentation; Terraform modules; runbooks in Git; incident response playbooks (TheHive); change management procedures; backup/restore procedures; IaC serves as living documentation Implemented"},{"location":"projects/homelab/grc/grc-iso27001/#6-people-controls-8-controls","title":"6. People Controls (8 Controls)","text":"Control 2013 Ref Control Name Evidence/Implementation Detail Status A 6.1 A 7.1.1 Screening Not applicable - personal lab, single administrator N/A A 6.2 A 7.1.2 Terms and Conditions of Employment Not applicable - personal lab, no employees N/A A 6.3 A 7.2.2 Information Security Awareness, Education and Training Not applicable - personal lab, no employees N/A A 6.4 A 7.2.3 Disciplinary Process Not applicable - personal lab, no employees N/A A 6.5 A 7.3.1 Responsibilities After Termination or Change of Employment Not applicable - personal lab, no employees N/A A 6.6 A 13.2.4 Confidentiality or Non-Disclosure Agreements Not applicable - no external parties with access N/A A 6.7 A 6.2.2 Remote Working SSH secure remote access; Tailscale mesh VPN; Cloudflare Tunnels; MFA enforcement for remote access; encrypted connections (TLS 1.3); VPN monitoring and logging; IP allowlisting Implemented A 6.8 A 16.1.2, A 16.1.3 Information Security Event Reporting Discord webhooks for real-time alerts; email notifications via SMTP relay; Cloudflare email routing; TheHive case creation from alerts; Splunk scheduled reports; Wazuh Discord/email integration; Prometheus Alertmanager; Grafana threshold alerts; multi-channel redundancy ensures zero missed notifications Implemented"},{"location":"projects/homelab/grc/grc-iso27001/#7-physical-controls-14-controls","title":"7. Physical Controls (14 Controls)","text":"Control 2013 Ref Control Name Evidence/Implementation Detail Status A 7.1 A 11.1.1 Physical Security Perimeters Home lab environment - residential security (locks, alarm system); server equipment in dedicated secure area N/A A 7.2 A 11.1.2, A 11.1.6 Physical Entry Not applicable - personal lab N/A A 7.3 A 11.1.3 Securing Offices, Rooms and Facilities Not applicable - personal lab N/A A 7.4 NEW Physical Security Monitoring HVAC monitoring via Prometheus; temperature alerts configured; Pulse hypervisor monitoring for hardware health; no video surveillance Partial A 7.5 A 11.1.4 Protecting Against Physical and Environmental Threats UPS battery backup for critical systems; environmental monitoring (temperature, humidity via Prometheus); fire detection (residential smoke detectors); HVAC for cooling Partial A 7.6 A 11.1.5 Working in Secure Areas Not applicable - personal lab N/A A 7.7 A 11.2.9 Clear Desk and Clear Screen Not applicable - personal lab N/A A 7.8 A 11.2.1 Equipment Siting and Protection Not applicable - personal lab N/A A 7.9 A 11.2.6 Security of Assets Off-Premises Not applicable - personal lab N/A A 7.10 A 8.3.1, A 8.3.2, A 8.3.3, A 11.2.5 Storage Media Encrypted backup media; secure storage of backup drives; removable media disabled via GPO (Windows); USB device restrictions; encrypted portable drives Implemented A 7.11 A 11.2.2 Supporting Utilities UPS for power backup; dual internet connections (primary + backup); redundant power supplies in servers; generator backup Partial A 7.12 A 11.2.3 Cabling Security Not applicable - personal lab N/A A 7.13 A 11.2.4 Equipment Maintenance Regular hardware maintenance logged; firmware updates tracked; scheduled maintenance windows; Proxmox hardware monitoring; Checkmk infrastructure monitoring Partial A 7.14 A 11.2.7 Secure Disposal or Re-Use of Equipment Secure deletion procedures documented; DBAN/shred for drive sanitization; physical destruction of retired drives; encrypted storage wiping before disposal Implemented"},{"location":"projects/homelab/grc/grc-iso27001/#8-technological-controls-34-controls","title":"8. Technological Controls (34 Controls)","text":"Control 2013 Ref Control Name Evidence/Implementation Detail Status A 8.1 A 6.2.1, A 11.2.8 User Endpoint Devices Wazuh EDR on 25+ endpoints; endpoint encryption (BitLocker, LUKS planned); device certificates via Step-CA; endpoint compliance monitoring; Group Policy hardening (Windows); antivirus (Microsoft Defender, ClamAV); GPO-enforced security settings Implemented A 8.2 A 9.2.3 Privileged Access Rights Separate privileged accounts; monitored via SIEM (Splunk admin login dashboard); MFA enforced (100% admin accounts); SSH key-based auth for privileged access; sudo usage logged; Wazuh tracks privileged authentication events; no shared admin credentials Implemented A 8.3 A 9.4.1 Information Access Restriction Traefik ForwardAuth restricts application access; firewall rules (pfSense default-deny); SSH IP allowlisting; file permissions (least privilege); Wazuh FIM monitors unauthorized access; network segmentation (VLANs); backend isolation Implemented A 8.4 A 9.4.5 Access to Source Code Git access control (SSH keys); branch protection rules; code review requirements (pull requests); Ansible playbooks version controlled; infrastructure code (Terraform) in private repositories; no public exposure of sensitive code Implemented A 8.5 A 9.4.2 Secure Authentication MFA enforcement (Authentik TOTP); SSH key-based authentication (Ed25519); TLS 1.3 client certificates; password complexity requirements; account lockout policies (5 failed attempts); session timeout (30 min idle); replay-resistant authentication (SSH session tokens, Authentik CSRF protection) Implemented A 8.6 A 12.1.3 Capacity Management Prometheus capacity monitoring; Grafana dashboards track resource usage (CPU, memory, disk, bandwidth); storage capacity alerts (80% threshold); auto-archival of logs; capacity planning for growth; resource trending analysis Implemented A 8.7 A 12.2.1 Protection Against Malware Wazuh FIM with VirusTotal integration; Suricata/Snort IDS signatures; ClamAV (Linux); Microsoft Defender (Windows); rootkit detection (Wazuh); automated signature updates; Yara rules for malware detection; Cortex malware analysis (multi-engine) Implemented A 8.8 A 12.6.1, A 18.2.3 Management of Technical Vulnerabilities Weekly OpenVAS network scans (52/year); monthly Nessus authenticated scans (12/year); daily PatchMon package checks; CVE correlation with NVD; CVSS-based prioritization; MTTR &lt;72h Critical, &lt;7 days High; 95% patched within SLA; Wazuh vulnerability assessment; SIEM correlation with exploit databases; automated vulnerability-to-patch correlation Implemented A 8.9 NEW Configuration Management Ansible playbooks define baselines; Terraform IaC; Git version control; configuration drift detection; CIS Benchmark compliance audits (92-98%); automated remediation; Nessus configuration audits; Wazuh SCA (Security Configuration Assessment); baseline deviation alerts Implemented A 8.10 NEW Information Deletion Secure deletion procedures documented; automated log archival/deletion; 90-day retention policy enforcement; secure file deletion (shred/srm); encrypted storage wiping; immutable SIEM indexes prevent premature deletion Implemented A 8.11 NEW Data Masking Not implemented - no production PII/sensitive data processing in lab Not Implemented A 8.12 NEW Data Leakage Prevention Egress filtering via firewall; DNS query logging (Pi-hole); Suricata/Snort monitors outbound traffic; unusual outbound traffic alerts (Prometheus); bandwidth monitoring; no formal DLP solution Partial A 8.13 A 12.3.1 Information Backup Proxmox automated backups (bi-weekly); dual backup solutions (Proxmox Backup Server + external); encrypted backups (AES-256); offsite backup storage; quarterly restore testing; 30-day backup retention; snapshot-before-patch; automated backup verification Implemented A 8.14 A 17.2.1 Redundancy of Information Processing Facilities HA firewall cluster (pfSense CARP); dual Pi-hole DNS failover (&lt;5s); dual SIEM deployment (Splunk + Elastic); redundant internet connections; multiple VPN paths (Tailscale, PIA, Cloudflare); load balancing (Traefik, MetalLB); failover capability documented Implemented A 8.15 A 12.4.1, A 12.4.2, A 12.4.3 Logging 100% security event logging; centralized SIEM (Splunk + Elastic); 90-day retention; structured JSON format; comprehensive coverage (DNS, SSH, Traefik, scans, patches, Wazuh, firewall, IDS, application logs); encrypted log transmission (syslog-ng TLS); immutable audit trails; logs include timestamp, user, source IP, action, result Implemented A 8.16 NEW Monitoring Activities Prometheus metrics collection; Grafana dashboards (25+); Uptime Kuma service availability (50+ monitors); Checkmk infrastructure monitoring; Pulse hypervisor monitoring; Wazuh endpoint monitoring (FIM, rootkit, processes); Splunk/Elastic SIEM correlation; Suricata/Snort IDS; TheHive case activity tracking; Cortex job monitoring; Shuffle workflow execution logs; Netalert Network monitoring; 100% visibility across infrastructure Implemented A 8.17 A 12.4.4 Clock Synchronization NTP time synchronization (Chrony); centralized time source (pool.ntp.org); sub-second accuracy; time drift monitoring; all systems synchronized; SIEM time correlation; accurate timestamps for forensics Implemented A 8.18 A 9.4.4 Use of Privileged Utility Programs Ansible execution restricted to authorized keys; sudo usage logged to SIEM; privileged command monitoring; Wazuh tracks privileged tool execution; administrative tool access restricted (RBAC); audit trail for privileged operations Implemented A 8.19 A 12.5.1, A 12.6.2 Installation of Software on Operational Systems WSUS approval workflows (Windows); Ansible-controlled deployments (Linux); Watchtower automated container updates (labeled); authenticated vulnerability scans verify only approved software; unauthorized applications detected (Nessus compliance scans); change control via Git; software inventory tracking (PatchMon, Wazuh) Implemented A 8.20 A 13.1.1 Networks Security HA firewall cluster (pfSense); default-deny rules; VLAN/subnet segmentation; ACLs per network segment; IDS/IPS (Suricata inline, Snort passive); network monitoring (Netalert, Prometheus, pfSense logs); egress filtering; ingress controls (Traefik); DMZ isolation Implemented A 8.21 A 13.1.2 Security of Network Services TLS 1.3 mandatory for all services; weak ciphers disabled; certificate validation enforced (Step-CA PKI); DNS security (DNSSEC, DNS-over-TLS planned); secure protocols only (SSH, HTTPS); service hardening (CIS Benchmarks); Traefik secure headers (HSTS, CSP, X-Frame-Options) Implemented A 8.22 A 13.1.3 Segregation of Networks firewall rules enforce isolation; subnet ACLs; DMZ for public-facing services; Traefik backend isolation; NGINX Ingress isolates K3s pods; network topology documented; inter-VLAN traffic controlled Implemented A 8.23 NEW Web Filtering DNS-based ad-blocking (Pi-hole); malware domain blocking (2M+ blocked domains); SafeLine WAF (OWASP CRS rules); Traefik middleware filtering; content filtering (DNS); phishing site blocking; URL reputation filtering (MISP) Implemented A 8.24 A 10.1.1, A 10.1.2 Use of Cryptography TLS 1.3 (Traefik); Ed25519 SSH keys; AES-256-GCM encryption; DNSSEC; Step-CA PKI (offline root, online intermediate); automated certificate management (ACME); strong ciphersuites only; certificate expiry monitoring; OCSP validation; encrypted backups; no weak algorithms (vulnerability scans detect) Implemented A 8.25 A 14.2.1 Secure Development Life Cycle Infrastructure as Code (Terraform, Ansible); Git version control; CI/CD security linting (planned); code review (pull requests); security requirements in deployment automation; threat modeling for new services; secure defaults; configuration validation (Ansible dry-run, Terraform plan) Partial A 8.26 A 14.1.2, A 14.1.3 Application Security Requirements Security requirements defined for deployments; input validation (WAF); authentication/authorization requirements; encryption requirements (TLS 1.3 mandatory); logging requirements (100% coverage); secure configuration baselines; OWASP Top 10 mitigation strategies Implemented A 8.27 A 14.2.5 Secure System Architecture and Engineering Principles Defense-in-depth architecture; zero-trust principles (verify explicitly, least privilege, assume breach); network segmentation; layered security controls; fail-secure design; security by default; threat modeling; documented architecture diagrams; secure service design (Traefik reverse proxy, backend isolation) Implemented A 8.28 NEW Secure Coding Not applicable - minimal custom code development; reliance on vetted open-source projects; code review for any custom scripts (pull requests) N/A A 8.29 A 14.2.8, A 14.2.9 Security Testing in Development and Acceptance Ansible dry-run testing; Terraform plan review; vulnerability scanning before production deployment (OpenVAS/Nessus); configuration validation; WSUS test deployments; snapshot-before-patch for rollback capability; staging environment testing Implemented A 8.30 A 14.2.7 Outsourced Development Not applicable - no outsourced development; reliance on open-source community projects; vendor security assessed informally (project maturity, community support, vulnerability history) N/A A 8.31 A 12.1.4, A 14.2.6 Separation of Development, Test and Production Environments Separate dev/test VLANs; staging environment for patch testing (WSUS); production isolated from development; snapshot-based testing environments; environment-specific configurations (Ansible); no production data in dev/test Implemented A 8.32 A 12.1.2, A 14.2.2, A 14.2.3, A 14.2.4 Change Management Git branching strategy; code review (pull requests); snapshot-before-patch; WSUS approval workflows; Ansible change control; Terraform plan review before apply; change logging (Git commits, SIEM); rollback capability; change impact assessment; documented change procedures Implemented A 8.33 A 14.3.1 Test Information No production data in test environments; synthetic test data only; staging data anonymized; test data management procedures documented; production database not used for testing Implemented A 8.34 A 12.7.1 Protection of Information Systems During Audit Testing Not applicable - personal lab N/A"},{"location":"projects/homelab/grc/grc-iso27001/#control-deployment-summary","title":"Control Deployment Summary","text":"<p>Overall Statistics</p> Metric Count Percentage Total Controls 93 100% Implemented 55 59% Partial 17 18% Not Implemented 2 2% N/A 19 21% Applicable Controls 74 100% Coverage (Applicable Only) 72 74%"},{"location":"projects/homelab/grc/grc-iso27001/#control-family-breakdown","title":"Control Family Breakdown","text":""},{"location":"projects/homelab/grc/grc-iso27001/#5-organizational-controls-37-controls","title":"5. Organizational Controls (37 Controls)","text":"Status Count Controls Percentage Implemented 22 A 5.1, A 5.7, A 5.9, A 5.14, A 5.15, A 5.16, A 5.17, A 5.18, A 5.23, A 5.24, A 5.25, A 5.26, A 5.27, A 5.28, A 5.29, A 5.30, A 5.33, A 5.34, A 5.36, A 5.37 (20), plus 2 partial upgraded 59% Partial 8 A 5.8, A 5.12, A 5.19, A 5.21, A 5.22, A 5.31, A 5.32 (7), plus 1 22% Not Implemented 1 A 5.13 3% N/A 6 A 5.2, A 5.3, A 5.4, A 5.5, A 5.6, A 5.10, A 5.11, A 5.20, A 5.35 (actual: A 5.2, A 5.3, A 5.4, A 5.5, A 5.6, A 5.10, A 5.11, A 5.20, A 5.35 = 9, but doc says 6) 16% Applicable Controls 31 - 100% Coverage 22/31 - 71%"},{"location":"projects/homelab/grc/grc-iso27001/#6-people-controls-8-controls_1","title":"6. People Controls (8 Controls)","text":"Status Count Controls Percentage Implemented 2 A 6.7, A 6.8 25% Partial 0 - 0% Not Implemented 0 - 0% N/A 6 A 6.1, A 6.2, A 6.3, A 6.4, A 6.5, A 6.6 75% Applicable Controls 2 - 100% Coverage 2/2 - 100%"},{"location":"projects/homelab/grc/grc-iso27001/#7-physical-controls-14-controls_1","title":"7. Physical Controls (14 Controls)","text":"Status Count Controls Percentage Implemented 2 A 7.10, A 7.14 14% Partial 4 A 7.4, A 7.5, A 7.11, A 7.13 29% Not Implemented 0 - 0% N/A 8 A 7.1, A 7.2, A 7.3, A 7.6, A 7.7, A 7.8, A 7.9, A 7.12 57% Applicable Controls 6 - 100% Coverage 2/6 - 33%"},{"location":"projects/homelab/grc/grc-iso27001/#8-technological-controls-34-controls_1","title":"8. Technological Controls (34 Controls)","text":"Status Count Controls Percentage Implemented 29 A 8.1, A 8.2, A 8.3, A 8.4, A 8.5, A 8.6, A 8.7, A 8.8, A 8.9, A 8.10, A 8.13, A 8.14, A 8.15, A 8.16, A 8.17, A 8.18, A 8.19, A 8.20, A 8.21, A 8.22, A 8.23, A 8.24, A 8.26, A 8.27, A 8.29, A 8.31, A 8.32, A 8.33 (28), plus A 8.25 reclassified 85% Partial 2 A 8.12, A 8.25 6% Not Implemented 1 A 8.11 3% N/A 2 A 8.28, A 8.30, A 8.34 (actual: 3) 6% Applicable Controls 32 - 100% Coverage 29/32 - 91%"},{"location":"projects/homelab/grc/grc-iso27001/#corrected-summary-statistics","title":"Corrected Summary Statistics","text":"Control Category Total Controls Implemented Partial Not Implemented N/A Applicable Coverage Organizational (5.x) 37 22 8 1 6* 31* 71% People (6.x) 8 2 0 0 6 2 100% Physical (7.x) 14 2 4 0 8 6 33% Technological (8.x) 34 29 2 1 2* 32* 91% TOTAL 93 55 14 2 22 71 77%"},{"location":"projects/homelab/grc/grc-iso27001/#version-history","title":"Version History","text":"Version Date Changes 1.0 January 2026 Initial assessment and summary statistics 1.1 January 2026 Corrected N/A counts and coverage percentages"},{"location":"projects/homelab/grc/grc-mitre/","title":"MITRE ATT&amp;CK Enterprise Framework v18.1","text":"<p>Document Control: Version: 1.0 Last Updated: January 2026 Owner: Paul Leone  </p> <p>Framework Version: ATT&amp;CK v18.1 (October 2025)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0001-initial-access","title":"TA0001 - Initial Access","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1078 Valid Accounts FULL Splunk correlation detects failed auth patterns; Wazuh monitors authentication logs; TheHive creates cases for brute force (&gt;5 failures/5min); Authentik enforces account lockout; SSH tracks all authentication attempts Deploy UEBA for behavioral baselines; implement impossible travel detection T1133 External Remote Services FULL pfSense logs all VPN connections; SSH session logging to SIEM; Traefik access logs track ForwardAuth requests; Uptime Kuma monitors service availability; Tailscale audit logs Add geolocation-based alerts; implement time-of-day access policies T1190 Exploit Public-Facing Application PARTIAL Weekly OpenVAS scans detect vulnerabilities; Nessus authenticated scans verify patch levels; Suricata/Snort IDS signatures; SafeLine WAF blocks OWASP Top 10 attacks (25% block rate) Deploy virtual patching via WAF rules; implement honeypot services T1566 Phishing FULL Shuffle phishing analysis workflow analyzes email headers, URLs, attachments; Cortex multi-engine analysis (VirusTotal, URLhaus, PhishTank); MISP correlates known phishing IOCs; Pi-hole blocks malicious domains Add email gateway integration; deploy user reporting mechanism; implement DMARC/SPF/DKIM validation T1091 Replication Through Removable Media FULL Group Policy blocks autorun.inf execution; Wazuh FIM monitors USB device insertion (Event ID 2003); alerts on unauthorized removable media; registry monitoring detects autorun changes Deploy USB whitelisting; implement file encryption requirements for removable media T1189 Drive-by Compromise PARTIAL Pi-hole blocks 2M+ malicious domains; Suricata/Snort detect exploit kit traffic patterns; SafeLine WAF protects web applications; DNS filtering prevents callback connections Add browser isolation technology; implement content security policies; deploy endpoint isolation for high-risk browsing T1199 Trusted Relationship PARTIAL MISP tracks vendor compromise campaigns; vulnerability scanning includes supply chain components; monitoring of third-party integrations GAP: Implement vendor security assessments; deploy third-party risk management program; add API gateway monitoring T1195 Supply Chain Compromise PARTIAL Package signature verification on Linux systems; Docker image verification (SHA-256); Git commit signing enforced GAP: Deploy SBOM tracking (Trivy/Grype); implement dependency scanning; add software composition analysis T1659 Content Injection MINIMAL SafeLine WAF blocks common injection patterns; input validation at application layer GAP: Deploy Content Security Policy (CSP) headers globally; implement subresource integrity (SRI) checks <p>Tactic Summary:</p> <p>Strengths: Strong authentication monitoring, phishing detection, network-based filtering</p> <p>Gaps: Limited supply chain visibility, minimal content injection protection</p> <p>Priority: Implement SBOM tracking (Q1 2026), enhance WAF rulesets (Q2 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0002-execution-8-of-12-techniques-67-coverage","title":"TA0002 - Execution (8 of 12 techniques - 67% coverage)","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1059.001 PowerShell FULL Sysmon captures PowerShell commands (Event ID 1, 4103, 4104); Wazuh detects obfuscated PowerShell (base64, encoded commands); Splunk searches for suspicious patterns (Invoke-Expression, DownloadString); script block logging enabled Add PowerShell Constrained Language Mode; implement JEA (Just Enough Administration) T1059.003 Windows Command Shell FULL Sysmon logs cmd.exe execution with full command-line; Wazuh detects living-off-the-land binaries (LOLBins); parent-child process analysis identifies anomalies; TheHive escalates suspicious executions Deploy application whitelisting (AppLocker/WDAC); implement command-line auditing policies T1059.006 Python PARTIAL Wazuh monitors Python process execution; auditd logs script execution on Linux; limited visibility into script content analysis GAP: Implement Python script sandboxing; add runtime application self-protection (RASP); deploy code signing requirements T1059.013 Container CLI/API PARTIAL Required Action: Enable comprehensive container command auditing: kubectl exec logging, docker exec logging, Container escape detection Wazuh: Add rules for container command execution; Splunk: Create correlation for kubectl/docker exec; Audit: Enable Kubernetes audit logging (--audit-log-path) T1053 Scheduled Task/Job FULL Wazuh monitors scheduled task creation (Event ID 4698, 106); Sysmon tracks Task Scheduler API calls; FIM detects changes to cron/Task Scheduler directories; Splunk correlates privileged task creation Add baseline of legitimate scheduled tasks; implement approval workflow for new tasks T1106 Native API PARTIAL auditd logs system calls on Linux; Sysmon captures CreateRemoteThread, VirtualAllocEx; limited direct API call visibility GAP: Deploy endpoint detection with API hooking; implement process injection detection; add kernel-level monitoring T1129 Shared Modules FULL Sysmon ImageLoad events (Event ID 7) track DLL loading; Wazuh alerts on unsigned/untrusted DLLs; code signing validation enforced; detection of DLL search order hijacking Implement DLL whitelisting; add certificate pinning for critical modules T1203 Exploitation for Client Execution PARTIAL Suricata/Snort IDS signatures detect known exploit patterns; vulnerability scanning identifies unpatched client software; Cortex analyzes suspicious files with VirusTotal GAP: Add exploit mitigation features (EMET/Windows Defender Exploit Guard); implement application sandboxing; deploy zero-day protection T1204 User Execution FULL Sysmon tracks process creation from user-writable directories; Wazuh monitors execution of files from Temp/Downloads; Cortex analyzes executables with multi-engine scanning; VirusTotal integration for malware detection Add email attachment sandboxing; implement user training simulation; deploy macro blocking policies T1569 System Services FULL Wazuh monitors service creation/modification (Event ID 7045, 7036); Sysmon tracks service installation; FIM alerts on service binary changes; unauthorized service detection Implement service whitelisting; add approval workflow for service changes T1047 Windows Management Instrumentation MINIMAL Limited WMI event monitoring; Sysmon tracks WMI activity (Event ID 19-21) GAP: Enable comprehensive WMI logging; implement WMI subscription monitoring; add WMI persistence detection T1648 Serverless Execution NOT APPLICABLE No cloud serverless infrastructure in scope N/A T1609 Container Administration Command PARTIAL Docker audit logging enabled; Kubernetes audit logs to SIEM; monitoring of kubectl/docker exec commands; see also T1059.013 for container CLI/API execution monitoring GAP: Implement admission controllers; add runtime container security (Falco); deploy container network policies <p>Tactic Summary:</p> <p>Strengths: Comprehensive process monitoring, script execution detection, service tracking</p> <p>Gaps: Limited WMI visibility, minimal API call monitoring, container CLI/API monitoring incomplete (T1059.013)</p> <p>Priority: Enhance WMI logging (immediate), implement container command auditing (T1059.013 - Q1 2026), deploy container security tools (Q2 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0003-persistence","title":"TA0003 - Persistence","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1098 Account Manipulation FULL Active Directory logs track group membership changes (Event ID 4728, 4732, 4756); Wazuh monitors user attribute modifications; Splunk correlation detects privilege escalation patterns; TheHive escalates unauthorized changes Implement privileged access management (PAM); add approval workflow for admin group changes T1136 Create Account FULL Wazuh monitors account creation (Event ID 4720 Windows, useradd Linux); Splunk alerts on new accounts created outside business hours; unauthorized account detection via baseline comparison Add account provisioning workflow; implement automated account lifecycle management T1543 Create or Modify System Process FULL Sysmon Event ID 7045 tracks service creation; Wazuh monitors systemd unit changes on Linux; FIM alerts on service binary modifications; unauthorized service detection Deploy service creation approval workflow; implement signed service binary requirement T1547 Boot or Logon Autostart Execution FULL Sysmon Event ID 13 monitors registry Run keys; Wazuh FIM tracks startup folders, /etc/init.d, systemd; detection of persistence via: Run keys, startup scripts, scheduled tasks, WMI subscriptions Add autostart location baseline; implement startup item approval process T1053 Scheduled Task/Job FULL Comprehensive monitoring (see TA0002 above); persistence-specific detection includes: task creation by non-admin users, tasks with SYSTEM privileges, tasks pointing to suspicious paths Implement task scheduler hardening; add scheduled task inventory baseline T1505 Server Software Component PARTIAL Wazuh FIM monitors web directories (/var/www, IIS wwwroot); Yara signatures detect common web shells (China Chopper, WSO, b374k); IDS signatures for web shell activity; limited PHP/ASP behavioral analysis GAP: Deploy web shell-specific detection (NeoPI); implement web application firewall with virtual patching; add file integrity baseline for web assets T1078 Valid Accounts FULL Behavioral analysis detects: unusual login times, geographic anomalies, impossible travel, privileged account usage patterns; Splunk dashboards track authentication trends; UEBA planned for Q2 2026 Deploy full UEBA capabilities; implement privileged access analytics; add session recording for admin accounts T1546.018 Event Triggered Execution: Python Startup Hooks MINIMAL No monitoring of Python startup files (.pythonrc, sitecustomize.py, usercustomize.py); Limited tracking of PYTHONSTARTUP environment variable; Wazuh FIM does not monitor Python site-packages directories GAP: Implement Wazuh FIM on ~/.pythonrc, /usr/lib/python*/site-packages, /etc/pythonrc.d/; Monitor PYTHONSTARTUP environment variable changes; Add auditd rules for Python startup file access; Deploy baseline for legitimate Python customizations T1556 Modify Authentication Process PARTIAL Wazuh FIM monitors: /etc/pam.d, LSASS process memory, credential providers, SSH authorized_keys; limited detection of in-memory credential provider injection GAP: Implement memory scanning for credential provider tampering; add LSASS protection; deploy credential guard on Windows T1197 BITS Jobs MINIMAL Limited BITS job monitoring GAP: Enable BitsAdmin logging (Event ID 59, 60, 61); implement BITS job enumeration; add suspicious BITS transfer detection T1037 Boot or Logon Initialization Scripts PARTIAL FIM monitors common script locations (bashrc, profile, logon scripts); limited detection of obfuscated scripts GAP: Add script content analysis; implement script whitelisting; deploy behavioral analysis for script execution T1176 Browser Extensions MINIMAL No browser extension monitoring GAP: Deploy browser extension inventory; implement extension whitelisting; add browser telemetry collection T1554 Compromise Client Software Binary PARTIAL FIM monitors application directories; code signing validation detects unsigned binaries; limited binary integrity verification GAP: Implement application whitelisting; add runtime binary verification; deploy EDR with process hollowing detection <p>Additional Unmonitored Persistence Techniques:</p> <ul> <li>T1137 (Office Application Startup): No Office macro/add-in monitoring</li> <li>T1525 (Implant Internal Image): No VM/container image integrity monitoring</li> <li>T1137 (Office Test): No Office persistence mechanism detection</li> <li>T1546 (Event Triggered Execution): Partial coverage; WMI, Accessibility Features need enhancement; T1546.018 (Python Startup Hooks) not monitored</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong account monitoring, registry persistence detection, service tracking</p> <p>Gaps: Limited BITS monitoring, minimal browser extension visibility, no Office persistence detection</p> <p>Priority: Enable BITS logging (immediate), deploy application binary monitoring (Q1 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0004-privilege-escalation","title":"TA0004 - Privilege Escalation","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1068 Exploitation for Privilege Escalation PARTIAL Weekly OpenVAS + monthly Nessus scans identify kernel exploits; Sysmon monitors unusual child processes from vulnerable applications; Wazuh detects known exploit patterns; limited zero-day detection GAP: Deploy exploit mitigation features (EMET, Windows Defender Exploit Guard); implement kernel patch verification; add memory exploit detection T1134 Access Token Manipulation PARTIAL Sysmon Event ID 4648 (explicit credential logon), 4672 (special privileges assigned); detection of SeDebugPrivilege abuse; limited token impersonation monitoring GAP: Implement comprehensive token manipulation detection; add Windows Defender Credential Guard; deploy API hooking for token APIs T1548 Abuse Elevation Control Mechanism PARTIAL Sysmon detects UAC bypass attempts (registry keys, file system redirects); Wazuh monitors eventvwr.exe, fodhelper.exe abuse; limited coverage of all bypass techniques GAP: Enable UAC monitoring (Event ID 4103); implement UAC configuration auditing; add detection for UIPI bypasses T1053 Scheduled Task/Job FULL Comprehensive monitoring of privileged task creation; detection of task creation with SYSTEM privileges; alerts on tasks created by non-admin users; tracking of task modification Deploy task creation approval workflow; implement privileged task baseline T1078 Valid Accounts FULL Tracks privileged account usage patterns; monitors admin account logons outside business hours; detects lateral movement via admin accounts; TheHive escalates anomalous privileged access Add privileged access management (PAM) solution; implement just-in-time (JIT) admin access T1055 Process Injection MINIMAL Sysmon captures CreateRemoteThread, QueueUserAPC; limited visibility into process hollowing, reflective DLL injection GAP: Deploy advanced EDR with process injection detection; implement memory scanning; add API hooking for injection techniques T1543 Create or Modify System Process FULL Covered under TA0003 Persistence See Persistence section T1574 Hijack Execution Flow MINIMAL FIM monitors DLL directories; limited DLL search order hijacking detection; no PATH hijacking monitoring GAP: Implement DLL preloading detection; add PATH manipulation monitoring; deploy signed binary enforcement T1484 Domain Policy Modification FULL Active Directory audit logs track GPO changes (Event ID 5136, 5137, 5141); Wazuh alerts on unauthorized GPO modifications; SIEM correlation detects privilege escalation via GPO Implement GPO change approval workflow; add GPO baseline comparison <p>Additional Unmonitored Techniques:</p> <ul> <li>T1547 (Boot or Logon Autostart): Covered under Persistence</li> <li>T1037 (Boot/Logon Initialization): Partial coverage</li> <li>T1611 (Escape to Host): No container escape detection</li> <li>T1546 (Event Triggered Execution): Partial WMI coverage; T1546.018 (Python Startup Hooks) not monitored - see Persistence section</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong privileged account monitoring, GPO change detection, scheduled task tracking</p> <p>Gaps: Minimal process injection visibility, limited UAC bypass coverage, no container escape detection</p> <p>Priority: Deploy advanced EDR for process injection (Q2 2026), enhance UAC monitoring (immediate)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0005-defense-evasion","title":"TA0005 - Defense Evasion","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1027 Obfuscated Files or Information PARTIAL Cortex Yara signatures detect packing, base64 encoding; limited entropy analysis; detection of certutil decode, PowerShell encoding GAP: Deploy advanced entropy analysis; implement sandbox detonation; add machine learning-based obfuscation detection T1036 Masquerading PARTIAL Sysmon tracks process path anomalies; Wazuh validates code signing; detection of processes running from unusual locations; limited filename spoofing detection GAP: Implement process name whitelist; add parent-child process validation; deploy binary reputation scoring T1070 Indicator Removal FULL Windows Event ID 1102 alerts on log clearing; Wazuh monitors file deletion in critical directories; immutable SIEM logs prevent tampering; FIM tracks log file modifications Add log integrity verification; implement write-once-read-many (WORM) storage for critical logs T1112 Modify Registry FULL Sysmon Event ID 13 captures all registry modifications; Wazuh FIM monitors critical registry keys; baseline deviation detection; alerts on security-related key changes Implement registry change approval workflow; add registry rollback capability T1140 Deobfuscate/Decode Files PARTIAL Process command-line monitoring detects certutil, base64 commands; limited file content analysis post-decoding GAP: Deploy file detonation sandbox; implement recursive unpacking analysis; add memory-based deobfuscation detection T1202 Indirect Command Execution PARTIAL Sysmon tracks LOLBin usage (mshta, regsvr32, rundll32, wmic); Wazuh alerts on unusual parent-child relationships; detection of script execution via non-standard interpreters GAP: Implement comprehensive LOLBin baseline; add behavioral analysis for indirect execution; deploy application control policies T1222 File and Directory Permissions Modification FULL Wazuh FIM alerts on permission changes; auditd logs chmod/chown on Linux; icacls/takeown monitoring on Windows; detection of privilege escalation via ACL modification Add permission change approval workflow; implement least privilege validation T1484 Group Policy Modification FULL Covered under TA0004 Privilege Escalation; comprehensive GPO change auditing See Privilege Escalation section T1562 Impair Defenses FULL Wazuh monitors: Windows Defender tampering (registry, services), firewall rule changes, security service stops, log deletion attempts; alerts on antimalware service termination Implement tamper protection; add service recovery automation; deploy security tool health monitoring T1564 Hide Artifacts MINIMAL FIM monitors hidden file creation; limited alternate data stream (ADS) detection; no VBA stomping detection GAP: Enable ADS scanning; implement VBA source code extraction; add hidden process detection T1601 Modify System Image NOT APPLICABLE Network device firmware monitoring not implemented (firewall managed via pfSense) N/A for current scope T1006 Direct Volume Access MINIMAL Limited raw disk access monitoring GAP: Deploy volume shadow copy monitoring; add raw disk access alerting; implement VSS change detection"},{"location":"projects/homelab/grc/grc-mitre/#new-defense-evasion-techniques-in-v181","title":"New Defense Evasion Techniques in v18.1","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1678 Delay Execution MINIMAL Limited sleep/timeout command monitoring; Sysmon captures timeout.exe, sleep commands; no behavioral analysis for time-delay patterns GAP: Implement detection for extended sleep commands (&gt;60 seconds); Add correlation for delays preceding malicious activity; Deploy sandbox evasion detection; Monitor timeout/sleep in scripts T1679 Selective Exclusion PARTIAL Wazuh monitors Windows Defender exclusion additions (registry HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions); Limited detection of firewall/EDR exclusions GAP: Monitor all security tool configuration changes; Alert on antivirus exclusion paths (especially C:\\Windows, C:\\Users); Track pfSense/firewall bypass rule additions; Implement security tool configuration baseline T1036.012 Masquerading: Browser Fingerprint MINIMAL No browser fingerprinting detection; limited user-agent analysis in Traefik/Suricata logs GAP: Deploy browser telemetry collection; Implement user-agent anomaly detection; Add browser fingerprinting signature detection (Canvas, WebGL); Monitor for automation frameworks (Puppeteer, Selenium) T1562.013 Disable or Modify Network Device Firewall PARTIAL pfSense logs firewall rule changes via syslog; Limited SNMP monitoring for network devices GAP: Implement SNMP trap monitoring for all network devices; Add Checkmk SNMP monitoring for firewall config changes; Deploy configuration backup validation; Alert on unauthorized firewall rule deletions <p>Major Unmonitored Defense Evasion Techniques:</p> <ul> <li>T1550 (Use Alternate Authentication Material): Pass-the-hash, pass-the-ticket detection needed</li> <li>T1218 (System Binary Proxy Execution): Partial LOLBin coverage; need comprehensive monitoring</li> <li>T1207 (Rogue Domain Controller): No DC replication monitoring</li> <li>T1620 (Reflective Code Loading): No in-memory module detection</li> <li>T1553 (Subvert Trust Controls): Code signing bypass detection limited</li> <li>T1497 (Virtualization/Sandbox Evasion): No sandbox evasion detection</li> <li>T1599 (Network Boundary Bridging): No network bridge detection</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong log protection, registry monitoring, security tool tampering detection</p> <p>Gaps: Minimal obfuscation analysis, limited indirect execution detection, no alternate authentication material monitoring, new v18.1 techniques (T1678 Delay Execution, T1679 Selective Exclusion, T1036.012 Browser Fingerprint, T1562.013 Network Device Firewall) require enhancement</p> <p>Priority: Deploy advanced obfuscation detection (Q2 2026), implement pass-the-hash monitoring (Q1 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0006-credential-access","title":"TA0006 - Credential Access","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1003 OS Credential Dumping FULL Sysmon Event ID 10 detects LSASS process access; Wazuh alerts on Mimikatz signatures; detection of SAM/SYSTEM file access; monitoring of credential dumping tools (pwdump, gsecdump) Deploy Windows Defender Credential Guard; implement LSASS protection (RunAsPPL); add memory scanning for credential extraction T1110 Brute Force FULL Multi-source correlation: failed logins from firewall, SSH, Authentik, RDP; Shuffle workflow creates TheHive cases for brute force (&gt;5 failures/5min); account lockout enforcement; IP-based rate limiting Add distributed brute force detection; implement CAPTCHA after failed attempts; deploy geolocation-based blocking T1555 Credentials from Password Stores PARTIAL Wazuh FIM monitors browser credential directories (Chrome, Firefox); limited coverage of password manager access (KeePass, 1Password); no macOS Keychain monitoring GAP: Implement comprehensive password store monitoring; add credential access behavioral analysis; deploy browser credential protection T1552 Unsecured Credentials PARTIAL Wazuh FIM monitors sensitive directories (/root/.ssh, .aws, .kube); Yara signatures detect credential patterns in files; limited coverage of memory credential scanning GAP: Deploy secret scanning tools (TruffleHog, GitLeaks); implement memory credential detection; add configuration file credential scanning T1528 Steal Application Access Token MINIMAL Limited OAuth token monitoring GAP: Implement OAuth token theft detection; add API token usage monitoring; deploy token expiration enforcement T1557 Adversary-in-the-Middle MINIMAL TLS validation prevents MITM; limited ARP spoofing detection GAP: Deploy ARP spoofing detection (ArpWatch); implement certificate pinning; add network anomaly detection for MITM T1558 Steal or Forge Kerberos Tickets MINIMAL No Kerberos ticket monitoring (Event ID 4769, 4768) GAP: Enable Kerberos event logging; implement golden/silver ticket detection; add Kerberos encryption downgrade monitoring T1539 Steal Web Session Cookie MINIMAL No browser cookie theft monitoring GAP: Implement session hijacking detection; add browser telemetry; deploy session binding (IP, User-Agent validation) <p>Additional Unmonitored Techniques:</p> <ul> <li>T1556 (Modify Authentication Process): Partial coverage under Persistence</li> <li>T1040 (Network Sniffing): No promiscuous mode detection</li> <li>T1111 (Multi-Factor Authentication Interception): No MFA push notification monitoring</li> <li>T1606 (Forge Web Credentials): No SAML token forgery detection</li> <li>T1649 (Steal or Forge Authentication Certificates): No certificate theft detection</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong brute force detection, LSASS access monitoring, credential dumping detection</p> <p>Gaps: Minimal Kerberos monitoring, limited password store coverage, no session hijacking detection</p> <p>Priority: Enable Kerberos logging (immediate), implement session monitoring (Q1 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0007-discovery","title":"TA0007 - Discovery","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1087 Account Discovery FULL Command-line monitoring detects: net user, net group, whoami, id, getent; Wazuh tracks LDAP queries (Event ID 4662); Active Directory enumeration alerts; detection of account enumeration via SMB Add baseline of legitimate discovery activity; implement honeypot accounts for detection T1010 Application Window Discovery PARTIAL Limited GUI enumeration detection; process monitoring tracks tasklist, Get-Process GAP: Implement GUI interaction monitoring; add screenshot detection; deploy user activity analytics T1217 Browser Bookmark Discovery PARTIAL Wazuh FIM monitors browser profile access; limited content analysis of bookmarks GAP: Deploy browser telemetry collection; add bookmark enumeration detection; implement user behavior analytics T1482 Domain Trust Discovery FULL Active Directory logs LDAP queries (Event ID 4662); Wazuh monitors nltest, dsquery commands; detection of trust enumeration; SMB session monitoring Implement AD enumeration baseline; add honeypot OUs for detection T1083 File and Directory Discovery FULL Sysmon/auditd tracks dir, ls, find commands; detection of recursive directory traversal; monitoring of file enumeration in sensitive directories; alerts on rapid file system scanning Add file access behavioral baseline; implement honeypot files for detection T1046 Network Service Discovery FULL Suricata/Snort detect port scans (SYN scans, full connects, UDP scans); pfSense logs scan activity; Splunk correlates reconnaissance patterns; detection of network sweeps Deploy deception technology (honeypots); implement port scan response automation T1049 System Network Connections Discovery FULL Sysmon Event ID 3 logs network connections; auditd tracks netstat commands; monitoring of connection enumeration; detection of network profiling Add network connection baseline; implement connection anomaly detection T1018 Remote System Discovery FULL Suricata/Snort detect network sweeps; detection of ping sweeps, ARP scans; monitoring of network reconnaissance tools (nmap, masscan); pfSense logs scanning activity Deploy network segmentation alerting; add internal reconnaissance detection T1082 System Information Discovery FULL Command-line monitoring tracks: systeminfo, uname, hostname, Get-ComputerInfo; detection of system profiling commands; monitoring of WMI queries for system info Implement discovery command baseline; add system information honeypot values T1016 System Network Configuration Discovery FULL Monitors ipconfig, ifconfig, ip addr, route, netsh commands; detection of network adapter enumeration; tracking of routing table queries Add network configuration change alerting; implement network topology obfuscation T1007 System Service Discovery PARTIAL Monitors sc query, systemctl, service commands; limited behavioral analysis GAP: Implement service enumeration baseline; add service discovery anomaly detection T1518.002 Backup Software Discovery FULL Sysmon/auditd tracks backup software processes; Command-line monitoring detects backup enumeration queries; Registry monitoring (HKLM\\SOFTWARE\\Backup); Process monitoring for backup service queries (Get-Service, sc query) Implement backup software inventory baseline; add behavioral detection for rapid backup enumeration; deploy honeypot backup configurations T1680 Local Storage Discovery PARTIAL Command-line monitoring detects df, mount, lsblk, fsutil commands; auditd logs storage queries on Linux; limited behavioral baseline for storage enumeration patterns GAP: Implement behavioral baseline for normal storage discovery; Add detection for rapid enumeration (&gt;10 queries/min); Deploy SIEM correlation for unusual storage profiling patterns; Add cloud storage enumeration detection T1124 System Time Discovery PARTIAL Limited time discovery monitoring (net time, w32tm) GAP: Add time synchronization monitoring; implement time-based behavioral analysis <p>Additional Unmonitored Discovery Techniques:</p> <ul> <li>T1069 (Permission Groups Discovery): Partial coverage; need comprehensive group enumeration detection</li> <li>T1057 (Process Discovery): Process listing commands monitored; behavioral analysis needed</li> <li>T1012 (Query Registry): Limited registry query monitoring outside of modifications</li> <li>T1518 (Software Discovery): Vulnerability scanners provide inventory; T1518.002 (Backup Software Discovery) fully covered via process/registry monitoring; limited detection for other software enumeration patterns</li> <li>T1135 (Network Share Discovery): No share enumeration monitoring (net view, net share)</li> <li>T1201 (Password Policy Discovery): No password policy query detection (net accounts)</li> <li>T1120 (Peripheral Device Discovery): No device enumeration monitoring</li> <li>T1614 (System Location Discovery): No geolocation discovery monitoring</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong network reconnaissance detection, comprehensive command-line monitoring, AD enumeration tracking</p> <p>Gaps: Limited share enumeration detection, minimal peripheral discovery monitoring, no password policy query detection, local storage discovery (T1680) needs behavioral baseline</p> <p>Priority: Implement share enumeration monitoring (Q1 2026), add peripheral device tracking (Q2 2026), enhance local storage discovery detection (T1680 - Q1 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0008-lateral-movement","title":"TA0008 - Lateral Movement","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1210 Exploitation of Remote Services PARTIAL Suricata/Snort signatures detect known exploits (EternalBlue, BlueKeep); vulnerability scanning identifies exploitable services; limited zero-day detection GAP: Deploy exploit detection via behavioral analysis; implement exploit mitigation features; add honeypot services T1021.001 Remote Desktop Protocol FULL Suricata monitors RDP traffic; Wazuh tracks RDP sessions (Event ID 4624 type 10, 4625); Splunk correlates unusual RDP patterns; detection of RDP from unusual sources; monitoring of RDP tunneling Implement RDP gateway with MFA; add session recording; deploy geographic restrictions T1021.002 SMB/Windows Admin Shares FULL Suricata monitors SMB traffic; Event logs track admin share access (Event ID 5140, 5145); Wazuh alerts on lateral movement via PsExec, WMIC; detection of administrative tool usage Deploy SMB signing enforcement; implement network segmentation; add admin share access baseline T1021.004 SSH FULL Comprehensive SSH logging to SIEM; Wazuh monitors all SSH sessions; detection of: key-based auth anomalies, unusual SSH sources, privilege escalation via sudo; Splunk tracks SSH lateral movement patterns Implement SSH certificate authority; add session recording; deploy jump host architecture T1080 Taint Shared Content PARTIAL Wazuh FIM monitors shared directories; detection of file modifications on network shares; limited content tampering detection GAP: Implement share access behavioral baseline; add file integrity verification; deploy honeypot files on shares T1563 Remote Service Session Hijacking PARTIAL Limited session hijacking detection; monitoring of unusual session activity GAP: Implement session validation (IP, User-Agent binding); add session termination on anomaly; deploy privileged session monitoring T1021.006 Windows Remote Management MINIMAL Limited WinRM monitoring (Event ID 4688 for wsmprovhost.exe) GAP: Enable comprehensive WinRM logging (Event ID 6, 91, 168); implement WinRM usage baseline; add remote PowerShell detection T1072 Software Deployment Tools MINIMAL No SCCM/deployment tool monitoring GAP: Implement deployment tool activity monitoring; add unauthorized deployment detection; deploy approval workflow T1550 Use Alternate Authentication Material MINIMAL No pass-the-hash/pass-the-ticket detection GAP: Enable detection of: pass-the-hash (Event ID 4624/4625 type 9), pass-the-ticket (Kerberos anomalies), token theft; deploy Credential Guard <p>Tactic Summary:</p> <p>Strengths: Strong RDP/SMB/SSH monitoring, comprehensive authentication logging, lateral movement detection</p> <p>Gaps: Minimal WinRM visibility, no pass-the-hash detection, limited deployment tool monitoring</p> <p>Priority: Implement pass-the-hash detection (immediate), enable WinRM logging (Q1 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0009-collection","title":"TA0009 - Collection","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1560 Archive Collected Data PARTIAL Process monitoring detects: 7zip, WinRAR, tar, zip commands; Wazuh tracks archive creation in suspicious locations; limited behavioral analysis of data staging GAP: Implement data staging detection via file access patterns; add archive content analysis; deploy DLP for sensitive data archiving T1123 Audio Capture PARTIAL Limited microphone access monitoring; process monitoring detects audio recording tools GAP: Implement audio device access controls; add microphone usage monitoring; deploy privacy controls T1005 Data from Local System PARTIAL Wazuh FIM detects mass file access; limited data exfiltration staging detection; monitoring of file access in sensitive directories GAP: Deploy DLP for sensitive file access; implement data classification; add user entity behavior analytics (UEBA) for abnormal file access T1039 Data from Network Shared Drive MINIMAL No dedicated network share access monitoring beyond authentication logs GAP: Implement share access behavioral baseline; deploy file access auditing on shares; add DLP for share-based exfiltration T1025 Data from Removable Media PARTIAL Wazuh monitors USB device insertion (Event ID 2003); limited file access monitoring from removable media GAP: Implement removable media file access tracking; add DLP for USB data transfers; deploy device control policies T1074 Data Staged MINIMAL Limited staging location monitoring; file creation in Temp directories tracked GAP: Implement behavioral detection for data staging; add anomaly detection for large file consolidation; deploy honeypot staging directories T1213.006 Data from Information Repositories: Databases MINIMAL No database-specific monitoring implemented; limited visibility into database query patterns or mass data extraction GAP: Implement database access logging (MySQL/PostgreSQL audit logs); Deploy query monitoring for mass SELECT statements; Add SIEM correlation for unusual database access patterns; Implement database exfiltration detection (large result sets, off-hours queries); Consider if databases are in lab scope T1114 Email Collection MINIMAL No email access monitoring (Outlook PST, webmail) GAP: Deploy email access auditing; implement mailbox audit logging; add email exfiltration detection T1115 Clipboard Data NOT APPLICABLE No clipboard monitoring capabilities GAP: Implement clipboard access detection; add clipboard content analysis for sensitive data T1530 Data from Cloud Storage NOT APPLICABLE Minimal cloud storage usage; no cloud access monitoring N/A or deploy cloud access security broker (CASB) if cloud usage increases <p>Major Unmonitored Collection Techniques:</p> <ul> <li>T1213.006 (Data from Databases): No database query monitoring or exfiltration detection</li> <li>T1056 (Input Capture): No keylogger detection, credential input monitoring</li> <li>T1113 (Screen Capture): No screenshot detection capabilities</li> <li>T1125 (Video Capture): No webcam access monitoring</li> <li>T1119 (Automated Collection): Limited detection of automated data gathering scripts</li> <li>T1185 (Browser Session Hijacking): No browser extension/plugin monitoring for data theft</li> <li>T1213 (Data from Information Repositories): T1213.006 (Databases) not monitored; No SharePoint/wiki/documentation platform monitoring</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Basic archive detection, USB device monitoring, file access tracking</p> <p>Gaps: Minimal DLP capabilities, no email collection detection, limited staging detection</p> <p>Priority: Deploy DLP solution (Q2 2026), implement email auditing (Q1 2026), add UEBA for collection detection (Q2 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0010-exfiltration","title":"TA0010 - Exfiltration","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1020 Automated Exfiltration PARTIAL pfSense monitors bandwidth usage; Prometheus tracks outbound traffic volume; Suricata detects large data transfers; threshold alerts for unusual upload rates GAP: Implement behavioral baseline for normal data transfers; add time-series anomaly detection; deploy DLP for automated exfiltration prevention T1030 Data Transfer Size Limits PARTIAL Network monitoring detects chunked transfers; Splunk analyzes transfer patterns; limited detection of data obfuscation via chunking GAP: Implement transfer pattern analysis; add detection for slow exfiltration; deploy statistical analysis of outbound data sizes T1048 Exfiltration Over Alternative Protocol PARTIAL Suricata monitors non-standard protocols; pfSense logs unusual port usage; DNS tunneling detection via query analysis (Pi-hole); ICMP tunneling detection GAP: Enhance DNS tunneling detection (entropy analysis, subdomain length); add steganography detection; implement protocol anomaly detection T1041 Exfiltration Over C2 Channel FULL Suricata/Snort detect C2 beacon patterns; pfSense logs all outbound connections; MISP correlates known C2 IOCs; Cortex enriches suspicious IPs with threat intelligence; TheHive tracks C2 communications Deploy automated C2 blocking; implement beacon detection (jitter analysis); add domain generation algorithm (DGA) detection T1011 Exfiltration Over Other Network Medium MINIMAL No Bluetooth/WiFi exfiltration monitoring GAP: Implement wireless network monitoring; add Bluetooth device detection; deploy air-gapped network controls T1052 Exfiltration Over Physical Medium PARTIAL USB device insertion monitored; limited file transfer tracking to removable media GAP: Implement USB file transfer auditing; add DLP for removable media; deploy device control policies with allow/block lists T1567 Exfiltration Over Web Service MINIMAL TLS inspection limited; no web service-specific exfiltration detection (Dropbox, Google Drive, Pastebin) GAP: Deploy web service usage monitoring; implement cloud DLP; add web traffic categorization; monitor OAuth token usage T1029 Scheduled Transfer MINIMAL Limited detection of scheduled exfiltration tasks GAP: Correlate scheduled tasks with network activity; add time-based exfiltration pattern detection; implement job scheduler monitoring T1537 Transfer Data to Cloud Account MINIMAL No cloud upload monitoring GAP: Deploy CASB for cloud service monitoring; implement cloud DLP; add sanctioned vs. unsanctioned cloud service detection <p>Tactic Summary:</p> <p>Strengths: Strong C2 detection, DNS tunneling monitoring, bandwidth alerting</p> <p>Gaps: Limited web service exfiltration detection, no physical medium file tracking, minimal cloud exfiltration monitoring</p> <p>Priority: Deploy DLP capabilities (Q2 2026), implement web service monitoring (Q1 2026), add physical media auditing (Q1 2026)</p> <p>Note on ATT&amp;CK v18.1 Updates:</p> <ul> <li>T1681 (Search Threat Vendor Data): Reconnaissance technique; not directly detectable in lab environment (external attacker activity)</li> <li>T1677 (Poisoned Pipeline Execution): Not applicable unless CI/CD pipelines are in scope; see Execution section if implementing</li> </ul>"},{"location":"projects/homelab/grc/grc-mitre/#ta0011-command-and-control","title":"TA0011 - Command and Control","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1071 Application Layer Protocol FULL Suricata/Snort analyze HTTP/HTTPS traffic patterns; pfSense logs all application protocols; Traefik access logs provide HTTP visibility; detection of C2 over HTTP/HTTPS, DNS, SMTP Deploy TLS inspection for encrypted C2; implement user-agent analysis; add HTTP header anomaly detection T1132 Data Encoding PARTIAL Suricata detects base64, hex encoding in traffic; limited entropy analysis; Splunk searches for encoded data patterns GAP: Implement comprehensive entropy analysis; add multi-layer decoding detection; deploy ML-based encoding detection T1001 Data Obfuscation PARTIAL Suricata monitors traffic anomalies; limited protocol obfuscation detection; detection of steganography signatures GAP: Deploy steganography detection tools; implement protocol conformance validation; add traffic normalization analysis T1568 Dynamic Resolution FULL Pi-hole logs all DNS queries; pfSense DNS logs forwarded to SIEM; Suricata detects DGA patterns; detection of: fast flux, domain generation algorithms, DNS tunneling; MISP correlates suspicious domains Enhance DGA detection with ML models; implement NXDomain tracking; add DNS reputation scoring T1573 Encrypted Channel PARTIAL Suricata analyzes TLS metadata (certificate details, cipher suites, JA3 fingerprints); limited TLS decryption capabilities; detection of unusual TLS patterns GAP: Deploy TLS inspection infrastructure; implement certificate anomaly detection; add JA3/JA3S fingerprint threat intelligence T1571 Non-Standard Port FULL Suricata/pfSense detect protocol-port mismatches (HTTP on 8443, SSH on 443); Splunk correlates unusual port usage; detection of port obfuscation; monitoring of all non-standard service ports Add port usage behavioral baseline; implement service fingerprinting; deploy protocol conformance validation T1095 Non-Application Layer Protocol PARTIAL Suricata monitors ICMP tunneling; pfSense logs raw socket connections; limited detection of custom protocols GAP: Implement comprehensive ICMP analysis; add GRE/IPIP tunnel detection; deploy protocol anomaly detection T1572 Protocol Tunneling PARTIAL Suricata detects SSH tunneling, DNS tunneling, VPN-over-DNS; limited detection of protocol encapsulation techniques GAP: Deploy comprehensive tunneling detection; implement encapsulation pattern analysis; add behavioral baseline for tunneling T1090 Proxy FULL pfSense logs proxy connections; Suricata detects SOCKS, HTTP proxy usage; detection of: internal proxy usage, unusual proxy chains, tor exit nodes Add proxy authentication enforcement; implement proxy reputation scoring; deploy allowlist for legitimate proxies T1219 Remote Access Software MINIMAL Limited remote access tool detection (TeamViewer, AnyDesk, LogMeIn signatures in Suricata) GAP: Deploy comprehensive remote access tool inventory; implement application control for remote access; add remote access behavioral baseline T1105 Ingress Tool Transfer PARTIAL Monitors file downloads via HTTP/HTTPS; PowerShell DownloadFile detection; limited executable download analysis GAP: Implement comprehensive download monitoring; add executable reputation checking; deploy sandbox for downloaded files T1104 Multi-Stage Channels MINIMAL Limited multi-stage C2 detection GAP: Implement C2 session correlation across channels; add multi-protocol C2 detection; deploy behavioral analysis for staged communication <p>Additional Unmonitored C2 Techniques:</p> <ul> <li>T1102 (Web Service): Limited detection of C2 over legitimate web services (Twitter, GitHub, Pastebin)</li> <li>T1659 (Content Injection): Minimal content injection detection in C2 channels</li> <li>T1205 (Traffic Signaling): No port knocking or traffic manipulation detection</li> <li>T1665 (Hide Infrastructure): Limited CDN/cloud fronting detection</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Strong DNS monitoring, proxy detection, non-standard port identification</p> <p>Gaps: Limited TLS inspection, minimal remote access tool detection, no traffic signaling monitoring</p> <p>Priority: Deploy TLS inspection (Q2 2026), implement remote access tool controls (Q1 2026), add web service C2 detection (Q2 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#ta0040-impact","title":"TA0040 - Impact","text":"Technique ID Technique Name Defense Status Lab Implementation Recommendations T1485 Data Destruction PARTIAL Wazuh FIM detects mass file deletion (&gt;50 files/min); monitoring of del, rm, Remove-Item commands; limited detection of secure wipe tools GAP: Implement file deletion behavioral baseline; add volume shadow copy deletion detection; deploy immutable backups T1486 Data Encrypted for Impact FULL Wazuh detects mass file modification (&gt;50 files/min); Shuffle ransomware workflow monitors: file extension changes (.encrypted, .locked), ransomware note creation (README.txt), encryption tool execution; automated containment via Active Response; sub-30-minute MTTR Deploy ransomware-specific behavioral detection; implement canary files for early detection; add automated network isolation T1490 Inhibit System Recovery PARTIAL Wazuh FIM monitors backup file access; Event ID 524 (VSS deletion) alerts; limited vssadmin, wbadmin command detection GAP: Implement comprehensive backup tampering detection; add volume shadow copy protection; deploy immutable backup verification T1498 Network Denial of Service PARTIAL Suricata detects SYN floods, UDP floods; pfSense monitors bandwidth spikes; Prometheus alerts on connection exhaustion; limited distributed DDoS detection GAP: Deploy comprehensive DDoS mitigation; implement rate limiting at firewall; add uplink provider DDoS protection T1496 Resource Hijacking FULL Prometheus monitors CPU/memory anomalies; Grafana alerts on sustained high resource usage; Wazuh detects cryptomining processes (xmrig, cpuminer); detection of GPU mining activity; Checkmk infrastructure monitoring Add cryptomining network pattern detection; implement process reputation scoring; deploy GPU usage monitoring T1489 Service Stop FULL Wazuh monitors service stop events (Event ID 7036); systemd service failures tracked; critical service protection alerts; detection of security service termination; automated service recovery Implement service stop approval workflow; add critical service health checks; deploy service dependency mapping T1657 Financial Theft NOT APPLICABLE No financial transaction monitoring in scope N/A T1491 Defacement PARTIAL Wazuh FIM monitors web directories; limited web content integrity verification GAP: Implement website content baseline; add automated defacement detection; deploy web application integrity monitoring T1561 Disk Wipe MINIMAL Limited detection of disk wipe tools (diskpart, dd, shred) GAP: Implement disk modification monitoring; add MBR/boot sector protection; deploy bootloader integrity verification T1499 Endpoint Denial of Service PARTIAL Resource exhaustion monitoring; process CPU/memory limits; limited fork bomb detection GAP: Implement process spawn rate limiting; add resource quota enforcement; deploy fork bomb detection <p>Additional Unmonitored Impact Techniques:</p> <ul> <li>T1495 (Firmware Corruption): No UEFI/BIOS integrity monitoring</li> <li>T1529 (System Shutdown/Reboot): Limited shutdown command monitoring</li> <li>T1531 (Account Access Removal): No bulk account deletion detection</li> </ul> <p>Tactic Summary:</p> <p>Strengths: Excellent ransomware detection, strong resource hijacking monitoring, service stop protection</p> <p>Gaps: Limited disk wipe detection, minimal defacement monitoring, no firmware integrity verification</p> <p>Priority: Implement disk modification monitoring (Q1 2026), add defacement detection (Q1 2026), deploy firmware integrity checks (Q3 2026)</p>"},{"location":"projects/homelab/grc/grc-mitre/#overall-coverage-summary","title":"Overall Coverage Summary","text":"<p>Coverage by Tactic</p> Tactic Coverage Maturity Priority Enhancements Initial Access 67% (6/9) Strong SBOM tracking, content injection detection (T1659 existing) Execution 67% (9/13) Strong WMI logging, container CLI/API (T1059.013), container security enhancement Persistence 37% (8/20) Moderate BITS monitoring, browser extension tracking, Office persistence, Python startup hooks (T1546.018) Privilege Escalation 38% (5/13) Moderate Process injection detection, UAC bypass enhancement, container escape detection Defense Evasion 21% (13/46) Weak Obfuscation analysis, pass-the-hash detection, alternate auth material monitoring, v18.1 techniques (T1678, T1679, T1036.012, T1562.013) Credential Access 27% (4/15) Weak Kerberos monitoring, session hijacking detection, password store coverage Discovery 30% (10/32) Moderate Share enumeration, peripheral tracking, backup software (T1518.002 covered), local storage (T1680) baseline Lateral Movement 56% (5/9) Strong Pass-the-hash detection, WinRM logging, deployment tool monitoring Collection 20% (4/18) Weak DLP implementation, email auditing, UEBA, database monitoring (T1213.006) Exfiltration 44% (4/9) Moderate DLP deployment, web service monitoring, physical media auditing Command and Control 38% (6/16) Moderate TLS inspection, remote access tool controls, web service C2 detection Impact 46% (6/13) Moderate Disk modification monitoring, defacement detection, firmware integrity <p>Overall lab coverage: 30% (65 techniques of 216)</p>"},{"location":"projects/homelab/grc/grc-mitre/#key-changes-in-v181","title":"Key Changes in v18.1","text":"Change Type Count Details New Techniques 12 T1059.013, T1213.006, T1678, T1546.018, T1562.013, T1680, T1036.012, T1677, T1681, T1679, T1518.002, T1204.005 Total Techniques 216 Increased from 191 (13% growth) Total Sub-techniques 475 Increased from 385 (23% growth) Lab Coverage Impact -4% Coverage adjusted from 34% to 30% due to denominator increase"},{"location":"projects/homelab/grc/grc-mitre/#threat-intelligence-updates","title":"Threat Intelligence Updates","text":"<p>New Threat Actors (Update MISP):</p> <ul> <li>G1053 - Storm-0501 (Ransomware operations)</li> <li>G1048 - UNC3886 (VMware/network device exploitation)</li> <li>G1052 - Contagious Interview (Supply chain via fake interviews)</li> <li>G1051 - Medusa Group (Ransomware)</li> <li>G1050 - Water Galura (APT/critical infrastructure)</li> <li>G1049 - AppleJeus (Cryptocurrency theft)</li> </ul> <p>New Malware Families (Update IDS Signatures):</p> <ul> <li>S1240 - RedLine Stealer</li> <li>S1242 - Qilin Ransomware</li> <li>S1244 - Medusa Ransomware</li> <li>S1111 - DarkGate Loader</li> <li>S1229 - Havoc C2 Framework</li> <li>S1247 - Embargo Ransomware</li> <li>S1245 - InvisibleFerret Backdoor</li> </ul>"},{"location":"projects/homelab/grc/grc-nist-800/","title":"NIST SP 800-53 Rev 5 Framework","text":"<p>Document Control: Version: 1.0 Last Updated: January 2026 Owner: Paul Leone Classification: Internal Use  </p> <p>Framework Version: NIST SP 800-53 Revision 5</p>"},{"location":"projects/homelab/grc/grc-nist-800/#access-control-ac-family","title":"Access Control (AC) Family","text":"Control Control Name Implementation Status AC-1 Policy and Procedures Lab mission statement defines security-first architecture; documented access control requirements Implemented AC-2 Account Management Authentik user lifecycle management; SSH individual user accounts; Wazuh tracks active sessions; no shared credentials Implemented AC-2(1) Automated System Account Management Authentik automated provisioning/deprovisioning Implemented AC-2(2) Automated Temporary Account Management N/A - No temporary accounts in lab environment N/A AC-2(3) Disable Accounts Authentik automated account disabling after 90 days inactivity Partial AC-2(4) Automated Audit Actions SIEM tracks all account creation/modification/deletion Implemented AC-2(5) Inactivity Logout Authentik 30-min idle timeout; SSH ClientAliveInterval=300 Implemented AC-2(7) Privileged User Accounts Separate admin accounts; monitored via SIEM; MFA enforced Implemented AC-2(9) Restrictions on Shared Accounts N/A -- Single user home lab N/A AC-2(12) Account Monitoring Atypical Usage Splunk behavioral analysis; unusual login times/geoIP tracking Partial AC-2(13) Disable High-Risk Accounts Wazuh Active Response disables compromised accounts. Remote access via root is not authorized. Implemented AC-3 Access Enforcement Authentik/AD RBAC groups; SSH sudo enforcement; Traefik middleware access control Implemented AC-3(7) Role-Based Access Control Authentik groups map to application permissions; AD OUs for Windows Implemented AC-3(8) Revocation of Access Centralized SSH key revocation via Ansible; Authentik account deactivation Implemented AC-5 Separation of Duties N/A -- Single user home lab N/A AC-6 Least Privilege SSH sudo policies; Authentik role-based permissions; minimal access granted Implemented AC-6(1) Authorize Access to Security Functions Security tool access restricted to SOC role; documented in Authentik Implemented AC-6(2) Non-Privileged Access for Non-Security Functions Standard user accounts for daily operations Implemented AC-6(5) Privileged Accounts Separate privileged accounts; monitored; MFA enforced Implemented AC-6(9) Log Use of Privileged Functions All sudo commands logged to SIEM; Windows privileged operations audited Implemented AC-7 Unsuccessful Logon Attempts SSH MaxAuthTries=5; Authentik lockout after 5 failures; Wazuh active-response Implemented AC-8 System Use Notification SSH banner configured; Authentik login notice Implemented AC-11 Device Lock N/A -- Single user home lab N/A AC-12 Session Termination Authentik session timeout; SSH automatic disconnect Implemented AC-17 Remote Access SSH hardening; IP restrictions (firewall + Traefik); MFA for admin access; Tailscale VPN Implemented AC-17(1) Monitoring and Control VPN connections logged; SSH sessions monitored; Traefik access logs Implemented AC-17(2) Protection via Encryption SSH AES-256-GCM; TLS 1.3 (Traefik); Tailscale WireGuard Implemented AC-17(4) Privileged Commands via Remote Access Privileged SSH sessions logged separately; sudo usage tracked Implemented AC-17(9) Disconnect or Disable Access Remote access can be disabled via firewall rules; Tailscale ACLs Partial AC-17(10) Authenticate Remote Commands SSH key-based authentication; command verification via logging Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#audit-and-accountability-au-family","title":"Audit and Accountability (AU) Family","text":"Control Control Name Implementation Status AU-1 Policy and Procedures Comprehensive logging policy documented; 100% security event coverage requirement Implemented AU-2 Event Logging DNS queries, SSH sessions, Traefik requests, patch events, scan activity, Wazuh events logged Implemented AU-3 Content of Audit Records Logs include: timestamp, user, source IP, action, result; Wazuh includes file hashes, process trees Implemented AU-3(1) Additional Audit Information SSH key fingerprints, DNS query details, Traefik request/response, Sysmon process telemetry Implemented AU-4 Audit Log Storage Capacity 90-day retention; auto-archival to cold storage; capacity monitoring via Prometheus Implemented AU-5 Response to Audit Logging Process Failures SIEM alerts on logging failures; redundant log paths (local + remote) Implemented AU-5(1) Storage Capacity Warning Prometheus/Pulse alerts at 80% capacity; automated archival triggers, Proxmox and NAS storage monitoring. Implemented AU-5(2) Real-Time Alerts Splunk/Elastic real-time correlation; Wazuh instant alerts; sub-60s notification latency Implemented AU-6 Audit Record Review Splunk/ Elastic dashboards (DNS/SSH/Traefik); automated correlation; vulnerability trending; Wazuh dashboards Implemented AU-6(1) Automated Process Integration SIEM correlation across Splunk/Elastic/Wazuh; TheHive case aggregation; n8n/Shuffle workflows Implemented AU-6(3) Correlate Audit Record Repositories Multi-source correlation: Splunk + Elastic + Wazuh + network logs; unified timeline analysis Implemented AU-6(5) Integrated Analysis Cortex multi-engine analysis; MISP threat intelligence; Shuffle enrichment pipelines Implemented AU-7 Audit Record Reduction Splunk SPL queries; Elastic KQL; Wazuh filters; automated report generation Implemented AU-7(1) Automatic Processing Scheduled Splunk searches; Elastic detection rules; automated dashboards Implemented AU-9 Protection of Audit Information Logs forwarded to immutable SIEM; Splunk read-only indexes; syslog-ng TLS encryption; Elastic immutable streams Implemented AU-11 Audit Record Retention 90-day hot retention; 1-year cold storage; automated lifecycle management Implemented AU-12 Audit Record Generation Universal Forwarders (30+ hosts); Elastic Agents; Wazuh agents (25+); structured JSON format Implemented AU-12(1) System-Wide Audit Trail Centralized logging across all infrastructure; time-correlated via NTP (SC-45) Implemented AU-12(2) Standardized Formats JSON/CEF formats; normalized in SIEM; CIM-compliant (Splunk) Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#assessment-authorization-and-monitoring-ca-family","title":"Assessment, Authorization, and Monitoring (CA) Family","text":"Control Control Name Implementation Status CA-1 Policy and Procedures Assessment and authorization policy documented; continuous monitoring strategy defined Implemented CA-2 Control Assessments Weekly OpenVAS scans; monthly Nessus authenticated scans; CIS Benchmark audits; Wazuh SCA Implemented CA-2(1) Independent Assessors N/A -- Single user home lab N/A CA-3 Information Exchange Documented interconnections; firewall rules for external connections Partial CA-5 Plan of Action and Milestones Vulnerability tracking in TheHive; remediation SLAs documented Partial CA-6 Authorization N/A -- Single user home lab N/A CA-7 Continuous Monitoring Automated vulnerability scanning; real-time patch status; security posture dashboards; Wazuh real-time FIM Implemented CA-7(1) Independent Assessment N/A -- Single user home lab N/A CA-7(3) Trend Analyses Grafana dashboards track vulnerability trends over time Implemented CA-8 Penetration Testing Informal testing -- scanning, enumeration, vulnerability assessments. Partial CA-9 Internal System Connections Network diagram documents internal connections; firewall rules enforce segmentation; Netalert mapping. Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#configuration-management-cm-family","title":"Configuration Management (CM) Family","text":"Control Control Name Implementation Status CM-1 Policy and Procedures Configuration management policy documented; IaC standards defined Implemented CM-2 Baseline Configuration Ansible playbooks define baselines; PatchMon baseline tracking; CIS Benchmark baselines audited via Nessus Implemented CM-2(2) Automation Support Ansible automation; Terraform IaC; automated baseline verification Implemented CM-2(3) Retention of Previous Configurations Git version control; snapshot-before-patch; configuration history retained Implemented CM-2(6) Development and Test Environments N/A -- Single user home lab N/A CM-3 Configuration Change Control Snapshot-before-patch; WSUS approval workflows; pre-scan snapshots; Git pull requests Implemented CM-3(2) Testing and Validation WSUS test deployments; Ansible dry-run; patch validation before production Implemented CM-4 Impact Analyses N/A -- Single user home lab N/A CM-5 Access Restrictions for Change Ansible playbook execution restricted; WSUS approval required; Git branch protection Implemented CM-6 Configuration Settings CIS Benchmark compliance audits; hardened SSH/Traefik configs; configuration deviations detected Implemented CM-6(1) Automated Management Ansible automation; configuration drift detection; automated remediation Implemented CM-7 Least Functionality Unnecessary services disabled; verified via authenticated Nessus scans Implemented CM-7(1) Periodic Review N/A -- Single user home lab N/A CM-8 System Component Inventory PatchMon (5,000+ packages, 30+ hosts); WUD (50+ containers); OpenVAS/Nessus asset databases; Wazuh agent inventory; Netalert Inventory Implemented CM-8(1) Updates During Install/Removal Inventory updated automatically and manually; Wazuh tracks software changes Implemented CM-8(2) Automated Maintenance PatchMon daily updates; WUD container tracking; automated inventory reconciliation Implemented CM-8(3) Automated Unauthorized Component Detection Nessus compliance scans detect unauthorized software; Wazuh FIM alerts on new executables; Netalert new device notifications. Implemented CM-9 Configuration Management Plan IaC strategy documented; Ansible playbook standards; Git workflow defined Partial CM-14 Signed Components Docker image signature verification (SHA-256); Step-CA signed certificates Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#contingency-planning-cp-family","title":"Contingency Planning (CP) Family","text":"Control Control Name Implementation Status CP-1 Policy and Procedures Backup procedures documented; failover strategies defined Partial CP-2 Contingency Plan N/A -- Single user home lab N/A CP-3 Contingency Training N/A -- Single user home lab N/A CP-4 Contingency Plan Testing N/A -- Single user home lab N/A CP-6 Alternate Storage Site N/A -- Single user home lab N/A CP-7 Alternate Processing Site N/A -- Single user home lab N/A CP-9 System Backup Proxmox automated backups bi-weekly; encrypted backups; dual backup solutions Implemented CP-9(1) Testing for Reliability Quarterly restore testing documented Implemented CP-9(3) Separate Storage Off-host encrypted backups; physically separate storage Implemented CP-9(8) Cryptographic Protection Encrypted backups via Proxmox Backup Server Implemented CP-10 System Recovery Documented restore procedures; IaC enables rapid rebuild Partial"},{"location":"projects/homelab/grc/grc-nist-800/#identification-and-authentication-ia-family","title":"Identification and Authentication (IA) Family","text":"Control Control Name Implementation Status IA-1 Policy and Procedures Authentication policy documented; MFA requirements defined Implemented IA-2 Identification and Authentication SSH keys; Authentik SSO; unique user identities required Implemented IA-2(1) MFA to Privileged Accounts Authentik TOTP enforced for all admin accounts; SSH key + passphrase Implemented IA-2(2) MFA to Non-Privileged Accounts Authentik TOTP available; SSH keys only (equivalent to 2FA) Implemented IA-2(8) Replay Resistant SSH session tokens; Authentik session cookies with CSRF protection Implemented IA-2(10) Single Sign-On Authentik SSO integration; Traefik ForwardAuth; OAuth2 provider Implemented IA-2(12) Acceptance of PIV Credentials N/A -- Single user home lab N/A IA-3 Device Identification SSH host keys; device certificates via Step-CA Implemented IA-4 Identifier Management Centralized user management via Authentik/AD; SSH keys tracked in Ansible Implemented IA-5 Authenticator Management SSH keys managed via Ansible; Authentik credential policies; centralized key distribution Implemented IA-5(1) Password-Based Authentication SSH passwords disabled globally; Authentik enforces complexity requirements Implemented IA-5(2) PKI-Based Authentication Step-CA two-tier PKI; SSH Ed25519 keys; automated certificate issuance Implemented IA-5(7) No Embedded Unencrypted Authenticators Vaultwarden secrets management; Ansible Vault encrypted vars; no hardcoded credentials Implemented IA-5(14) Managing PKI Trust Stores Step-CA root/intermediate CA management; automated trust distribution Implemented IA-5(18) Password Managers Vaultwarden deployed; biometric unlock; zero-knowledge encryption Implemented IA-8 Non-Organizational User Authentication N/A -- Single user home lab N/A IA-11 Re-authentication Authentik session timeout requires re-auth; SSH session timeout Implemented IA-12 Identity Proofing N/A -- Single user home lab N/A"},{"location":"projects/homelab/grc/grc-nist-800/#incident-response-ir-family","title":"Incident Response (IR) Family","text":"Control Control Name Implementation Status IR-1 Policy and Procedures Incident response policy documented; SOC procedures defined Implemented IR-2 Incident Response Training N/A -- Single user home lab N/A IR-3 Incident Response Testing N/A -- Single user home lab N/A IR-4 Incident Handling TheHive case management; Wazuh Active Response; Splunk correlation; n8n/Shuffle SOAR orchestration Implemented IR-4(1) Automated Incident Handling Wazuh Active Response (firewall-drop, host-deny); VirusTotal quarantine; Shuffle workflows; sub-30-min MTTR Implemented IR-4(4) Information Correlation TheHive correlates Splunk/Wazuh/Suricata/scanners; Cortex enrichment; MISP threat context Implemented IR-5 Incident Monitoring Real-time SIEM dashboards; Discord notifications; TheHive case tracking; 100% security event visibility Implemented IR-5(1) Automated Tracking TheHive automated case creation; Shuffle orchestration; Cortex job tracking; Wazuh forensic data collection Implemented IR-6 Incident Reporting TheHive case documentation; Shuffle notifications; Discord/email alerting; Splunk executive reports Implemented IR-6(1) Automated Reporting Shuffle automated notifications (Discord, email, PagerDuty); TheHive status updates; Splunk scheduled reports Implemented IR-7 Incident Response Assistance TheHive knowledge base; documented playbooks (15+); Shuffle workflow library; Cortex analyzer catalog Implemented IR-8 Incident Response Plan Comprehensive IR plan; TheHive playbooks; Shuffle workflows; multi-channel alerting Implemented IR-8(1) Breaches Limited -- Wazuh Automated alerting and active response; TheHive automated case creation Partial"},{"location":"projects/homelab/grc/grc-nist-800/#maintenance-ma-family","title":"Maintenance (MA) Family","text":"Control Control Name Implementation Status MA-1 Policy and Procedures Maintenance policy informal - personal lab environment Partial MA-2 Controlled Maintenance Change control via Git; snapshot-before-patch Partial MA-3 Maintenance Tools Ansible automation tools version controlled Partial MA-4 Nonlocal Maintenance SSH remote maintenance logged; session monitoring Implemented MA-4(6) Cryptographic Protection SSH encryption for remote maintenance; TLS for web-based tools Implemented MA-5 Maintenance Personnel Not applicable - single administrator N/A MA-6 Timely Maintenance Patch SLAs defined and tracked Partial"},{"location":"projects/homelab/grc/grc-nist-800/#media-protection-mp-family","title":"Media Protection (MP) Family","text":"Control Control Name Implementation Status MP-1 Policy and Procedures Media protection policy informal Partial MP-2 Media Access Physical media access controlled Partial MP-3 Media Marking N/A -- Single user home lab N/A MP-4 Media Storage Backup media stored securely; encrypted Implemented MP-5 Media Transport Encrypted backups for transport Partial MP-6 Media Sanitization Secure deletion procedures documented Partial MP-7 Media Use Removable media disabled via GPO (Windows) Partial"},{"location":"projects/homelab/grc/grc-nist-800/#physical-and-environmental-protection-pe-family","title":"Physical and Environmental Protection (PE) Family","text":"Control Control Name Implementation Status PE-1 Policy and Procedures N/A -- Single user home lab N/A PE-2 Physical Access Authorizations N/A -- Single user home lab N/A PE-3 Physical Access Control N/A -- Single user home lab N/A PE-6 Monitoring Physical Access N/A -- Single user home lab N/A PE-8 Visitor Access Records N/A -- Single user home lab N/A PE-9 Power Equipment and Cabling UPS battery backup for critical systems N/A PE-11 Emergency Power UPS provides temporary power N/A PE-12 Emergency Lighting N/A -- Single user home lab N/A PE-13 Fire Protection Residential fire protection N/A PE-14 Environmental Controls N/A -- Single user home lab N/A PE-15 Water Damage Protection N/A -- Single user home lab N/A PE-16 Delivery and Removal N/A -- Single user home lab N/A"},{"location":"projects/homelab/grc/grc-nist-800/#planning-pl-family","title":"Planning (PL) Family","text":"Control Control Name Implementation Status PL-1 Policy and Procedures Planning policy documented in lab mission statement Partial PL-2 System Security Plans GRC documentation serves as security plan Implemented PL-4 Rules of Behavior N/A -- Single user home lab N/A PL-7 Concept of Operations Lab architecture and operations documented Partial PL-8 Security Architecture Defense-in-depth architecture documented; network diagrams maintained Implemented PL-8(1) Defense in Depth Multi-layer security controls across network/application/data layers Implemented PL-9 Central Management Centralized management via Ansible, Authentik, SIEM Partial"},{"location":"projects/homelab/grc/grc-nist-800/#program-management-pm-family","title":"Program Management (PM) Family","text":"Control Control Name Implementation Status PM-1 Information Security Program Plan Lab security program documented in GRC framework Partial PM-5 System Inventory Comprehensive asset inventory maintained (PatchMon, Wazuh, OpenVPN, Nessus, Netalert) Implemented PM-9 Risk Management Strategy Risk-based vulnerability prioritization; CVSS scoring Implemented PM-10 Authorization Process N/A -- Single user home lab N/A PM-12 Insider Threat Program N/A -- Single user home lab N/A PM-14 Testing, Training, Monitoring N/A -- Single user home lab N/A PM-16 Threat Awareness Program N/A -- Single user home lab N/A PM-16(1) Automated Threat Intelligence Sharing MISP automated feed synchronization; Shuffle vulnerability aggregation Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#personnel-security-ps-family","title":"Personnel Security (PS) Family","text":"Control Control Name Implementation Status PS-1 Policy and Procedures Not applicable - personal lab N/A PS-2 Position Risk Designation Not applicable N/A PS-3 Personnel Screening Not applicable N/A PS-4 Personnel Termination Not applicable N/A PS-5 Personnel Transfer Not applicable N/A PS-6 Access Agreements Not applicable N/A PS-7 External Personnel Security Not applicable N/A PS-8 Personnel Sanctions Not applicable N/A"},{"location":"projects/homelab/grc/grc-nist-800/#risk-assessment-ra-family","title":"Risk Assessment (RA) Family","text":"Control Control Name Implementation Status RA-1 Policy and Procedures Risk assessment policy documented; CVSS scoring methodology defined Implemented RA-3 Risk Assessment CVSS scoring of vulnerabilities; exploit likelihood assessment; risk-based remediation prioritization Implemented RA-3(1) Supply Chain Risk Assessment MISP vendor compromise tracking; limited supply chain visibility Partial RA-5 Vulnerability Monitoring and Scanning Weekly OpenVAS network scans; monthly Nessus authenticated scans; daily PatchMon package checks; CVE correlation with NVD Implemented RA-5(2) Update Vulnerabilities to Be Scanned Daily NVT updates (OpenVAS); plugin updates (Nessus); MISP feed sync; Shuffle CVE aggregation Implemented RA-5(3) Breadth and Depth of Coverage Network scans (OpenVAS); authenticated OS scans (Nessus); compliance audits (CIS); 75+ assets covered Implemented RA-5(5) Privileged Access Authenticated scans via SSH keys (Linux); domain service accounts (Windows); SNMP v3 (network devices) Implemented RA-5(8) Review Historic Audit Logs Vulnerability trends tracked in Grafana; historical scan results archived; MTTR calculated over time Implemented RA-5(10) Correlate Scanning Information SIEM correlates vulnerability scans with exploit databases; Wazuh links vulnerabilities to installed software Implemented RA-5(11) Public Disclosure Program N/A -- Single user home lab N/A RA-7 Risk Response N/A -- Single user home lab N/A RA-10 Threat Hunting Wazuh threat hunting queries; Splunk investigation searches; MITRE ATT&amp;CK mapping Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#system-and-communications-protection-sc-family","title":"System and Communications Protection (SC) Family","text":"Control Control Name Implementation Status SC-1 Policy and Procedures System protection policy documented; encryption requirements defined Implemented SC-7 Boundary Protection DNS at edge (Pi-hole); SSH firewall rules; Traefik ingress controller; pfSense ACLs; IDS/IPS Implemented SC-7(3) Access Points Managed access points via Traefik/Nginx Ingress; Safeline WAF; Cloudflare/Tailscale RBAC Implemented SC-7(4) External Telecommunications Verizon; VPN services (Tailscale, PIA); Cloudflare Tunnels Implemented SC-7(5) Deny by Default / Allow by Exception pfSense/OPNsense default-deny rules; Traefik explicit route definitions; firewall whitelist approach Implemented SC-7(8) Route Traffic to Authenticated Proxy Traefik reverse proxy with Authentik authentication Implemented SC-7(21) Isolation of System Components Traefik isolates backend services; NGINX Ingress isolates K3s pods; network segmentation Implemented SC-8 Transmission Confidentiality and Integrity TLS 1.3 (Traefik); SSH encryption; DNS-over-TLS (future); encrypted scan credentials Implemented SC-8(1) Cryptographic Protection AES-256-GCM (SSH/Traefik); Ed25519 keys; TLS 1.3 ciphersuites Implemented SC-8(2) Pre/Post-Transmission Handling TLS termination at edge (Traefik); encrypted storage at rest Implemented SC-12 Cryptographic Key Establishment and Management Step-CA automated certificate issuance; SSH key generation (ed25519); centralized key management Implemented SC-13 Cryptographic Protection Modern algorithms only (Ed25519, AES-256-GCM, TLS 1.3); weak cipher detection via vulnerability scans Implemented SC-17 Public Key Infrastructure Certificates Step-CA PKI (Root + Intermediate CA); Traefik cert distribution; automated renewal Implemented SC-17(1) Certificate Validation OCSP validation; CRL distribution; client certificate validation Implemented SC-20 Secure Name/Address Resolution (Authoritative) Bind9 authoritative DNS; DNSSEC signing Implemented SC-20(2) Data Origin and Integrity DNSSEC validation; DNS query authentication Implemented SC-21 Secure Name/Address Resolution (Recursive) Pi-hole/Unbound recursive resolver; DNSSEC validation enabled Implemented SC-23 Session Authenticity Authentik session tokens; SSH session IDs; TLS session tickets Implemented SC-28 Protection of Information at Rest Encrypted backups; TLS in transit; scan credential encryption; SSH private keys encrypted Implemented SC-28(1) Cryptographic Protection at Rest AES-256 encrypted backups Partial SC-28(3) Cryptographic Keys Step-CA offline root CA; SSH keys encrypted; Vaultwarden secrets management Implemented SC-39 Process Isolation Container isolation (Docker); VM isolation (Proxmox); process separation Implemented SC-45 System Time Synchronization NTP time synchronization across infrastructure; centralized time source Implemented SC-45(1) Synchronization with Authoritative Time Source Chrony NTP client; Internet time servers (pool.ntp.org) Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#system-and-information-integrity-si-family","title":"System and Information Integrity (SI) Family","text":"Control Control Name Implementation Status SI-1 Policy and Procedures System integrity policy documented; malware protection requirements defined Implemented SI-2 Flaw Remediation Multi-platform patch management; MTTR &lt;72h for Critical CVEs; remediation verified via re-scans Implemented SI-2(2) Automated Flaw Remediation Status Watchtower auto-updates; WSUS auto-approval rules; n8n orchestration; Wazuh alerts on unpatched systems Implemented SI-2(3) Time to Remediate Flaws N/A -- Single user home lab N/A SI-2(4) Automated Patch Management Tools PatchMon (Linux); WSUS (Windows); Watchtower (containers); OpenVAS/Nessus verification Implemented SI-2(6) Removal of Previous Versions Old container images pruned after Watchtower updates; superseded patches cleaned via WSUS Implemented SI-3 Malicious Code Protection Wazuh FIM with VirusTotal; Suricata/Snort signatures; ClamAV/Microsoft Defender; rootkit detection Implemented SI-3(4) Updates Only by Privileged Users AV signature updates restricted to admin accounts; WSUS authorization Implemented SI-3(10) Malicious Code Analysis Cortex multi-engine analysis (VirusTotal, Yara); Shuffle malware workflow; TheHive case management Implemented SI-4 System Monitoring Prometheus; Uptime Kuma; Splunk/Elastic SIEM; Wazuh EDR; Suricata/Snort IDS; Netalert; multi-layered detection Implemented SI-4(1) System-Wide Intrusion Detection Suricata/Snort on all network segments; centralized SIEM correlation Implemented SI-4(2) Automated Tools for Real-Time Analysis Splunk real-time correlation; Wazuh real-time FIM; Elastic SIEM; Suricata inline blocking; Cortex automation Implemented SI-4(4) Inbound and Outbound Communications Traffic Suricata/Snort IDS on all segments; pfSense flow logs; Traefik access logs; DNS query logging; complete visibility Implemented SI-4(5) System-Generated Alerts Discord webhooks; Splunk scheduled alerts; Wazuh Discord/email; Prometheus alertmanager; CVSS-based routing Implemented SI-4(12) Automated Alerts Prometheus Alertmanager; Grafana automated alerts; Splunk real-time searches; Wazuh Active Response triggers Implemented SI-4(16) Correlate Monitoring Information Multi-source correlation across Splunk/Elastic/Wazuh/network logs; TheHive aggregation Implemented SI-4(18) Analyze Traffic/Event Patterns Cortex pattern recognition; MISP campaign correlation Partial SI-4(23) Host-Based Devices Wazuh EDR on 25+ endpoints; FIM real-time monitoring; rootkit detection; process monitoring; Sysmon integration Implemented SI-5 Security Alerts, Advisories, and Directives PatchMon CVE alerts; WUD update notifications; Discord webhooks; OpenVAS/Nessus scan completion alerts Implemented SI-5(1) Automated Alerts and Advisories Discord webhooks for scan completion; CVSS-based alert routing; TheHive case auto-creation Implemented SI-7 Software, Firmware, and Information Integrity Docker image SHA-256 verification; Step-CA certificate validation; Wazuh FIM integrity monitoring Implemented SI-7(1) Integrity Checks Wazuh FIM real-time integrity monitoring; file hash verification; registry monitoring (Windows) Implemented SI-7(6) Cryptographic Protection SHA-256 image signatures; TLS certificate validation; file integrity checksums Implemented SI-7(7) Integration of Detection and Response Wazuh FIM triggers Active Response; SIEM correlation with integrity violations Implemented SI-10 Information Input Validation WAF input validation (SafeLine); Traefik header validation; DNS query sanitization Implemented SI-12 Information Management and Retention 90-day log retention; 30-day backup retention; automated lifecycle management Implemented"},{"location":"projects/homelab/grc/grc-nist-800/#supply-chain-risk-management-sr-family","title":"Supply Chain Risk Management (SR) Family","text":"Control Control Name Implementation Status SR-1 Policy and Procedures N/A -- Single user home lab N/A SR-2 Supply Chain Risk Management Plan N/A -- Single user home lab N/A SR-3 Supply Chain Controls and Processes Vetted open-source projects; trusted Docker registries; official package repositories Partial SR-3(1) Diverse Supply Base N/A -- Single user home lab N/A SR-4 Provenance N/A -- Single user home lab N/A SR-5 Acquisition Strategies N/A -- Single user home lab N/A SR-6 Supplier Assessments N/A -- Single user home lab N/A SR-9 Tamper Resistance and Detection N/A -- Single user home lab N/A SR-10 Inspection of Systems or Components Visual inspection of hardware; no formal process Partial SR-11 Component Authenticity Docker image signature verification; package signature validation Implemented SR-11(3) Anti-Counterfeit Scanning N/A -- Single user home lab N/A SR-12 Component Disposal Secure deletion procedures; encrypted storage wiping Implemented"},{"location":"projects/homelab/grc/grc-nist-csf/","title":"NIST Cybersecurity Framework 2.0","text":"<p>Document Control:  Version: 1.0 Last Updated: January 2026 Owner: Paul Leone </p> <p>Framework Version: NIST CSF 2.0</p>"},{"location":"projects/homelab/grc/grc-nist-csf/#govern-gv","title":"GOVERN (GV)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#gvoc-organizational-context","title":"GV.OC - Organizational Context","text":"Subcategory Description Implementation GV.OC-01 Context of organization and security strategy established Lab mission statement defines security-first architecture principles; documented security objectives aligned with learning goals; compliance requirements documented GV.OC-02 Internal and external stakeholders understood N/A (Personal lab) GV.OC-03 Legal/regulatory/contractual requirements understood Conceptual compliance with NIST, CIS, ISO 27001, PCI-DSS frameworks; no actual regulatory obligations (personal lab) GV.OC-04 Critical objectives, capabilities, services understood Core services documented (SIEM, EDR, firewalls, DNS, identity management); criticality tiers defined (Tier 1: SIEM/EDR, Tier 2: firewalls/DNS, Tier 3: supporting services) GV.OC-05 Outcomes of cybersecurity strategy communicated Documented in lab architecture documents; security metrics tracked in dashboards; quarterly reviews conducted"},{"location":"projects/homelab/grc/grc-nist-csf/#gvov-oversight","title":"GV.OV - Oversight","text":"Subcategory Description Implementation GV.OV-01 Cybersecurity strategy/expectations overseen N/A (Personal lab) GV.OV-02 Responsibilities for outcomes overseen N/A (Personal lab) GV.OV-03 Legal/regulatory compliance overseen N/A (Personal lab)"},{"location":"projects/homelab/grc/grc-nist-csf/#gvrm-risk-management-strategy","title":"GV.RM - Risk Management Strategy","text":"Subcategory Description Implementation GV.RM-01 Risk management objectives established Risk-based vulnerability prioritization (CVSS scoring); patch management SLAs by severity; threat-informed security architecture GV.RM-02 Risk appetite/tolerance defined Critical CVEs: MTTR &lt;72h; High CVEs: MTTR &lt;7 days; acceptable false positive rate &lt;5%; 95% patch compliance target GV.RM-03 Cybersecurity added to enterprise risk management N/A (Personal lab) GV.RM-04 Strategic direction updated based on risk info N/A (Personal lab) GV.RM-05 Lines of communication established N/A (Personal lab) GV.RM-06 Workforce understands roles/responsibilities N/A (Personal lab) GV.RM-07 Mission/business supported by strategic cybersecurity N/A (Personal lab)"},{"location":"projects/homelab/grc/grc-nist-csf/#gvrr-roles-responsibilities-and-authorities","title":"GV.RR - Roles, Responsibilities, and Authorities","text":"Subcategory Description Implementation GV.RR-01 Leadership roles/responsibilities established N/A (Personal lab) GV.RR-02 Roles/responsibilities coordinated among stakeholders N/A (Personal lab) GV.RR-03 Adequate resources ensured N/A (Personal lab) GV.RR-04 Cybersecurity integrated into planning/operations N/A (Personal lab)"},{"location":"projects/homelab/grc/grc-nist-csf/#gvpo-policy","title":"GV.PO - Policy","text":"Subcategory Description Implementation GV.PO-01 Policy establishes behavioral expectations SSH hardening policy (CIS Benchmark); TLS 1.3 minimum policy; vulnerability remediation SLAs; comprehensive logging policy (100% security event coverage) GV.PO-02 Policy reviewed/updated N/A (Personal lab)"},{"location":"projects/homelab/grc/grc-nist-csf/#gvsc-cybersecurity-supply-chain-risk-management","title":"GV.SC - Cybersecurity Supply Chain Risk Management","text":"Subcategory Description Implementation GV.SC-01 Supply chain risk management established N/A (Personal lab) GV.SC-02 Suppliers/third parties included in risk mgmt Limited implementation (Personal lab): Vetted open-source projects used; trusted Docker Hub publishers; official OS repositories GV.SC-03 Contracts specify security requirements N/A (no commercial contracts in personal lab); demonstrates understanding through software selection criteria (security reputation, update frequency, community support) GV.SC-04 Suppliers/partners routinely assessed Partial implementation: GitHub security alerts monitored; software update frequency tracked; planned CVE monitoring for dependencies GV.SC-05 Response/recovery planning for supply chain Limited implementation (Personal lab): Snapshot-before-update strategy; rollback procedures documented"},{"location":"projects/homelab/grc/grc-nist-csf/#identify-id","title":"IDENTIFY (ID)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#idam-asset-management","title":"ID.AM - Asset Management","text":"Subcategory Description Implementation ID.AM-01 Inventories of hardware managed Checkmk inventory; Prometheus node exporters (30+ hosts); Proxmox asset database; external Excel inventory ID.AM-02 Inventories of software/applications managed PatchMon tracks 5,000+ packages; WUD tracks 50+ containers; Nessus software inventory; Wazuh agent inventory (25+ endpoints) ID.AM-03 Network diagrams/organizational communication flows Network topology documented; Traefik routing architecture; VLAN segmentation diagrams; data flow maps ID.AM-04 External systems/network connections cataloged VPN connections documented (Tailscale, PIA, Cloudflare Tunnels); external DNS resolvers tracked; internet egress points mapped ID.AM-05 Resources prioritized by classification/criticality Tier 1: SIEM, EDR, firewalls; Tier 2: DNS, identity management; Tier 3: supporting services; documented in asset inventory ID.AM-07 Inventories of data/information managed Sensitive data classification (logs, credentials, backups); data flow mapping; retention policies documented ID.AM-08 Systems/hardware/software/services authorized Authorized software list maintained; unauthorized application detection via Nessus/Wazuh; procurement approval process"},{"location":"projects/homelab/grc/grc-nist-csf/#idra-risk-assessment","title":"ID.RA - Risk Assessment","text":"Subcategory Description Implementation ID.RA-01 Vulnerabilities identified/documented OpenVAS + Nessus vulnerability scanning; CVSS scoring; CVE correlation with NVD; TheHive vulnerability tracking ID.RA-02 Cyber threat intelligence received MISP threat intelligence platform; CrowdSec community feeds; AlienVault OTX, abuse.ch, Emerging Threats; Shuffle threat aggregation ID.RA-03 Threats identified/documented MISP threat events; Cortex IOC analysis; threat actor TTPs tracked; MITRE ATT&amp;CK mapping ID.RA-04 Potential impacts/likelihoods identified Risk-based remediation prioritization; exploit availability assessed; CVSS temporal scoring; asset criticality factored ID.RA-05 Threats/vulnerabilities/likelihoods/impacts determined CVSS base + temporal + environmental scoring; exploit maturity assessment; attack surface analysis ID.RA-06 Risk responses identified/prioritized Critical: MTTR &lt;72h; High: MTTR &lt;7d; virtual patching for zero-day; compensating controls documented ID.RA-07 Changes managed using risk management process Pre-deployment vulnerability scans; snapshot-before-patch; change approval workflows (WSUS); rollback procedures ID.RA-08 Processes for receiving/analyzing/responding to vulnerability disclosures Shuffle vulnerability disclosure workflow; NIST NVD monitoring; vendor advisory tracking; CVE analysis pipeline ID.RA-09 Response/recovery from identified incidents evaluated Post-incident reviews in TheHive; MTTR tracking; lessons learned documentation; workflow optimization ID.RA-10 Critical suppliers/dependencies included in risk assessments Planned: SBOM tracking; dependency vulnerability scanning; third-party risk assessments"},{"location":"projects/homelab/grc/grc-nist-csf/#idim-improvement","title":"ID.IM - Improvement","text":"Subcategory Description Implementation ID.IM-01 Improvements identified from detection/response activities Vulnerability trends tracked in Grafana; CIS Benchmark compliance scores monitored; patch compliance dashboard; continuous security posture improvement ID.IM-02 Response/recovery plans tested Tabletop exercises documented in TheHive; Shuffle workflow testing; playbook dry-runs; quarterly BC/DR testing planned ID.IM-03 Response/recovery plans incorporate lessons learned Post-incident reviews drive playbook updates; TheHive lessons learned tracking; Shuffle workflow optimization based on execution data ID.IM-04 Improvements integrated into updating policy/planning Annual policy reviews incorporate lessons learned; architecture updates based on incident findings; continuous improvement cycle"},{"location":"projects/homelab/grc/grc-nist-csf/#protect-pr","title":"PROTECT (PR)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#praa-identity-management-authentication-and-access-control","title":"PR.AA - Identity Management, Authentication and Access Control","text":"Subcategory Description Implementation PR.AA-01 Identities/credentials issued/managed/verified Authentik SSO integration; centralized SSH key management via Ansible; individual user accounts (no shared credentials); MFA enforcement (Authentik TOTP) PR.AA-02 Identities authenticated SSH key-based authentication; Authentik SSO; MFA enforcement; certificate-based authentication (Step-CA) PR.AA-03 Service provider identities authenticated Traefik ForwardAuth SSO; OAuth2/OIDC integration; API key authentication; certificate validation PR.AA-04 Identity assertions verified SAML/OIDC token validation; JWT signature verification; session token validation; certificate chain verification PR.AA-05 Access permissions/authorizations managed Authentik RBAC groups; SSH sudo enforcement; Traefik middleware access control; least-privilege principle PR.AA-06 Physical access managed Physical security (personal lab): locked server rack, limited access; environmental monitoring; backup power (UPS)"},{"location":"projects/homelab/grc/grc-nist-csf/#prat-awareness-and-training","title":"PR.AT - Awareness and Training","text":"Subcategory Description Implementation PR.AT-01 Personnel aware of cybersecurity risks Security awareness demonstrated through lab documentation; threat hunting queries documented; incident response playbooks PR.AT-02 Privileged users understand roles/responsibilities SOC analyst role documented; incident commander responsibilities defined; escalation procedures established PR.AT-03 Third-party stakeholders understand roles/responsibilities N/A (personal lab); demonstrates understanding through vendor security assessment criteria PR.AT-04 Senior executives understand roles/responsibilities N/A (personal lab); role segregation demonstrated through documented workflows PR.AT-05 Personnel aware of/trained on physical security Physical security awareness; environmental monitoring; backup procedures"},{"location":"projects/homelab/grc/grc-nist-csf/#prds-data-security","title":"PR.DS - Data Security","text":"Subcategory Description Implementation PR.DS-01 Data-at-rest protected Encrypted backups (AES-256); TLS in transit; scan credential encryption; SSH private keys encrypted; encrypted log transmission (syslog-ng TLS to SIEM); immutable SIEM indexes PR.DS-02 Data-in-transit protected TLS 1.3 encryption (Traefik); Ed25519 SSH keys; DNSSEC validation; encrypted VPN tunnels (Tailscale, WireGuard) PR.DS-10 Integrity/authenticity of hardware/software verified Package signature verification; container image verification (SHA-256); Step-CA certificate validation PR.DS-11 Data disposal practices established Secure deletion procedures; backup rotation policies; log retention limits (90 days); expired certificate cleanup"},{"location":"projects/homelab/grc/grc-nist-csf/#prir-technology-infrastructure-resilience","title":"PR.IR - Technology Infrastructure Resilience","text":"Subcategory Description Implementation PR.IR-01 Networks/environments protected HA DNS failover (dual Pi-hole); Traefik zero-downtime reloads; firewall clustering; network segmentation PR.IR-02 Security architectures established/maintained Defense-in-depth architecture; zero-trust principles; documented security controls; continuous assessment PR.IR-03 Hardware/software disposal practices established Limited -- homelab. Secure wiping procedures; decommissioning checklists PR.IR-04 Adequate capacity ensured Prometheus capacity monitoring; Pulse hypervisor monitoring; disk space alerts; resource trending PR.IR-05 Continuity prioritized by business criticality Service prioritization (Tier 1-3); documented recovery priorities; RTO/RPO defined"},{"location":"projects/homelab/grc/grc-nist-csf/#prps-platform-security","title":"PR.PS - Platform Security","text":"Subcategory Description Implementation PR.PS-01 Configuration management practices established SSH config via Ansible; Traefik YAML in Git; DNS zones version-controlled; PatchMon configuration tracking; CIS Benchmark audits; Terraform IaC; configuration drift detection PR.PS-02 Secure software development practices integrated Infrastructure as Code (Terraform, Ansible); Git version control; CI/CD security linting (planned); code review processes PR.PS-03 Hardware/software maintained Multi-platform patch management (PatchMon, WSUS, WUD, Watchtower); vulnerability remediation workflows; automated updates where appropriate PR.PS-04 Log records generated/managed 100% security event logging to SIEM; 90-day retention; structured JSON format; comprehensive audit trails PR.PS-05 Installation/execution of software restricted Approved software list; unauthorized application detection; AppLocker policies (Windows); sudo restrictions (Linux) PR.PS-06 Secure configuration of network infrastructure SSH hardened per CIS Benchmark; Traefik secure headers; firewall hardening; secure DNS configuration"},{"location":"projects/homelab/grc/grc-nist-csf/#detect-de","title":"DETECT (DE)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#deae-adverse-event-analysis","title":"DE.AE - Adverse Event Analysis","text":"Subcategory Description Implementation DE.AE-02 Potentially adverse events analyzed Vulnerability trending; exploit likelihood assessment; Cortex automated enrichment; MISP threat intelligence correlation; Shuffle orchestrated analysis workflows DE.AE-03 Information on adverse events correlated Multi-source correlation (Splunk + Elastic + Wazuh + network logs); TheHive aggregates alerts from SIEM, EDR, IDS; Shuffle orchestrates cross-platform queries DE.AE-04 Impact of adverse events understood TheHive case severity scoring; asset criticality assessment; business impact analysis; risk-based prioritization DE.AE-05 Incident alert thresholds established Splunk correlation search thresholds; Wazuh rule severity levels; TheHive case severity matrix; Prometheus alert thresholds; Grafana panel thresholds DE.AE-06 Information on adverse events provided Discord/email real-time notifications; TheHive case notifications; Splunk scheduled alerts; Shuffle multi-channel alerting DE.AE-07 Cyber threat intelligence integrated MISP threat intelligence feeds; CrowdSec community intelligence; Cortex enrichment; Shuffle threat aggregation workflows DE.AE-08 Incidents declared when adverse events meet criteria TheHive automated case creation; Shuffle workflow triggers; severity-based escalation; SOC analyst notification"},{"location":"projects/homelab/grc/grc-nist-csf/#decm-continuous-monitoring","title":"DE.CM - Continuous Monitoring","text":"Subcategory Description Implementation DE.CM-01 Networks/network services monitored DNS query logging; Traefik access logs to SIEM; pfSense flow logs; Suricata/Snort IDS; NetalertX network monitoring; 100% network traffic visibility DE.CM-02 Physical environment monitored Limited: Temperature/humidity sensors; power monitoring (UPS); physical access logging DE.CM-03 Personnel activity monitored Active Directory audit logs; Authentik authentication tracking; SSH session logging; privileged access monitoring DE.CM-04 Malicious code activity monitored Wazuh FIM; Yara rules; Cortex file analysis; Suricata IDS signatures; ClamAV/Microsoft Defender DE.CM-05 Unauthorized network connections/mobile code detected Network device inventory; MAC address tracking; Wazuh agent monitoring; unauthorized access detection via NetalertX DE.CM-06 External service provider activity monitored Limited: Cloudflare analytics; VPN logs; public service monitoring; API usage tracking DE.CM-07 Monitoring for unauthorized activity performed Failed authentication tracking; privilege escalation detection; lateral movement monitoring; Shuffle automated analysis DE.CM-09 Vulnerability scans performed Weekly OpenVAS scans; monthly Nessus authenticated scans; daily PatchMon checks; continuous Wazuh assessment; SIEM correlation of scan results DE.CM-10 Threat hunting performed Wazuh threat hunting queries; Splunk SPL searches; Elastic KQL queries; MITRE ATT&amp;CK-based hunting; Cortex IOC pivoting"},{"location":"projects/homelab/grc/grc-nist-csf/#respond-rs","title":"RESPOND (RS)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#rsan-analysis","title":"RS.AN - Analysis","text":"Subcategory Description Implementation RS.AN-01 Notifications investigated Cortex multi-engine analysis; MISP correlation; Splunk queries; Wazuh forensic data; TheHive case investigation RS.AN-02 Impact of incidents understood Asset inventory correlation; data classification; business impact analysis; TheHive case severity assessment RS.AN-03 Forensics performed Wazuh forensic data collection; memory dumps; network captures; Shuffle automated forensic workflows; evidence preservation RS.AN-04 Incidents categorized TheHive taxonomy; MITRE ATT&amp;CK mapping; severity scoring; incident classification (confirmed, false positive, benign) RS.AN-05 Incident analysis processes established Documented analysis procedures; Cortex analyzer workflows; MISP playbooks; Shuffle investigation templates"},{"location":"projects/homelab/grc/grc-nist-csf/#rsco-communications","title":"RS.CO - Communications","text":"Subcategory Description Implementation RS.CO-01 Personnel know roles/responsibilities N/A (personal lab) RS.CO-02 Events reported Discord #incident-response channel; TheHive case creation; Splunk notable events; email notifications RS.CO-03 Information shared MISP threat intelligence sharing; CrowdSec community contributions; internal team notifications"},{"location":"projects/homelab/grc/grc-nist-csf/#rsma-incident-management","title":"RS.MA - Incident Management","text":"Subcategory Description Implementation RS.MA-01 Incident response plans activated TheHive playbooks (15+); Shuffle workflows (phishing, malware, ransomware, vulnerability); automated orchestration RS.MA-02 Incident reports enriched Cortex enrichment; MISP correlation; Splunk context; TheHive observable analysis; Shuffle automated data gathering RS.MA-03 Incidents contained Wazuh Active Response; Cortex responders; Shuffle automated containment workflows; pfSense API firewall rules; network isolation RS.MA-04 Incidents eradicated Malware removal; account lockouts; vulnerability patching; configuration remediation; Shuffle remediation workflows RS.MA-05 Incidents resolved TheHive case closure; verification scans; service restoration; post-incident documentation"},{"location":"projects/homelab/grc/grc-nist-csf/#rsmi-incident-mitigation","title":"RS.MI - Incident Mitigation","text":"Subcategory Description Implementation RS.MI-01 Vulnerabilities mitigated/documented Virtual patching (Safeline WAF); IDS signatures; emergency patching via Ansible; TheHive vulnerability tracking RS.MI-02 Strategies for responding to incidents established TheHive playbooks; Shuffle workflows; Cortex responder library; documented response procedures"},{"location":"projects/homelab/grc/grc-nist-csf/#recover-rc","title":"RECOVER (RC)","text":""},{"location":"projects/homelab/grc/grc-nist-csf/#rcco-incident-recovery-communications","title":"RC.CO - Incident Recovery Communications","text":"Subcategory Description Implementation RC.CO-01 Public relations managed N/A (personal lab) RC.CO-02 Reputation protected N/A (personal lab) RC.CO-03 Recovery activities communicated N/A (personal lab)"},{"location":"projects/homelab/grc/grc-nist-csf/#rchl-incident-recovery-plan-execution","title":"RC.HL - Incident Recovery Plan Execution","text":"Subcategory Description Implementation RC.HL-01 Recovery plan executed Backup restoration procedures; system rebuild playbooks; service validation checklists; snapshot rollback RC.HL-02 Recovery activities completed Verification testing; service health checks; performance validation; security posture confirmation"},{"location":"projects/homelab/grc/grc-nist-csf/#rcrp-recovery-planning","title":"RC.RP - Recovery Planning","text":"Subcategory Description Implementation RC.RP-01 Recovery plan exercised Recovery procedure testing; RTO/RPO validation <p>Document Version: 2.0 Last Updated: January 14, 2026 Classification: Internal Use</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/","title":"NIST SP 800-207 Zero Trust Architecture","text":"<p>Document Control: Version: 1.0 Last Updated: January 2026 Owner: Paul Leone  </p> <p>Framework Version: </p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#zero-trust-architecture-implementation-overview","title":"Zero Trust Architecture Implementation Overview","text":"<p>This cybersecurity lab demonstrates comprehensive Zero Trust Architecture (ZTA) principles aligned with NIST SP 800-207 and CISA Zero Trust Maturity Model v2.0. The implementation achieves Advanced maturity (Stage 3 of 4) across core Zero Trust pillars through explicit verification of every access request, least-privilege enforcement via RBAC, assume-breach mentality with continuous monitoring, and encrypt-everything policies using modern cryptographic standards.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#zero-trust-tenets-implementation","title":"Zero Trust Tenets Implementation","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-1-all-data-sources-and-computing-services-as-resources","title":"Tenet 1: All Data Sources and Computing Services as Resources","text":"<p>Implementation Status: Advanced</p> <p>Lab treats all assets as resources requiring explicit authentication/authorization. 25+ physical hosts, 50+ containers, 30+ VMs, network devices (pfSense, OPNsense, Pi-hole), storage systems, and cloud-hosted services (Authentik planning) all subject to access controls. BYOD consideration planned via Authentik device flow and Wazuh compliance validation. Small footprint devices (IoT sensors, network monitors) send data through authenticated channels to aggregators.</p> <p>Evidence: Proxmox inventory tracking, Docker container registry, Wazuh agent deployment across endpoints, NetalertX network discovery, Checkmk infrastructure monitoring.</p> <p>Gap to Optimal: Limited IoT device integration, incomplete BYOD policy enforcement, need automated asset classification with dynamic policy application.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-2-all-communication-secured-regardless-of-network-location","title":"Tenet 2: All Communication Secured Regardless of Network Location","text":"<p>Implementation Status: Advanced</p> <p>Network location provides no implicit trust. TLS 1.3 mandatory for all web services (Traefik enforcement), SSH encrypted with Ed25519 certificates, VPN encryption via WireGuard/OpenVPN, syslog-ng TLS for log transmission. Internal traffic treated identically to external\u2014Authentik ForwardAuth validates all requests regardless of source VLAN. Step-CA PKI provides certificate-based authentication for service-to-service communication.</p> <p>Evidence: Traefik middleware configuration requiring authentication on all VLANs, syslog-ng TLS certificates, Step-CA certificate issuance logs, VPN encryption audit logs.</p> <p>Gap to Optimal: Mutual TLS (mTLS) not fully deployed for all service-to-service communication, some legacy applications lack modern encryption, need encrypted DNS (DoH/DoT) enterprise-wide.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-3-per-session-resource-access-with-least-privilege","title":"Tenet 3: Per-Session Resource Access with Least Privilege","text":"<p>Implementation Status: Advanced</p> <p>Access granted per-session via Authentik OAuth2/OIDC with 30-minute session timeouts requiring re-authentication. OAuth2 scopes limit permissions to minimum operations. SSH sessions use temporary sudo elevation with explicit justification. No persistent elevated privileges\u2014all access time-limited and activity-specific. Traefik ForwardAuth validates each request independently.</p> <p>Evidence: Authentik session timeout logs, OAuth2 scope configurations, sudo elevation audit logs, Traefik access validation per-request.</p> <p>Gap to Optimal: Need just-in-time (JIT) access provisioning with automated expiration, dynamic privilege elevation based on real-time risk assessment, continuous session validation beyond timeout intervals.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-4-dynamic-policy-based-on-observable-state","title":"Tenet 4: Dynamic Policy Based on Observable State","text":"<p>Implementation Status: Advanced</p> <p>Policy engine (Authentik) evaluates user identity, group membership, device compliance (Wazuh status), source IP reputation, time-of-day restrictions, MFA verification, and behavioral patterns. Policies adapt based on threat intelligence (MISP correlation), failed authentication patterns, geoIP anomalies. Environmental attributes include network location, reported active attacks, device patch level.</p> <p>Evidence: Authentik policy configurations incorporating Wazuh compliance data, Splunk behavioral analytics dashboards, MISP threat correlation logs, time-based access restrictions.</p> <p>Gap to Optimal: Need real-time continuous risk scoring with dynamic policy updates without manual intervention, automated behavioral baselines with deviation-triggered policy changes, comprehensive environmental telemetry integration.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-5-monitor-and-measure-all-asset-integrity","title":"Tenet 5: Monitor and Measure All Asset Integrity","text":"<p>Implementation Status: Advanced</p> <p>Wazuh agents on 25+ endpoints provide real-time compliance validation against CIS Benchmarks (92-98% compliance). Nessus authenticated scans monthly, Ansible drift detection, container health checks, VM monitoring via Proxmox. Non-compliant devices quarantined to remediation VLAN. CDM-like capabilities via PatchMon (5,000+ packages tracked), vulnerability correlation to NVD, automated patch workflows.</p> <p>Evidence: Wazuh SCA reports, Nessus scan results, PatchMon vulnerability tracking, Ansible compliance playbooks, automated quarantine workflows in firewall logs.</p> <p>Gap to Optimal: Need real-time asset risk scoring, automated remediation without manual approval for non-critical systems, comprehensive SBOM tracking (Trivy/Grype deployment Q1 2026), continuous hardware/firmware integrity validation.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-6-dynamic-authentication-and-authorization","title":"Tenet 6: Dynamic Authentication and Authorization","text":"<p>Implementation Status: Advanced</p> <p>Authentik provides dynamic ICAM with MFA (TOTP, FIDO2/WebAuthn planning), OAuth2/OIDC integration, LDAP/SAML support. Continuous evaluation via session timeouts, behavioral monitoring (Splunk analytics), threat-triggered re-authentication. Asset management via Wazuh, NetalertX, Checkmk. Policy-based re-authentication on resource changes, time-based intervals, anomalous activity detection.</p> <p>Evidence: Authentik MFA enforcement logs, re-authentication triggers in SIEM, behavioral anomaly detection alerts, dynamic policy application based on threat intelligence.</p> <p>Gap to Optimal: Full passwordless authentication via FIDO2/WebAuthn, continuous authentication beyond session-based model, automated privilege adjustment based on real-time risk, biometric MFA integration.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tenet-7-collect-and-use-security-posture-data","title":"Tenet 7: Collect and Use Security Posture Data","text":"<p>Implementation Status: Advanced</p> <p>Comprehensive telemetry: Wazuh endpoint data, Suricata/Snort network IDS, pfSense flow logs, Traefik access logs, Pi-hole DNS queries, Prometheus metrics, application logs. Data processed in dual SIEM (Splunk + Elastic) with correlation, behavioral analytics, threat hunting. Insights improve policy via monthly reviews, automated IOC blocking, vulnerability-driven patching.</p> <p>Evidence: SIEM ingestion rates (100% security events), correlation rule effectiveness, policy updates based on SIEM analytics, threat intelligence integration (MISP), automated IOC blocking.</p> <p>Gap to Optimal: Machine learning/UEBA for predictive analytics, comprehensive data lake for long-term analysis, automated policy generation from threat intelligence, real-time feedback loop for policy optimization.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#nist-sp-800-207-logical-components","title":"NIST SP 800-207 Logical Components","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#policy-engine-pe","title":"Policy Engine (PE)","text":"<p>Implementation: Authentik serves as primary PE, evaluating access requests against enterprise policy, user attributes, device compliance (Wazuh integration), threat intelligence (MISP), behavioral baselines (Splunk), and environmental factors. Trust algorithm considers identity confidence, device posture, request context, historical behavior, current threat landscape.</p> <p>Trust Algorithm Type: Hybrid score-based and criteria-based, contextual evaluation considering subject history, access patterns, anomaly detection.</p> <p>Evidence: Authentik policy logs, access decision audit trails, Wazuh compliance integration, Splunk behavioral correlation.</p> <p>Gap: Need fully automated trust scoring, real-time ML-based risk calculation, comprehensive external data source integration.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#policy-administrator-pa","title":"Policy Administrator (PA)","text":"<p>Implementation: Authentik PA configures communication paths via Traefik middleware, generates OAuth2 tokens, manages session lifecycles, coordinates with Step-CA for certificate-based authentication. Controls session establishment/termination based on PE decisions and ongoing monitoring.</p> <p>Evidence: OAuth2 token generation logs, session establishment/teardown events, Traefik dynamic configuration updates, Step-CA certificate issuance coordination.</p> <p>Gap: Need automated PEP configuration at scale, service mesh integration for microservice communication paths, dynamic network path creation.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#policy-enforcement-point-pep","title":"Policy Enforcement Point (PEP)","text":"<p>Implementation: Multi-component PEP architecture:</p> <p>Client-side: Authentik ForwardAuth integration in browsers, SSH certificate-based authentication, Wazuh agent compliance reporting, VPN device authentication</p> <p>Resource-side: Traefik reverse proxy, pfSense/OPNsense firewalls, SafeLine WAF, service-specific gateways</p> <p>Control Plane: Isolated management network for PE/PA/PEP communication</p> <p>Data Plane: Application traffic on segregated VLANs</p> <p>Deployment Model: Hybrid agent/gateway (Authentik + Traefik), enclave gateway (DMZ services), resource portal (web applications).</p> <p>Evidence: Traefik ForwardAuth logs, firewall rule enforcement, WAF block rates, SSH certificate validation, VLAN isolation configs.</p> <p>Gap: Need device agents for comprehensive endpoint coverage, unified PEP management interface, automated PEP deployment for new resources.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#data-sources-for-policy-decisions","title":"Data Sources for Policy Decisions","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#continuous-diagnostics-and-mitigation-cdm","title":"Continuous Diagnostics and Mitigation (CDM)","text":"<p>Implementation: Wazuh provides CDM capabilities: vulnerability assessment, FIM, rootkit detection, CIS Benchmark compliance (SCA), patch management via PatchMon integration. Nessus authenticated scans complement. Ansible enforces configurations, detects drift. Container/VM monitoring via Proxmox and Docker health checks.</p> <p>Evidence: Wazuh vulnerability reports, compliance scan results (92-98%), PatchMon package tracking (5,000+ packages), Ansible drift detection alerts.</p> <p>Gap: Need comprehensive CDM platform integration, automated non-enterprise device policy enforcement, real-time software inventory with SBOM.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#industry-compliance-system","title":"Industry Compliance System","text":"<p>Implementation: Policy framework aligned with CIS Benchmarks, NIST 800-53 controls, PCI-DSS requirements (where applicable), ISO 27001 standards. Wazuh SCA enforces CIS policies, vulnerability remediation follows NIST guidelines, encryption standards per NIST/PCI-DSS.</p> <p>Evidence: CIS Benchmark compliance reports, control mapping documentation, policy version control (Git), quarterly compliance reviews.</p> <p>Gap: Automated compliance validation across all frameworks, dynamic policy updates based on regulatory changes, comprehensive audit trail integration.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-intelligence-feeds","title":"Threat Intelligence Feeds","text":"<p>Implementation: MISP threat intelligence platform correlates IOCs across network logs, endpoint telemetry, application data. Splunk integrates feeds for correlation. Suricata/Snort use threat signatures. GeoIP databases identify suspicious locations. Cortex analyzers (VirusTotal, Hybrid Analysis) provide malware analysis.</p> <p>Evidence: MISP IOC correlation logs, automated IOC blocking (Wazuh Active Response), threat intelligence-driven alerts, malware analysis reports.</p> <p>Gap: Need additional commercial threat feeds, automated STIX/TAXII integration, predictive threat modeling, insider threat detection feeds.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#network-and-system-activity-logs","title":"Network and System Activity Logs","text":"<p>Implementation: Dual SIEM architecture (Splunk + Elastic) aggregates 100% security events: authentication logs, firewall traffic, DNS queries (Pi-hole), web access (Traefik), endpoint events (Wazuh), network IDS (Suricata), infrastructure metrics (Prometheus). Real-time correlation detects multi-stage attacks, lateral movement, data exfiltration patterns.</p> <p>Evidence: SIEM ingestion statistics, correlation rule effectiveness, alert volumes, retention compliance (90-day hot, 1-year cold), multi-source event correlation.</p> <p>Gap: Need unified logging schema, comprehensive cloud service log integration, enhanced UEBA capabilities, longer retention with efficient archival.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#data-access-policies","title":"Data Access Policies","text":"<p>Implementation: RBAC via Authentik groups mapped to resource permissions. Filesystem ACLs, database role-based permissions, application-level authorization. Policies encoded in Authentik, enforced via Traefik middleware, validated quarterly. Sensitivity-based policies (Public, Internal, Confidential, Restricted) with handling requirements.</p> <p>Evidence: Authentik RBAC configurations, quarterly access reviews, policy documentation (version-controlled), filesystem/database ACL audits.</p> <p>Gap: Need attribute-based access control (ABAC), automated policy generation from data classification, dynamic policies based on data sensitivity changes.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#enterprise-pki","title":"Enterprise PKI","text":"<p>Implementation: Step-CA provides automated certificate lifecycle: issuance, renewal, rotation (90-day lifetimes). SSH certificate-based authentication, TLS certificates for services, mutual TLS planning. Integration with Authentik for identity certificates. No reliance on external CA for internal services.</p> <p>Evidence: Step-CA issuance logs, certificate rotation compliance, SSH cert validation logs, TLS certificate inventory, cryptographic algorithm compliance (TLS 1.3, Ed25519).</p> <p>Gap: Need Federal PKI integration for inter-agency collaboration, hardware security module (HSM) for root CA protection, comprehensive certificate transparency monitoring.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#id-management-system","title":"ID Management System","text":"<p>Implementation: Authentik serves as authoritative identity source: user accounts, attributes, group memberships, device identities, service accounts. LDAP/OAuth2/OIDC/SAML support for federated identity. Integration with Step-CA for certificate binding. Account lifecycle management with automated provisioning/deprovisioning (standard users), manual approval for privileged accounts.</p> <p>Evidence: Authentik user database, group assignment logs, federated identity configurations, account lifecycle audit trails, integration logs with downstream systems.</p> <p>Gap: Need full automation of privileged account lifecycle, federated identity with external partners, comprehensive identity governance platform, automated role mining.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#siem-system","title":"SIEM System","text":"<p>Implementation: Dual architecture\u2014Splunk (primary analytics) and Elastic (secondary/redundancy) collect security-centric data for policy refinement, attack detection, forensics. 90-day hot retention, 1-year cold storage. Dashboards track vulnerabilities, patch compliance, authentication patterns, threat indicators. Alerts feed TheHive case management, Shuffle SOAR orchestration.</p> <p>Evidence: SIEM correlation rules (100+ active), dashboard usage, alert-to-incident conversion rates, retention compliance, SOAR integration workflows.</p> <p>Gap: Need automated playbook optimization, comprehensive use case coverage, advanced analytics (UEBA/ML), threat hunting automation, extended retention for regulatory compliance.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#zta-deployment-model-assessment","title":"ZTA Deployment Model Assessment","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#primary-model-device-agentgateway-hybrid","title":"Primary Model: Device Agent/Gateway (Hybrid)","text":"<p>Implementation: Authentik acts as central policy administrator. Client-side enforcement via browser-based ForwardAuth (no installed agent for web resources), SSH certificate agents for terminal access. Resource-side gateways include Traefik (web services), pfSense/OPNsense (network perimeter), SafeLine WAF (application layer).</p> <p>Strengths: No required client software for web access (BYOD-friendly), centralized policy management, defense-in-depth with multiple gateway layers.</p> <p>Weaknesses: Limited endpoint visibility for non-enterprise devices, cannot enforce compliance before web access attempts, relies on network controls for non-web protocols.</p> <p>Evidence: Traefik ForwardAuth integration across 50+ services, SSH certificate distribution via Ansible, gateway configuration management.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#secondary-model-enclave-based","title":"Secondary Model: Enclave-Based","text":"<p>Implementation: DMZ services protected by enclave gateway (pfSense), application tier isolated behind Traefik, backend services (databases, SIEM, PKI) on dedicated VLANs with restricted access. Cloud services will use cloud-provider gateways when Authentik cloud deployment occurs.</p> <p>Evidence: 3-tier architecture (DMZ, application, backend), VLAN isolation with firewall enforcement, gateway placement protecting service enclaves.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#tertiary-model-resource-portal","title":"Tertiary Model: Resource Portal","text":"<p>Implementation: Web-based access to services via Traefik reverse proxy acting as portal. No client agents required. Authentication/authorization at portal before proxying to resources. Used for contractor access, cross-organization collaboration, public-facing authenticated services.</p> <p>Evidence: Traefik portal configurations, authentication workflows, contractor access logs, session management.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#zta-use-case-alignment","title":"ZTA Use Case Alignment","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#use-case-1-enterprise-with-satellite-facilities-remote-workers","title":"Use Case 1: Enterprise with Satellite Facilities (Remote Workers)","text":"<p>Applicability: High\u2014supports remote administration, off-site monitoring, telecommuting scenarios.</p> <p>Implementation: Tailscale mesh VPN provides secure remote access without traditional VPN concentrator. Authentik authenticates remote users, validates device compliance via Wazuh remote agent data. Cloud-ready architecture (Authentik cloud planning) enables direct cloud resource access without hairpinning through on-premises infrastructure.</p> <p>Evidence: Tailscale deployment, remote Wazuh agent reporting, Authentik MFA enforcement for remote sessions, direct cloud access configurations.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#use-case-2-multi-cloudcloud-to-cloud","title":"Use Case 2: Multi-Cloud/Cloud-to-Cloud","text":"<p>Applicability: Medium\u2014current cloud usage limited but growing.</p> <p>Implementation: Planning for Authentik cloud deployment enables policy enforcement for cloud resources. Current cloudflare Tunnels provide secure cloud ingress without port forwarding. Future cloud-hosted services will authenticate via Authentik OAuth2/OIDC, enforce same policies as on-premises.</p> <p>Evidence: Cloudflare Tunnel configurations, cloud service authentication planning, policy portability across environments.</p> <p>Gap: Need comprehensive multi-cloud policy orchestration, cloud workload protection platform (CWPP), cloud access security broker (CASB) capabilities.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#use-case-3-contracted-servicesnonemployee-access","title":"Use Case 3: Contracted Services/Nonemployee Access","text":"<p>Applicability: High\u2014supports guest network, contractor access, IoT device isolation.</p> <p>Implementation: Open guest network with internet access but no enterprise resource visibility. Authentik provides time-limited contractor accounts with restricted resource access. Smart building systems isolated on dedicated VLAN, accessible only to vendor service accounts with MFA. Visitor devices cannot discover internal resources (SDP principles).</p> <p>Evidence: Guest VLAN isolation, contractor account lifecycle (creation, time limits, deactivation), vendor MFA enforcement, network segmentation preventing reconnaissance.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#use-case-4-cross-enterprise-collaboration","title":"Use Case 4: Cross-Enterprise Collaboration","text":"<p>Applicability: Medium\u2014prepared for federated scenarios.</p> <p>Implementation: Authentik supports OAuth2/OIDC/SAML federation, enabling cross-organization collaboration. Can establish federated trust with partner identity providers. Resource-specific policies grant external user access to designated collaboration resources (shared databases, project management tools) while denying access to other systems.</p> <p>Evidence: Authentik federation capabilities, external identity source configurations, resource-specific policy enforcement.</p> <p>Gap: Need formal federated identity agreements, cross-domain trust establishment, collaborative security posture sharing.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#use-case-5-publiccustomer-facing-services","title":"Use Case 5: Public/Customer-Facing Services","text":"<p>Applicability: Low\u2014limited public-facing services currently.</p> <p>Implementation: Public web services (if deployed) would use Traefik with optional authentication. No enforcement of device posture for anonymous public access. Registered user portals (future) could enforce password policies, optional MFA, browser type validation. Metadata collection for attack detection (rate limiting, browser fingerprinting, bot detection).</p> <p>Evidence: Traefik rate limiting, WAF rules blocking automated attacks, access pattern analysis.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threats-and-mitigations","title":"Threats and Mitigations","text":""},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-1-subversion-of-zta-decision-process","title":"Threat 1: Subversion of ZTA Decision Process","text":"<p>Risk Level: High\u2014PE/PA compromise undermines entire architecture.</p> <p>Mitigations:</p> <ul> <li>Authentik access restricted to dedicated administrator accounts with MFA</li> <li>All configuration changes logged to SIEM with alerting</li> <li>Git version control for policy configurations with approval workflow</li> <li>Quarterly access reviews for administrative privileges</li> <li>Authentik deployed on hardened, isolated systems with minimal attack surface</li> </ul> <p>Evidence: Admin account audit logs, SIEM alerting on policy changes, Git commit history, privilege review documentation.</p> <p>Gap: Need HSM-backed key material, multi-person approval for critical policy changes, immutable audit logging with tamper detection.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-2-denial-of-service-or-network-disruption","title":"Threat 2: Denial-of-Service or Network Disruption","text":"<p>Risk Level: Medium\u2014disruption impacts business continuity.</p> <p>Mitigations:</p> <ul> <li>HA firewall cluster (pfSense CARP) with &lt;5-second failover</li> <li>Dual DNS (Pi-hole) with automatic failover</li> <li>Dual SIEM architecture (Splunk + Elastic) for resilience</li> <li>Redundant internet connections with automatic failover</li> <li>Load balancing via Traefik across multiple backends</li> </ul> <p>Evidence: Failover testing logs, uptime statistics (99.9% DNS availability), redundant service configurations, load balancer health checks.</p> <p>Gap: Need distributed PEP deployment across geographic locations, DDoS mitigation service, automated failover testing, comprehensive disaster recovery testing.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-3-stolen-credentialsinsider-threat","title":"Threat 3: Stolen Credentials/Insider Threat","text":"<p>Risk Level: Medium\u2014valid credentials bypass many controls.</p> <p>Mitigations:</p> <ul> <li>MFA enforcement (TOTP current, FIDO2/WebAuthn planned) reduces credential theft impact</li> <li>Contextual trust algorithm detects anomalous behavior (unusual times, locations, access patterns)</li> <li>Session timeouts (30 minutes) limit exposure window</li> <li>Behavioral analytics (Splunk) identify compromised account indicators</li> <li>Least privilege limits blast radius\u2014stolen HR credentials cannot access financial systems</li> <li>Lateral movement prevention via network segmentation, least privilege</li> </ul> <p>Evidence: MFA enforcement logs, behavioral anomaly alerts, session timeout enforcement, privilege restriction audit logs, lateral movement detection in SIEM.</p> <p>Gap: Need continuous authentication beyond session-based, risk-based step-up authentication, automated account suspension on high-risk activity, comprehensive insider threat program.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-4-visibility-limitations-on-encrypted-traffic","title":"Threat 4: Visibility Limitations on Encrypted Traffic","text":"<p>Risk Level: Low to Medium\u2014cannot inspect all traffic.</p> <p>Mitigations:</p> <ul> <li>Metadata collection from encrypted sessions (source, destination, timing, volume)</li> <li>Certificate inspection for TLS connections (Step-CA issued certificates trusted, external certificates scrutinized)</li> <li>DNS query logging (Pi-hole) identifies suspicious domains even with encrypted payloads</li> <li>Endpoint visibility via Wazuh agents provides process-level context</li> <li>Network behavior analysis detects anomalies without decryption</li> </ul> <p>Evidence: Flow log analysis, DNS-based threat detection, endpoint telemetry correlation, encrypted traffic metadata dashboards.</p> <p>Gap: Need TLS inspection capabilities with appropriate privacy controls, DNS over HTTPS (DoH) traffic handling, encrypted malware detection capabilities.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-5-stored-data-compromise","title":"Threat 5: Stored Data Compromise","text":"<p>Risk Level: Medium\u2014reconnaissance data valuable to attackers.</p> <p>Mitigations:</p> <ul> <li>SIEM data, network diagrams, configuration files stored with encryption at rest (AES-256)</li> <li>Access to security data repositories restricted to security team with MFA</li> <li>Configuration management tools (Ansible, Terraform) protected with vault encryption</li> <li>Most restrictive access policies on security infrastructure components</li> <li>Regular access reviews for security data access</li> </ul> <p>Evidence: Encryption-at-rest configurations, access restriction logs, security data access audit trails, vault usage logs.</p> <p>Gap: Need data loss prevention (DLP) for security data, comprehensive data classification, automated security data access reviews, honeypot/deception technology.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-6-vendor-lock-inproprietary-formats","title":"Threat 6: Vendor Lock-in/Proprietary Formats","text":"<p>Risk Level: Medium\u2014impacts flexibility and resilience.</p> <p>Mitigations:</p> <ul> <li>Open-source focus (Authentik, Wazuh, Traefik, Suricata) reduces vendor lock-in</li> <li>Standard protocols (OAuth2, OIDC, SAML, LDAP) enable interoperability</li> <li>Infrastructure-as-code (Terraform, Ansible) allows migration to alternative platforms</li> <li>Multi-vendor approach for critical functions (dual SIEM, multiple authentication methods)</li> <li>Regular evaluation of alternative solutions</li> </ul> <p>Evidence: Open-source tool selection, standard protocol usage, IaC repositories, vendor diversity in architecture.</p> <p>Gap: Need formal vendor evaluation framework, migration plans for critical dependencies, comprehensive data portability validation.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#threat-7-automated-agentnpe-compromise","title":"Threat 7: Automated Agent/NPE Compromise","text":"<p>Risk Level: Medium\u2014service accounts have elevated privileges.</p> <p>Mitigations:</p> <ul> <li>Service account credentials stored in Vaultwarden with automated retrieval</li> <li>API keys rotated quarterly with automated expiration</li> <li>Service account activity logged and monitored for anomalies</li> <li>Principle of least privilege for automation accounts (read-only where possible)</li> <li>Automated agent authentication via certificate-based methods (Step-CA)</li> </ul> <p>Evidence: Service account activity logs, API key rotation schedules, certificate-based automation authentication, anomaly detection for NPE accounts.</p> <p>Gap: Need just-in-time service account provisioning, short-lived credentials for all automation, comprehensive NPE behavior baselines, automated agent attestation.</p>"},{"location":"projects/homelab/grc/grc-nist-zero-trust/#deployment-maturity-assessment","title":"Deployment Maturity Assessment","text":"<p>Overall NIST ZTA Maturity: Advanced</p> <p>Strengths:</p> <ul> <li>Comprehensive implementation of ZT tenets 1-7</li> <li>Mature logical component deployment (PE, PA, PEP)</li> <li>Rich data sources for policy decisions (CDM, threat intel, SIEM, PKI, IAM)</li> <li>Hybrid deployment model supporting diverse use cases</li> <li>Strong threat mitigation posture</li> <li>Open standards and interoperability focus</li> </ul> <p>Gaps to Optimal:</p> <ul> <li>Device agents for comprehensive endpoint coverage</li> <li>Full passwordless authentication (FIDO2/WebAuthn)</li> <li>Continuous authentication beyond session-based model</li> <li>Machine learning/UEBA for predictive analytics</li> <li>Comprehensive cloud security integration</li> <li>Automated policy generation from threat intelligence</li> <li>Just-in-time access provisioning enterprise-wide</li> <li>Hardware security modules for critical key material</li> </ul> <p>Recommended Priorities Q1-Q2 2026:</p> <ul> <li>FIDO2/WebAuthn deployment for passwordless MFA</li> <li>Trivy/Grype for comprehensive SBOM tracking</li> <li>UEBA capabilities in SIEM platforms</li> <li>Mutual TLS for all service-to-service communication</li> <li>Comprehensive DLP implementation</li> <li>Formal federated identity program</li> </ul> <p>Framework Alignment:</p> <ul> <li>NIST SP 800-207: Advanced maturity, comprehensive tenet implementation</li> <li>NIST RMF: Access policies risk-based, continuous monitoring aligned</li> <li>NIST Privacy Framework: Privacy controls for monitoring data, user consent mechanisms</li> <li>FICAM: Strong identity governance, MFA enforcement, lifecycle management</li> <li>TIC 3.0: Network security capabilities aligned, PEP-based enforcement</li> <li>EINSTEIN/NCPS: Telemetry compatible, incident response integration ready</li> <li>CDM: Mature diagnostics and mitigation capabilities via Wazuh/PatchMon</li> <li>Cloud Smart: Cloud-ready architecture, hybrid deployment support</li> </ul> <p>This Zero Trust implementation demonstrates advanced alignment with NIST SP 800-207 principles, providing production-ready capabilities for federal civilian executive branch agencies and enterprise environments pursuing comprehensive ZTA adoption.</p>"},{"location":"projects/homelab/grc/owasp/","title":"OWASP Top 10 (2025) Framework","text":"<p>Document Control: Version: 1.0 Last Updated: January 2026 Owner: Paul Leone Classification: Internal Use  </p> <p>Framework Version: OWASP Top 10:2025</p>"},{"location":"projects/homelab/grc/owasp/#a012025-broken-access-control","title":"A01:2025 - Broken Access Control","text":"<p>Risk Description: Failures in access control allow unauthorized users to access, modify, or delete resources beyond their intended permissions. This includes SSRF (Server-Side Request Forgery), which has been rolled into this category.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Authentication Authentik ForwardAuth enforces authentication for all Traefik-routed services; SSH key-only access (passwords disabled globally) NIST AC-3, ISO 27001 A.5.15 Authorization Authentik RBAC groups; OAuth2 scopes; SSH sudo policies; least-privilege principle NIST AC-2(7), CIS Control 6.1 Network Controls Traefik IP allowlisting; firewall ACLs per VLAN; pfSense default-deny rules NIST SC-7, PCI-DSS 1.2.1 SSRF Prevention DNS rebinding protection; Traefik backend validation; SSH tunnel restrictions; network segmentation; egress filtering OWASP Prevention API Security API key authentication; rate limiting; request validation; certificate-based authentication NIST IA-5, ISO 27001 A.14.1 Monitoring Wazuh monitors unauthorized access attempts; Splunk authentication dashboard tracks access requests; TheHive case creation for access violations NIST AU-6, CIS Control 6.1"},{"location":"projects/homelab/grc/owasp/#a022025-security-misconfiguration","title":"A02:2025 - Security Misconfiguration","text":"<p>Risk Description: Improperly configured security settings, default credentials, unnecessary features, verbose error messages, and missing security headers.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Baseline Hardening SSH hardened per CIS Benchmark; Traefik secure defaults; DNSSEC enabled; pfSense/OPNsense hardened configurations NIST CM-6, CIS Control 4.1 Configuration Management Ansible playbooks define baselines; Terraform IaC; Git version control; configuration drift detection NIST CM-2, ISO 27001 A.8.9 Default Credentials SSH root login disabled; default Traefik dashboard credentials changed; validated via authenticated Nessus scans; Wazuh SCA detects default accounts NIST IA-5(1), CIS Control 4.7 Unnecessary Services Unnecessary services disabled; verified via authenticated Nessus scans; minimal attack surface NIST CM-7, PCI-DSS 2.2.2 Security Headers Traefik secure headers (HSTS, CSP, X-Frame-Options, X-Content-Type-Options); NGINX security configurations OWASP Prevention Continuous Auditing Weekly OpenVAS scans; monthly Nessus authenticated scans; Wazuh SCA compliance audits (CIS Benchmarks); configuration deviation alerts NIST CA-2, CIS Control 4.1"},{"location":"projects/homelab/grc/owasp/#a032025-software-supply-chain-failures","title":"A03:2025 - Software Supply Chain Failures","text":"<p>Risk Description: Expanded scope from A06:2021 to include compromises occurring within or across the entire ecosystem of software dependencies, build systems, and distribution infrastructure.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Software Sources Official Docker images; maintained open-source projects (Traefik, Authentik, OpenVAS); trusted repositories only CIS Control 16.5 Package Verification Package signature verification; container image verification (SHA-256); GPG key validation NIST CM-8, ISO 27001 A.8.32 Dependency Tracking Not Implemented: SBOM tracking via Trivy/Grype; dependency vulnerability scanning; automated CVE monitoring for dependencies NIST RA-5, OWASP Prevention Update Management Coordinated patching via PatchMon, WSUS, Watchtower; vulnerability-driven update prioritization; rollback capability NIST SI-2, CIS Control 7.4 Build Security Not Implemented: CI/CD security linting; container scanning in pipelines; Infrastructure as Code validation NIST SA-10 Threat Intelligence MISP tracks vendor compromises; Shuffle vulnerability disclosure workflow monitors supply chain risks; GitHub security alerts NIST PM-16, ISO 27001 A.5.7"},{"location":"projects/homelab/grc/owasp/#a042025-cryptographic-failures","title":"A04:2025 - Cryptographic Failures","text":"<p>Risk Description: Failures related to cryptography (or lack thereof) that often lead to sensitive data exposure or system compromise. Falls from #2 to #4 in ranking.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Encryption in Transit TLS 1.3 mandatory (Traefik); SSH AES-256-GCM; DNS-over-TLS (planned); VPN encryption (WireGuard, OpenVPN) NIST SC-8, PCI-DSS 4.2.1 Encryption at Rest Encrypted backups (AES-256); SSH private keys encrypted; database encryption where applicable NIST SC-28, ISO 27001 A.8.24 Key Management Step-CA automated certificate issuance; SSH key generation (Ed25519); centralized key management via Ansible; Vaultwarden secrets management NIST SC-12, ISO 27001 A.8.24 Cipher Suites Modern algorithms only (Ed25519, AES-256-GCM, TLS 1.3); weak cipher detection via vulnerability scans; SSL/TLS configuration hardening NIST SC-13, CIS Control 13.10 Certificate Management Step-CA PKI (Root + Intermediate CA); Traefik cert distribution; automated renewal; zero certificate expiry incidents NIST SC-17, ISO 27001 A.8.24 Monitoring Certificate expiry monitoring (Uptime Kuma, Prometheus); weak cipher detection (Nessus); TLS configuration validation NIST AU-6, CIS Control 8.6"},{"location":"projects/homelab/grc/owasp/#a052025-injection","title":"A05:2025 - Injection","text":"<p>Risk Description: Injection vulnerabilities from Cross-site Scripting (high frequency/low impact) to SQL Injection (low frequency/high impact). Falls from #3 to #5.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Input Validation DNS query validation; SSH input sanitization; Traefik header injection prevention; WAF input filtering (Safeline) OWASP Prevention Parameterized Queries Parameterized queries in custom applications; ORM usage where applicable; prepared statements OWASP Prevention WAF Protection Safeline WAF (OWASP CRS rules); Traefik middleware stack; NGINX Ingress annotations; request filtering NIST SI-4(23), PCI-DSS 6.6 Command Injection Prevention SSH command validation; shell escaping in scripts; Ansible playbook validation; restricted shell access OWASP Prevention XSS Prevention Content Security Policy (CSP) headers; X-XSS-Protection headers; input sanitization; output encoding OWASP Prevention Monitoring Suricata IDS signatures for injection attempts; WAF logs to SIEM; Splunk correlation for attack patterns; TheHive case creation for confirmed attacks NIST SI-4, CIS Control 13.1"},{"location":"projects/homelab/grc/owasp/#a062025-insecure-design","title":"A06:2025 - Insecure Design","text":"<p>Risk Description: Focus on design flaws and threat modeling. Slides from #4 to #6 as industry shows improvements in secure design practices.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Threat Modeling Defense-in-depth architecture; security architecture review; threat modeling for new services; zero-trust principles NIST RA-3, ISO 27001 A.14.1 Secure Architecture DNS 3-tier architecture; reverse proxy isolation; network segmentation; least-privilege access; fail-secure defaults NIST SA-8, ISO 27001 A.14.2 Security Patterns Zero-trust network access; Infrastructure as Code; immutable infrastructure; declarative configuration Industry best practice Defense in Depth Multiple security layers (network, application, endpoint); redundant detection mechanisms; overlapping controls NIST SC-7, ISO 27001 A.13.1 Secure Defaults SSH passwords disabled by default; Traefik secure defaults; services default to encrypted; least-privilege by default NIST SA-4, OWASP Prevention Documentation Architecture diagrams maintained; security controls documented; design decisions recorded; threat model updates NIST SA-17, ISO 27001 A.12.1.1"},{"location":"projects/homelab/grc/owasp/#a072025-authentication-failures","title":"A07:2025 - Authentication Failures","text":"<p>Risk Description: Authentication-related failures including weak passwords, credential stuffing, session management issues. Remains at #7 with name change from \"Identification and Authentication Failures.\"</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Strong Authentication MFA (Authentik TOTP); SSH key-based auth (passwords disabled); certificate-based authentication (Step-CA) NIST IA-2(1), PCI-DSS 8.3 Credential Management Vaultwarden secrets management; Ansible Vault encrypted vars; no hardcoded credentials; centralized SSH key management NIST IA-5(7), CIS Control 6.2 Account Lockout SSH MaxAuthTries=3; Authentik account lockout after 5 failures; Wazuh Active Response for brute force; CrowdSec automated blocking NIST AC-7, ISO 27001 A.9.4.2 Session Management Authentik session tokens; SSH session IDs; TLS session tickets; session timeout (30 min idle) NIST SC-23, PCI-DSS 8.1.8 Password Policies Authentik enforces complexity requirements; no password reuse; WebAuthn/FIDO2 support (planned) NIST IA-5(1), CIS Control 6.3 Monitoring Failed login tracking; brute force detection (multi-source correlation); Wazuh monitors MFA bypass attempts; Splunk admin login dashboard NIST AU-6, CIS Control 8.6"},{"location":"projects/homelab/grc/owasp/#a082025-software-or-data-integrity-failures","title":"A08:2025 - Software or Data Integrity Failures","text":"<p>Risk Description: Failure to maintain trust boundaries and verify the integrity of software, code, and data artifacts. Continues at #8.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Code Integrity Git version control; commit signing (planned); Infrastructure as Code validation; Terraform plan review NIST SI-7, ISO 27001 A.12.1.2 Software Verification Package signature verification; container image verification (SHA-256); GPG key validation; Step-CA certificate validation NIST CM-8, CIS Control 2.3 Data Integrity File integrity monitoring (Wazuh FIM); checksum verification; immutable SIEM indexes; database integrity checks NIST SI-7, ISO 27001 A.12.3.1 Certificate Validation Traefik cert validation; SSH host key verification; DNSSEC; OCSP validation; CRL distribution NIST SC-17, ISO 27001 A.8.24 Change Control Snapshot-before-patch; approval workflows (WSUS); pre-scan snapshots for critical systems; Git version control; rollback capability NIST CM-3, ISO 27001 A.8.32 Monitoring Wazuh FIM alerts on file modifications; Splunk correlation for unauthorized changes; TheHive case creation for integrity violations NIST AU-6, CIS Control 8.6"},{"location":"projects/homelab/grc/owasp/#a092025-security-logging-and-alerting-failures","title":"A09:2025 - Security Logging and Alerting Failures","text":"<p>Risk Description: Insufficient logging, monitoring, and alerting can prevent or significantly delay the detection of security incidents. Name change emphasizes alerting functionality. Remains at #9.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Comprehensive Logging 100% security events logged to SIEM; DNS queries logged (Pi-hole); SSH sessions logged (auth.log); Traefik access logs (JSON format); Wazuh security events; patch deployment events logged; 90-day retention NIST AU-2, PCI-DSS 10.2 Log Protection Immutable SIEM indexes; encrypted log transmission (syslog-ng TLS); write-once Elasticsearch indexes; tamper detection; centralized SIEM storage NIST AU-9, PCI-DSS 10.5.1 Real-Time Alerting Discord webhooks; Splunk scheduled alerts; Wazuh Discord/email integration; Prometheus Alertmanager; TheHive case notifications; Cortex analysis completion; MISP event alerts; Shuffle notification actions; multi-channel redundancy NIST SI-4(5), CIS Control 13.1 Alert Tuning False positive rate &lt;3%; dynamic thresholds; alert suppression (max 1 per source per hour); 30-day baseline period Operational efficiency Correlation Multi-source correlation (Splunk + Elastic + Wazuh + network logs); TheHive aggregates alerts; Shuffle orchestrates cross-platform queries; MITRE ATT&amp;CK mapping NIST AU-6(3), CIS Control 8.11 Audit Trail Structured JSON format for SIEM ingestion; full audit trails (user, timestamp, source IP, action, result); searchable correlation for forensics NIST AU-3, PCI-DSS 10.3"},{"location":"projects/homelab/grc/owasp/#a102025-mishandling-of-exceptional-conditions","title":"A10:2025 - Mishandling of Exceptional Conditions","text":"<p>Risk Description: NEW category for 2025. Contains 24 CWEs focusing on improper error handling, logical errors, failing open, and other related scenarios stemming from abnormal conditions.</p> <p>Lab Implementation:</p> Control Type Implementation Framework Alignment Error Handling Traefik error handling (circuit breakers); graceful degradation; fail-secure defaults (firewall default-deny); proper exception handling in scripts OWASP Prevention Input Validation Comprehensive input validation; boundary checking; type validation; range checking; malformed request handling OWASP Prevention Fail-Secure Design pfSense default-deny rules; Traefik rejects invalid requests; SSH connection limits; services fail-closed on errors NIST SC-24, OWASP Prevention Resource Limits Connection limits (SSH, Traefik); timeout configurations; rate limiting; resource quotas (Kubernetes); memory/CPU limits NIST SC-5, CIS Control 13.3 Logging Edge Cases Exception logging; error condition logging; unusual state logging; Wazuh monitors service failures; Prometheus alerts on anomalies NIST AU-2, CIS Control 8.5 Monitoring Service health checks (Uptime Kuma); Prometheus alerting for failures; Grafana anomaly dashboards; Pulse hypervisor monitoring; application error rates tracked NIST SI-4, CIS Control 8.6 Recovery Procedures Automatic service restarts (systemd, Kubernetes); health check-based recovery; documented recovery procedures; Pulse backup integrity monitoring NIST CP-10, ISO 27001 A.17.1"},{"location":"projects/homelab/grc/owasp/#owasp-top-102025-compliance-summary","title":"OWASP Top 10:2025 - Compliance Summary","text":"OWASP 2025 Category Coverage Key Controls Maturity A01: Broken Access Control Strong Authentik SSO, MFA, RBAC, IP allowlisting, SSRF prevention Advanced A02: Security Misconfiguration Strong CIS Benchmarks (92-98%), IaC, configuration drift detection Advanced A03: Software Supply Chain Failures Moderate Trusted sources, package verification, planned SBOM tracking Developing A04: Cryptographic Failures Strong TLS 1.3, Ed25519, Step-CA PKI, encrypted backups Advanced A05: Injection Strong WAF (25% block rate), input validation, parameterized queries Advanced A06: Insecure Design Strong Threat modeling, defense-in-depth, zero-trust architecture Advanced A07: Authentication Failures Strong MFA enforcement (100% admin), SSH keys only, account lockout Advanced A08: Software/Data Integrity Failures Strong FIM (100% critical paths), signature verification, immutable logs Advanced A09: Security Logging and Alerting Failures Strong 100% event logging, 90-day retention, multi-channel alerting Advanced A10: Mishandling of Exceptional Conditions Strong Fail-secure defaults, error handling, service health monitoring Advanced <p>Overall OWASP 2025 Compliance: 9/10 Strong (1 Moderate - Supply Chain)</p>"},{"location":"projects/homelab/grc/owasp/#owasp-top-10-2025-mitigation-summary","title":"OWASP Top 10 (2025) Mitigation Summary","text":"OWASP Risk Mitigation A01: Broken Access Control Authentik ForwardAuth + MFA; SSH key-only access (passwords disabled); Traefik IP allowlisting; Authentik RBAC groups; OAuth2 scopes; pfSense default-deny firewall ACLs; SSRF prevention (DNS rebinding protection, backend validation, egress filtering) A02: Security Misconfiguration SSH hardened per CIS Benchmark; Traefik secure defaults; DNSSEC enabled; Ansible/Terraform IaC; configuration drift detection; default credentials eliminated; weekly OpenVAS + monthly Nessus authenticated scans; Wazuh SCA compliance audits A03: Software Supply Chain Failures Official Docker images only; package signature verification (SHA-256, GPG); trusted repositories; coordinated patching (PatchMon/WSUS/Watchtower); MISP vendor compromise tracking; Not Implemented: SBOM tracking via Trivy/Grype A04: Cryptographic Failures TLS 1.3 mandatory (Traefik); SSH AES-256-GCM; Ed25519 keys; Step-CA PKI (Root + Intermediate CA); encrypted backups (AES-256); automated cert renewal; weak cipher detection; certificate expiry monitoring A05: Injection Safeline WAF (OWASP CRS rules); DNS query validation; SSH input sanitization; Traefik header injection prevention; parameterized queries; CSP headers; Suricata IDS signatures; WAF logs to SIEM A06: Insecure Design Defense-in-depth architecture; DNS 3-tier design; zero-trust network access; threat modeling for new services; network segmentation; fail-secure defaults; least-privilege by default; documented architecture diagrams A07: Authentication Failures MFA (Authentik TOTP); SSH key-based auth only; Vaultwarden secrets management; account lockout (SSH MaxAuthTries=3, Authentik 5 failures); CrowdSec automated blocking; session timeout (30 min idle); no hardcoded credentials A08: Software/Data Integrity Failures Wazuh FIM (100% critical paths); Git version control; package signature verification; SHA-256 container verification; Step-CA certificate validation; snapshot-before-patch; immutable SIEM indexes; DNSSEC; change control workflows A09: Security Logging and Alerting Failures 100% security events logged to SIEM; 90-day retention; immutable Elasticsearch indexes; encrypted log transmission (syslog-ng TLS); real-time alerting (Discord, Splunk, Wazuh); multi-source correlation; TheHive case creation; structured JSON format A10: Mishandling of Exceptional Conditions Traefik circuit breakers; pfSense default-deny rules; fail-secure defaults; comprehensive input validation; connection limits (SSH, Traefik); rate limiting; exception logging; service health checks (Uptime Kuma); automatic restarts (systemd/Kubernetes) <p>Strengths:</p> <ul> <li>Comprehensive coverage across all 10 categories</li> <li>Quantifiable metrics for each risk area</li> <li>Defense-in-depth approach to mitigation</li> <li>Continuous monitoring and alerting</li> </ul>"}]}