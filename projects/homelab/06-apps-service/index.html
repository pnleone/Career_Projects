
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../05-auto-iac/">
      
      
        <link rel="next" href="../07-vis-response-pt1/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Applications and Services - Paul Leone – Projects & Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/image-overrides.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#applications-and-services" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Paul Leone – Projects &amp; Portfolio" class="md-header__button md-logo" aria-label="Paul Leone – Projects & Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 4a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m5.13 12A9.7 9.7 0 0 1 12 20.92 9.7 9.7 0 0 1 6.87 17c-.34-.5-.63-1-.87-1.53 0-1.65 2.71-3 6-3s6 1.32 6 3c-.24.53-.53 1.03-.87 1.53"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Paul Leone – Projects & Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Applications and Services
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Paul Leone – Projects &amp; Portfolio" class="md-nav__button md-logo" aria-label="Paul Leone – Projects & Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 4a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m5.13 12A9.7 9.7 0 0 1 12 20.92 9.7 9.7 0 0 1 6.87 17c-.34-.5-.63-1-.87-1.53 0-1.65 2.71-3 6-3s6 1.32 6 3c-.24.53-.53 1.03-.87 1.53"/></svg>

    </a>
    Paul Leone – Projects & Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projects
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../business-intelligence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Business Intelligence & Data Analytics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../threat-intel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Threat Intelligence Brief & SOC Improvement Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security Homelab
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security Homelab
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview/Landing Page
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-exec-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Executive Summary/Posture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platform and Virtualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Security and Remote Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-iam-secrets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Identity, Access and Secrets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-auto-iac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automation and IaC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Applications and Services
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Applications and Services
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platform-and-service-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Platform and Service Dashboard
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dns-infrastructure-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Infrastructure Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS Infrastructure Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind9-namedconfoptions-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bind9 named.conf.options configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-dns-query-flows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed DNS Query Flows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed DNS Query Flows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns-query-flow-external-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Query Flow - External Domains
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-query-flow-internal-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Query Flow - Internal Domains
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-dns-query-flow-ptr-lookup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse DNS Query Flow (PTR Lookup)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-security-gate-flow-dns-rebinding" class="md-nav__link">
    <span class="md-ellipsis">
      
        The "Security Gate" Flow (DNS Rebinding)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Security Controls
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS Security Controls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnssec-validation-unbound" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSSEC Validation (Unbound)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-logging-privacy-pi-hole-bind9" class="md-nav__link">
    <span class="md-ellipsis">
      
        Query Logging &amp; Privacy (Pi-hole &amp; BIND9)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting-memory-protection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rate Limiting &amp; Memory Protection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-rebinding-protection-the-bind9-guard" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Rebinding Protection (The "BIND9 Guard")
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-based-ad-blocking-threat-intelligence" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS-Based Ad Blocking &amp; Threat Intelligence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnssec-hardening-unbound" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSSEC Hardening (Unbound)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-observability" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring &amp; Observability
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secure-shell-ssh-access" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secure Shell (SSH) Access
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Secure Shell (SSH) Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-security-configuration-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSH Security Configuration Summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supporting Infrastructure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-management-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Management Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vs-code-remote-ssh-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        VS Code Remote SSH Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-and-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Audit and Logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-proxy-and-ingress-controllers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse Proxy and Ingress Controllers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse Proxy and Ingress Controllers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-overview_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefik-reverse-proxy-for-docker-lxc-and-vm-hosted-applications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traefik Reverse Proxy for Docker, LXC and VM Hosted Applications
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traefik Reverse Proxy for Docker, LXC and VM Hosted Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-middlewares" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTP Middlewares
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-routing-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Service Routing Table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-and-routing-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS and Routing Behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-termination-and-backend-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        TLS Termination and Backend Security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Controls
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metallb-and-nginx-ingress-controller-for-k3s-kubernetes-based-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetalLB and NGINX Ingress Controller for K3s Kubernetes-Based Services
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetalLB and NGINX Ingress Controller for K3s Kubernetes-Based Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metallb" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetalLB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-ingress-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        NGINX Ingress Controller
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerability-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#greenbone-openvas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Greenbone OpenVAS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Greenbone OpenVAS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-controls_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Controls
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tenable-nessus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tenable Nessus
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tenable Nessus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Remediation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-patch-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Software Patch Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Patch Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-software-management-patchmon" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Software Management - PatchMon
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux Software Management - PatchMon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-overview-pre-patching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initial Overview - Pre-Patching
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-host-scan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initial Host Scan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-patching-scan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Post-Patching Scan
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-software-management-windows-server-update-services-wsus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Software Management - Windows Server Update Services (WSUS)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-container-software-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Container Software Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Container Software Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whats-up-docker-wud" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's Up Docker (WUD)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#watchtower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Watchtower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#malware-protection-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Malware Protection Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Malware Protection Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment-overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Overview
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-services-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Web Services Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Services Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment-overview_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Overview
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-integration-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Service Integration Architecture
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases-and-deployment-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use Cases and Deployment Scenarios
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use Cases and Deployment Scenarios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-1-zero-trust-web-access" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario 1: Zero-Trust Web Access
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-2-automated-vulnerability-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario 2: Automated Vulnerability Remediation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-3-dns-based-ad-blocking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario 3: DNS-Based Ad Blocking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-4-certificate-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario 4: Certificate Lifecycle Management
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-5-distributed-logging-and-incident-investigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scenario 5: Distributed Logging and Incident Investigation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-homelab-section-links" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Homelab Section Links
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-vis-response-pt1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability and Response, part 1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-vis-response-pt2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability and Response, part 2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_10" >
        
          
          <label class="md-nav__link" for="__nav_2_3_10" id="__nav_2_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    GRC Frameworks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    GRC Frameworks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GRC Overview/Landing Page
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/01-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GRC Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-nist-csf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NIST CSF
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-nist-800/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NIST SP 800-53
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-cis-controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CIS Controls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-iso27001/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ISO 27001
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/grc-mitre/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MITRE ATT&CK
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/owasp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OWASP 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grc/zero-trust.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CISA & NIST Zero Trust
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="applications-and-services">Applications and Services<a class="headerlink" href="#applications-and-services" title="Permanent link">&para;</a></h1>
<p><strong>Document Control:</strong> <br />
Version: 1.0<br />
Last Updated: January 30, 2026<br />
Owner: Paul Leone </p>
<hr />
<h2 id="architecture-overview">Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permanent link">&para;</a></h2>
<p>The lab deploys a comprehensive application stack spanning infrastructure management, security operations, monitoring, automation, and productivity services. This ecosystem provides hands-on experience with enterprise-grade platforms while demonstrating integration patterns, security controls, and operational excellence.</p>
<p><strong>Core Service Categories:</strong></p>
<ul>
<li>DNS Infrastructure: Multi-tier architecture with ad-blocking and DNSSEC validation</li>
<li>SSH Access: Secure and auditable remote access to all hosts</li>
<li>Reverse Proxy and Ingress Controller: Centralized ingress with TLS termination and SSO integration</li>
<li>Vulnerability Management: Continuous scanning with OpenVAS and Nessus</li>
<li>Patch Management: Comprehensive, multi-platform patch management solution with PatchMon (Linux), Windows Server Update Services, WUD (What's Up Docker) and Watchtower (Docker)</li>
<li>Malware Protection Management: ClamAV (Linux, FreeBSD, MacOS), Microsoft Defender (Windows)</li>
<li>Web Services: Apache2, NGINX and IIS web servers</li>
<li>Miscellaneous Services: Media Management and Streaming, PDF Management, File Sharing, and Dashboard Services</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>This service architecture mirrors production enterprise environments, providing practical experience with tools used in security operations centers, DevOps teams, and infrastructure engineering roles. The layered approach to DNS, reverse proxy, and vulnerability scanning demonstrates defense-in-depth principles and operational maturity beyond simple lab exercises.</p>
<p><strong>Strategic Value:</strong></p>
<ul>
<li>Unified Access: Heimdall dashboard provides single pane of glass for all services</li>
<li>Security First: Every service protected by SSO, TLS certificates, and network segmentation</li>
<li>Operational Visibility: Prometheus metrics, health checks, and centralized logging</li>
<li>Automation Ready: API-first architecture enables workflow integration</li>
<li>Enterprise Patterns: Reverse proxy, DNS hierarchy, and PKI mirror production designs</li>
</ul>
<hr />
<h2 id="platform-and-service-dashboard">Platform and Service Dashboard<a class="headerlink" href="#platform-and-service-dashboard" title="Permanent link">&para;</a></h2>
<div class="two-col-right">
  <div class="text-col">
    <p>
      The Heimdall dashboard serves as a centralized launchpad for accessing the WebUIs of all deployed platforms and services within the lab environment. This unified interface streamlines navigation across infrastructure components.
    </p>
    <p>
      Where supported, API integrations have been configured to surface real-time metrics and service health indicators directly within the dashboard tiles. This enables at-a-glance visibility into system status, resource utilization, and uptime without requiring manual logins or context switching. Examples include container stats, authentication flow summaries, and firewall throughput, depending on the service.
    </p>
  </div>

  <div class="image-col">
    <figure>
      <img src="/Career_Projects/assets/screenshots/heimdall.png" alt="Heimdall Dashboard Screenshot">
      <figcaption style="font-size:0.9rem; color:var(--md-secondary-text-color); margin-top:0.5rem;">
        Heimdall Dashboard Overview
      </figcaption>
    </figure>
  </div>
</div>

<hr />
<h2 id="dns-infrastructure-architecture">DNS Infrastructure Architecture<a class="headerlink" href="#dns-infrastructure-architecture" title="Permanent link">&para;</a></h2>
<h3 id="deployment-overview">Deployment Overview<a class="headerlink" href="#deployment-overview" title="Permanent link">&para;</a></h3>
<div class="two-col-right">
  <div class="text-col">
    <p>
      A layered DNS setup balances local authority, recursive privacy, and high-performance ad-blocking. Pi-hole (`192.168.1.250`) acts as the primary resolver for network clients, forwarding standard queries to Unbound (`.252`) with `1.1.1.1` as fallback, and sending all `home.com` queries to BIND9 (`.251`) for authoritative local resolution. BIND9 serves as the master of the `home.com` zone with security hardening via `recursion yes`, `forward only`, and `deny-answer-addresses` to prevent DNS loops. Unbound communicates directly with root servers for maximum privacy from third-party DNS logging. The network path is: Client → Pi-hole → BIND9 (Authoritative Answer) → Traefik (Step-CA HTTPS) → Backend VM
    </p>
  </div>

  <div class="image-col">
    <figure>
      <img src="/Career_Projects/assets/diagrams/dns-overview.png" alt="DNS Architecture Diagram">
      <figcaption style="font-size:0.9rem; color:var(--md-secondary-text-color); margin-top:0.5rem;">
        Three-Tier DNS Architecture
      </figcaption>
    </figure>
  </div>
</div>

<p><strong>Security Impact</strong></p>
<ul>
<li>Malware C2 communication blocked at the DNS layer before outbound connections can be established</li>
<li>DNSSEC validation prevents DNS spoofing and poisoning attacks</li>
<li>Privacy-preserving recursive resolution eliminates third-party visibility into DNS queries</li>
<li>Conditional forwarding isolates the internal namespace from external resolvers</li>
<li>DNS query logging enables threat hunting, anomaly detection, and forensic analysis</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>DNS is a foundational service that impacts every network connection. Compromise or disruption of DNS services can paralyze entire networks. Enterprise environments deploy layered DNS architectures for resilience, security, and performance. This implementation demonstrates understanding of DNS security best practices including split-horizon DNS (internal vs. external), DNSSEC validation, DNS-based threat blocking, and high-availability design patterns.</p>
<p><strong>Architecture Principles Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Three-tier architecture ensures single component compromise doesn't expose entire DNS infrastructure; ad-blocking, DNSSEC validation, and authoritative services provide overlapping security controls</li>
<li><strong>Secure by Design:</strong> DNSSEC validation enabled by default; DNS rebinding protection prevents internal IP exposure; rate limiting blocks DNS amplification attacks</li>
<li><strong>Zero Trust:</strong> Every DNS query validated and logged; no implicit trust of external resolvers; conditional forwarding segregates internal namespace</li>
</ul>
<p><strong>Three-Tier DNS Architecture:</strong></p>
<table>
<thead>
<tr>
<th>Tier</th>
<th>Component</th>
<th>IP Address</th>
<th>Primary Function</th>
<th>Secondary Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>Edge/Filtering</td>
<td>Pi-hole Primary</td>
<td>192.168.1.250</td>
<td>Primary Resolver for all network clients; Forwards standard queries to Unbound (<code>.252</code>); Upstreams to <code>1.1.1.1</code> as fallback</td>
<td>Conditional Forwarding: Sends all <code>home.com</code> queries to BIND9 (<code>.251</code>) for authoritative resolution</td>
</tr>
<tr>
<td>Edge/Filtering</td>
<td>Pi-hole Backup</td>
<td>192.168.1.126</td>
<td>High-availability failover</td>
<td>Synchronized blocklists and configuration</td>
</tr>
<tr>
<td>Recursive Resolution</td>
<td>Unbound</td>
<td>192.168.1.252</td>
<td>Recursive Resolver: Communicates directly with root servers for external domains, providing maximum privacy from third-party DNS logging</td>
<td>Access Control: Configured to trust and respond to queries from specific local subnets. Privacy-preserving external resolution</td>
</tr>
<tr>
<td>Authoritative</td>
<td>Bind9</td>
<td>192.168.1.251</td>
<td>Authoritative Source for the <code>home.com</code> zone with exact IP mappings for entire homelab</td>
<td>Security Hardening: Fixed with <code>recursion yes</code>, <code>forward only</code>, and <code>deny-answer-addresses</code> to prevent DNS loops and ensure local queries never leak to public internet</td>
</tr>
</tbody>
</table>
<p><strong>Design Rationale:</strong></p>
<p><strong>Why Separate Components?</strong></p>
<ul>
<li><strong>Performance Isolation:</strong> Blocking logic (Pi-hole) separated from recursive resolution (Unbound) prevents query processing bottlenecks</li>
<li><strong>Independent Scaling:</strong> Each tier can be scaled independently based on load</li>
<li><strong>Fault Isolation:</strong> Unbound failure doesn't impact internal domain resolution via Bind9</li>
<li><strong>Security Segmentation:</strong> Authoritative server (Bind9) not directly exposed to internet queries</li>
<li><strong>Audit Trail Granularity:</strong> Each tier logs independently, enabling precise troubleshooting</li>
</ul>
<p><strong>High Availability Configuration:</strong></p>
<p><strong>Client Configuration:</strong></p>
<ul>
<li>Primary DNS: 192.168.1.250 (Pi-hole Primary)</li>
<li>Secondary DNS: 192.168.1.126 (Pi-hole Backup)</li>
<li>Failover: Automatic via client DNS resolver (5-second timeout)</li>
</ul>
<p><strong>Synchronization Strategy:</strong></p>
<ul>
<li>Nebula-Sync: Replicates Pi-hole settings and blocklists every 15 minutes</li>
<li>Custom DNS Records: Manually synchronized via Ansible playbook</li>
<li>Blocklist Updates: Both instances independently update from upstream sources</li>
</ul>
<h3 id="bind9-namedconfoptions-configuration">Bind9 <code>named.conf.options</code> configuration<a class="headerlink" href="#bind9-namedconfoptions-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>acl &quot;internal_networks&quot; {
    127.0.0.1;
    192.168.1.0/24;
    192.168.2.0/24;
    192.168.3.0/24;
    192.168.100.0/24;
    192.168.200.0/24;
};

options {
    directory &quot;/var/cache/bind&quot;;

    recursion yes;
    allow-query { &quot;internal_networks&quot;; };
    allow-recursion { &quot;internal_networks&quot;; };

    listen-on { any; };

    forwarders {
        192.168.1.252 port 5335;
    };
    forward only;

    // Stop local reverse lookups (PTR) for private IPs from leaking to Unbound
    empty-zones-enable yes;

    // DNS Rebinding protection: Prevents external domains from resolving
    // to internal IP addresses.
    deny-answer-addresses { 192.168.0.0/16; };

    dnssec-validation auto;

    version &quot;none&quot;;
};
</code></pre></div>
<h3 id="detailed-dns-query-flows">Detailed DNS Query Flows<a class="headerlink" href="#detailed-dns-query-flows" title="Permanent link">&para;</a></h3>
<h4 id="dns-query-flow-external-domains">DNS Query Flow - External Domains<a class="headerlink" href="#dns-query-flow-external-domains" title="Permanent link">&para;</a></h4>
<p><strong>Client Request Flow:</strong></p>
<ol>
<li>Client (192.168.1.31) → Pi-hole (192.168.1.250:53)</li>
<li>Pi-hole checks:</li>
<li><strong>Blocklist:</strong> Is domain in ad/tracker blocklist?<ul>
<li>If YES: Return 0.0.0.0 or NXDOMAIN (blocked)</li>
<li>If NO: Continue</li>
</ul>
</li>
<li><strong>Local Cache:</strong> Is answer cached?<ul>
<li>If YES: Return cached answer (TTL-aware)</li>
<li>If NO: Continue</li>
</ul>
</li>
<li><strong>Local DNS Records:</strong> Manual override configured?<ul>
<li>If YES: Return configured IP</li>
<li>If NO: Continue</li>
</ul>
</li>
<li>Pi-hole forwards to Unbound (192.168.1.252:5335)</li>
<li>Unbound performs recursive resolution:</li>
<li>Check Unbound cache (separate from Pi-hole cache)</li>
<li>If not cached, query root servers (.) for TLD nameservers</li>
<li>Query TLD nameservers for authoritative nameservers</li>
<li>Query authoritative nameservers for final answer</li>
<li>Validate DNSSEC signatures (if enabled for domain)</li>
<li>Cache result (default TTL: as specified by authoritative server)</li>
<li>Unbound returns answer to Pi-hole</li>
<li>Pi-hole caches answer and returns to client</li>
</ol>
<p><strong>Example Query for www.example.com:</strong></p>
<p>Client → Pi-hole → Unbound → Root (.) → .com TLD → example.com NS → IP</p>
<p><strong>Query Time:</strong> ~50ms (first query), ~1ms (cached)</p>
<h4 id="dns-query-flow-internal-domains">DNS Query Flow - Internal Domains<a class="headerlink" href="#dns-query-flow-internal-domains" title="Permanent link">&para;</a></h4>
<p><strong>Client Request Flow for *.home.com:</strong></p>
<ol>
<li>Client (192.168.1.31) → Pi-hole (192.168.1.250:53)</li>
<li>Pi-hole Rule Matching:</li>
<li>Pi-hole identifies home.com as a Conditional Forwarding target</li>
<li>Target: 192.168.1.251 (BIND9)</li>
<li>Pi-hole → BIND9:</li>
<li>Pi-hole sends a recursive query to BIND9</li>
<li>BIND9 Processing:</li>
<li><strong>Authority Check:</strong> BIND9 confirms it is the Master for home.com</li>
<li><strong>Record Lookup:</strong> Pulls the IP from db.home.com (e.g., uptimek → 192.168.1.247)</li>
<li><strong>Security Check:</strong> BIND9 verifies the requesting IP (Pi-hole) is in its allow-query ACL</li>
<li>BIND9 → Pi-hole → Client:</li>
<li><strong>Loop Prevention:</strong> BIND9 returns the answer directly. Because BIND9's forwarder is set to Unbound (not Pi-hole), no DNS loop occurs</li>
</ol>
<h4 id="reverse-dns-query-flow-ptr-lookup">Reverse DNS Query Flow (PTR Lookup)<a class="headerlink" href="#reverse-dns-query-flow-ptr-lookup" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Client/Service Queries:</strong> e.g., "Who is 192.168.100.51?" (51.100.168.192.in-addr.arpa)</li>
<li><strong>Pi-hole Forwarding:</strong></li>
<li>Pi-hole sees the query for the 100.168.192 range</li>
<li>Conditional forwarding sends this to BIND9 (.251)</li>
<li><strong>BIND9 Zone Selection:</strong></li>
<li>BIND9 matches the query to zone "100.168.192.in-addr.arpa" in named.conf.local</li>
<li>It consults the specific reverse zone file: db.192.168.100</li>
<li><strong>Result:</strong> BIND9 returns stepca.home.com</li>
<li><strong>Outcome:</strong> Pi-hole and Traefik logs now display stepca.home.com instead of the raw IP address</li>
</ol>
<h4 id="the-security-gate-flow-dns-rebinding">The "Security Gate" Flow (DNS Rebinding)<a class="headerlink" href="#the-security-gate-flow-dns-rebinding" title="Permanent link">&para;</a></h4>
<ol>
<li>Client requests malicious-site.com</li>
<li>Pi-hole (not on blocklist) → Unbound → Public Internet</li>
<li><strong>Upstream Response:</strong> The malicious DNS returns 192.168.1.254 (your pfSense IP)</li>
<li><strong>BIND9 Inspection:</strong></li>
<li>The answer passes through BIND9 (if BIND9 is the primary upstream) or is evaluated via the deny-answer-addresses rule</li>
<li><strong>Action:</strong> BIND9 sees a private IP address in a public response and drops the answer</li>
<li><strong>Result:</strong> The client receives no answer, preventing the malicious website from "talking" to your firewall</li>
</ol>
<p><strong>Conditional Forwarding Rules:</strong></p>
<table>
<thead>
<tr>
<th>Domain Pattern</th>
<th>Target Server</th>
<th>Purpose</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>home.com</td>
<td>192.168.1.251:53</td>
<td>Internal zone authority</td>
<td>All lab services (*.home.com)</td>
</tr>
<tr>
<td>1.168.192.in-addr.arpa</td>
<td>192.168.1.251:53</td>
<td>Reverse DNS (192.168.1.0/24)</td>
<td>Production network PTR records</td>
</tr>
<tr>
<td>2.168.192.in-addr.arpa</td>
<td>192.168.1.251:53</td>
<td>Reverse DNS (192.168.2.0/24)</td>
<td>DMZ services PTR records</td>
</tr>
<tr>
<td>100.168.192.in-addr.arpa</td>
<td>192.168.1.251:53</td>
<td>Reverse DNS (192.168.100.0/24)</td>
<td>Lab infrastructure PTR records</td>
</tr>
<tr>
<td>200.168.192.in-addr.arpa</td>
<td>192.168.1.251:53</td>
<td>Reverse DNS (192.168.200.0/24)</td>
<td>Kubernetes cluster PTR records</td>
</tr>
</tbody>
</table>
<p><strong>Upstream DNS:</strong></p>
<ul>
<li>Primary: 192.168.1.252:5335 (Unbound)</li>
<li>Secondary: 1.1.1.1 (Cloudflare, fallback only)</li>
</ul>
<h3 id="dns-security-controls">DNS Security Controls<a class="headerlink" href="#dns-security-controls" title="Permanent link">&para;</a></h3>
<h4 id="dnssec-validation-unbound">DNSSEC Validation (Unbound)<a class="headerlink" href="#dnssec-validation-unbound" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose:</strong> Cryptographically verify DNS responses haven't been tampered with in transit</li>
<li><strong>Implementation:</strong> Unbound (.252) performs full DNSSEC validation. Pi-hole (.250) and BIND9 (.251) are configured to trust Unbound's validation status (via the ad flag)</li>
<li><strong>Validation Behavior:</strong></li>
<li>Valid signature: Cache and return answer with AUTHENTICATED DATA status</li>
<li>Invalid signature: Return SERVFAIL (blocks potentially poisoned records)</li>
<li>No DNSSEC support: Process query normally (unsigned but not rejected)</li>
<li><strong>Security Impact:</strong> Prevents DNS cache poisoning and "Man-in-the-Middle" attacks for external lookups</li>
</ul>
<h4 id="query-logging-privacy-pi-hole-bind9">Query Logging &amp; Privacy (Pi-hole &amp; BIND9)<a class="headerlink" href="#query-logging-privacy-pi-hole-bind9" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Retention:</strong> 24 hours in Pi-hole's FTL database for real-time visibility</li>
<li><strong>Implementation:</strong> Pi-hole logs the "Front-Door" request from the client; BIND9 logs are restricted to internal zone transfers and errors to minimize disk I/O</li>
</ul>
<h4 id="rate-limiting-memory-protection">Rate Limiting &amp; Memory Protection<a class="headerlink" href="#rate-limiting-memory-protection" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Threshold:</strong> 1000 queries/minute per client IP (Pi-hole default)</li>
<li><strong>Memory Safeguard:</strong> Shared Memory (/dev/shm) expanded to 256MB to prevent FTL engine crashes and database locks during high-volume bursts</li>
<li><strong>Action:</strong> Temporary block (60-second cooldown)</li>
<li><strong>Purpose:</strong> Prevents DNS amplification attacks and detects DNS tunneling attempts by internal malware</li>
</ul>
<h4 id="dns-rebinding-protection-the-bind9-guard">DNS Rebinding Protection (The "BIND9 Guard")<a class="headerlink" href="#dns-rebinding-protection-the-bind9-guard" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Rule:</strong> deny-answer-addresses enabled in BIND9 for the 192.168.0.0/16 range</li>
<li><strong>Implementation:</strong> If an external forwarder (like Cloudflare or Unbound) returns a private IP for a public domain (e.g., attacker.com → 192.168.1.1), BIND9 explicitly drops the answer</li>
<li><strong>Security Impact:</strong> Prevents "Browser-as-a-Proxy" attacks where a malicious website tries to interact with your pfSense, Step-CA, or Traefik management interfaces</li>
</ul>
<h4 id="dns-based-ad-blocking-threat-intelligence">DNS-Based Ad Blocking &amp; Threat Intelligence<a class="headerlink" href="#dns-based-ad-blocking-threat-intelligence" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Blocklists:</strong> 2M+ domains from curated feeds (StevenBlack, OISD, Firebog) via Pi-hole</li>
<li><strong>Local Overrides:</strong> Authoritative home.com records in BIND9 take precedence over any external blocklists</li>
<li><strong>Action:</strong> Blocked domains return 0.0.0.0 (null routing), causing connections to fail instantly without generating outbound traffic</li>
<li><strong>Update Frequency:</strong> Daily at 3 AM (Gravity update); BIND9 records are static and updated manually via db.home.com</li>
</ul>
<h4 id="dnssec-hardening-unbound">DNSSEC Hardening (Unbound)<a class="headerlink" href="#dnssec-hardening-unbound" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Configuration:</strong></li>
<li>harden-dnssec-stripped: yes (reject responses with DNSSEC signatures removed)</li>
<li>val-clean-additional: yes (validate additional section of DNS responses)</li>
<li>val-permissive-mode: no (strict validation, fail on invalid signatures)</li>
<li><strong>Security Impact:</strong> Prevents sophisticated attacks where attackers strip DNSSEC signatures to bypass validation</li>
</ul>
<h3 id="monitoring-observability">Monitoring &amp; Observability<a class="headerlink" href="#monitoring-observability" title="Permanent link">&para;</a></h3>
<p><strong>Pi-hole Dashboard:</strong></p>
<ul>
<li><strong>Real-Time Metrics:</strong></li>
<li>Queries per second (current load)</li>
<li>Percentage blocked (ad-blocking effectiveness)</li>
<li>Top queried domains (most frequently accessed)</li>
<li>Top blocked domains (what's being filtered)</li>
<li>Client activity breakdown (which devices query most)</li>
<li><strong>Access:</strong> https://pihole.home.com/admin/ (protected by Authentik SSO)</li>
</ul>
<p><strong>Prometheus Metrics Exporter:</strong></p>
<ul>
<li><strong>Metrics Exposed:</strong></li>
<li>pihole_queries_total (cumulative query count)</li>
<li>pihole_blocked_queries_total (cumulative blocks)</li>
<li>pihole_query_types (A vs AAAA vs PTR distribution)</li>
<li>pihole_cache_size (DNS cache entries)</li>
<li>pihole_upstream_queries (queries forwarded to Unbound)</li>
<li><strong>Scrape Interval:</strong> 15 seconds (Prometheus)</li>
<li><strong>Grafana Dashboard:</strong> DNS query trends, block rates, cache hit ratios</li>
</ul>
<p><strong>Uptime Kuma Health Checks:</strong></p>
<ul>
<li><strong>HTTP Check:</strong> https://pihole.home.com/admin/ (every 60 seconds)</li>
<li><strong>DNS Check:</strong> Resolve test.home.com via 192.168.1.250 (every 30 seconds)</li>
<li><strong>Alert Trigger:</strong> 3 consecutive failures → Discord webhook</li>
</ul>
<p><strong>Discord Alerts:</strong></p>
<ul>
<li><strong>Service Failure:</strong> Pi-hole container down (Uptime Kuma)</li>
<li><strong>High Query Rate:</strong> &gt;10,000 queries/minute (potential DNS tunneling or amplification)</li>
<li><strong>Upstream DNS Failure:</strong> Unbound unreachable (Pi-hole fallback to Cloudflare 1.1.1.1)</li>
<li><strong>Sync Failure:</strong> Nebula-Sync unable to replicate to backup</li>
</ul>
<hr />
<h2 id="secure-shell-ssh-access">Secure Shell (SSH) Access<a class="headerlink" href="#secure-shell-ssh-access" title="Permanent link">&para;</a></h2>
<h3 id="architecture-overview_1">Architecture Overview<a class="headerlink" href="#architecture-overview_1" title="Permanent link">&para;</a></h3>
<p>Enterprise-grade SSH infrastructure provides secure, auditable remote access to 40+ hosts across the lab environment. This implementation emphasizes modern cryptography (Ed25519), certificate-based authentication, centralized key management, and comprehensive session logging—demonstrating zero-trust principles where every connection is authenticated, authorized, and audited.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>Password-based SSH attacks eliminated through key-only authentication</li>
<li>Root account compromise prevented by disabling direct root login</li>
<li>Centralized key management enables instant credential revocation across all hosts</li>
<li>Session logging provides forensic evidence for incident investigations</li>
<li>Modern Ed25519 cryptography offers strong resistance to brute-force and emerging quantum-computing attacks</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>SSH is the primary administrative access method for Linux infrastructure in enterprise environments. Weak SSH configurations are frequently exploited by attackers (botnets scan for weak passwords, default credentials, outdated crypto). This hardened SSH deployment demonstrates understanding of cryptographic best practices, privilege escalation controls, and audit logging requirements mandated by compliance frameworks (PCI-DSS 8.2, NIST SP 800-53 AC-17).</p>
<p><strong>Architecture Principles Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Multi-layer access controls (firewall IP restrictions, key-based authentication, privilege escalation via sudo, session logging)</li>
<li><strong>Secure by Design:</strong> Modern cryptography enforced by default; weak algorithms disabled; root login prohibited globally</li>
<li><strong>Zero Trust:</strong> Every session authenticated via cryptographic keys; source IP validation; session activity logged for audit</li>
</ul>
<h3 id="ssh-security-configuration-summary">SSH Security Configuration Summary<a class="headerlink" href="#ssh-security-configuration-summary" title="Permanent link">&para;</a></h3>
<p><strong>Key Regeneration with ssh-ed25519:</strong></p>
<ul>
<li>All previous keys were reissued using the Ed25519 algorithm for stronger cryptographic integrity and faster performance</li>
<li>Keys are distributed manually or via internal automation (StepCA, Ansible playbook)</li>
<li>Host and user keys are centrally managed</li>
</ul>
<p><strong>Root Login Disabled:</strong></p>
<ul>
<li>PermitRootLogin no ensures that root access is never exposed over SSH</li>
<li>Privilege escalation is managed locally via sudo, with logging enabled for audit purposes</li>
</ul>
<p><strong>Access Control and Audit:</strong></p>
<ul>
<li>SSH access is restricted to specific users/groups</li>
<li>Logging is centralized via Splunk for session tracking and anomaly detection</li>
</ul>
<p><strong>Host Hardening:</strong></p>
<ul>
<li>Firewall rules (via pfSense) restrict SSH to known IP ranges</li>
</ul>
<h3 id="supporting-infrastructure">Supporting Infrastructure<a class="headerlink" href="#supporting-infrastructure" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>StepCA Integration:</strong> SSH certificates can be issued via StepCA to streamline access provisioning and revocation</li>
<li><strong>Firewall Rules (pfSense):</strong> SSH access is restricted to trusted IP ranges and zones</li>
<li><strong>Host Hardening:</strong> SSHD is configured with minimal exposure, and unused authentication methods are disabled</li>
<li><strong>DNS Resolution:</strong> SSH targets resolved via Pi-hole → Unbound → Bind9 chain</li>
</ul>
<p><strong>Example SSH Config:</strong>
<div class="highlight"><pre><span></span><code>Host stepca
  HostName stepca.home.com
  User admin
  IdentityFile ~/.ssh/id_ed25519
</code></pre></div></p>
<p><strong>Configuration Rationale:</strong></p>
<p><strong>Why Disable Root Login?</strong></p>
<ul>
<li>Audit Trail: Forces administrators to log in as themselves, then sudo to root (logs show "who did what")</li>
<li>Accountability: Can't claim "root did it" when each admin has unique account</li>
<li>Least Privilege: Administrators only elevate to root when necessary</li>
</ul>
<p><strong>Why Disable Password Authentication?</strong></p>
<ul>
<li>Eliminates Brute-Force: Attackers can't guess passwords if passwords aren't accepted</li>
<li>Eliminates Credential Stuffing: Leaked password databases useless without private key</li>
<li>Forces MFA-Equivalent: Private key (something you have) + optional passphrase (something you know)</li>
</ul>
<p><strong>Why Limit Ciphers/MACs/KexAlgorithms?</strong></p>
<ul>
<li>Removes Weak Crypto: Old algorithms (3DES, RC4, MD5, SHA-1) exploitable</li>
<li>Prevents Downgrade Attacks: Attacker can't force connection to use weak cipher</li>
<li>Compliance: PCI-DSS, NIST SP 800-131A prohibit weak cryptography</li>
</ul>
<h3 id="key-management-strategy">Key Management Strategy<a class="headerlink" href="#key-management-strategy" title="Permanent link">&para;</a></h3>
<p><strong>Ed25519 Key Advantages:</strong></p>
<ul>
<li>Key Size: 256-bit (equivalent to RSA 3072-bit security)</li>
<li>Performance: 5x faster signature generation than RSA</li>
<li>Security: Resistant to timing attacks</li>
<li>Size: Smaller keys (68 bytes public, 32 bytes private)</li>
</ul>
<p><strong>Key Distribution:</strong></p>
<ol>
<li>Administrator generates key pair: <code>ssh-keygen -t ed25519 -C "admin@lab"</code></li>
<li>Public key stored in Vaultwarden</li>
<li>Ansible playbook deploys to authorized_keys on target hosts</li>
<li>Private key stored encrypted on admin workstation</li>
</ol>
<h3 id="vs-code-remote-ssh-integration">VS Code Remote SSH Integration<a class="headerlink" href="#vs-code-remote-ssh-integration" title="Permanent link">&para;</a></h3>
<div class="two-col-right">
  <div class="text-col">
    <p><strong>Configuration:</strong></p>
    <ul>
      <li>Remote - SSH extension connects to lab hosts using SSH config</li>
      <li>Workspace: Shared folder on remote host</li>
      <li>Extensions: Installed remotely for Docker, Kubernetes, YAML</li>
      <li>Terminal: Integrated terminal provides direct shell access</li>
      <li>Port Forwarding: Automatic forwarding of service ports to local browser</li>
    </ul>
  </div>

  <div class="image-col">

  </div>
</div>

<h3 id="audit-and-logging">Audit and Logging<a class="headerlink" href="#audit-and-logging" title="Permanent link">&para;</a></h3>
<p><strong>Session Logging:</strong></p>
<ul>
<li><strong>Syslog:</strong> All SSH sessions logged to /var/log/auth.log</li>
<li><strong>Wazuh Integration:</strong> Threat hunting module captures all Auth events</li>
<li><strong>Elastic Integration:</strong> Auth logs forwarded via syslog-ng</li>
<li><strong>Alerts:</strong> Discord notification on root login attempts (should never happen)</li>
</ul>
<p><strong>Logged Events:</strong></p>
<ul>
<li>Connection attempts (successful and failed)</li>
<li>Authentication method used</li>
<li>Source IP address</li>
<li>Session duration</li>
<li>Commands executed (if using sudo)</li>
<li>File transfers (scp, sftp)</li>
</ul>
<p><strong>Compliance Dashboard (Elastic):</strong></p>
<ul>
<li>Failed Login Attempts: Graph by host and source IP</li>
<li>Successful Logins: Table with user, host, timestamp</li>
<li>Root Login Attempts: Alert (should be zero)</li>
<li>Key-based vs Password Auth: Pie chart (should be 100% key-based)</li>
</ul>
<p><strong>Alerting:</strong></p>
<p>Multiple failed SSH login attempts in Wazuh will trigger an alert notification to Discord and email. Active Response module will block the remote IP address on all configured hosts.</p>
<hr />
<h2 id="reverse-proxy-and-ingress-controllers">Reverse Proxy and Ingress Controllers<a class="headerlink" href="#reverse-proxy-and-ingress-controllers" title="Permanent link">&para;</a></h2>
<h3 id="architecture-overview_2">Architecture Overview<a class="headerlink" href="#architecture-overview_2" title="Permanent link">&para;</a></h3>
<p>To enable secure, centralized access to internal services and simplify URL structures across the lab, reverse proxies were deployed in front of several web-facing applications. This eliminates the need to remember non-standard ports or paths, allowing services to be accessed via top-level FQDNs.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>TLS termination enforced at the edge, eliminating unencrypted HTTP exposure</li>
<li>Centralized authentication via Authentik ForwardAuth provides SSO for all services</li>
<li>Credential exposure eliminated by removing per-service password management</li>
<li>Rate limiting blocks brute-force and credential-stuffing attempts</li>
<li>IP allowlisting restricts access to trusted networks and administrative ranges</li>
<li>Uniform security headers (HSTS, CSP, X-Frame-Options) harden all web applications against common attacks</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>Exposing multiple web services on different ports creates management complexity and security inconsistencies. Reverse proxies consolidate security controls at a single ingress point, mirroring enterprise edge architecture (NGINX, HAProxy, F5 BIG-IP). This demonstrates understanding of defense-in-depth where authentication happens at the network edge before requests reach backend applications.</p>
<p><strong>Architecture Principles Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Traefik enforces authentication before routing; WAF rules filter malicious requests; backend services isolated from direct internet exposure</li>
<li><strong>Secure by Design:</strong> TLS 1.3 mandatory; weak ciphers disabled; automated certificate renewal via Step-CA; secure headers applied by default</li>
<li><strong>Zero Trust:</strong> Every request authenticated via Authentik tokens; no implicit trust based on source IP; request metadata logged to SIEM</li>
</ul>
<h3 id="traefik-reverse-proxy-for-docker-lxc-and-vm-hosted-applications">Traefik Reverse Proxy for Docker, LXC and VM Hosted Applications<a class="headerlink" href="#traefik-reverse-proxy-for-docker-lxc-and-vm-hosted-applications" title="Permanent link">&para;</a></h3>
<p><strong>Architecture Overview:</strong></p>
<p>Traefik acts as the edge router for all HTTP/HTTPS services in the lab, providing dynamic service discovery, automatic TLS certificate management, centralized authentication, load balancing, health checks, and observability. </p>
<p>Traefik Container:
- DNS Resolution: Hard-coded to Pi-hole (<code>.250</code>) and BIND9 (<code>.251</code>) to prevent internal Docker DNS timeouts
- Certificate Handling: Configured with the <code>stepca</code> resolver, using Smallstep ACME protocol to automatically issue certificates to services
- Prometheus Metrics: Enabled with specialized labels to allow Grafana to scrape per-service traffic data</p>
<p>Step-CA:
- Provisioner: Updated with an X.509 template that correctly handles IP SANs and uses <code>.Insecure.CR</code> variables for ACME compatibility
- Validity: Hard-coded to 30-day (720h) durations to override default short-lived ACME certificates</p>
<p><strong>Deployment Architecture:</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Technology</th>
<th>Location</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Traefik Proxy</td>
<td>Docker container</td>
<td>192.168.1.247</td>
<td>Edge router</td>
</tr>
<tr>
<td>Configuration</td>
<td>YAML + Docker labels</td>
<td>/etc/traefik/</td>
<td>Static + dynamic config</td>
</tr>
<tr>
<td>TLS Certificates</td>
<td>Step-CA</td>
<td>/certs/</td>
<td>Automatic cert management</td>
</tr>
<tr>
<td>Authentik Outpost</td>
<td>Docker container</td>
<td>192.168.1.247</td>
<td>SSO forward auth</td>
</tr>
<tr>
<td>Dashboard</td>
<td>Built-in and Elastic</td>
<td>trfk.home.com:8080</td>
<td>Monitoring UI</td>
</tr>
</tbody>
</table>
<p><strong>Entrypoints:</strong></p>
<ul>
<li>HTTP :80 -- for initial requests and redirection</li>
<li>HTTPS :443 -- for secure traffic termination</li>
<li>Traefik :8080 -- internal dashboard and metrics</li>
</ul>
<p><strong>Providers:</strong></p>
<ul>
<li><strong>Docker</strong> -- for dynamic service discovery</li>
<li><strong>File (YAML)</strong> -- for static routing and middleware definitions</li>
</ul>
<p><strong>Features:</strong></p>
<ul>
<li><strong>Prometheus metrics</strong> -- exposed for Grafana integration</li>
</ul>
<h4 id="http-middlewares">HTTP Middlewares<a class="headerlink" href="#http-middlewares" title="Permanent link">&para;</a></h4>
<p>Traefik middlewares enforce security, access control, and routing behavior:</p>
<ul>
<li><strong>Forward Authorization via Authentik:</strong> Authentik acts as an identity provider, enforcing SSO and injecting identity headers (X-Forwarded-User, X-Forwarded-Groups) for downstream services</li>
<li><strong>IP Allow List:</strong> Restricts access to trusted networks (192.168.0.0/16, localhost). Applied to sensitive services (TheHive, Grafana, Traefik dashboard)</li>
<li><strong>Secure Headers:</strong></li>
<li>Strict-Transport-Security: max-age=31536000; includeSubDomains (HSTS)</li>
<li>X-Frame-Options: SAMEORIGIN (clickjacking prevention)</li>
<li>X-Content-Type-Options: nosniff (MIME type sniffing prevention)</li>
<li>Referrer-Policy: strict-origin-when-cross-origin (privacy)</li>
<li>Content-Security-Policy: default-src 'self' (XSS mitigation)</li>
<li><strong>Redirect Web to WebSecure:</strong> Automatically upgrades HTTP requests to HTTPS for all defined routes</li>
<li><strong>Rate Limiting:</strong> Limits requests to 100/minute per IP address (prevents brute-force attacks)</li>
<li><strong>Circuit Breaker:</strong> Automatically disables routing to unhealthy backends (monitors response codes, latency)</li>
</ul>
<h4 id="service-routing-table">Service Routing Table<a class="headerlink" href="#service-routing-table" title="Permanent link">&para;</a></h4>
<p>All routers are configured with TLS and mapped to internal services via hostname:</p>
<table>
<thead>
<tr>
<th>Hostname</th>
<th>Backend Service</th>
<th>Port</th>
<th>Protocol</th>
<th>Auth</th>
<th>Health Check</th>
</tr>
</thead>
<tbody>
<tr>
<td>checkmk.home.com</td>
<td>CheckMK container</td>
<td>5000</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/check_mk/</td>
</tr>
<tr>
<td>dashbd.home.com</td>
<td>Heimdall container</td>
<td>80</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/</td>
</tr>
<tr>
<td>elastic.home.com</td>
<td>Elasticsearch</td>
<td>9200</td>
<td>HTTP</td>
<td>Basic</td>
<td>/_cluster/health</td>
</tr>
<tr>
<td>n8n.home.com</td>
<td>n8n workflow engine</td>
<td>5678</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/healthz</td>
</tr>
<tr>
<td>pulse.home.com</td>
<td>Uptime Kuma</td>
<td>3001</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/</td>
</tr>
<tr>
<td>authentik.home.com</td>
<td>Authentik server</td>
<td>9000</td>
<td>HTTP</td>
<td>None</td>
<td>/-/health/live/</td>
</tr>
<tr>
<td>trfk.home.com</td>
<td>Traefik dashboard</td>
<td>8080</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/ping</td>
</tr>
<tr>
<td>grafana.home.com</td>
<td>Grafana dashboards</td>
<td>3000</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/api/health</td>
</tr>
<tr>
<td>pihole.home.com</td>
<td>Pi-hole primary</td>
<td>80</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/admin/</td>
</tr>
<tr>
<td>piholebk.home.com</td>
<td>Pi-hole backup</td>
<td>80</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/admin/</td>
</tr>
<tr>
<td>plex.home.com</td>
<td>Plex media server</td>
<td>32400</td>
<td>HTTPS</td>
<td>Plex SSO</td>
<td>/identity</td>
</tr>
<tr>
<td>portainer.home.com</td>
<td>Portainer CE</td>
<td>9443</td>
<td>HTTPS</td>
<td>Authentik</td>
<td>/api/status</td>
</tr>
<tr>
<td>splunk.home.com</td>
<td>Splunk Enterprise</td>
<td>8000</td>
<td>HTTP</td>
<td>Splunk</td>
<td>/services/server/info</td>
</tr>
<tr>
<td>vault.home.com</td>
<td>Vaultwarden</td>
<td>80</td>
<td>HTTP</td>
<td>Vault</td>
<td>/alive</td>
</tr>
<tr>
<td>vas.home.com</td>
<td>OpenVAS scanner</td>
<td>9392</td>
<td>HTTPS</td>
<td>Basic</td>
<td>/login</td>
</tr>
<tr>
<td>wud.home.com</td>
<td>What's Up Docker</td>
<td>3000</td>
<td>HTTP</td>
<td>Authentik</td>
<td>/</td>
</tr>
<tr>
<td>whoami.home.com</td>
<td>Traefik whoami</td>
<td>80</td>
<td>HTTP</td>
<td>None</td>
<td>/</td>
</tr>
</tbody>
</table>
<h4 id="dns-and-routing-behavior">DNS and Routing Behavior<a class="headerlink" href="#dns-and-routing-behavior" title="Permanent link">&para;</a></h4>
<p>All hostnames are defined via <strong>DNS A records</strong> pointing to the Traefik container's IP address. Traefik handles all routing internally, translating requests like:</p>
<p>https://portainer.home.com → https://192.168.1.126:9443</p>
<p><strong>Example Router Configuration:</strong>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="nt">routers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">portainer-router</span><span class="p">:</span>
<span class="w">      </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Host(`portainer.home.com`)&quot;</span>
<span class="w">      </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">portainer-service</span>
<span class="w">      </span><span class="nt">entryPoints</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">websecure</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">        </span><span class="nt">certResolver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stepca</span>
<span class="w">      </span><span class="nt">middlewares</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authentik</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-headers</span>

<span class="w">  </span><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">portainer-service</span><span class="p">:</span>
<span class="w">      </span><span class="nt">loadBalancer</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serversTransport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">portainer-tls</span>
<span class="w">        </span><span class="nt">servers</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://192.168.1.126:9443&quot;</span>
<span class="w">        </span><span class="nt">passHostHeader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">healthCheck</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">          </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30s&quot;</span>

<span class="w">  </span><span class="nt">middlewares</span><span class="p">:</span>
<span class="w">    </span><span class="nt">authentik</span><span class="p">:</span>
<span class="w">      </span><span class="nt">forwardAuth</span><span class="p">:</span>
<span class="w">        </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://authentik_proxy:9000/outpost.goauthentik.io/auth/traefik&quot;</span>
<span class="w">        </span><span class="nt">trustForwardHeader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">authResponseHeadersRegex</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^X-Authentik-&quot;</span>
<span class="w">        </span><span class="nt">authResponseHeaders</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Username</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Groups</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Entitlements</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Email</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Name</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Uid</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Jwt</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Meta-Jwks</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Meta-Outpost</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Meta-Provider</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Meta-App</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Authentik-Meta-Version</span>
</code></pre></div></p>
<p>This allows services to be accessed via clean FQDNs without exposing backend ports.</p>
<h4 id="tls-termination-and-backend-security">TLS Termination and Backend Security<a class="headerlink" href="#tls-termination-and-backend-security" title="Permanent link">&para;</a></h4>
<p>For services that do not natively support HTTPS or cannot integrate with the lab's PKI infrastructure, Traefik terminates TLS at the edge and forwards traffic to the backend over HTTP. This ensures:</p>
<ul>
<li>Secure communication between client and proxy</li>
<li>Compatibility with legacy or non-PKI-compliant services</li>
<li>Centralized certificate management via Step CA</li>
</ul>
<h3 id="security-controls">Security Controls<a class="headerlink" href="#security-controls" title="Permanent link">&para;</a></h3>
<p><strong>Defense in Depth:</strong></p>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Control</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network</td>
<td>Firewall rules (pfSense)</td>
<td>Only 80/443 exposed</td>
</tr>
<tr>
<td>Edge</td>
<td>Traefik TLS termination</td>
<td>Strong ciphers only</td>
</tr>
<tr>
<td>Authentication</td>
<td>Authentik forward auth</td>
<td>SSO for all services</td>
</tr>
<tr>
<td>Authorization</td>
<td>HTTP headers from Authentik</td>
<td>RBAC enforcement</td>
</tr>
<tr>
<td>Transport</td>
<td>TLS 1.3 only</td>
<td>No downgrade attacks</td>
</tr>
<tr>
<td>Application</td>
<td>Secure headers middleware</td>
<td>HSTS CSP X-Frame-Options</td>
</tr>
<tr>
<td>Audit</td>
<td>Access logs to Elastic</td>
<td>Full request logging</td>
</tr>
</tbody>
</table>
<p><strong>Monitoring and Alerting:</strong></p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Tool</th>
<th>Threshold</th>
<th>Alert</th>
</tr>
</thead>
<tbody>
<tr>
<td>Traefik container down</td>
<td>Uptime Kuma</td>
<td>Service unreachable</td>
<td>Discord</td>
</tr>
<tr>
<td>Certificate expiry</td>
<td>Prometheus</td>
<td>&lt;30 days</td>
<td>Discord</td>
</tr>
<tr>
<td>High error rate</td>
<td>Prometheus</td>
<td>&gt;5% 5xx responses</td>
<td>Discord</td>
</tr>
<tr>
<td>Slow response time</td>
<td>Prometheus</td>
<td>P95 &gt;2 seconds</td>
<td>Discord</td>
</tr>
<tr>
<td>Config reload failures</td>
<td>Traefik logs</td>
<td>Any reload error</td>
<td>Elastic alert</td>
</tr>
</tbody>
</table>
<p><strong>Troubleshooting Tools:</strong></p>
<ul>
<li>Dashboard: https://trfk.home.com:8080/dashboard/</li>
<li>API: <code>curl http://traefik:8080/api/http/routers</code></li>
<li>Logs: <code>docker logs traefik -f --tail 100</code></li>
<li>Debug Mode: Add <code>--log.level=DEBUG</code> to container</li>
</ul>
<div class="two-col-right">
  <div class="text-col">
    <p><strong>Traefik Dashboard:</strong></p>
    <ul>
      <li>Real-time router and service status</li>
      <li>Middleware configuration</li>
      <li>Certificate management</li>
      <li>Health check status</li>
    </ul>
  </div>

  <div class="image-col">
    <figure>
      <img src="/Career_Projects/assets/screenshots/traefik.png" alt="Traefik Dashboard">
      <figcaption style="font-size:0.9rem; color:var(--md-secondary-text-color); margin-top:0.5rem;">
        Traefik Dashboard Overview
      </figcaption>
    </figure>
  </div>
</div>

<h3 id="metallb-and-nginx-ingress-controller-for-k3s-kubernetes-based-services">MetalLB and NGINX Ingress Controller for K3s Kubernetes-Based Services<a class="headerlink" href="#metallb-and-nginx-ingress-controller-for-k3s-kubernetes-based-services" title="Permanent link">&para;</a></h3>
<h4 id="metallb">MetalLB<a class="headerlink" href="#metallb" title="Permanent link">&para;</a></h4>
<p>MetalLB provides network load-balancer implementation for Kubernetes clusters that don't run on cloud providers. It enables services of type LoadBalancer to receive external IP addresses in bare-metal environments.</p>
<p><strong>Core Features:</strong></p>
<ul>
<li><strong>Address Allocation:</strong> Assigns external IPs from a pre-configured pool to Kubernetes services</li>
<li><strong>External Announcement:</strong> Makes assigned IPs reachable on the local network via Layer 2 (ARP/NDP) or BGP</li>
</ul>
<p><strong>Layer 2 Mode Configuration:</strong></p>
<p>In Layer 2 mode, one Kubernetes node takes ownership of the service IP and responds to ARP requests. This provides simple, switch-agnostic load balancing without requiring BGP peering.</p>
<p><strong>Deployment Details:</strong></p>
<ul>
<li>IP pool: 192.168.200.30-192.168.200.49 (20 addresses reserved for K3s services)</li>
<li>ARP announcements via primary node (automatic failover if node fails)</li>
<li>No external dependencies (works with any standard switch)</li>
</ul>
<p><strong>Security Impact:</strong> Eliminates need for NodePort services (which expose random high ports); centralizes ingress traffic through predictable IPs; enables firewall rules based on service IP rather than dynamic ports.</p>
<p><strong>IP Address Pool Configuration:</strong>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPAddressPool</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pool1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">addresses</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.200.30-192.168.200.49</span>
<span class="w">  </span><span class="nt">autoAssign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">L2Advertisement</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pool1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metallb-system</span>
</code></pre></div></p>
<h4 id="nginx-ingress-controller">NGINX Ingress Controller<a class="headerlink" href="#nginx-ingress-controller" title="Permanent link">&para;</a></h4>
<p>The NGINX Ingress Controller translates Kubernetes Ingress resources into NGINX configuration, providing HTTP/HTTPS routing, TLS termination, and load balancing for cluster services.</p>
<p><strong>Integration with MetalLB:</strong></p>
<ol>
<li>Ingress Controller deployed as LoadBalancer service</li>
<li>MetalLB assigns external IP (e.g., 192.168.200.31)</li>
<li>External requests → MetalLB IP → NGINX Ingress → Backend pods</li>
<li>NGINX handles TLS termination, path-based routing, and SSL passthrough</li>
</ol>
<p><strong>Example Ingress Configuration:</strong>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-ingress</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.200.32</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div></p>
<p><strong>Security Features:</strong></p>
<ul>
<li><strong>TLS Termination:</strong> Certificates managed by cert-manager + Step-CA</li>
<li><strong>Authentik Integration:</strong> ForwardAuth via NGINX annotations</li>
<li><strong>Rate Limiting:</strong> NGINX limit_req directives prevent abuse</li>
<li><strong>IP Whitelisting:</strong> nginx.ingress.kubernetes.io/whitelist-source-range annotation</li>
</ul>
<p><strong>Architecture Benefits:</strong></p>
<ul>
<li><strong>Kubernetes-Native Design:</strong> Ingress resources define routing declaratively (no manual NGINX config)</li>
<li><strong>High Availability:</strong> Multiple NGINX replicas (2 pods) with MetalLB failover</li>
<li><strong>Separation of Concerns:</strong> MetalLB handles IP allocation; NGINX handles HTTP routing; cert-manager handles TLS</li>
<li><strong>Observability:</strong> Prometheus metrics exported by both MetalLB and NGINX Ingress</li>
</ul>
<hr />
<h2 id="vulnerability-management">Vulnerability Management<a class="headerlink" href="#vulnerability-management" title="Permanent link">&para;</a></h2>
<p>A mature vulnerability management program provides continuous security assessment across network assets, identifying exploitable weaknesses before attackers can weaponize them. This dual-scanner approach combines OpenVAS (open-source, network-wide scanning) with Tenable Nessus (commercial-grade, authenticated deep inspection) to provide comprehensive coverage across diverse technology stacks including Linux, Windows, containers, network appliances, and Kubernetes clusters.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>Proactive identification of security weaknesses reduces dwell time from months (reactive patching) to days through risk-based prioritization</li>
<li>Authenticated scanning uncovers privilege-escalation paths and configuration weaknesses that network-only scanners cannot detect</li>
<li>Continuous assessment prevents security posture degradation between scheduled scans</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>Vulnerability management is a foundational security control mandated by NIST CSF (DE.CM-8), CIS Controls v8 (Control 7), PCI-DSS (11.2), and ISO 27001 (A.12.6.1). Deploying both OpenVAS and Nessus demonstrates real-world enterprise practices where multiple scanning tools provide defense-in-depth through overlapping coverage.</p>
<p><strong>Architecture Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Vulnerability scanning discovers weaknesses across network, OS, application, and configuration layers before attackers can exploit them</li>
<li><strong>Secure by Design:</strong> Continuous scanning validates security baselines and detects configuration drift from hardened standards</li>
<li><strong>Zero Trust:</strong> Authenticated scans verify security posture of systems regardless of network location; vulnerability data feeds into risk-based access decisions</li>
</ul>
<h3 id="greenbone-openvas">Greenbone OpenVAS<a class="headerlink" href="#greenbone-openvas" title="Permanent link">&para;</a></h3>
<p><strong>Overview:</strong></p>
<p>OpenVAS (Open Vulnerability Assessment System) provides comprehensive vulnerability scanning across network infrastructure and applications. This implementation demonstrates continuous security assessment and remediation workflow integration. The platform scans 75+ assets across four network segments weekly, identifying CVEs, misconfigurations, weak cryptography, and compliance violations.</p>
<p><strong>Deployment Architecture:</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenVAS Scanner</td>
<td>Deployed in a dedicated container with persistent volume for scan data and logs</td>
</tr>
<tr>
<td>Reverse Proxy</td>
<td>Traefik routes requests to OpenVAS UI and API, secured via TLS. ForwardAuth middleware enforces Authentik SSO authentication</td>
</tr>
<tr>
<td>PKI Integration</td>
<td>Fullchain certs propagated via Step CA; scanner trusts internal CA for HTTPS targets</td>
</tr>
<tr>
<td>Dashboard Integration</td>
<td>Scan results exported to Grafana via custom exporter and JSON API bridge</td>
</tr>
</tbody>
</table>
<p><strong>Scanning Architecture:</strong></p>
<p><strong>Target Scope Definition:</strong></p>
<table>
<thead>
<tr>
<th>Network Segment</th>
<th>CIDR</th>
<th>Asset Count</th>
<th>Scan Frequency</th>
</tr>
</thead>
<tbody>
<tr>
<td>Production Network</td>
<td>192.168.1.0/24</td>
<td>~40 hosts</td>
<td>Weekly</td>
</tr>
<tr>
<td>Lab Infrastructure</td>
<td>192.168.100.0/24</td>
<td>~20 hosts</td>
<td>Weekly</td>
</tr>
<tr>
<td>DMZ Services</td>
<td>192.168.2.0/24</td>
<td>~10 hosts</td>
<td>Bi-weekly</td>
</tr>
<tr>
<td>Kubernetes Cluster</td>
<td>192.168.200.0/24</td>
<td>~5 hosts</td>
<td>Weekly</td>
</tr>
</tbody>
</table>
<p><strong>Exclusions:</strong></p>
<ul>
<li>Network devices without SSH/HTTP: 192.168.1.1-192.168.1.10</li>
<li>IoT devices (limited patch capability): 192.168.1.200-250</li>
<li>Active Directory DC (change control required): 192.168.1.10</li>
</ul>
<p><strong>Scan Profiles:</strong></p>
<table>
<thead>
<tr>
<th>Profile Name</th>
<th>Description</th>
<th>Duration</th>
</tr>
</thead>
<tbody>
<tr>
<td>Full and Fast</td>
<td>Comprehensive scan optimized timing</td>
<td>~2 hours</td>
</tr>
<tr>
<td>Discovery</td>
<td>Network and service detection only</td>
<td>~15 min</td>
</tr>
<tr>
<td>System Discovery</td>
<td>OS fingerprinting and basic info</td>
<td>~30 min</td>
</tr>
<tr>
<td>Host Discovery</td>
<td>Ping sweep and port scan only</td>
<td>~5 min</td>
</tr>
</tbody>
</table>
<p><strong>Scan Configuration (Full and Fast):</strong></p>
<ul>
<li>Port Range: 1-65535 (all TCP ports)</li>
<li>UDP Ports: Top 100 common UDP services</li>
<li>OS Detection: Active fingerprinting via TCP/IP stack analysis</li>
<li>Service Detection: Banner grabbing and version detection</li>
<li>TLS/SSL Testing: Certificate validation, weak ciphers, protocol versions</li>
<li>Web App Scanning: Directory enumeration, known vulnerabilities</li>
<li>Authenticated Scans: SSH and SMB credentials for deeper inspection</li>
</ul>
<p><strong>Sample Reports:</strong></p>
<div class="two-col-right">
  <div class="text-col">
    <p><strong>TLS/Certificate Issues:</strong></p>
    <ul>
      <li>Weak cipher suites</li>
      <li>Certificate expiration</li>
      <li>Self-signed certificates</li>
      <li>Protocol vulnerabilities</li>
    </ul>
  </div>

  <div class="image-col">
    <figure>
      <img src="/Career_Projects/assets/screenshots/tls-cert.png" alt="OpenVAS TLS Report">
      <figcaption style="font-size:0.9rem; color:var(--md-secondary-text-color); margin-top:0.5rem;">
        OpenVAS TLS/Certificate Scan Results
      </figcaption>
    </figure>
  </div>
</div>

<p><strong>OS and Service Fingerprinting:</strong></p>
<p><img alt="OpenVAS OS Fingerprinting" src="/Career_Projects/assets/screenshots/os-fp.png" /></p>
<p><strong>Proxmox Host Scan Results:</strong></p>
<p><img alt="OpenVAS Proxmox Scan" src="/Career_Projects/assets/screenshots/openvas-results.png" /></p>
<p>Results from a scan on Proxmox host. After the initial scan, updates to address the critical vulnerability were downloaded and applied.</p>
<h4 id="security-controls_1">Security Controls<a class="headerlink" href="#security-controls_1" title="Permanent link">&para;</a></h4>
<p><strong>Scanner Hardening:</strong></p>
<p><strong>Access Control:</strong></p>
<ul>
<li>Traefik reverse proxy + Authentik SSO enforces MFA before accessing OpenVAS web interface</li>
<li>API Authentication: GMP (Greenbone Management Protocol) API requires username/password authentication; API keys rotated quarterly</li>
<li>Credential Encryption: Scan credentials (SSH keys, service account passwords) encrypted at rest using AES-256; stored in PostgreSQL database with TDE (Transparent Data Encryption)</li>
<li>Audit Logging: All scan activity (task creation, target modifications, report downloads) logged to Splunk SIEM with user attribution</li>
</ul>
<p><strong>Scan Safety Controls:</strong></p>
<ul>
<li>Non-Disruptive Checks: Safe checks enabled by default; exploit-based tests disabled to prevent system crashes</li>
<li>Rate Limiting: Maximum 10 concurrent TCP connections per target; configurable to prevent network congestion or triggering IPS alerts</li>
<li>Excluded Checks: DoS-inducing vulnerability tests (e.g., TCP SYN flood checks) explicitly disabled in scan configurations</li>
<li>Maintenance Windows: Automated scans scheduled during low-traffic periods (Saturday 2-4 AM) to minimize business impact</li>
<li>Rollback Capability: Proxmox snapshots taken before scanning critical infrastructure (VMs, LXC containers); enables instant recovery from scan-induced failures</li>
</ul>
<p><strong>Compliance Alignment:</strong></p>
<p><strong>Framework Mapping:</strong></p>
<table>
<thead>
<tr>
<th>Framework</th>
<th>Requirement</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>NIST CSF</td>
<td>DE.CM-8: Vulnerability scans</td>
<td>Weekly automated scans</td>
</tr>
<tr>
<td>CIS Controls v8</td>
<td>7.1: Vulnerability scanning</td>
<td>Authenticated scans enabled</td>
</tr>
<tr>
<td>PCI-DSS</td>
<td>11.2: Quarterly vulnerability scans</td>
<td>Monthly scans (exceeds req)</td>
</tr>
<tr>
<td>ISO 27001</td>
<td>A.12.6.1: Tech vulnerabilities</td>
<td>Documented remediation SLA</td>
</tr>
</tbody>
</table>
<h3 id="tenable-nessus">Tenable Nessus<a class="headerlink" href="#tenable-nessus" title="Permanent link">&para;</a></h3>
<p><strong>Overview:</strong></p>
<p>Tenable Nessus provides commercial-grade vulnerability scanning with 170,000+ plugins, advanced compliance auditing, and deep authenticated scanning capabilities. While OpenVAS provides broad network coverage, Nessus excels at OS-level inspection via credentialed scans, configuration auditing against CIS Benchmarks, and specialized assessments for Active Directory, Kubernetes, and cloud platforms.</p>
<p><strong>Deployment Rationale:</strong></p>
<p>Nessus complements OpenVAS by providing deeper inspection capabilities and compliance auditing features. Many enterprises deploy both tools for defense-in-depth: OpenVAS for continuous automated scanning and Nessus for quarterly compliance audits and deep-dive investigations.</p>
<p><strong>Technical Implementation:</strong></p>
<p><strong>Scanning Architecture - Authenticated Host Assessments:</strong></p>
<p>Nessus performs authenticated scans against key infrastructure hosts representing each major platform:</p>
<p><strong>Linux and Windows Host Scanning:</strong></p>
<ul>
<li><strong>Windows Server 2022 / Active Directory scanning and enumeration</strong></li>
<li>Hostname: DC01</li>
<li>IP: 192.168.1.152</li>
<li><strong>Windows 11 Pro scanning</strong></li>
<li>Hostname: win11pro2</li>
<li>IP: 192.168.1.184</li>
<li><strong>Red Hat Enterprise Linux 10 with K3s node scanning</strong></li>
<li>Hostname: k3s-worker</li>
<li>IP: 192.168.200.21</li>
<li><strong>Ubuntu Desktop 25.04 with Docker engine scanning</strong></li>
<li>Hostname: ubuntuGenVM1</li>
<li>IP: 192.168.1.126</li>
<li><strong>Debian 12 LXC host scanning</strong></li>
<li>Hostname: stepca</li>
<li>IP: 192.168.100.51</li>
</ul>
<h4 id="example-remediation">Example Remediation<a class="headerlink" href="#example-remediation" title="Permanent link">&para;</a></h4>
<p><strong>Initial Scan:</strong>
Debian Linux Package Vulnerabilities:
- High/Medium CVSS rating
- Multiple outdated packages identified
- CVE details and remediation guidance provided</p>
<p><strong>Detailed Vulnerability Reports:</strong></p>
<p><img alt="Nessus Vulnerability Report 1" src="/Career_Projects/assets/screenshots/nessus-before.png" /></p>
<p><strong>Follow-up Scan After Remediation:</strong></p>
<p><img alt="Nessus Post-Remediation Scan 1" src="/Career_Projects/assets/screenshots/nessus-after.png" /></p>
<p>Removal of all Debian Linux package vulnerabilities. Only remaining identified vulnerability higher than "low" is a false positive related to internal lab certificate issued by an "unknown" CA.</p>
<hr />
<h2 id="software-patch-management">Software Patch Management<a class="headerlink" href="#software-patch-management" title="Permanent link">&para;</a></h2>
<p>A comprehensive, multi-platform patch management strategy ensures timely deployment of security updates across 30+ Linux hosts, 50+ Docker containers, and Windows systems. This layered approach addresses the entire technology stack, from host operating systems to containerized applications, providing centralized visibility, automated monitoring, and controlled deployment workflows that reduce attack surface while maintaining operational stability.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>Reduced attack surface through rapid deployment of security patches</li>
<li>Centralized visibility into patch status prevents vulnerable systems from going unnoticed</li>
<li>SHA-256 integrity verification protects against tampered packages and supply-chain attacks</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>Patch management is a critical component of defense-in-depth strategy, directly addressing NIST CSF "Protect" and CIS Control 7 (Continuous Vulnerability Management). Automated monitoring reduces mean time to detect (MTTD) for new vulnerabilities from weeks to hours, while coordinated deployment workflows minimize service disruption.</p>
<p><strong>Architecture Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Patches eliminate vulnerabilities at OS, runtime, and application layers before they can be exploited</li>
<li><strong>Secure by Design:</strong> Automated monitoring ensures security updates are deployed by default, not as afterthought</li>
<li><strong>Zero Trust:</strong> Continuous verification of software versions prevents reliance on outdated "trusted" configurations</li>
</ul>
<h3 id="linux-software-management-patchmon">Linux Software Management - PatchMon<a class="headerlink" href="#linux-software-management-patchmon" title="Permanent link">&para;</a></h3>
<p>PatchMon provides enterprise-grade visibility into Linux package states across Ubuntu, Debian, RHEL, CentOS, and Fedora systems. The platform monitors 30+ hosts via native package managers (apt, yum, dnf), tracking 5,000+ installed packages and correlating available updates with CVE databases to prioritize security-critical patches.</p>
<p>Key Features:</p>
<ul>
<li>Centralized inventory eliminates shadow IT by discovering all installed packages</li>
<li>CVE mapping enables risk-based patch prioritization</li>
<li>Historical tracking demonstrates continuous security posture improvement</li>
</ul>
<p><strong>Technical Implementation:</strong></p>
<ul>
<li><strong>Agent-Based Monitoring:</strong> Lightweight agents poll package managers every 6 hours for update availability</li>
<li><strong>Vulnerability Correlation:</strong> Available updates cross-referenced with NVD (National Vulnerability Database) to identify security patches vs. feature updates</li>
<li><strong>Multi-Distribution Support:</strong> Unified dashboard aggregates data from Debian-based (apt), RHEL-based (yum/dnf), and Arch-based (pacman) systems</li>
<li><strong>Docker Integration:</strong> Discovers containers running on monitored hosts, tracking base image versions and installed packages within containers</li>
<li><strong>Group-Based Organization:</strong> Hosts categorized by role (LXC containers, VM hosts, Docker hosts) for targeted patch campaigns</li>
<li><strong>Health Monitoring:</strong> Identifies hosts with &gt;50 outstanding updates or &gt;10 security updates as "at-risk" requiring immediate attention</li>
</ul>
<p><strong>Host Information:</strong></p>
<table>
<thead>
<tr>
<th>Friendly Name</th>
<th>System Hostname</th>
<th>IP Address</th>
<th>Group</th>
<th>OS</th>
<th>OS Version</th>
<th>Updates</th>
<th>Security Updates</th>
</tr>
</thead>
<tbody>
<tr>
<td>apache-ubuntu</td>
<td>apache-ubuntu</td>
<td>192.168.1.108</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>25.04 (Plucky Puffin)</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>bentopdf</td>
<td>bentopdf</td>
<td>192.168.2.12</td>
<td>LXC containers</td>
<td>Debian</td>
<td>13 (trixie)</td>
<td>29</td>
<td>0</td>
</tr>
<tr>
<td>bind9-new</td>
<td>bind9-new</td>
<td>192.168.1.251</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>25.04 (Plucky Puffin)</td>
<td>30</td>
<td>13</td>
</tr>
<tr>
<td>centos</td>
<td>centos</td>
<td>192.168.1.93</td>
<td>LXC containers</td>
<td>CentOS</td>
<td>9</td>
<td>51</td>
<td>0</td>
</tr>
<tr>
<td>crowdsec</td>
<td>crowdsec</td>
<td>192.168.1.33</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>33</td>
<td>5</td>
</tr>
<tr>
<td>Dockervm2</td>
<td>Dockervm2</td>
<td>192.168.1.166</td>
<td>DockerVM hosts</td>
<td>Debian</td>
<td>13 (trixie)</td>
<td>214</td>
<td>28</td>
</tr>
<tr>
<td>elastic</td>
<td>elastic</td>
<td>192.168.200.8</td>
<td>VM hosts</td>
<td>Debian</td>
<td>13 (trixie)</td>
<td>37</td>
<td>0</td>
</tr>
<tr>
<td>fedora</td>
<td>fedora</td>
<td>192.168.100.5</td>
<td>VM hosts</td>
<td>Fedora</td>
<td>43 (Server Edition)</td>
<td>113</td>
<td>0</td>
</tr>
<tr>
<td>grafana-debian</td>
<td>grafana-debian</td>
<td>192.168.1.246</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>66</td>
<td>3</td>
</tr>
<tr>
<td>heimdall</td>
<td>heimdall</td>
<td>192.168.200.7</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>38</td>
<td>1</td>
</tr>
<tr>
<td>redhat-k3s-control</td>
<td>k3-control</td>
<td>192.168.200.22</td>
<td>VM hosts</td>
<td>Red Hat Enterprise Linux</td>
<td>10.1 (Coughlan)</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>redhat-k3s-worker</td>
<td>k3-worker</td>
<td>192.168.200.21</td>
<td>VM hosts</td>
<td>Red Hat Enterprise Linux</td>
<td>10.1 (Coughlan)</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>kali</td>
<td>kaliGenVM</td>
<td>192.168.1.100</td>
<td>VM hosts</td>
<td>Kali Linux</td>
<td>2025.4</td>
<td>872</td>
<td>0</td>
</tr>
<tr>
<td>overseerr</td>
<td>overseerr</td>
<td>192.168.100.15</td>
<td>DockerLXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>47</td>
<td>4</td>
</tr>
<tr>
<td>ParrotOS</td>
<td>parrot</td>
<td>192.168.100.16</td>
<td>VM hosts</td>
<td>Parrot Security</td>
<td>7.1 (echo)</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Pi-hole-Ubuntu</td>
<td>Pi-hole-Ubuntu</td>
<td>192.168.1.250</td>
<td>DockerLXC containers</td>
<td>Ubuntu</td>
<td>22.04.5 LTS (Jammy Jellyfish)</td>
<td>44</td>
<td>26</td>
</tr>
<tr>
<td>safeline</td>
<td>safeline-waf</td>
<td>192.168.1.89</td>
<td>DockerVM hosts</td>
<td>Debian</td>
<td>13 (trixie)</td>
<td>41</td>
<td>1</td>
</tr>
<tr>
<td>stepca</td>
<td>stepca</td>
<td>192.168.100.51</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>31</td>
<td>1</td>
</tr>
<tr>
<td>traefik</td>
<td>traefik</td>
<td>192.168.1.247</td>
<td>DockerLXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>37</td>
<td>3</td>
</tr>
<tr>
<td>Dockervm1</td>
<td>UbuntuVM1</td>
<td>192.168.1.126</td>
<td>DockerVM hosts</td>
<td>Ubuntu</td>
<td>25.10 (Questing Quokka)</td>
<td>9</td>
<td>0</td>
</tr>
<tr>
<td>unbound</td>
<td>unbound</td>
<td>192.168.1.252</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>22.04.5 LTS (Jammy Jellyfish)</td>
<td>34</td>
<td>20</td>
</tr>
<tr>
<td>uptime-kuma-debian</td>
<td>uptime-kuma-debian</td>
<td>192.168.1.181</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>vaultwarden</td>
<td>vaultwarden</td>
<td>192.168.1.4</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>44</td>
<td>6</td>
</tr>
<tr>
<td>ansible</td>
<td>ansible</td>
<td>192.168.1.25</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>69</td>
<td>0</td>
</tr>
<tr>
<td>debian-Extlan</td>
<td>debian-Extlan</td>
<td>192.168.2.5</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>4</td>
<td>3</td>
</tr>
<tr>
<td>Jellyfin-Ubuntu</td>
<td>Jellyfin-Ubuntu</td>
<td>192.168.200.244</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>22.04.5 LTS (Jammy Jellyfish)</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Plex-Ubuntu</td>
<td>Plex-Ubuntu</td>
<td>192.168.1.136</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>22.04.5 LTS (Jammy Jellyfish)</td>
<td>34</td>
<td>21</td>
</tr>
<tr>
<td>Ubuntu-pfS</td>
<td>Ubuntu-pfS</td>
<td>192.168.100.4</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>25.10 (Questing Quokka)</td>
<td>49</td>
<td>27</td>
</tr>
<tr>
<td>ubuntu-pfS2</td>
<td>ubuntu-pfS2</td>
<td>192.168.200.5</td>
<td>LXC containers</td>
<td>Ubuntu</td>
<td>25.10 (Questing Quokka)</td>
<td>49</td>
<td>27</td>
</tr>
<tr>
<td>wazuh</td>
<td>wazuh</td>
<td>192.168.1.219</td>
<td>LXC containers</td>
<td>Debian</td>
<td>12 (bookworm)</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>splunk</td>
<td>N/A</td>
<td>N/A</td>
<td>VM hosts</td>
<td>unknown</td>
<td>unknown</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>kms-iso</td>
<td>N/A</td>
<td>N/A</td>
<td>LXC containers</td>
<td>unknown</td>
<td>unknown</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="initial-overview-pre-patching">Initial Overview - Pre-Patching<a class="headerlink" href="#initial-overview-pre-patching" title="Permanent link">&para;</a></h4>
<p><img alt="PatchMon Overview" src="/Career_Projects/assets/screenshots/patchmon-overview.png" /></p>
<h4 id="initial-host-scan">Initial Host Scan<a class="headerlink" href="#initial-host-scan" title="Permanent link">&para;</a></h4>
<p><strong>Host: parrot, parrot-security-7, 6.12.57+deb13-amd64</strong></p>
<p><img alt="PatchMon Parrot Initial 1" src="/Career_Projects/assets/screenshots/patchmon-before.png" /></p>
<p><strong>Outdated packages:</strong> 156, <strong>Security updates:</strong> 27</p>
<h4 id="post-patching-scan">Post-Patching Scan<a class="headerlink" href="#post-patching-scan" title="Permanent link">&para;</a></h4>
<p><strong>Host: parrot, parrot-security-7.1, 6.17.13+2-amd64</strong></p>
<p><img alt="PatchMon Parrot After 1" src="/Career_Projects/assets/screenshots/patchmon-after.png" /></p>
<p><strong>Outdated packages:</strong> 0, <strong>Security updates:</strong> 0</p>
<h3 id="windows-software-management-windows-server-update-services-wsus">Windows Software Management - Windows Server Update Services (WSUS)<a class="headerlink" href="#windows-software-management-windows-server-update-services-wsus" title="Permanent link">&para;</a></h3>
<p>Windows Server Update Services provides centralized control over Microsoft product updates across Windows Server and Windows 10/11 endpoints. Unlike consumer Windows Update, WSUS enables approval workflows, phased deployments, and internal update distribution without requiring every client to download patches from Microsoft's servers.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li>Controlled deployment prevents zero-day patches from breaking production systems</li>
<li>Bandwidth optimization reduces internet consumption by 80% (clients download once to WSUS, then distribute internally)</li>
<li>Compliance reporting demonstrates adherence to patch SLAs for audits</li>
</ul>
<p><strong>Technical Implementation:</strong></p>
<ul>
<li><strong>Centralized Update Server:</strong> WSUS server synchronizes with Microsoft Update catalog daily, downloading metadata and binaries for approved patch categories</li>
<li><strong>Approval Workflow:</strong> Administrators review updates in staging environment before approving for production deployment</li>
<li><strong>Computer Groups:</strong> Clients organized by role (Domain Controllers, File Servers, Workstations) enabling phased rollout (test group → production group)</li>
<li><strong>Automatic Deployment Rules:</strong> Critical security updates auto-approved for deployment within 24 hours; feature updates require manual approval</li>
<li><strong>Supersedence Handling:</strong> WSUS declines superseded updates automatically, preventing installation of outdated patches</li>
<li><strong>Reporting Dashboard:</strong> Compliance reports show installation status (installed, pending, failed) per computer and update</li>
</ul>
<p><strong>Integration with Active Directory:</strong></p>
<ul>
<li>Group Policy Objects (GPOs) enforce WSUS configuration across all domain-joined Windows systems</li>
<li>WSUS server URL, update installation schedules, and reboot behavior centrally managed</li>
<li>Non-compliant clients automatically remediated via GPO enforcement</li>
</ul>
<h3 id="docker-container-software-management">Docker Container Software Management<a class="headerlink" href="#docker-container-software-management" title="Permanent link">&para;</a></h3>
<p><strong>Watchtower &amp; WUD (What's Up Docker):</strong> WUD provides visibility into outdated images, while Watchtower automates the update process for approved containers.</p>
<h4 id="whats-up-docker-wud">What's Up Docker (WUD)<a class="headerlink" href="#whats-up-docker-wud" title="Permanent link">&para;</a></h4>
<div class="two-col-right">
  <div class="text-col">
    <p>
      WUD monitors 50+ running containers across 4 Docker engines (UbuntuVM1, Dockervm2, SafeLine-WAF, Pi-hole-Ubuntu), checking Docker Hub, GitHub Container Registry, and private registries for image updates every 6 hours.
    </p>
  </div>

  <div class="image-col">
    <figure>
      <img src="/Career_Projects/assets/screenshots/wud.png" alt="WUD Dashboard">
      <figcaption style="font-size:0.9rem; color:var(--md-secondary-text-color); margin-top:0.5rem;">
        What's Up Docker Dashboard
      </figcaption>
    </figure>
  </div>
</div>

<p><strong>Technical Implementation:</strong></p>
<ul>
<li><strong>Multi-Engine Support:</strong> Connects to local and remote Docker daemons via TCP socket (TLS encrypted)</li>
<li><strong>Registry Integration:</strong> Authenticates with Docker Hub, GHCR, and private registries to query image tags</li>
<li><strong>Semantic Versioning:</strong> Detects new versions using semver comparison (1.2.3 → 1.2.4 = patch, 1.2.x → 1.3.0 = minor)</li>
<li><strong>Webhook Notifications:</strong> Sends Discord alerts when new versions available, including changelog links and vulnerability fix details</li>
<li><strong>Tag Tracking:</strong> Monitors specific tags (e.g., latest, stable, 1.x) and alerts when tag points to new digest</li>
</ul>
<p><img alt="WUD Container List 1" src="/Career_Projects/assets/screenshots/wud-containers-1.png" /></p>
<p><img alt="WUD Container List 2" src="/Career_Projects/assets/screenshots/wud-containers-2.png" /></p>
<h4 id="watchtower">Watchtower<a class="headerlink" href="#watchtower" title="Permanent link">&para;</a></h4>
<p>Watchtower monitors approved containers and automatically pulls new images, stops old containers, and starts updated versions with identical configurations. This "self-healing" approach ensures critical infrastructure containers (monitoring agents, log forwarders) remain current without manual intervention.</p>
<p><strong>Technical Implementation:</strong></p>
<ul>
<li><strong>Selective Monitoring:</strong> Only updates containers with <code>com.centurylinklabs.watchtower.enable=true</code> label, preventing unintended updates to production applications</li>
<li><strong>Configuration Preservation:</strong> Recreates containers with original environment variables, volumes, networks, and port mappings</li>
<li><strong>Cleanup:</strong> Removes old images after successful update to reclaim disk space</li>
<li><strong>Rollback Capability:</strong> Failed updates trigger automatic rollback to previous image version</li>
<li><strong>Notification Integration:</strong> Sends Discord webhook on successful update or rollback event</li>
<li><strong>Scheduling:</strong> Runs daily at 1 AM during low-traffic period</li>
</ul>
<p><strong>Deployment Strategy:</strong></p>
<ul>
<li><strong>WUD Only (Manual Updates):</strong> Production application containers (databases, web apps) require approval before updates</li>
<li><strong>WUD + Watchtower (Auto-Updates):</strong> Infrastructure containers with low change risk (Prometheus exporters, logging agents, Grafana dashboards)</li>
</ul>
<hr />
<h2 id="malware-protection-management">Malware Protection Management<a class="headerlink" href="#malware-protection-management" title="Permanent link">&para;</a></h2>
<h3 id="deployment-overview_1">Deployment Overview<a class="headerlink" href="#deployment-overview_1" title="Permanent link">&para;</a></h3>
<p>The malware protection layer provides host-based antivirus and antimalware capabilities across all operating systems in the lab environment. ClamAV delivers open-source malware scanning for Linux, FreeBSD, and macOS systems, while Microsoft Defender provides real-time protection, behavioral analysis, and cloud-assisted threat detection for Windows hosts.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>Detects known malware, trojans, ransomware, and malicious binaries</li>
<li>Provides real-time protection on Windows systems through Microsoft Defender</li>
<li>Enables scheduled and on-demand scanning across Linux, BSD, and macOS via ClamAV</li>
<li>Integrates with SIEM and SOAR platforms for automated alerting and response</li>
<li>Supports file quarantine, signature updates, and threat classification</li>
<li>Enhances endpoint-layer detection to complement network and SIEM telemetry</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>Malware protection is a foundational security control across enterprise environments. This deployment demonstrates the ability to manage multi-OS antivirus solutions, integrate them with SIEM/SOAR workflows, and maintain consistent scanning policies across diverse systems.</p>
<p><strong>Architecture Principles Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Adds endpoint-level malware detection beneath SIEM, EDR, and IDS layers; multiple engines reduce reliance on a single signature source; complements network-based detection with host-level scanning</li>
<li><strong>Secure by Design:</strong> Automated signature updates ensure current detection capabilities; real-time protection on Windows reduces exposure to active threats; scheduled scanning enforces consistent hygiene across all systems</li>
<li><strong>Zero Trust:</strong> No file or process is implicitly trusted; all are subject to scanning; continuous monitoring ensures rapid detection of malicious activity; integration with SOAR enforces validation before remediation actions</li>
</ul>
<hr />
<h2 id="web-services-architecture">Web Services Architecture<a class="headerlink" href="#web-services-architecture" title="Permanent link">&para;</a></h2>
<h3 id="deployment-overview_2">Deployment Overview<a class="headerlink" href="#deployment-overview_2" title="Permanent link">&para;</a></h3>
<p>The web services layer hosts internal dashboards, application endpoints, and Windows-based update services across multiple platforms. Apache2 is deployed within an LXC container to serve the external lab dashboard and internal web applications. NGINX operates within the K3s cluster, providing reverse proxying, ingress routing, and application hosting for containerized workloads. Microsoft IIS runs on Windows Server Domain Controllers to support Windows Server Update Services (WSUS) and internal enterprise web functions.</p>
<p>These services are protected by the SafeLine WAF, which currently secures four separate web portals—including the Apache external lab dashboard and the NGINX web server in K3s. Active protections include intelligent web threat detection, bot mitigation, and HTTP-flood DDoS protection. Where required, additional authorization is enforced through Authentik using OIDC, ensuring strong identity-based access control for sensitive dashboards and administrative interfaces.</p>
<p><strong>Security Impact</strong></p>
<ul>
<li>Segmented hosting reduces blast radius across LXC, Kubernetes, and Windows Server</li>
<li>SafeLine WAF provides intelligent threat detection, bot filtering, and DDoS mitigation for all protected portals</li>
<li>Authentik/OIDC adds identity-aware access control for sensitive web applications</li>
<li>TLS termination and reverse proxying via NGINX protect backend services</li>
<li>IIS supports secure distribution of Windows updates through WSUS</li>
<li>Apache2 provides isolated hosting for external and internal dashboards</li>
<li>Logging across all web servers supports SIEM correlation and threat hunting</li>
</ul>
<p><strong>Deployment Rationale:</strong></p>
<p>Web services are essential for internal dashboards, update distribution, and application hosting. Deploying Apache2, NGINX, and IIS across different infrastructure layers demonstrates proficiency with multi-platform web hosting, reverse proxying, ingress management, and Windows-based enterprise services.</p>
<p><strong>Architecture Principles Alignment:</strong></p>
<ul>
<li><strong>Defense in Depth:</strong> Multiple web servers isolate workloads across containers, Kubernetes, and Windows; SafeLine WAF adds a dedicated protection layer before traffic reaches backend services; reverse proxying and ingress control provide additional filtering and segmentation; WSUS reduces exposure to external update sources</li>
<li><strong>Secure by Design:</strong> TLS-secured endpoints and hardened configurations across all web servers; Authentik/OIDC enforces strong authentication and access control; segmented hosting reduces cross-service exposure; logging and monitoring integrated with SIEM and SOAR</li>
<li><strong>Zero Trust:</strong> No inbound request is implicitly trusted; all traffic passes through WAF and controlled ingress; identity-based access enforced through Authentik/OIDC; continuous monitoring validates service integrity and request behavior</li>
</ul>
<p><strong>Configuration:</strong></p>
<ul>
<li><strong>Apache2:</strong> Deployed within an LXC container supporting an internal dashboard</li>
<li><strong>NGINX:</strong> Deployed within K3s cluster supporting internal workloads</li>
<li><strong>Microsoft IIS:</strong> Deployed on Windows Server Domain Controllers supporting Windows Server Update Services</li>
</ul>
<hr />
<h2 id="service-integration-architecture">Service Integration Architecture<a class="headerlink" href="#service-integration-architecture" title="Permanent link">&para;</a></h2>
<p><strong>Integration Patterns:</strong></p>
<p>The lab services are interconnected through multiple integration patterns, demonstrating enterprise architecture principles:</p>
<table>
<thead>
<tr>
<th>Integration Type</th>
<th>Pattern</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authentication</td>
<td>SSO (OAuth2/OIDC)</td>
<td>Authentik → All web services</td>
</tr>
<tr>
<td>Observability</td>
<td>Metrics Pull</td>
<td>Prometheus → Service exporters</td>
</tr>
<tr>
<td>Logging</td>
<td>Centralized Syslog</td>
<td>All services → Splunk/Elastic</td>
</tr>
<tr>
<td>Service Discovery</td>
<td>DNS + Reverse Proxy</td>
<td>Pi-hole + Traefik</td>
</tr>
<tr>
<td>Secret Management</td>
<td>Centralized Vault</td>
<td>Services → Vaultwarden API</td>
</tr>
<tr>
<td>Certificate Distribution</td>
<td>ACME Protocol</td>
<td>Traefik → Step-CA</td>
</tr>
<tr>
<td>Workflow Orchestration</td>
<td>Event-Driven</td>
<td>n8n → Ansible, GitHub, Discord</td>
</tr>
<tr>
<td>Configuration Management</td>
<td>Infrastructure as Code</td>
<td>Ansible → All Linux hosts</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="use-cases-and-deployment-scenarios">Use Cases and Deployment Scenarios<a class="headerlink" href="#use-cases-and-deployment-scenarios" title="Permanent link">&para;</a></h2>
<h3 id="scenario-1-zero-trust-web-access">Scenario 1: Zero-Trust Web Access<a class="headerlink" href="#scenario-1-zero-trust-web-access" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Securely access Portainer from any device without VPN</p>
<p><strong>Workflow:</strong></p>
<ol>
<li>User navigates to https://portainer.home.com from laptop</li>
<li>DNS query: Laptop → Pi-hole → Bind9 → Returns 192.168.1.126</li>
<li>HTTPS request: Laptop → Traefik (192.168.1.126:443)</li>
<li>Traefik checks for valid session cookie</li>
<li>No session found → Redirect to Authentik SSO</li>
<li>User authenticates: username + password + TOTP (Microsoft Authenticator)</li>
<li>Authentik validates credentials, checks MFA, issues JWT token</li>
<li>Redirect back to Traefik with OAuth2 authorization code</li>
<li>Traefik exchanges code for access token, creates session cookie</li>
<li>Traefik forwards request to Portainer backend (192.168.1.126:9443)</li>
<li>Traefik injects headers: X-authentik-username, X-authentik-email</li>
<li>Portainer receives authenticated request, user accesses dashboard</li>
</ol>
<p><strong>Result:</strong> Secure, passwordless access with MFA enforcement. No credentials stored in browser, session expires after 12 hours.</p>
<h3 id="scenario-2-automated-vulnerability-remediation">Scenario 2: Automated Vulnerability Remediation<a class="headerlink" href="#scenario-2-automated-vulnerability-remediation" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Detect and patch vulnerabilities within SLA timeframe</p>
<p><strong>Workflow:</strong></p>
<ol>
<li>Sunday 2 AM: OpenVAS scan runs on 192.168.1.0/24 network</li>
<li>Scan completes: 2 Critical, 5 High, 15 Medium vulnerabilities found</li>
<li>OpenVAS generates XML report with CVE details</li>
<li>n8n workflow polls OpenVAS API every hour</li>
<li>n8n detects new Critical vulnerability: CVE-2024-12345 (OpenSSH RCE)</li>
<li>n8n workflow:</li>
<li>Parses CVE details and affected hosts</li>
<li>Creates GitHub Issue with vulnerability details, affected hosts, patch commands</li>
<li>Labels: security, critical, needs-patch</li>
<li>Sends Discord notification to #security channel with CVE link</li>
<li>Admin receives alert within minutes</li>
<li>Admin reviews CVE details on NVD database</li>
<li>Admin tests patch in dev environment</li>
<li>Admin applies patch via Ansible playbook: <code>ansible-playbook -i hosts.yml patch_openssh.yml --limit affected-hosts</code></li>
<li>Ansible updates OpenSSH package on 5 affected hosts</li>
<li>Admin marks GitHub issue as resolved</li>
<li>Next Sunday: OpenVAS re-scan confirms vulnerability remediated</li>
</ol>
<p><strong>Result:</strong> 7-day critical SLA met. Full audit trail from detection → remediation → verification.</p>
<h3 id="scenario-3-dns-based-ad-blocking">Scenario 3: DNS-Based Ad Blocking<a class="headerlink" href="#scenario-3-dns-based-ad-blocking" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Block ads and trackers network-wide without per-device configuration</p>
<p><strong>Workflow:</strong></p>
<ol>
<li>IoT device (smart TV) attempts to fetch ad: ad.doubleclick.net</li>
<li>DNS query: Smart TV → Pi-hole (192.168.1.250:53)</li>
<li>Pi-hole checks query against 250,000 blocklists</li>
<li>Match found: ad.doubleclick.net in blocklist</li>
<li>Pi-hole returns: 0.0.0.0 (or NXDOMAIN)</li>
<li>Smart TV receives "no such domain" response</li>
<li>Ad request fails, content loads without ad</li>
<li>Pi-hole logs query for statistics</li>
</ol>
<p><strong>Result:</strong> Network-wide ad blocking without browser extensions. Protects all devices including IoT.</p>
<h3 id="scenario-4-certificate-lifecycle-management">Scenario 4: Certificate Lifecycle Management<a class="headerlink" href="#scenario-4-certificate-lifecycle-management" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Automatic certificate renewal without manual intervention</p>
<p><strong>Workflow:</strong></p>
<ol>
<li><strong>Day 0:</strong> Traefik requests certificate for portainer.home.com</li>
<li>ACME HTTP-01 challenge to Step-CA</li>
<li>Certificate issued: 365-day validity</li>
<li>Stored in /acme.json</li>
<li><strong>Day 335</strong> (30 days before expiry): Traefik triggers renewal</li>
<li>Traefik initiates ACME renewal request</li>
<li>Step-CA validates domain ownership again</li>
<li>New certificate issued with fresh 365-day validity</li>
<li>Old certificate replaced in acme.json</li>
<li>Traefik hot-reloads certificate (no downtime)</li>
<li><strong>Day 330</strong> (if renewal failed): Alert triggered</li>
<li>Custom script checks certificate expiry daily</li>
<li>Certificate &lt;30 days → Discord alert sent</li>
<li>Admin investigates: Check Step-CA logs, network connectivity</li>
<li>Manual renewal if needed: Restart Traefik to retry</li>
</ol>
<p><strong>Result:</strong> Zero-touch certificate management. 100% uptime during renewals. Alerts only on failures.</p>
<h3 id="scenario-5-distributed-logging-and-incident-investigation">Scenario 5: Distributed Logging and Incident Investigation<a class="headerlink" href="#scenario-5-distributed-logging-and-incident-investigation" title="Permanent link">&para;</a></h3>
<p><strong>Objective:</strong> Investigate failed login attempts across all services</p>
<p><strong>Workflow:</strong></p>
<ol>
<li>Security team suspects brute force attack</li>
<li>Analyst logs into Splunk: https://splunk.home.com</li>
<li>
<p>Runs SPL query:
<div class="highlight"><pre><span></span><code>index=linux sourcetype=syslog &quot;Failed password&quot;
| stats count by src_ip, dest_host
| where count &gt; 10
| sort -count
</code></pre></div></p>
</li>
<li>
<p>Results show:</p>
</li>
<li>Source IP: 192.168.1.99 (unknown device)</li>
<li>Target: 5 different hosts</li>
<li>Failed attempts: 150 in last hour</li>
<li>
<p>Analyst pivots to authentication logs:
<div class="highlight"><pre><span></span><code>index=auth sourcetype=authentik
| search src_ip=&quot;192.168.1.99&quot;
</code></pre></div></p>
</li>
<li>
<p>Finds Authentik login failures with username enumeration attempts</p>
</li>
<li>Analyst checks network context:</li>
<li>MAC address lookup: IoT device (compromised smart bulb)</li>
<li>First seen: 2 hours ago</li>
<li>Remediation:</li>
<li>Block IP at pfSense firewall</li>
<li>Disconnect device from network</li>
<li>Factory reset device</li>
<li>Update firmware</li>
</ol>
<p><strong>Result:</strong> Full attack lifecycle documented in SIEM. Incident contained within 30 minutes of detection.</p>
<hr />
<h2 id="security-homelab-section-links">Security Homelab Section Links<a class="headerlink" href="#security-homelab-section-links" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><a href="/Career_Projects/projects/homelab/01-exec-summary/">Executive Summary and Security Posture</a></strong></li>
<li><strong><a href="/Career_Projects/projects/homelab/02-platform/">Infrastructure Platform, Virtualization Stack and Hardware</a></strong> </li>
<li><strong><a href="/Career_Projects/projects/homelab/03-network/">Network Security, Privacy and Remote Access</a></strong> </li>
<li><strong><a href="/Career_Projects/projects/homelab/04-iam-secrets/">Identity, Access, Secrets and Trust Management</a></strong> </li>
<li><strong><a href="/Career_Projects/projects/homelab/05-auto-iac/">Automation and IaC</a></strong></li>
<li><strong><a href="/Career_Projects/projects/homelab/06-apps-service/">Applications and Services</a></strong></li>
<li><strong><a href="/Career_Projects/projects/homelab/07-vis-response-pt1/">Observability and Response, Part 1</a></strong></li>
<li><strong><a href="/Career_Projects/projects/homelab/08-vis-response-pt2/">Observability and Response, Part 2</a></strong></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.sections", "navigation.expand", "content.code.copy", "content.tabs.link", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>